Linear Algebra and Its Applications 
Fourth Edition 
Gilbert Strang 
y 
x .. y ..z 
z 
Ax .. b 
b 
0 
Ay .. b 
Az .. 0 
0
Contents 
Preface iv 
1 Matrices and Gaussian Elimination 1 
1.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 
1.2 The Geometry of Linear Equations . . . . . . . . . . . . . . . . . . . . 4 
1.3 An Example of Gaussian Elimination . . . . . . . . . . . . . . . . . . 13 
1.4 Matrix Notation and Matrix Multiplication . . . . . . . . . . . . . . . . 21 
1.5 Triangular Factors and Row Exchanges . . . . . . . . . . . . . . . . . 36 
1.6 Inverses and Transposes . . . . . . . . . . . . . . . . . . . . . . . . . . 50 
1.7 Special Matrices and Applications . . . . . . . . . . . . . . . . . . . . 66 
Review Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72 
2 Vector Spaces 77 
2.1 Vector Spaces and Subspaces . . . . . . . . . . . . . . . . . . . . . . . 77 
2.2 Solving Ax = 0 and Ax = b . . . . . . . . . . . . . . . . . . . . . . . . 86 
2.3 Linear Independence, Basis, and Dimension . . . . . . . . . . . . . . . 103 
2.4 The Four Fundamental Subspaces . . . . . . . . . . . . . . . . . . . . 115 
2.5 Graphs and Networks . . . . . . . . . . . . . . . . . . . . . . . . . . . 129 
2.6 Linear Transformations . . . . . . . . . . . . . . . . . . . . . . . . . . 140 
Review Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 154 
3 Orthogonality 159 
3.1 Orthogonal Vectors and Subspaces . . . . . . . . . . . . . . . . . . . . 159 
3.2 Cosines and Projections onto Lines . . . . . . . . . . . . . . . . . . . . 171 
3.3 Projections and Least Squares . . . . . . . . . . . . . . . . . . . . . . 180 
3.4 Orthogonal Bases and Gram-Schmidt . . . . . . . . . . . . . . . . . . 195 
3.5 The Fast Fourier Transform . . . . . . . . . . . . . . . . . . . . . . . . 211 
Review Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221 
i
ii CONTENTS 
4 Determinants 225 
4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 225 
4.2 Properties of the Determinant . . . . . . . . . . . . . . . . . . . . . . . 227 
4.3 Formulas for the Determinant . . . . . . . . . . . . . . . . . . . . . . . 236 
4.4 Applications of Determinants . . . . . . . . . . . . . . . . . . . . . . . 247 
Review Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 258 
5 Eigenvalues and Eigenvectors 260 
5.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 260 
5.2 Diagonalization of a Matrix . . . . . . . . . . . . . . . . . . . . . . . . 273 
5.3 Difference Equations and Powers Ak . . . . . . . . . . . . . . . . . . . 283 
5.4 Differential Equations and eAt . . . . . . . . . . . . . . . . . . . . . . 296 
5.5 Complex Matrices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 312 
5.6 Similarity Transformations . . . . . . . . . . . . . . . . . . . . . . . . 325 
Review Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 341 
6 Positive Definite Matrices 345 
6.1 Minima, Maxima, and Saddle Points . . . . . . . . . . . . . . . . . . . 345 
6.2 Tests for Positive Definiteness . . . . . . . . . . . . . . . . . . . . . . 352 
6.3 Singular Value Decomposition . . . . . . . . . . . . . . . . . . . . . . 367 
6.4 Minimum Principles . . . . . . . . . . . . . . . . . . . . . . . . . . . 376 
6.5 The Finite Element Method . . . . . . . . . . . . . . . . . . . . . . . . 384 
7 Computations with Matrices 390 
7.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 390 
7.2 Matrix Norm and Condition Number . . . . . . . . . . . . . . . . . . . 391 
7.3 Computation of Eigenvalues . . . . . . . . . . . . . . . . . . . . . . . 399 
7.4 Iterative Methods for Ax = b . . . . . . . . . . . . . . . . . . . . . . . 407 
8 Linear Programming and Game Theory 417 
8.1 Linear Inequalities . . . . . . . . . . . . . . . . . . . . . . . . . . . . 417 
8.2 The Simplex Method . . . . . . . . . . . . . . . . . . . . . . . . . . . 422 
8.3 The Dual Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 434 
8.4 Network Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 444 
8.5 Game Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 451 
A Intersection, Sum, and Product of Spaces 459 
A.1 The Intersection of Two Vector Spaces . . . . . . . . . . . . . . . . . . 459 
A.2 The Sum of Two Vector Spaces . . . . . . . . . . . . . . . . . . . . . . 460 
A.3 The Cartesian Product of Two Vector Spaces . . . . . . . . . . . . . . . 461 
A.4 The Tensor Product of Two Vector Spaces . . . . . . . . . . . . . . . . 461 
A.5 The Kronecker Product A­B of Two Matrices . . . . . . . . . . . . . 462
CONTENTS iii 
B The Jordan Form 466 
C Matrix Factorizations 473 
D Glossary: A Dictionary for Linear Algebra 475 
E MATLAB Teaching Codes 484 
F Linear Algebra in a Nutshell 486 
AT~y = ~0 
A~x = ~0 
~0 
~0 
Rn Rm 
Row Space Column Space 
all AT~y all A~x 
Null 
Space Left 
Null Space 
A~x =~b 
AT~y = ~c 
C(AT) 
dim r 
C(A) 
dim r 
N(A) 
dim n . r 
N(AT) 
dim m . r 
.. .. 
.. 
.. 
..
Preface 
Revising this textbook has been a special challenge, for a very nice reason. So many 
people have read this book, and taught from it, and even loved it. The spirit of the book 
could never change. This text was written to help our teaching of linear algebra keep up 
with the enormous importance of this subject—which just continues to grow. 
One step was certainly possible and desirable—to add new problems. Teaching for all 
these years required hundreds of new exam questions (especially with quizzes going onto 
the web). I think you will approve of the extended choice of problems. The questions are 
still a mixture of explain and compute—the two complementary approaches to learning 
this beautiful subject. 
I personally believe that many more people need linear algebra than calculus. Isaac 
Newton might not agree! But he isn’t teaching mathematics in the 21st century (and 
maybe he wasn’t a great teacher, but we will give him the benefit of the doubt). Certainly 
the laws of physics are well expressed by differential equations. Newton needed 
calculus—quite right. But the scope of science and engineering and management (and 
life) is now so much wider, and linear algebra has moved into a central place. 
May I say a little more, because many universities have not yet adjusted the balance 
toward linear algebra. Working with curved lines and curved surfaces, the first step is 
always to linearize. Replace the curve by its tangent line, fit the surface by a plane, 
and the problem becomes linear. The power of this subject comes when you have ten 
variables, or 1000 variables, instead of two. 
You might think I am exaggerating to use the word “beautiful” for a basic course 
in mathematics. Not at all. This subject begins with two vectors v and w, pointing in 
different directions. The key step is to take their linear combinations. We multiply to 
get 3v and 4w, and we add to get the particular combination 3v+4w. That new vector 
is in the same plane as v and w. When we take all combinations, we are filling in the 
whole plane. If I draw v and w on this page, their combinations cv+dw fill the page 
(and beyond), but they don’t go up from the page. 
In the language of linear equations, I can solve cv+dw = b exactly when the vector 
b lies in the same plane as v and w. 
iv
v 
Matrices 
I will keep going a little more to convert combinations of three-dimensional vectors into 
linear algebra. If the vectors are v=(1;2;3) and w=(1;3;4), put them into the columns 
of a matrix: 
matrix = 
2
64
1 1 
2 3 
3 4
3
75
: 
To find combinations of those columns, “multiply” the matrix by a vector (c;d): 
Linear combinations cv+dw 
2
64
1 1 
2 3 
3 4
3
75 
"
c
d
# 
= c
2
64
1
2
3
3
75
+d
2
64
1
3
4
3
75
: 
Those combinations fill a vector space. We call it the column space of the matrix. (For 
these two columns, that space is a plane.) To decide if b = (2;5;7) is on that plane, we 
have three components to get right. So we have three equations to solve: 
2
64
1 1 
2 3 
3 4
3
75 
"
c
d
# 
= 
2
64
2
5
7
3
75
means 
c+ d = 2 
2c+3d = 5 
3c+4d = 7 
: 
I leave the solution to you. The vector b = (2;5;7) does lie in the plane of v and w. 
If the 7 changes to any other number, then b won’t lie in the plane—it will not be a 
combination of v and w, and the three equations will have no solution. 
Now I can describe the first part of the book, about linear equations Ax = b. The 
matrix A has n columns and m rows. Linear algebra moves steadily to n vectors in mdimensional 
space. We still want combinations of the columns (in the column space). 
We still get m equations to produce b (one for each row). Those equations may or may 
not have a solution. They always have a least-squares solution. 
The interplay of columns and rows is the heart of linear algebra. It’s not totally easy, 
but it’s not too hard. Here are four of the central ideas: 
1. The column space (all combinations of the columns). 
2. The row space (all combinations of the rows). 
3. The rank (the number of independent columns) (or rows). 
4. Elimination (the good way to find the rank of a matrix). 
I will stop here, so you can start the course.
vi PREFACE 
Web Pages 
It may be helpful to mention the web pages connected to this book. So many messages 
come back with suggestions and encouragement, and I hope you will make free use 
of everything. You can directly access http://web.mit.edu/18.06, which is continually 
updated for the course that is taught every semester. Linear algebra is also on MIT’s 
OpenCourseWare site http://ocw.mit.edu, where 18.06 became exceptional by including 
videos of the lectures (which you definitely don’t have to watch...). Here is a part of 
what is available on the web: 
1. Lecture schedule and current homeworks and exams with solutions. 
2. The goals of the course, and conceptual questions. 
3. Interactive Java demos (audio is now included for eigenvalues). 
4. Linear Algebra Teaching Codes and MATLAB problems. 
5. Videos of the complete course (taught in a real classroom). 
The course page has become a valuable link to the class, and a resource for the students. 
I am very optimistic about the potential for graphics with sound. The bandwidth for 
voiceover is low, and FlashPlayer is freely available. This offers a quick review (with 
active experiment), and the full lectures can be downloaded. I hope professors and 
students worldwide will find these web pages helpful. My goal is to make this book as 
useful as possible with all the course material I can provide. 
Other Supporting Materials 
Student Solutions Manual 0-495-01325-0 The Student Solutions Manual provides 
solutions to the odd-numbered problems in the text. 
Instructor’s Solutions Manual 0-030-10588-4 The Instructor’s Solutions Manual 
has teaching notes for each chapter and solutions to all of the problems in the text. 
Structure of the Course 
The two fundamental problems are Ax = b and Ax =l x for square matrices A. The first 
problem Ax = b has a solution when A has independent columns. The second problem 
Ax = l x looks for independent eigenvectors. A crucial part of this course is to learn 
what “independence” means. 
I believe that most of us learn first from examples. You can see that 
A = 
2
64
1 1 2 
1 2 3 
1 3 4
3
75
does not have independent columns.
vii 
Column 1 plus column 2 equals column 3. A wonderful theorem of linear algebra says 
that the three rows are not independent either. The third row must lie in the same plane 
as the first two rows. Some combination of rows 1 and 2 will produce row 3. You might 
find that combination quickly (I didn’t). In the end I had to use elimination to discover 
that the right combination uses 2 times row 2, minus row 1. 
Elimination is the simple and natural way to understand a matrix by producing a lot 
of zero entries. So the course starts there. But don’t stay there too long! You have to get 
from combinations of the rows, to independence of the rows, to “dimension of the row 
space.” That is a key goal, to see whole spaces of vectors: the row space and the column 
space and the nullspace. 
A further goal is to understand how the matrix acts. When A multiplies x it produces 
the new vector Ax. The whole space of vectors moves—it is “transformed” by A. Special 
transformations come from particular matrices, and those are the foundation stones of 
linear algebra: diagonal matrices, orthogonal matrices, triangular matrices, symmetric 
matrices. 
The eigenvalues of those matrices are special too. I think 2 by 2 matrices provide 
terrific examples of the information that eigenvalues l can give. Sections 5.1 and 5.2 
are worth careful reading, to see how Ax =l x is useful. Here is a case in which small 
matrices allow tremendous insight. 
Overall, the beauty of linear algebra is seen in so many different ways: 
1. Visualization. Combinations of vectors. Spaces of vectors. Rotation and reflection 
and projection of vectors. Perpendicular vectors. Four fundamental subspaces. 
2. Abstraction. Independence of vectors. Basis and dimension of a vector space. 
Linear transformations. Singular value decomposition and the best basis. 
3. Computation. Elimination to produce zero entries. Gram-Schmidt to produce 
orthogonal vectors. Eigenvalues to solve differential and difference equations. 
4. Applications. Least-squares solution when Ax = b has too many equations. Difference 
equations approximating differential equations. Markov probability matrices 
(the basis for Google!). Orthogonal eigenvectors as principal axes (and more...). 
To go further with those applications, may I mention the books published byWellesley- 
Cambridge Press. They are all linear algebra in disguise, applied to signal processing 
and partial differential equations and scientific computing (and even GPS). If you look 
at http://www.wellesleycambridge.com, you will see part of the reason that linear algebra 
is so widely used. 
After this preface, the book will speak for itself. You will see the spirit right away. 
The emphasis is on understanding—I try to explain rather than to deduce. This is a 
book about real mathematics, not endless drill. In class, I am constantly working with 
examples to teach what students need.
viii PREFACE 
Acknowledgments 
I enjoyed writing this book, and I certainly hope you enjoy reading it. A big part of the 
pleasure comes from working with friends. I had wonderful help from Brett Coonley 
and Cordula Robinson and Erin Maneri. They created the LATEX files and drew all the 
figures. Without Brett’s steady support I would never have completed this new edition. 
Earlier help with the Teaching Codes came from Steven Lee and Cleve Moler. Those 
follow the steps described in the book; MATLAB and Maple and Mathematica are faster 
for large matrices. All can be used (optionally) in this course. I could have added 
“Factorization” to that list above, as a fifth avenue to the understanding of matrices: 
[L, U, P] = lu(A) for linear equations 
[Q, R] = qr(A) to make the columns orthogonal 
[S, E] = eig(A) to find eigenvectors and eigenvalues. 
In giving thanks, I never forget the first dedication of this textbook, years ago. That 
was a special chance to thank my parents for so many unselfish gifts. Their example is 
an inspiration for my life. 
And I thank the reader too, hoping you like this book. 
Gilbert Strang
Chapter 1 
Matrices and Gaussian Elimination 
1.1 Introduction 
This book begins with the central problem of linear algebra: solving linear equations. 
The most important ease, and the simplest, is when the number of unknowns equals the 
number of equations. We have n equations in n unknowns, starting with n = 2: 
Two equations 1x + 2y = 3 
Two unknowns 4x + 5y = 6: 
(1) 
The unknowns are x and y. I want to describe two ways, elimination and determinants, 
to solve these equations. Certainly x and y are determined by the numbers 1, 2, 3, 4, 5, 
6. The question is how to use those six numbers to solve the system. 
1. Elimination Subtract 4 times the first equation from the second equation. This 
eliminates x from the second equation. and it leaves one equation for y: 
(equation 2).4(equation 1) .3y = .6: (2) 
Immediately we know y = 2. Then x comes from the first equation 1x+2y = 3: 
Back-substitution 1x+2(2) = 3 gives x = .1: (3) 
Proceeding carefully, we cheek that x and y also solve the second equation. This 
should work and it does: 4 times (x = .1) plus 5 times (y = 2) equals 6. 
2. Determinants The solution y = 2 depends completely on those six numbers in the 
equations. There most be a formula for y (and also x) It is a “ratio of determinants” 
and I hope you will allow me to write it down directly: 
y = 
.....
1 3 
4 6
.....
.....
1 2 
4 5
..... 
= 
1 . 6.3 . 4 
1 . 5.2 . 4 
= 
.6 
.3 
= 2: (4)
2 Chapter 1 Matrices and Gaussian Elimination 
That could seem a little mysterious, unless you already know about 2 by 2 determinants. 
They gave the same answer y = 2, coming from the same ratio of .6 to .3. 
If we stay with determinants (which we don’t plan to do), there will be a similar 
formula to compute the other unknown, x: 
x = 
.....
3 2 
6 5
.....
.....
1 2 
4 5
..... 
= 
3 . 5.2 . 6 
1 . 5.2 . 4 
= 
3 
.3 
= .1: (5) 
Let me compare those two approaches, looking ahead to real problems when n is 
much larger (n = 1000 is a very moderate size in scientific computing). The truth is that 
direct use of the determinant formula for 1000 equations would be a total disaster. It 
would use the million numbers on the left sides correctly, but not efficiently. We will 
find that formula (Cramer’s Rule) in Chapter 4, but we want a good method to solve 
1000 equations in Chapter 1. 
That good method is Gaussian Elimination. This is the algorithm that is constantly 
used to solve large systems of equations. From the examples in a textbook (n = 3 is 
close to the upper limit on the patience of the author and reader) too might not see much 
difference. Equations (2) and (4) used essentially the same steps to find y = 2. Certainly 
x came faster by the back-substitution in equation (3) than the ratio in (5). For larger 
n there is absolutely no question. Elimination wins (and this is even the best way to 
compute determinants). 
The idea of elimination is deceptively simple—you will master it after a few examples. 
It will become the basis for half of this book, simplifying a matrix so that we can 
understand it. Together with the mechanics of the algorithm, we want to explain four 
deeper aspects in this chapter. They are: 
1. Linear equations lead to geometry of planes. It is not easy to visualize a ninedimensional 
plane in ten-dimensional space. It is harder to see ten of those planes, 
intersecting at the solution to ten equations—but somehow this is almost possible. 
Our example has two lines in Figure 1.1, meeting at the point (x;y) = (.1;2). 
Linear algebra moves that picture into ten dimensions, where the intuition has to 
imagine the geometry (and gets it right) 
2. We move to matrix notation, writing the n unknowns as a vector x and the n equations 
as Ax = b. We multiply A by “elimination matrices” to reach an upper triangular 
matrix U. Those steps factor A into L times U, where L is lower triangular. 
I will write down A and its factors for our example, and explain them at the right 
time: 
Factorization A = 
"
1 2 
4 5
# 
= 
"
1 0 
4 1
#"
1 2 
0 .3
# 
= L times U: (6)
1.1 Introduction 3 
y 
x 
b 
x + 2y = 3 x = .1 
y = 2 
4x + 5y = 6 
One solution (x, y) = (.1, 2) 
y 
x 
x + 2y = 3 
4x + 8y = 6 
Parallel: No solution 
y 
x 
x + 2y = 3 
4x + 8y = 12 
Whole line of solutions 
Figure 1.1: The example has one solution. Singular cases have none or too many. 
First we have to introduce matrices and vectors and the rules for multiplication. 
Every matrix has a transpose AT. This matrix has an inverse A.1. 
3. In most cases elimination goes forward without difficulties. The matrix has an 
inverse and the system Ax = b has one solution. In exceptional cases the method 
will break down—either the equations were written in the wrong order, which is 
easily fixed by exchanging them, or the equations don’t have a unique solution. 
That singular case will appear if 8 replaces 5 in our example: 
Singular case 
Two parallel lines 
1x + 2y = 3 
4x + 8y = 6: 
(7) 
Elimination still innocently subtracts 4 times the first equation from the second. But 
look at the result! 
(equation 2).4(equation 1) 0 = .6: 
This singular case has no solution. Other singular cases have infinitely many solutions. 
(Change 6 to 12 in the example, and elimination will lead to 0 = 0. Now y 
can have any value,) When elimination breaks down, we want to find every possible 
solution. 
4. We need a rough count of the number of elimination steps required to solve a system 
of size n. The computing cost often determines the accuracy in the model. A 
hundred equations require a third of a million steps (multiplications and subtractions). 
The computer can do those quickly, but not many trillions. And already 
after a million steps, roundoff error could be significant. (Some problems are sensitive; 
others are not.) Without trying for full detail, we want to see large systems 
that arise in practice, and how they are actually solved. 
The final result of this chapter will be an elimination algorithm that is about as efficient 
as possible. It is essentially the algorithm that is in constant use in a tremendous 
variety of applications. And at the same time, understanding it in terms of matrices—the 
coefficient matrix A, the matrices E for elimination and P for row exchanges, and the
4 Chapter 1 Matrices and Gaussian Elimination 
final factors L and U—is an essential foundation for the theory. I hope you will enjoy 
this book and this course. 
1.2 The Geometry of Linear Equations 
The way to understand this subject is by example. We begin with two extremely humble 
equations, recognizing that you could solve them without a course in linear algebra. 
Nevertheless I hope you will give Gauss a chance: 
2x . y = 1 
x + y = 5: 
We can look at that system by rows or by columns. We want to see them both. 
The first approach concentrates on the separate equations (the rows). That is the 
most familiar, and in two dimensions we can do it quickly. The equation 2x.y = 1 is 
represented by a straight line in the x-y plane. The line goes through the points x = 1, 
y = 1 and x = 12
, y = 0 (and also through (2;3) and all intermediate points). The second 
equation x+y = 5 produces a second line (Figure 1.2a). Its slope is dy=dx = .1 and it 
crosses the first line at the solution. 
The point of intersection lies on both lines. It is the only solution to both equations. 
That point x = 2 and y = 3 will soon be found by “elimination.” 
b 
b 
(0, 5) 
(0,.1) ( 1
2 , 0) 
x + y = 5 
2x . y = 1 
x 
y 
(5, 0) 
(x, y) = (2, 3) 
(a) Lines meet at x = 2, y = 3 
b b 
b 
b 
b 
(.3, 3) 
(.1, 1) (2, 1) = column 1 
(4, 2) 
(1, 5) = 
2 (column 1) 
+3 (column 2) 
(b) Columns combine with 2 and 3 
Figure 1.2: Row picture (two lines) and column picture (combine columns). 
The second approach looks at the columns of the linear system. The two separate 
equations are really one vector equation: 
Column form x
"
2
1
#
+y
"
.1 
1 
# 
= 
"
1
5
#
:
1.2 The Geometry of Linear Equations 5 
The problem is to find the combination of the column vectors on the left side that 
produces the vector on the right side. Those vectors (2;1) and (.1;1) are represented 
by the bold lines in Figure 1.2b. The unknowns are the numbers x and y that multiply 
the column vectors. The whole idea can be seen in that figure, where 2 times column 
1 is added to 3 times column 2. Geometrically this produces a famous parallelogram. 
Algebraically it produces the correct vector (1;5), on the right side of our equations. 
The column picture confirms that x = 2 and y = 3. 
More time could be spent on that example, but I would rather move forward to n = 3. 
Three equations are still manageable, and they have much more variety: 
Three planes 
2u + v + w = 5 
4u . 6v = .2 
.2u + 7v + 2w = 9: 
(1) 
Again we can study the rows or the columns, and we start with the rows. Each equation 
describes a plane in three dimensions. The first plane is 2u+v+w=5, and it is sketched 
in Figure 1.3. It contains the points (52
;0;0) and (0;5;0) and (0;0;5). It is determined 
by any three of its points—provided they do not lie on a line. 
w 
u 
v 
b
(1, 1, 2) = point of intersection 
with third plane = solution 
4u . 6v = .2 (vertical plane) 
line of intersection: first two planes 
2u + v + w = 5 (sloping plane) 
Figure 1.3: The row picture: three intersecting planes from three linear equations. 
Changing 5 to 10, the plane 2u+v+w = 10 would be parallel to this one. It contains 
(5;0;0) and (0;10;0) and (0;0;10), twice as far from the origin—which is the center 
point u = 0, v = 0, w = 0. Changing the right side moves the plane parallel to itself, and 
the plane 2u+v+w = 0 goes through the origin.
6 Chapter 1 Matrices and Gaussian Elimination 
The second plane is 4u.6v = .2. It is drawn vertically, because w can take any 
value. The coefficient of w is zero, but this remains a plane in 3-space. (The equation 
4u = 3, or even the extreme case u = 0, would still describe a plane.) The figure shows 
the intersection of the second plane with the first. That intersection is a line. In three 
dimensions a line requires two equations; in n dimensions it will require n.1. 
Finally the third plane intersects this line in a point. The plane (not drawn) represents 
the third equation .2u+7v+2w = 9, and it crosses the line at u = 1, v = 1, w = 2. That 
triple intersection point (1;1;2) solves the linear system. 
How does this row picture extend into n dimensions? The n equations will contain 
n unknowns. The first equation still determines a “plane.” It is no longer a twodimensional 
plane in 3-space; somehow it has “dimension” n.1. It must be flat and 
extremely thin within n-dimensional space, although it would look solid to us. 
If time is the fourth dimension, then the plane t = 0 cuts through four-dimensional 
space and produces the three-dimensional universe we live in (or rather, the universe as 
it was at t =0). Another plane is z=0, which is also three-dimensional; it is the ordinary 
x-y plane taken over all time. Those three-dimensional planes will intersect! They share 
the ordinary x-y plane at t = 0. We are down to two dimensions, and the next plane 
leaves a line. Finally a fourth plane leaves a single point. It is the intersection point of 4 
planes in 4 dimensions, and it solves the 4 underlying equations. 
I will be in trouble if that example from relativity goes any further. The point is that 
linear algebra can operate with any number of equations. The first equation produces an 
(n.1)-dimensional plane in n dimensions, The second plane intersects it (we hope) in 
a smaller set of “dimension n.2.” Assuming all goes well, every new plane (every new 
equation) reduces the dimension by one. At the end, when all n planes are accounted 
for, the intersection has dimension zero. It is a point, it lies on all the planes, and its 
coordinates satisfy all n equations. It is the solution! 
Column Vectors and Linear Combinations 
We turn to the columns. This time the vector equation (the same equation as (1)) is 
Column form u
2
64
2
4 
.2
3
75
+v
2
64
1 
.6 
7 
3
75
+w
2
64
1
0
2
3
75
= 
2
64
5 
.2 
9 
3
75
= b: (2) 
Those are three-dimensional column vectors. The vector b is identified with the point 
whose coordinates are 5, .2, 9. Every point in three-dimensional space is matched to a 
vector, and vice versa. That was the idea of Descartes, who turned geometry into algebra 
by working with the coordinates of the point. We can write the vector in a column, or 
we can list its components as b = (5;.2;9), or we can represent it geometrically by an 
arrow from the origin. You can choose the arrow, or the point, or the three numbers. In 
six dimensions it is probably easiest to choose the six numbers.
1.2 The Geometry of Linear Equations 7 
We use parentheses and commas when the components are listed horizontally, and 
square brackets (with no commas) when a column vector is printed vertically. What 
really matters is addition of vectors and multiplication by a scalar (a number). In Figure 
1.4a you see a vector addition, component by component: 
Vector addition 
2
64
5
0
0
3
75
+
2
64
0 
.2 
0 
3
75
+
2
64
0
0
9
3
75
= 
2
64
5 
.2 
9 
3
75
: 
In the right-hand figure there is a multiplication by 2 (and if it had been .2 the vector 
b 
b 
b 
b h 0 
.2 
0 i
h 5
0
0 i 
b = h 5 
.2 
9 i 
h 0
0
9 i 
(a) Add vectors along axes 
b 
b b 
h 2
0
4 i = 2 h 1
0
2 i 
2 (column 3) 
h 2
4 
.2 i + h 1 
.6 
7 i = h 3 
.2 
5 i 
columns 1 + 2 
h 5 
.1 
9 i = linear combination equals b 
(b) Add columns 1 + 2 + (3 + 3) 
Figure 1.4: The column picture: linear combination of columns equals b. 
would have gone in the reverse direction): 
Multiplication by scalars 2
2
641
0
2
3
75
= 
2
64
2
0
4
3
75
; .2
2
64
1
0
2
3
75
= 
2
64
.2 
0 
.4
3
75
: 
Also in the right-hand figure is one of the central ideas of linear algebra. It uses both 
of the basic operations; vectors are multiplied by numbers and then added. The result is 
called a linear combination, and this combination solves our equation: 
Linear combination 1
2
64
2
4 
.2
3
75
+1
2
64
1 
.6 
7 
3
75
+2
2
64
1
0
2
3
75
= 
2
64
5 
.2 
9 
3
75
: 
Equation (2) asked for multipliers u, v, w that produce the right side b. Those numbers 
are u = 1, v = 1, w = 2. They give the correct combination of the columns. They also 
gave the point (1;1;2) in the row picture (where the three planes intersect).
8 Chapter 1 Matrices and Gaussian Elimination 
Our true goal is to look beyond two or three dimensions into n dimensions. With n 
equations in n unknowns, there are n planes in the row picture. There are n vectors in 
the column picture, plus a vector b on the right side. The equations ask for a linear combination 
of the n columns that equals b. For certain equations that will be impossible. 
Paradoxically, the way to understand the good case is to study the bad one. Therefore 
we look at the geometry exactly when it breaks down, in the singular case. 
Row picture: Intersection of planes Column picture: Combination of columns 
The Singular Case 
Suppose we are again in three dimensions, and the three planes in the row picture do not 
intersect. What can go wrong? One possibility is that two planes may be parallel. The 
equations 2u+v+w = 5 and 4u+2v+2w = 11 are inconsistent—and parallel planes 
give no solution (Figure 1.5a shows an end view). In two dimensions, parallel lines 
are the only possibility for breakdown. But three planes in three dimensions can be in 
trouble without being parallel. 
two parallel planes 
(a) 
no intersection 
(b) 
line of intersection 
(c) 
all planes parallel 
(d) 
Figure 1.5: Singular cases: no solution for (a), (b), or (d), an infinity of solutions for (c). 
The most common difficulty is shown in Figure 1.5b. From the end view the planes 
form a triangle. Every pair of planes intersects in a line, and those lines are parallel. The 
third plane is not parallel to the other planes, but it is parallel to their line of intersection. 
This corresponds to a singular system with b = (2;5;6): 
No solution, as in Figure 1.5b 
u + v + w = 2 
2u + 3w = 5 
3u + v + 4w = 6: 
(3) 
The first two left sides add up to the third. On the right side that fails: 2+5 6=6. Equation 
1 plus equation 2 minus equation 3 is the impossible statement 0=1. Thus the equations 
are inconsistent, as Gaussian elimination will systematically discover.
1.2 The Geometry of Linear Equations 9 
Another singular system, close to this one, has an infinity of solutions. When the 
6 in the last equation becomes 7, the three equations combine to give 0 = 0. Now the 
third equation is the sum of the first two. In that case the three planes have a whole line 
in common (Figure 1.5c). Changing the right sides will move the planes in Figure 1.5b 
parallel to themselves, and for b = (2;5;7) the figure is suddenly different. The lowest 
plane moved up to meet the others, and there is a line of solutions. Problem 1.5c is still 
singular, but now it suffers from too many solutions instead of too few. 
The extreme case is three parallel planes. For most right sides there is no solution 
(Figure 1.5d). For special right sides (like b = (0;0;0)!) there is a whole plane of 
solutions—because the three parallel planes move over to become the same. 
What happens to the column picture when the system is singular? it has to go wrong; 
the question is how, There are still three columns on the left side of the equations, and 
we try to combine them to produce b. Stay with equation (3): 
Singular case: Column picture 
Three columns in the same plane 
Solvable only for b in that plane 
u
2
64
1
2
3
3
75
+v
2
64
1
0
1
3
75
+w
2
64
1
3
4
3
75
= b: (4) 
For b = (2;5;7) this was possible; for b = (2;5;6) it was not. The reason is that those 
three columns lie in a plane. Then every combination is also in the plane (which goes 
through the origin). If the vector b is not in that plane, no solution is possible (Figure 
1.6). That is by far the most likely event; a singular system generally has no solution. 
But there is a chance that b does lie in the plane of the columns. In that case there are too 
many solutions; the three columns can be combined in infinitely many ways to produce 
b. That column picture in Figure 1.6b corresponds to the row picture in Figure 1.5c. 
b 
b 
b not in place 
3 columns 
in a plane 
(a) no solution 
b 
b in place b 
3 columns 
in a plane 
(b) infinity of solutions 
Figure 1.6: Singular cases: b outside or inside the plane with all three columns. 
How do we know that the three columns lie in the same plane? One answer is to find a 
combination of the columns that adds to zero. After some calculation, it is u = 3, v = 1, 
w = .2. Three times column 1 equals column 2 plus twice column 3. Column 1 is in
10 Chapter 1 Matrices and Gaussian Elimination 
the plane of columns 2 and 3. Only two columns are independent. 
The vector b = (2;5;7) is in that plane of the columns—it is column 1 plus column 
3—so (1, 0, 1) is a solution. We can add an multiple of the combination (3;.1;.2) that 
gives b = 0. So there is a whole line of solutions—as we know from the row picture. 
The truth is that we knew the columns would combine to give zero, because the rows 
did. That is a fact of mathematics, not of computation—and it remains true in dimension 
n. If the n planes have no point in common, or infinitely many points, then the n 
columns lie in the same plane. 
If the row picture breaks down, so does the column picture. That brings out the 
difference between Chapter 1 and Chapter 2. This chapter studies the most important 
problem—the nonsingular case—where there is one solution and it has to be found. 
Chapter 2 studies the general case, where there may be many solutions or none. In 
both cases we cannot continue without a decent notation (matrix notation) and a decent 
algorithm (elimination). After the exercises, we start with elimination. 
Problem Set 1.2 
1. For the equations x+y = 4, 2x.2y = 4, draw the row picture (two intersecting 
lines) and the column picture (combination of two columns equal to the column 
vector (4;4) on the right side). 
2. Solve to find a combination of the columns that equals b: 
Triangular system 
u . v . w = b1 
v + w = b2 
w = b3: 
3. (Recommended) Describe the intersection of the three planes u+v+w+z = 6 and 
u+w+z = 4 and u+w = 2 (all in four-dimensional space). Is it a line or a point or 
an empty set? What is the intersection if the fourth plane u = .1 is included? Find 
a fourth equation that leaves us with no solution. 
4. Sketch these three lines and decide if the equations are solvable: 
3 by 2 system 
x + 2y = 2 
x . y = 2 
y = 1: 
What happens if all right-hand sides are zero? Is there any nonzero choice of righthand 
sides that allows the three lines to intersect at the same point? 
5. Find two points on the line of intersection of the three planes t = 0 and z = 0 and 
x+y+z+t = 1 in four-dimensional space.
1.2 The Geometry of Linear Equations 11 
6. When b = (2;5;7), find a solution (u;v;w) to equation (4) different from the solution 
(1;0;1) mentioned in the text. 
7. Give two more right-hand sides in addition to b = (2;5;7) for which equation (4) 
can be solved. Give two more right-hand sides in addition to b = (2;5;6) for which 
it cannot be solved. 
8. Explain why the system 
u + v + w = 2 
u + 2v + 3w = 1 
v + 2w = 0 
is singular by finding a combination of the three equations that adds up to 0 = 1. 
What value should replace the last zero on the right side to allow the equations to 
have solutions—and what is one of the solutions? 
9. The column picture for the previous exercise (singular system) is 
u
2
64
1
1
0
3
75
+v
2
64
1
2
1
3
75
+w
2
64
1
3
2
3
75
= b: 
Show that the three columns on the left lie in the same plane by expressing the third 
column as a combination of the first two. What are all the solutions (u;v;w) if b is 
the zero vector (0;0;0)? 
10. (Recommended) Under what condition on y1, y2, y3 do the points (0;y1), (1;y2), 
(2;y3) lie on a straight line? 
11. These equations are certain to have the solution x = y = 0. For which values of a is 
there a whole line of solutions? 
ax + 2y = 0 
2x + ay = 0 
12. Starting with x+4y = 7, find the equation for the parallel line through x = 0, y = 0. 
Find the equation of another line that meets the first at x = 3, y = 1. 
Problems 13–15 are a review of the row and column pictures. 
13. Draw the two pictures in two planes for the equations x.2y = 0, x+y = 6. 
14. For two linear equations in three unknowns x, y, z, the row picture will show (2 or 3) 
(lines or planes) in (two or three)-dimensional space. The column picture is in (two 
or three)-dimensional space. The solutions normally lie on a .
12 Chapter 1 Matrices and Gaussian Elimination 
15. For four linear equations in two unknowns x and y, the row picture shows four 
. The column picture is in -dimensional space. The equations have no 
solution unless the vector on the right-hand side is a combination of . 
16. Find a point with z = 2 on the intersection line of the planes x+y+3z = 6 and 
x.y+z = 4. Find the point with z = 0 and a third point halfway between. 
17. The first of these equations plus the second equals the third: 
x + y + z = 2 
x + 2y + z = 3 
2x + 3y + 2z = 5: 
The first two planes meet along a line. The third plane contains that line, because 
if x, y, z satisfy the first two equations then they also . The equations have 
infinitely many solutions (the whole line L). Find three solutions. 
18. Move the third plane in Problem 17 to a parallel plane 2x+3y+2z = 9. Now the 
three equations have no solution—why not? The first two planes meet along the line 
L, but the third plane doesn’t that line. 
19. In Problem 17 the columns are (1;1;2) and (1;2;3) and (1;1;2). This is a “singular 
case” because the third column is . Find two combinations of the columns 
that give b = (2;3;5). This is only possible for b = (4;6;c) if c = . 
20. Normally 4 “planes” in four-dimensional space meet at a . Normally 4 column 
vectors in four-dimensional space can combine to produce b. What combination 
of (1;0;0;0), (1;1;0;0), (1;1;1;0), (1;1;1;1) produces b = (3;3;3;2)? What 4 
equations for x, y, z, t are you solving? 
21. When equation 1 is added to equation 2, which of these are changed: the planes in 
the row picture, the column picture, the coefficient matrix, the solution? 
22. If (a;b) is a multiple of (c;d) with abcd 6= 0, show that (a;c) is a multiple of (b;d). 
This is surprisingly important: call it a challenge question. You could use numbers 
first to see how a, b, c, and d are related. The question will lead to: 
If A = 
. a b 
c d 
¤ 
has dependent rows then it has dependent columns. 
23. In these equations, the third column (multiplying w) is the same as the right side b. 
The column form of the equations immediately gives what solution for (u;v;w)? 
6u + 7v + 8w = 8 
4u + 5v + 9w = 9 
2u . 2v + 7w = 7:
1.3 An Example of Gaussian Elimination 13 
1.3 An Example of Gaussian Elimination 
The way to understand elimination is by example. We begin in three dimensions: 
Original system 
2u + v + w = 5 
4u . 6v = .2 
.2u + 7v + 2w = 9: 
(1) 
The problem is to find the unknown values of u, v, and w, and we shall apply Gaussian 
elimination. (Gauss is recognized as the greatest of all mathematicians, but certainly not 
because of this invention, which probably took him ten minutes. Ironically, it is the most 
frequently used of all the ideas that bear his name.) The method starts by subtracting 
multiples of the first equation from the other equations. The goal is to eliminate u from 
the last two equations. This requires that we 
(a) subtract 2 times the first equation from the second 
(b) subtract .1 times the first equation from the third. 
Equivalent system 
2u + v + w = 5 
. 8v . 2w = .12 
8v + 3w = 14: 
(2) 
The coefficient 2 is the first pivot. Elimination is constantly dividing the pivot into the 
numbers underneath it, to find out the right multipliers. 
The pivot for the second stage of elimination is.8. We now ignore the first equation. 
A multiple of the second equation will be subtracted from the remaining equations (in 
this case there is only the third one) so as to eliminate v. We add the second equation to 
the third or, in other words, we 
(c) subtract .1 times the second equation from the third. 
The elimination process is now complete, at least in the “forward” direction: 
Triangular system 
2u + v + w = 5 
. 8v . 2w = .12 
1w = 2: 
(3) 
This system is solved backward, bottom to top. The last equation gives w = 2. Substituting 
into the second equation, we find v = 1. Then the first equation gives u = 1. 
This process is called back-substitution. 
To repeat: Forward elimination produced the pivots 2, .8, 1. It subtracted multiples 
of each row from the rows beneath, It reached the “triangular” system (3), which is 
solved in reverse order: Substitute each newly computed value into the equations that 
are waiting.
14 Chapter 1 Matrices and Gaussian Elimination 
Remark. One good way to write down the forward elimination steps is to include the 
right-hand side as an extra column. There is no need to copy u and v and w and = at 
every step, so we are left with the bare minimum: 
2
64
2 1 1 5 
4 .6 0 .2 
.2 7 2 9 
3
75
.!
2
64
2 1 1 5 
0 .8 .2 .12 
0 8 3 14 
3
75
.!
2
64
2 1 1 5 
0 .8 .2 .12 
0 0 1 2 
3
75
: 
At the end is the triangular system, ready for back-substitution. You may prefer this 
arrangement, which guarantees that operations on the left-hand side of the equations are 
also done on the right-hand side—because both sides are there together. 
In a larger problem, forward elimination takes most of the effort. We use multiples 
of the first equation to produce zeros below the first pivot. Then the second column is 
cleared out below the second pivot. The forward step is finished when the system is 
triangular; equation n contains only the last unknown multiplied by the last pivot. Backsubstitution 
yields the complete solution in the opposite order—beginning with the last 
unknown, then solving for the next to last, and eventually for the first. 
By definition, pivots cannot be zero. We need to divide by them. 
The Breakdown of Elimination 
Under what circumstances could the process break down? Something must go wrong 
in the singular case, and something might go wrong in the nonsingular case. This may 
seem a little premature—after all, we have barely got the algorithm working. But the 
possibility of breakdown sheds light on the method itself. 
The answer is: With a full set of n pivots, there is only one solution. The system is 
non singular, and it is solved by forward elimination and back-substitution. But if a zero 
appears in a pivot position, elimination has to stop—either temporarily or permanently. 
The system might or might not be singular. 
If the first coefficient is zero, in the upper left corner, the elimination of u from the 
other equations will be impossible. The same is true at every intermediate stage. Notice 
that a zero can appear in a pivot position, even if the original coefficient in that place 
was not zero. Roughly speaking, we do not know whether a zero will appear until we 
try, by actually going through the elimination process. 
In many cases this problem can be cured, and elimination can proceed. Such a system 
still counts as nonsingular; it is only the algorithm that needs repair. In other cases a 
breakdown is unavoidable. Those incurable systems are singular, they have no solution 
or else infinitely many, and a full set of pivots cannot be found.
1.3 An Example of Gaussian Elimination 15 
Example 1. Nonsingular (cured by exchanging equations 2 and 3) 
u + v + w = 
2u + 2v + 5w = 
4u + 6v + 8w = 
! 
u + v + w = 
3w = 
2v + 4w = 
! 
u + v + w = 
2v + 4w = 
3w = 
The system is now triangular, and back-substitution will solve it. 
Example 2. Singular (incurable) 
u + v + w = 
2u + 2v + 5w = 
4u + 4v + 8w = 
.! 
u + v + w = 
3w = 
4w = 
There is no exchange of equations that can avoid zero in the second pivot position. The 
equations themselves may be solvable or unsolvable. If the last two equations are 3w=6 
and 4w = 7, there is no solution. If those two equations happen to be consistent—as in 
3w = 6 and 4w = 8—then this singular case has an infinity of solutions. We know that 
w = 2, but the first equation cannot decide both u and v. 
Section 1.5 will discuss row exchanges when the system is not singular. Then the 
exchanges produce a full set of pivots. Chapter 2 admits the singular case, and limps 
forward with elimination. The 3w can still eliminate the 4w, and we will call 3 the 
second pivot. (There won’t be a third pivot.) For the present we trust all n pivot entries 
to be nonzero, without changing the order of the equations. That is the best case, with 
which we continue. 
The Cost of Elimination 
Our other question is very practical. How many separate arithmetical operations does 
elimination require, for n equations in n unknowns? If n is large, a computer is going to 
take our place in carrying out the elimination. Since all the steps are known, we should 
be able to predict the number of operations. 
For the moment, ignore the right-hand sides of the equations, and count only the 
operations on the left. These operations are of two kinds. We divide by the pivot to 
find out what multiple (say `) of the pivot equation is to be subtracted. When we do 
this subtraction, we continually meet a “multiply-subtract” combination; the terms in 
the pivot equation are multiplied by `, and then subtracted from another equation. 
Suppose we call each division, and each multiplication-subtraction, one operation. In 
column 1, it takes n operations for every zero we achieve—one to find the multiple `, 
and the other to find the new entries along the row. There are n.1 rows underneath the 
first one, so the first stage of elimination needs n(n.1) = n2.n operations. (Another 
approach to n2 .n is this: All n2 entries need to be changed, except the n in the first 
row.) Later stages are faster because the equations are shorter.
16 Chapter 1 Matrices and Gaussian Elimination 
When the elimination is down to k equations, only k2 .k operations are needed to 
clear out the column below the pivot—by the same reasoning that applied to the first 
stage, when k equaled n. Altogether, the total number of operations is the sum of k2.k 
over all values of k from 1 to n: 
Left side (12+. . .+n2).(1+. . .+n) = 
n(n+1)(2n+1) 
6 
. 
n(n+1) 
2 
= 
n3.n 
3 
: 
Those are standard formulas for the sums of the first n numbers and the first n squares. 
Substituting n=1 and n=2 and n=100 into the formula 13
(n3.n), forward elimination 
can take no steps or two steps or about a third of a million steps: 
If n is at all large, a good estimate for the number of operations is 13
n3. 
If the size is doubled, and few of the coefficients are zero, the cost is multiplied by 8. 
Back-substitution is considerably faster. The last unknown is found in only one operation 
(a division by the last pivot). The second to last unknown requires two operations, 
and so on. Then the total for back-substitution is 1+2+. . .+n. 
Forward elimination also acts on the right-hand side (subtracting the same multiples 
as on the left to maintain correct equations). This starts with n.1 subtractions of the 
first equation. Altogether the right-hand side is responsible for n2 operations—much 
less than the n3=3 on the left. The total for forward and back is 
Right side [(n.1)+(n.2)+. . .+1]+[1+2+. . .+n] = n2: 
Thirty years ago, almost every mathematician would have guessed that a general system 
of order n could not be solved with much fewer than n3=3 multiplications. (There 
were even theorems to demonstrate it, but they did not allow for all possible methods.) 
Astonishingly, that guess has been proved wrong. There now exists a method that requires 
only Cnlog2 7 multiplications! It depends on a simple fact: Two combinations of 
two vectors in two-dimensional space would seem to take 8 multiplications, but they can 
be done in 7. That lowered the exponent from log2 8, which is 3, to log2 7 . 2:8. This 
discovery produced tremendous activity to find the smallest possible power of n. The 
exponent finally fell (at IBM) below 2.376. Fortunately for elimination, the constant C 
is so large and the coding is so awkward that the new method is largely (or entirely) of 
theoretical interest. The newest problem is the cost with many processors in parallel. 
Problem Set 1.3 
Problems 1–9 are about elimination on 2 by 2 systems.
1.3 An Example of Gaussian Elimination 17 
1. What multiple ` of equation 1 should be subtracted from equation 2? 
2x + 3y = 1 
10x + 9y = 11: 
After this elimination step, write down the upper triangular system and circle the two 
pivots. The numbers 1 and 11 have no influence on those pivots. 
2. Solve the triangular system of Problem 1 by back-substitution, y before x. Verify 
that x times (2;10) plus y times (3;9) equals (1;11). If the right-hand side changes 
to (4;44), what is the new solution? 
3. What multiple of equation 2 should be subtracted from equation 3? 
2x . 4y = 6 
.x + 5y = 0: 
After this elimination step, solve the triangular system. If the right-hand side changes 
to (.6;0), what is the new solution? 
4. What multiple ` of equation 1 should be subtracted from equation 2? 
ax + by = f 
cx + dy = g: 
The first pivot is a (assumed nonzero). Elimination produces what formula for the 
second pivot? What is y? The second pivot is missing when ad = bc. 
5. Choose a right-hand side which gives no solution and another right-hand side which 
gives infinitely many solutions. What are two of those solutions? 
3x + 2y = 10 
6x + 4y = : 
6. Choose a coefficient b that makes this system singular. Then choose a right-hand 
side g that makes it solvable. Find two solutions in that singular case. 
2x + by = 16 
4x + 8y = g: 
7. For which numbers a does elimination break down (a) permanently, and (b) temporarily? 
ax + 3y = .3 
4x + 6y = 6: 
Solve for x and y after fixing the second breakdown by a row exchange.
18 Chapter 1 Matrices and Gaussian Elimination 
8. For which three numbers k does elimination break down? Which is fixed by a row 
exchange? In each case, is the number of solutions 0 or 1 or .? 
kx + 3y = 6 
3x + ky = .6: 
9. What test on b1 and b2 decides whether these two equations allow a solution? How 
many solutions will they have? Draw the column picture. 
3x . 2y = b1 
6x . 4y = b2: 
Problems 10–19 study elimination on 3 by 3 systems (and possible failure). 
10. Reduce this system to upper triangular form by two row operations: 
2x + 3y + z = 8 
4x + 7y + 5z = 20 
. 2y + 2z = 0: 
Circle the pivots. Solve by back-substitution for z, y, x. 
11. Apply elimination (circle the pivots) and back-substitution to solve 
2x . 3y = 3 
4x . 5y + z = 7 
2x . y . 3z = 5: 
List the three row operations: Subtract times row from row . 
12. Which number d forces a row exchange, and what is the triangular system (not singular) 
for that d? Which d makes this system singular (no third pivot)? 
2x + 5y + z = 0 
4x + dy + z = 2 
y . z = 3: 
13. Which number b leads later to a row exchange? Which b leads to a missing pivot? 
In that singular case find a nonzero solution x, y, z. 
x + by = 0 
x . 2y . z = 0 
y + z = 0: 
14. (a) Construct a 3 by 3 system that needs two row exchanges to reach a triangular 
form and a solution. 
(b) Construct a 3 by 3 system that needs a row exchange to keep going, but breaks 
down later.
1.3 An Example of Gaussian Elimination 19 
15. If rows 1 and 2 are the same, how far can you get with elimination (allowing row 
exchange)? If columns 1 and 2 are the same, which pivot is missing? 
2x.y+z = 0 
2x.y+z = 0 
4x+y+z = 2 
2x+2y+z = 0 
4x+4y+z = 0 
6x+6y+z = 2: 
16. Construct a 3 by 3 example that has 9 different coefficients on the left-hand side, but 
rows 2 and 3 become zero in elimination. How many solutions to your system with 
b = (1;10;100) and how many with b = (0;0;0)? 
17. Which number q makes this system singular and which right-hand side t gives it 
infinitely many solutions? Find the solution that has z = 1. 
x + 4y . 2z = 1 
x + 7y . 6z = 6 
3y + qz = t: 
18. (Recommended) It is impossible for a system of linear equations to have exactly two 
solutions. Explain why. 
(a) If (x;y; z) and (X;Y;Z) are two solutions, what is another one? 
(b) If 25 planes meet at two points, where else do they meet? 
19. Three planes can fail to have an intersection point, when no two planes are parallel. 
The system is singular if row 3 of A is a of the first two rows. Find a third 
equation that can’t be solved if x+y+z = 0 and x.2y.z = 1. 
Problems 20–22 move up to 4 by 4 and n by n. 
20. Find the pivots and the solution for these four equations: 
2x + y = 0 
x + 2y + z = 0 
y + 2z + t = 0 
z + 2t = 5: 
21. If you extend Problem 20 following the 1, 2, 1 pattern or the .1, 2, .1 pattern, what 
is the fifth pivot? What is the nth pivot? 
22. Apply elimination and back-substitution to solve 
2u + 3v = 0 
4u + 5v + w = 3 
2u . v . 3w = 5: 
What are the pivots? List the three operations in which a multiple of one row is 
subtracted from another.
20 Chapter 1 Matrices and Gaussian Elimination 
23. For the system 
u + v + w = 2 
u + 3v + 3w = 0 
u + 3v + 5w = 2; 
what is the triangular system after forward elimination, and what is the solution? 
24. Solve the system and find the pivots when 
2u . v = 0 
.u + 2v . w = 0 
. v + 2w . z = 0 
. w + 2z = 5: 
You may carry the right-hand side as a fifth column (and omit writing u, v, w, z until 
the solution at the end). 
25. Apply elimination to the system 
u + v + w = .2 
3u + 3v . w = 6 
u . v + w = .1: 
When a zero arises in the pivot position, exchange that equation for the one below it 
and proceed. What coefficient of v in the third equation, in place of the present .1, 
would make it impossible to proceed—and force elimination to break down? 
26. Solve by elimination the system of two equations 
x . y = 0 
3x + 6y = 18: 
Draw a graph representing each equation as a straight line in the x-y plane; the lines 
intersect at the solution. Also, add one more line—the graph of the new second 
equation which arises after elimination. 
27. Find three values of a for which elimination breaks down, temporarily or permanently, 
in 
au + u = 1 
4u + av = 2: 
Breakdown at the first step can be fixed by exchanging rows—but not breakdown at 
the last step. 
28. True or false: 
(a) If the third equation starts with a zero coefficient (it begins with 0u) then no 
multiple of equation 1 will be subtracted from equation 3.
1.4 Matrix Notation and Matrix Multiplication 21 
(b) If the third equation has zero as its second coefficient (it contains 0v) then no 
multiple of equation 2 will be subtracted from equation 3. 
(c) If the third equation contains 0u and 0v, then no multiple of equation 1 or equation 
2 will be subtracted from equation 3. 
29. (Very optional) Normally the multiplication of two complex numbers 
(a+ib)(c+id) = (ac.bd)+i(bc+ad) 
involves the four separate multiplications ac, bd, be, ad. Ignoring i, can you compute 
ac.bd and bc+ad with only three multiplications? (You may do additions, such as 
forming a+b before multiplying, without any penalty.) 
30. Use elimination to solve 
u + v + w = 6 
u + 2v + 2w = 11 
2u + 3v . 4w = 3 
and 
u + v + w = 7 
u + 2v + 2w = 10 
2u + 3v . 4w = 3: 
31. For which three numbers a will elimination fail to give three pivots? 
ax+2y+3z = b1 
ax+ay+4z = b2 
ax+ay+az = b3: 
32. Find experimentally the average size (absolute value) of the first and second and third 
pivots for MATLAB’s lu(rand(3;3)). The average of the first pivot from abs(A(1;1)) 
should be 0.5. 
1.4 Matrix Notation and Matrix Multiplication 
With our 3 by 3 example, we are able to write out all the equations in full. We can list 
the elimination steps, which subtract a multiple of one equation from another and reach 
a triangular matrix. For a large system, this way of keeping track of elimination would 
be hopeless; a much more concise record is needed. 
We now introduce matrix notation to describe the original system, and matrix multiplication 
to describe the operations that make it simpler. Notice that three different 
types of quantities appear in our example: 
Nine coefficients 
Three unknowns 
Three right-hand sides 
2u + v + w = 5 
4u . 6v = .2 
.2u + 7v + 2w = 9 
(1)
22 Chapter 1 Matrices and Gaussian Elimination 
On the right-hand side is the column vector b. On the left-hand side are the unknowns u, 
v, w. Also on the left-hand side are nine coefficients (one of which happens to be zero). 
It is natural to represent the three unknowns by a vector: 
The unknown is x = 
2
64
u
v
w
3
75
The solution is x = 
2
64
1
1
2
3
75
: 
The nine coefficients fall into three rows and three columns, producing a 3 by 3 matrix: 
Coefficient matrix A = 
2
64
2 1 1 
4 .6 0 
.2 7 2
3
75
: 
A is a square matrix, because the number of equations equals the number of unknowns. 
If there are n equations in n unknowns, we have a square n by n matrix. More generally, 
we might have m equations and n unknowns. Then A is rectangular, with m rows and n 
columns. It will be an “m by n matrix.” 
Matrices are added to each other, or multiplied by numerical constants, exactly as 
vectors are—one entry at a time. In fact we may regard vectors as special cases of 
matrices; they are matrices with only one column. As with vectors, two matrices can be 
added only if they have the same shape: 
Addition A+B 
Multiplication 2A 
2
64
2 1 
3 0 
0 4
3
75
+
2
64
1 2 
.3 1 
1 2
3
75
= 
2
64
3 3 
0 1 
1 6
3
752
2
64
2 1 
3 0 
0 4
3
75
= 
2
64
4 2 
6 0 
0 8
3
75
: 
Multiplication of a Matrix and a Vector 
We want to rewrite the three equations with three unknowns u, v, w in the simplified 
matrix form Ax = b. Written out in full, matrix times vector equals vector: 
Matrix form Ax = b 
2
64
2 1 1 
4 .6 0 
.2 7 2
3
75 
2
64
u
v
w
3
75
= 
2
64
5 
.2 
9 
3
75
: (2) 
The right-hand side b is the column vector of “inhomogeneous terms.” The left-hand 
side is A times x. This multiplication will be defined exactly so as to reproduce the 
original system. The first component of Ax comes from “multiplying” the first row of A 
into the column vector x: 
Row times column 
h
2 1 1
i
2
64
u
v
w
3
75
= 
h
2u+v+w
i 
= 
h
5
i
: (3)
1.4 Matrix Notation and Matrix Multiplication 23 
The second component of the product Ax is 4u.6v+0w, from the second row of A. The 
matrix equation Ax = b is equivalent to the three simultaneous equations in equation (1). 
Row times column is fundamental to all matrix multiplications. From two vectors it 
produces a single number. This number is called the inner product of the two vectors. 
In other words, the product of a 1 by n matrix (a row vector) and an n by 1 matrix (a 
column vector) is a 1 by 1 matrix: 
Inner product 
h
2 1 1
i
2
64
1
1
2
3
75
= 
h
2 . 1+1 . 1+1 . 2
i 
= 
h
5
i
: 
This confirms that the proposed solution x = (1;1;2) does satisfy the first equation. 
There are two ways to multiply a matrix A and a vector x. One way is a row at a 
time, Each row of A combines with x to give a component of Ax. There are three inner 
products when A has three rows: 
Ax by rows 
2
64
1 1 6 
3 0 1 
1 1 4
3
75 
2
64
2
5
0
3
75
= 
2
64
1 . 2+1 . 5+6 . 0 
3 . 2+0 . 5+3 . 0 
1 . 2+1 . 5+4 . 0
3
75
= 
2
64
7
6
7
3
75
: (4) 
That is how Ax is usually explained, but the second way is equally important. In fact it is 
more important! It does the multiplication a column at a time. The product Ax is found 
all at once, as a combination of the three columns of A: 
Ax by columns 2
2
64
1
3
1
3
75
+5
2
64
1
0
1
3
75
+0
2
64
6
3
4
3
75
= 
2
64
7
6
7
3
75
: (5) 
The answer is twice column 1 plus 5 times column 2. It corresponds to the “column 
picture” of linear equations. If the right-hand side b has components 7, 6, 7, then the 
solution has components 2, 5, 0. Of course the row picture agrees with that (and we 
eventually have to do the same multiplications). 
The column rule will be used over and over, and we repeat it for emphasis: 
1A Every product Ax can be found using whole columns as in equation (5). 
Therefore Ax is a combination of the columns of A. The coefficients are the 
components of x. 
To multiply A times x in n dimensions, we need a notation for the individual entries in 
A. The entry in the ith row and jth column is always denoted by ai j. The first subscript 
gives the row number, and the second subscript indicates the column. (In equation (4), 
a21 is 3 and a13 is 6.) If A is an m by n matrix, then the index i goes from 1 to m—there 
are m rows—and the index j goes from 1 to n. Altogether the matrix has mn entries, and 
amn is in the lower right corner.
24 Chapter 1 Matrices and Gaussian Elimination 
One subscript is enough for a vector. The jth component of x is denoted by x j. (The 
multiplication above had x1 = 2, x2 = 5, x3 = 0.) Normally x is written as a column 
vector—like an n by 1 matrix. But sometimes it is printed on a line, as in x = (2;5;0). 
The parentheses and commas emphasize that it is not a 1 by 3 matrix. It is a column 
vector, and it is just temporarily lying down. 
To describe the product Ax, we use the “sigma” symbol S for summation: 
Sigma notation The ith component of Ax is 
na 
j=1
ai jx j: 
This sum takes us along the ith row of A. The column index j takes each value from 1 
to n and we add up the results—the sum is ai1x1+ai2x2+. . .+ainxn. 
We see again that the length of the rows (the number of columns in A) must match 
the length of x. An m by n matrix multiplies an n-dimensional vector (and produces 
an m-dimensional vector). Summations are simpler than writing everything out in full, 
but matrix notation is better. (Einstein used “tensor notation,” in which a repeated index 
automatically means summation. He wrote ai jx j or even aj 
i x j, without the S. Not being 
Einstein, we keep the S.) 
The Matrix Form of One Elimination Step 
So far we have a convenient shorthand Ax = b for the original system of equations. 
What about the operations that are carried out during elimination? In our example, the 
first step subtracted 2 times the first equation from the second. On the right-hand side, 
2 times the first component of b was subtracted from the second component. The same 
result is achieved if we multiply b by this elementary matrix (or elimination matrix): 
Elementary matrix E = 
2
64
1 0 0 
.2 1 0 
0 0 1
3
75
: 
This is verified just by obeying the rule for multiplying a matrix and a vector: 
Eb = 
2
641 0 0 
.2 1 0 
0 0 1
3
75 
2
64
5 
.2 
9 
3
75
= 
2
64
5 
.12 
9 
3
75
: 
The components 5 and 9 stay the same (because of the 1, 0, 0 and 0, 0, 1 in the rows of 
E). The new second component .12 appeared after the first elimination step. 
It is easy to describe the matrices like E, which carry out the separate elimination 
steps. We also notice the “identity matrix,” which does nothing at all. 
1B The identity matrix I, with 1s on the diagonal and 0s everywhere else, 
leaves every vector unchanged. The elementary matrix Ei j subtracts ` times
1.4 Matrix Notation and Matrix Multiplication 25 
row j from row i. This Ei j includes .` in row i, column j. 
I = 
2
64
1 0 0 
0 1 0 
0 0 1
3
75
has Ib = b E31 = 
2
64
1 0 0 
0 1 0 
.` 0 1
3
75
has E31b = 
2
64
b1 
b2 
b3.`b1
3
75
: 
Ib = b is the matrix analogue of multiplying by 1. A typical elimination step 
multiplies by E31. The important question is: What happens to A on the lefthand 
side? 
To maintain equality, we must apply the same operation to both sides of Ax = b. In 
other words, we must also multiply the vector Ax by the matrix E. Our original matrix 
E subtracts 2 times the first component from the second, After this step the new and 
simpler system (equivalent to the old) is just E(Ax) = Eb. It is simpler because of the 
zero that was created below the first pivot. It is equivalent because we can recover the 
original system (by adding 2 times the first equation back to the second). So the two 
systems have exactly the same solution x. 
Matrix Multiplication 
Now we come to the most important question: How do we multiply two matrices? There 
is a partial clue from Gaussian elimination: We know the original coefficient matrix A, 
we know the elimination matrix E, and we know the result EA after the elimination step. 
We hope and expect that 
E = 
2
64
1 0 0 
.2 1 0 
0 0 1
3
75
times A = 
2
64
2 1 1 
4 .6 0 
.2 7 2
3
75
gives EA = 
2
64
2 1 1 
0 .8 .2 
.2 7 2 
3
75
: 
Twice the first row of A has been subtracted from the second row. Matrix multiplication 
is consistent with the row operations of elimination. We can write the result either as 
E(Ax) = Eb, applying E to both sides of our equation, or as (EA)x = Eb. The matrix 
EA is constructed exactly so that these equations agree, and we don’t need parentheses: 
Matrix multiplication (EA times x) equals (E times Ax). We just write EAx: 
This is the whole point of an “associative law” like 2.(3.4) = (2.3).4. The law 
seems so obvious that it is hard to imagine it could be false. But the same could be said 
of the “commutative law” 2.3 = 3.2—and for matrices EA is not AE. 
There is another requirement on matrix multiplication. We know how to multiply Ax, 
a matrix and a vector. The new definition should be consistent with that one. When 
a matrix B contains only a single column x, the matrix-matrix product AB should be 
identical with the matrix-vector product Ax. More than that: When B contains several
26 Chapter 1 Matrices and Gaussian Elimination 
columns b1, b2, b3, the columns of AB should be Ab1, Ab2, Ab3! 
Multiplication by columns AB = A
2
64
b1 
b2 
b3
3
75
= 
2
64
Ab1 
Ab2 
Ab3
3
75
: 
Our first requirement had to do with rows, and this one is concerned with columns. A 
third approach is to describe each individual entry in AB and hope for the best. In fact, 
there is only one possible rule, and I am not sure who discovered it. It makes everything 
work. It does not allow us to multiply every pair of matrices. If they are square, they 
must have the same size. If they are rectangular, they must not have the same shape; 
the number of columns in A has to equal the number of rows in B. Then A can be 
multiplied into each column of B. 
If A is m by n, and B is n by p, then multiplication is possible. The product AB will 
be m by p. We now find the entry in row i and column j of AB. 
1C The i, j entry of AB is the inner product of the ith row of A and the jth 
column of B. In Figure 1.7, the 3, 2 entry of AB comes from row 3 and column 
2: 
(AB)32 = a31b12+a32b22+a33b32+a34b42: (6) 
Figure 1.7: A 3 by 4 matrix A times a 4 by 2 matrix B is a 3 by 2 matrix AB. 
Note. We write AB when the matrices have nothing special to do with elimination. Our 
earlier example was EA, because of the elementary matrix E. Later we have PA, or LU, 
or even LDU. The rule for matrix multiplication stays the same. 
Example 1. 
AB = 
"
2 3 
4 0
#"
1 2 0 
5 .1 0
# 
= 
"
17 1 0 
4 8 0
#
: 
The entry 17 is (2)(1)+(3)(5), the inner product of the first row of A and first column 
of B. The entry 8 is (4)(2)+(0)(.1), from the second row and second column. 
The third column is zero in B, so it is zero in AB. B consists of three columns side by 
side, and A multiplies each column separately. Every column of AB is a combination 
of the columns of A. Just as in a matrix-vector multiplication, the columns of A are 
multiplied by the entries in B.
1.4 Matrix Notation and Matrix Multiplication 27 
Example 2. 
Row exchange matrix 
"
0 1 
1 0
#"
2 3 
7 8
# 
= 
"
7 8 
2 3
#
: 
Example 3. The 1s in the identity matrix I leave every matrix unchanged: 
Identity matrix IA = A and BI = B: 
Important: The multiplication AB can also be done a row at a time. In Example 1, the 
first row of AB uses the numbers 2 and 3 from the first row of A. Those numbers give 
2[row 1]+3[row 2] = [17 1 0]. Exactly as in elimination, where all this started, each 
row of AB is a combination of the rows of B. 
We summarize these three different ways to look at matrix multiplication. 
1D 
(i) Each entry of AB is the product of a row and a column: 
(AB)i j = (row i of A) times (column j of B) 
(ii) Each column of AB is the product of a matrix and a column: 
column j of AB = A times (column j of B) 
(iii) Each row of AB is the product of a row and a matrix: 
row i of AB = (row i of A) times B: 
This leads hack to a key property of matrix multiplication. Suppose the shapes of 
three matrices A, B, C (possibly rectangular) permit them to be multiplied. The rows in 
A and B multiply the columns in B and C. Then the key property is this: 
1E Matrix multiplication is associative: (AB)C = A(BC). Just write ABC. 
AB times C equals A times BC. If C happens to be just a vector (a matrix with only one 
column) this is the requirement (EA)x = E(Ax) mentioned earlier. It is the whole basis 
for the laws of matrix multiplication. And if C has several columns, we have only to 
think of them placed side by side, and apply the same rule several times. Parentheses 
are not needed when we multiply several matrices. 
There are two more properties to mention—one property that matrix multiplication 
has, and another which it does not have. The property that it does possess is: 
1F Matrix operations are distributive: 
A(B+C) = AB+AC and (B+C)D = BD+CD:
28 Chapter 1 Matrices and Gaussian Elimination 
Of course the shapes of these matrices must match properly—B and C have the same 
shape, so they can be added, and A and D are the right size for premultiplication and 
postmultiplication. The proof of this law is too boring for words. 
The property that fails to hold is a little more interesting: 
1G Matrix multiplication is not commutative: Usually FE 6= EF. 
Example 4. Suppose E subtracts twice the first equation from the second. Suppose F 
is the matrix for the next step, to add row 1 to row 3: 
E = 
2
64
1 0 0 
.2 1 0 
0 0 1
3
75
and F = 
2
64
1 0 0 
0 1 0 
1 0 1
3
75
: 
These two matrices do commute and the product does both steps at once: 
EF = 
2
64
1 0 0 
.2 1 0 
1 0 1
3
75
= FE: 
In either order, EF or FE, this changes rows 2 and 3 using row 1. 
Example 5. Suppose E is the same but G adds row 2 to row 3. Now the order makes a 
difference. When we apply E and then G, the second row is altered before it affects the 
third. If E comes after G, then the third equation feels no effect from the first. You will 
see a zero in the (3;1) entry of EG, where there is a .2 in GE: 
GE = 
2
64
1 0 0 
0 1 0 
0 1 1
3
75 
2
64
1 0 0 
.2 1 0 
0 0 1
3
75
= 
2
64
1 0 0 
.2 1 0 
.2 1 1
3
75
but EG = 
2
64
1 0 0 
.2 1 0 
0 1 1
3
75
: 
Thus EG 6= GE. A random example would show the same thing—most matrices don’t 
commute. Here the matrices have meaning. There was a reason for EF = FE, and a 
reason for EG 6= GE. It is worth taking one more step, to see what happens with all 
three elimination matrices at once: 
GFE = 
2
64
1 0 0 
.2 1 0 
.1 1 1
3
75
and EFG = 
2
64
1 0 0 
.2 1 0 
.1 1 1
3
75
: 
The product GFE is the true order of elimination. It is the matrix that takes the original 
A to the upper triangular U. We will see it again in the next section. 
The other matrix EFG is nicer. In that order, the numbers .2 from E and 1 from F 
and G were not disturbed. They went straight into the product. It is the wrong order for 
elimination. But fortunately it is the right order for reversing the elimination steps— 
which also comes in the next section. 
Notice that the product of lower triangular matrices is again lower triangular.
1.4 Matrix Notation and Matrix Multiplication 29 
Problem Set 1.4 
1. Compute the products 
2
64
4 0 1 
0 1 0 
4 0 1
3
75 
2
64
3
4
5
3
75
and 
2
64
1 0 0 
0 1 0 
0 0 1
3
75 
2
64
5 
.2 
3 
3
75
and 
"
2 0 
1 3
#"
1
1
#
: 
For the third one, draw the column vectors (2;1) and (0;3). Multiplying by (1;1) 
just adds the vectors (do it graphically). 
2. Working a column at a time, compute the products 
2
64
4 1 
5 1 
6 1
3
75 
"
1
3
# 
and 
2
64
1 2 3 
4 5 6 
7 8 9
3
75 
2
64
0
1
0
3
75
and 
2
64
4 3 
6 6 
8 9
3
75 
"
1213 
#
: 
3. Find two inner products and a matrix product: 
h
1 .2 7
i
2
64
1 
.2 
7 
3
75
and 
h
1 .2 7
i
2
64
3
5
1
3
75
and 
2
64
1 
.2 
7 
3
75
h
3 5 1
i
: 
The first gives the length of the vector (squared). 
4. If an m by n matrix A multiplies an n-dimensional vector x, how many separate 
multiplications are involved? What if A multiplies an n by p matrix B? 
5. Multiply Ax to find a solution vector x to the system Ax = zero vector. Can you find 
more solutions to Ax = 0? 
Ax = 
2
64
3 .6 0 
0 2 .2 
1 .1 .1
3
75 
2
64
2
1
1
3
75
: 
6. Write down the 2 by 2 matrices A and B that have entries ai j =i+ j and bi j =(.1)i+j. 
Multiply them to find AB and BA. 
7. Give 3 by 3 examples (not just the zero matrix) of 
(a) a diagonal matrix: ai j = 0 if i 6= j. 
(b) a symmetric matrix: ai j = aji for all i and j. 
(c) an upper triangular matrix: ai j = 0 if i > j. 
(d) a skew-symmetric matrix: ai j = .aji for all i and j. 
8. Do these subroutines multiply Ax by rows or columns? Start with B(I) = 0:
30 Chapter 1 Matrices and Gaussian Elimination 
DO 10 I = 1, N DO 10 J = 1, N 
DO 10 J = 1, N DO 10 I = 1, N 
10 B(I) = B(I) + A(I,J) * X(J) 10 B(I) = B(I) + A(I,J) * X(J) 
The outputs Bx = Ax are the same. The second code is slightly more efficient in 
FORTRAN and much more efficient on a vector machine (the first changes single 
entries B(I), the second can update whole vectors). 
9. If the entries of A are ai j, use subscript notation to write 
(a) the first pivot. 
(b) the multiplier `i1 of row 1 to be subtracted from row i. 
(c) the new entry that replaces ai j after that subtraction. 
(d) the second pivot. 
10. True or false? Give a specific counterexample when false. 
(a) If columns 1 and 3 of B are the same, so are columns 1 and 3 of AB. 
(b) If rows 1 and 3 of B are the same, so are rows 1 and 3 of AB. 
(c) If rows 1 and 3 of A are the same, so are rows 1 and 3 of AB. 
(d) (AB)2 = A2B2. 
11. The first row of AB is a linear combination of all the rows of B. What are the coefficients 
in this combination, and what is the first row of AB, if 
A = 
"
2 1 4 
0 .1 1
# 
and B = 
2
64
1 1 
0 1 
1 0
3
75
? 
12. The product of two lower triangular matrices is again lower triangular (all its entries 
above the main diagonal are zero). Confirm this with a 3 by 3 example, and then 
explain how it follows from the laws of matrix multiplication. 
13. By trial and error find examples of 2 by 2 matrices such that 
(a) A2 = .I, A having only real entries. 
(b) B2 = 0, although B 6= 0. 
(c) CD = .DC, not allowing the case CD = 0. 
(d) EF = 0, although no entries of E or F are zero. 
14. Describe the rows of EA and the columns of AE if 
E = 
"
1 7 
0 1
#
:
1.4 Matrix Notation and Matrix Multiplication 31 
15. Suppose A commutes with every 2 by 2 matrix (AB = BA), and in particular 
A = 
"
a b 
c d
# 
commutes with B1 = 
"
1 0 
0 0
# 
and B2 = 
"
0 1 
0 0
#
: 
Show that a = d and b = c = 0. If AB = BA for all matrices B, then A is a multiple 
of the identity. 
16. Let x be the column vector (1;0; : : : ;0). Show that the rule (AB)x = A(Bx) forces the 
first column of AB to equal A times the first column of B. 
17. Which of the following matrices are guaranteed to equal (A+B)2? 
A2+2AB+B2; A(A+B)+B(A+B); (A+B)(B+A); A2+AB+BA+B2: 
18. If A and B are n by n matrices with all entries equal to 1, find (AB)i j. Summation 
notation turns the product AB, and the law (AB)C = A(BC), into 
(AB)i j =ak
aikbk j aj 
A
ak
aikbk j
!
c jl =ak
aik
A
aj
bk jc jl
!
: 
Compute both sides if C is also n by n, with every c jl = 2. 
19. A fourth way to multiply matrices is columns of A times rows of B: 
AB = (column 1)(row 1)+. . .+(column n)(row n) = sum of simple matrices: 
Give a 2 by 2 example of this important rule for matrix multiplication. 
20. The matrix that rotates the x-y plane by an angle q is 
A(q ) = 
"
cosq .sinq 
sinq cosq 
#
: 
Verify that A(q1)A(q2)=A(q1+q2) from the identities for cos(q1+q2) and sin(q1+ 
q2). What is A(q ) times A(.q )? 
21. Find the powers A2, A3 (A2 times A), and B2, B3, C2, C3. What are Ak, Bk, and Ck? 
A = 
"
12 
1212 
12 
# 
and B = 
"
1 0 
0 .1
# 
and C = AB = 
"
12
.12
12
.12 
# 
Problems 22–31 are about elimination matrices. 
22. Write down the 3 by 3 matrices that produce these elimination steps: 
(a) E21 subtracts 5 times row 1 from row 2. 
(b) E32 subtracts .7 times row 2 from row 3.
32 Chapter 1 Matrices and Gaussian Elimination 
(c) P exchanges rows 1 and 2, then rows 2 and 3. 
23. In Problem 22, applying E21 and then E32 to the column b=(1;0;0) gives E32E21b= 
. Applying E32 before E21 gives E21E32b = . When E32 comes first, row 
feels no effect from row . 
24. Which three matrices E21, E31, E32 put A into triangular form U? 
A = 
2
64
1 1 0 
4 6 1 
.2 2 0
3
75
and E32E31E21A =U: 
Multiply those E’s to get one matrix M that does elimination: MA =U. 
25. Suppose a33 = 7 and the third pivot is 5. If you change a33 to 11, the third pivot is 
. If you change a33 to , there is zero in the pivot position. 
26. If every column of A is a multiple of (1;1;1), then Ax is always a multiple of (1;1;1). 
Do a 3 by 3 example. How many pivots are produced by elimination? 
27. What matrix E31 subtracts 7 times row 1 from row 3? To reverse that step, R31 should 
7 times row to row . Multiply E31 by R31. 
28. (a) E21 subtracts row 1 from row 2 and then P23 exchanges rows 2 and 3. What 
matrix M = P23E21 does both steps at once? 
(b) P23 exchanges rows 2 and 3 and then E31 subtracts row I from row 3. What 
matrix M = E31P23 does both steps at once? Explain why the M’s are the same 
but the E’s are different. 
29. (a) What 3 by 3 matrix E13 will add row 3 to row 1? 
(b) What matrix adds row 1 to row 3 and at the same time adds row 3 to row 1? 
(c) What matrix adds row 1 to row 3 and then adds row 3 to row 1? 
30. Multiply these matrices: 
2
64
0 0 1 
0 1 0 
1 0 0
3
75 
2
64
1 2 3 
4 5 6 
7 8 9
3
75 
2
640 0 1 
0 1 0 
1 0 0
3
75
and 
2
64
1 0 0 
.1 1 0 
.1 0 1
3
75 
2
64
1 2 3 
1 3 1 
1 4 0
3
75
: 
31. This 4 by 4 matrix needs which elimination matrices E21 and E32 and E43? 
A = 
2
6664 
2 .1 0 0 
.1 2 .1 0 
0 .1 2 .1 
0 0 .1 2 
3
7775
: 
Problems 32–44 are about creating and multiplying matrices
1.4 Matrix Notation and Matrix Multiplication 33 
32. Write these ancient problems in a 2 by 2 matrix form Ax = b and solve them: 
(a) X is twice as old as Y and their ages add to 39, 
(b) (x;y) = (2;5) and (3;7) lie on the line y = mx+c. Find m and c. 
33. The parabola y = a+bx+cx2 goes through the points (x;y) = (1;4) and (2;8) and 
(3;14). Find and solve a matrix equation for the unknowns (a;b;c). 
34. Multiply these matrices in the orders EF and FE and E2: 
E = 
2
64
1 0 0 
a 1 0 
b 0 1
3
75
F = 
2
64
1 0 0 
0 1 0 
0 c 1
3
75
: 
35. (a) Suppose all columns of B are the same. Then all columns of EB are the same, 
because each one is E times . 
(b) Suppose all rows of B are [1 2 4]. Show by example that all rows of EB are not 
[1 2 4]. It is true that those rows are . 
36. If E adds row 1 to row 2 and F adds row 2 to row 1, does EF equal FE? 
37. The first component of Ax is aa1 jx j = a11x1 +. . .+a1nxn. Write formulas for the 
third component of Ax and the (1;1) entry of A2. 
38. If AB = I and BC = I, use the associative law to prove A =C. 
39. A is 3 by 5, B is 5 by 3, C is 5 by 1, and D is 3 by 1. All entries are 1. Which of these 
matrix operations are allowed, and what are the results? 
BA AB ABD DBA A(B+C): 
40. What rows or columns or matrices do you multiply to find 
(a) the third column of AB? 
(b) the first row of AB? 
(c) the entry in row 3, column 4 of AB? 
(d) the entry in row 1, column 1 of CDE? 
41. (3 by 3 matrices) Choose the only B so that for every matrix A, 
(a) BA = 4A. 
(b) BA = 4B. 
(c) BA has rows 1 and 3 of A reversed and row 2 unchanged. 
(d) All rows of BA are the same as row 1 of A. 
42. True or false?
34 Chapter 1 Matrices and Gaussian Elimination 
(a) If A2 is defined then A is necessarily square. 
(b) If AB and BA are defined then A and B are square. 
(c) If AB and BA are defined then AB and BA are square. 
(d) If AB = B then A = I. 
43. If A is m by n, how many separate multiplications are involved when 
(a) A multiplies a vector x with n components? 
(b) A multiplies an n by p matrix B? Then AB is m by p. 
(c) A multiplies itself to produce A2? Here m = n. 
44. To prove that (AB)C = A(BC), use the column vectors b1; : : : ;bn of B. First suppose 
that C has only one column c with entries c1; : : : ;cn: 
AB has columns Ab1; : : : ;Abn, and Bc has one column c1b1+. . .+cnbn. 
Then (AB)c = c1Ab1+. . .+cnAbn, equals A(c1b1+. . .+cnbn) = A(Bc). 
Linearity gives equality of those two sums, and (AB)c = A(Bc). The same is true for 
all other of C. Therefore (AB)C = A(BC). 
Problems 45–49 use column-row multiplication and block multiplication. 
45. Multiply AB using columns times rows: 
AB = 
2
64
1 0 
2 4 
2 1
3
75 
"
3 3 0 
1 2 1
# 
= 
2
64
1
2
2
3
75
h
3 3 0
i
+ = : 
46. Block multiplication separates matrices into blocks (submatrices). If their shapes 
make block multiplication possible, then it is allowed. Replace these x’s by numbers 
and confirm that block multiplication succeeds. 
h
A B
i"
C
D
# 
= 
h
AC+BD
i 
and 
2
64
x x x 
x x x 
x x x 
3
75 
2
64
x x x 
x x x 
x x x 
3
75
: 
47. Draw the cuts in A and B and AB to show how each of the four multiplication rules 
is really a block multiplication to find AB: 
(a) Matrix A times columns of B. 
(b) Rows of A times matrix B. 
(c) Rows of A times columns of B. 
(d) Columns of A times rows of B.
1.4 Matrix Notation and Matrix Multiplication 35 
48. Block multiplication says that elimination on column 1 produces 
EA = 
" 
1 0 
.c=a I
#"
a b 
c D
# 
= 
"
a b 
0 
#
: 
49. Elimination for a 2 by 2 block matrix: When A.1A = I, multiply the first block row 
by CA.1 and subtract from the second row, to find the “Schur complement” S: 
" 
I 0 
.CA.1 I
#"
A B 
C D
# 
= 
"
A B 
0 S
#
: 
50. With i2 = .1, the product (A+iB)(x+iy) is Ax+iBx+iAy.By. Use blocks to 
separate the real part from the imaginary part that multiplies i: 
"
A .B 
? ? 
#"
x
y
# 
= 
"
Ax.By 
? 
# 
real part 
imaginary part 
51. Suppose you solve Ax = b for three special right-hand sides b: 
Ax1 = 
2
64
1
0
0
3
75
and Ax2 = 
2
64
0
1
0
3
75
and Ax3 = 
2
64
0
0
1
3
75
: 
If the solutions x1, x2, x3 are the columns of a matrix X, what is AX? 
52. If the three solutions in Question 51 are x1 = (1;1;1) and x2 = (0;1;1) and x3 = 
(0;0;1), solve Ax = b when b = (3;5;8). Challenge problem: What is A? 
53. Find all matrices
A = 
"
a b 
c d
# 
that satisfy A
"
1 1 
1 1
# 
= 
"
1 1 
1 1
#
A: 
54. If you multiply a northwest matrix A and a southeast matrix B, what type of matrices 
are AB and BA? “Northwest” and “southeast” mean zeros below and above the 
antidiagonal going from (1;n) to (n;1). 
55. Write 2x+3y+z+5t = 8 as a matrix A (how many rows?) multiplying the column 
vector (x;y; z; t) to produce b. The solutions fill a plane in four-dimensional space. 
The plane is three-dimensional with no 4D volume. 
56. What 2 by 2 matrix P1 projects the vector (x;y) onto the x axis to produce (x;0)? 
What matrix P2 projects onto the y axis to produce (0;y)? If you multiply (5;7) by 
P1 and then multiply by P2, you get ( ) and ( ). 
57. Write the inner product of (1;4;5) and (x;y; z) as a matrix multiplication Ax. A has 
one row. The solutions to Ax = 0 lie on a perpendicular to the vector . The 
columns of A are only in -dimensional space.
36 Chapter 1 Matrices and Gaussian Elimination 
58. In MATLAB notation, write the commands that define the matrix A and the column 
vectors x and b. What command would test whether or not Ax = b? 
A = 
"
1 2 
3 4
# 
x = 
" 
5 
.2
# 
b = 
"
1
7
# 
59. The MATLAB commands A = eye(3) and v = [3:5]’ produce the 3 by 3 identity 
matrix and the column vector (3;4;5). What are the outputs from A ¤ v and v’ ¤ v? 
(Computer not needed!) If you ask for v ¤ A, what happens? 
60. If you multiply the 4 by 4 all-ones matrix A = ones(4,4) and the column v = 
ones(4,1), what is A ¤ v? (Computer not needed.) If you multiply B = eye(4) 
+ ones(4,4) times w = zeros(4,1) + 2 ¤ ones(4,1), what is B ¤ w? 
61. Invent a 3 by 3 magic matrix M with entries 1;2; : : : ;9. All rows and columns and 
diagonals add to 15. The first row could be 8, 3, 4. What is M times (1;1;1)? What 
is the row vector 
h
1 1 1
i 
times M? 
1.5 Triangular Factors and Row Exchanges 
We want to look again at elimination, to see what it means in terms of matrices. The 
starting point was the model system Ax = b: 
Ax = 
2
64
2 1 1 
4 .6 0 
.2 7 2
3
75 
2
64
u
v
w
3
75
= 
2
64
5 
.2 
9 
3
75
= b: (1) 
Then there were three elimination steps, with multipliers 2, .1, .1: 
Step 1. Subtract 2 times the first equation from the second; 
Step 2. Subtract .1 times the first equation from the third; 
Step 3. Subtract .1 times the second equation from the third. 
The result was an equivalent system Ux = c, with a new coefficient matrix U: 
Upper triangular Ux = 
2
64
2 1 1 
0 .8 .2 
0 0 1 
3
75 
2
64
u
v
w
3
75
= 
2
64
5 
.12 
2 
3
75
= c: (2) 
This matrix U is upper triangular—all entries below the diagonal are zero. 
The new right side c was derived from the original vector b by the same steps that 
took A into U. Forward elimination amounted to three row operations:
1.5 Triangular Factors and Row Exchanges 37 
Start with A and b; 
Apply steps 1, 2, 3 in that order; 
End with U and c. 
Ux = c is solved by back-substitution. Here we concentrate on connecting A to U. 
The matrices E for step 1, F for step 2, and G for step 3 were introduced in the 
previous section. They are called elementary matrices, and it is easy to see how they 
work. To subtract a multiple ` of equation j from equation i, put the number .` into 
the (i; j) position. Otherwise keep the identity matrix, with 1s on the diagonal and 0s 
elsewhere. Then matrix multiplication executes the row operation. 
The result of all three steps is GFEA = U. Note that E is the first to multiply A, 
then F, then G. We could multiply GFE together to find the single matrix that takes A 
to U (and also takes b to c). It is lower triangular (zeros are omitted): 
From A to U GFE = 
2
64
1 
1
1 1
3
75 
2
64
1 
1 
1 1
3
75 
2
64
1 
.2 1 
1
3
75
= 
2
64
1 
.2 1 
.1 1 1
3
75
: (3) 
This is good, but the most important question is exactly the opposite: How would we 
get from U back to A? How can we undo the steps of Gaussian elimination? 
To undo step 1 is not hard. Instead of subtracting, we add twice the first row to the 
second. (Not twice the second row to the first!) The result of doing both the subtraction 
and the addition is to bring back the identity matrix: 
Inverse of 
subtraction 
is addition 
2
64
1 0 0 
2 1 0 
0 0 1
3
75 
2
64
1 0 0 
.2 1 0 
0 0 1
3
75
= 
2
64
1 0 0 
0 1 0 
0 0 1
3
75
: (4) 
One operation cancels the other. In matrix terms, one matrix is the inverse of the other. 
If the elementary matrix E has the number .` in the (i; j) position, then its inverse E.1 
has +` in that position. Thus E.1E = I, which is equation (4). 
We can invert each step of elimination, by using E.1 and F.1 and G.1. I think it’s 
not bad to see these inverses now, before the next section. The final problem is to undo 
the whole process at once, and see what matrix takes U back to A. 
Since step 3 was last in going from A to U, its matrix G must be the first to be 
inverted in the reverse direction. Inverses come in the opposite order! The second 
reverse step is F.1 and the last is E.1: 
From U back to A E.1F.1G.1U = A is LU = A: (5) 
You can substitute GFEA for U, to see how the inverses knock out the original steps. 
Now we recognize the matrix L that takes U back to A. It is called L, because it is 
lower triangular. And it has a special property that can be seen only by multiplying the
38 Chapter 1 Matrices and Gaussian Elimination 
three inverse matrices in the right order: 
E.1F.1G.1 = 
2
64
1
2 1 
1
3
75 
2
64
1 
1 
.1 1
3
75 
2
64
1 
1 
.1 1
3
75
= 
2
64
1
2 1 
.1 .1 1
3
75
= L: (6) 
The special thing is that the entries below the diagonal are the multipliers ` = 2, .1, 
and .1. When matrices are multiplied, there is usually no direct way to read off the 
answer. Here the matrices come in just the right order so that their product can be 
written down immediately. If the computer stores each multiplier `i j—the number that 
multiplies the pivot row j when it is subtracted from row i, and produces a zero in the i, 
j position—then these multipliers give a complete record of elimination. 
The numbers `i j fit right into the matrix L that takes U back to A. 
1H Triangular factorization A = LU with no exchanges of rows. L is lower 
triangular, with 1s on the diagonal. The multipliers `i j (taken from elimination) 
are below the diagonal. U is the upper triangular matrix which appears after 
forward elimination, The diagonal entries of U are the pivots. 
Example 1. 
A = 
"
1 2 
3 8
# 
goes to U = 
"
1 2 
0 2
# 
with L = 
"
1 0 
3 1
#
: Then LU = A: 
Example 2. (which needs a row exchange) 
A = 
"
0 2 
3 4
# 
cannot be factored into A = LU: 
Example 3. (with all pivots and multipliers equal to 1) 
A = 
2
64
1 1 1 
1 2 2 
1 2 3
3
75
= 
2
64
1 0 0 
1 1 0 
1 1 1
3
75 
2
64
1 1 1 
0 1 1 
0 0 1
3
75
= LU: 
From A to U there are subtractions of rows. From U to A there are additions of rows. 
Example 4. (when U is the identity and L is the same as A) 
Lower triangular case A = 
2
64
1 0 0 
`21 1 0 
`31 `32 1
3
75
: 
The elimination steps on this A are easy: (i) E subtracts `21 times row 1 from row 2, (ii) 
F subtracts `31 times row 1 from row 3, and (iii) G subtracts `32 times row 2 from row 3. 
The result is the identity matrix U = I. The inverses of E, F, and G will bring back A:
1.5 Triangular Factors and Row Exchanges 39 
E.1 applied to F.1 applied to G.1 applied to I produces A. 
2
64
1 
`21 1 
1
3
75
times 
2
64
1 
1 
`31 1
3
75
times 
2
64
1 
1 
`32 1
3
75
equals 
2
64
1 0 0 
`21 1 0 
`31 `32 1
3
75
: 
The order is right for the `’s to fall into position. This always happens! Note that 
parentheses in E.1F.1G.1 were not necessary because of the associative law. 
A = LU: The n by n case 
The factorization A = LU is so important that we must say more. It used to be missing 
in linear algebra courses when they concentrated on the abstract side. Or maybe it was 
thought to be too hard—but you have got it. If the last Example 4 allows any U instead 
of the particularU = I, we can see how the rule works in general. The matrix L, applied 
to U, brings back A: 
A = LU 
2
64
1 0 0 
`21 1 0 
`31 `32 1
3
75 
2
64
row 1 of U 
row 2 of U 
row 3 of U
3
75
= original A: (7) 
The proof is to apply the steps of elimination. On the right-hand side they take A to U. 
On the left-hand side they reduce L to I, as in Example 4. (The first step subtracts `21 
times (1;0;0) from the second row, which removes `21.) Both sides of (7) end up equal 
to the same matrixU, and the steps to get there are all reversible. Therefore (7) is correct 
and A = LU. 
A = LU is so crucial, and so beautiful, that Problem 8 at the end of this section 
suggests a second approach. We are writing down 3 by 3 matrices, but you can see how 
the arguments apply to larger matrices. Here we give one more example, and then put 
A = LU to use. 
Example 5. (A = LU, with zeros in the empty spaces) 
A = 
2
6664 
1 .1 
.1 2 .1 
.1 2 .1 
.1 2 
3
7775
= 
2
6664 
1 
.1 1 
.1 1 
.1 1
3
7775 
2
6664 
1 .1 
1 .1 
1 .1 
1 
3
7775
: 
That shows how a matrix A with three diagonals has factors L andU with two diagonals. 
This example comes from an important problem in differential equations (Section 1.7). 
The second difference in A is a backward difference L times a forward difference U.
40 Chapter 1 Matrices and Gaussian Elimination 
One Linear System = Two Triangular Systems 
There is a serious practical point about A = LU. It is more than just a record of elimination 
steps; L and U are the right matrices to solve Ax = b. In fact A could be thrown 
away! We go from b to c by forward elimination (this uses L) and we go from c to x by 
back-substitution (that uses U). We can and should do it without A: 
Splitting of Ax = b First Lc = b and then Ux = c: (8) 
Multiply the second equation by L to give LUx = Lc, which is Ax = b. Each triangular 
system is quickly solved. That is exactly what a good elimination code will do: 
1. Factor (from A find its factors L and U). 
2. Solve (from L and U and b find the solution x). 
The separation into Factor and Solve means that a series of b’s can be processed. The 
Solve subroutine obeys equation (8): two triangular systems in n2=2 steps each. The 
solution for any new right-hand side b can be found in only n2 operations. That is 
far below the n3=3 steps needed to factor A on the left-hand side. 
Example 6. This is the previous matrix A with a right-hand side b = (1;1;1;1). 
Ax = b 
x1 . x2 = 1 
.x1 + 2x2 . x3 = 1 
. x2 + 2x3 . x4 = 1 
. x3 + 2x4 = 1 
splits into Lc = b and Ux = c: 
Lc = b 
c1 = 1 
.c1 + c2 = 1 
. c2 + c3 = 1 
. c3 + c4 = 1 
gives c = 
2
6664 
1
2
3
4
3
7775
: 
Ux = c 
x1 . x2 = 1 
x2 . x3 = 2 
x3 . x4 = 3 
x4 = 4 
gives x = 
2
6664 
10 
9
7
4 
3
7775
: 
For these special “tridiagonal matrices,” the operation count drops from n2 to 2n. You 
see how Lc = b is solved forward (c1 comes before c2). This is precisely what happens 
during forward elimination. Then Ux = c is solved backward (x4 before x3). 
Remark 1. The LU form is “unsymmetric” on the diagonal: L has 1s where U has the
1.5 Triangular Factors and Row Exchanges 41 
pivots. This is easy to correct. Divide out of U a diagonal pivot matrix D: 
Factor out D U = 
2
6664 
d1 
d2 
. . . 
dn
3
7775 
2
66664 
1 u12=d1 u13=d1 
... 
1 u23=d2 
... 
. . . ... 
1
3
77775
: (9) 
In the last example all pivots were di = 1. In that case D = I. But that was very exceptional, 
and normally LU is different from LDU (also written LDV). 
The triangular factorization can be written A = LDU, where L and U have 1s on 
the diagonal and D is the diagonal matrix of pivots. 
Whenever you see LDU or LDV, it is understood that U or V has is on the diagonal— 
each row was divided by the pivot in D. Then L and U are treated evenly. An example 
of LU splitting into LDU is 
A = 
"
1 2 
3 4
# 
= 
"
1
3 1
#"
1 2 
.2
# 
= 
"
1
3 1
#"
1 
.2
#"
1 2
1
# 
= LDU: 
That has the 1s on the diagonals of L and U, and the pivots 1 and .2 in D. 
Remark 2. We may have given the impression in describing each elimination step, that 
the calculations must be done in that order. This is wrong. There is some freedom, and 
there is a “Crout algorithm” that arranges the calculations in a slightly different way. 
There is no freedom in the final L, D, and U. That is our main point: 
1I If A = L1D1U1 and also A = L2D2U2, where the L’s are lower triangular 
with unit diagonal, the U’s are upper triangular with unit diagonal, and the 
D’s are diagonal matrices with no zeros on the diagonal, then L1 = L2, D1 = 
D2, U1 = U2. The LDU factorization and the LU factorization are uniquely 
determined by A. 
The proof is a good exercise with inverse matrices in the next section. 
Row Exchanges and Permutation Matrices 
We now have to face a problem that has so far been avoided: The number we expect to 
use as a pivot might be zero. This could occur in the middle of a calculation. It will 
happen at the very beginning if a11 = 0. A simple example is 
Zero in the pivot position 
"
0 2 
3 4
#"
u
v
# 
= 
"
b1 
b2
#
: 
The difficulty is clear; no multiple of the first equation will remove the coefficient 3.
42 Chapter 1 Matrices and Gaussian Elimination 
The remedy is equally clear. Exchange the two equations, moving the entry 3 up 
into the pivot. In this example the matrix would become upper triangular: 
Exchange rows 
3u+4v = b2 
2v = b1 
To express this in matrix terms, we need the permutation matrix P that produces the 
row exchange. It comes from exchanging the rows of I: 
Permutation P = 
"
0 1 
1 0
# 
and PA = 
"
0 1 
1 0
#"
0 2 
3 4
# 
= 
"
3 4 
0 2
#
: 
P has the same effect on b, exchanging b1 and b2. The new system is PAx = Pb. The 
unknowns u and v are not reversed in a row exchange. 
A permutation matrix P has the same rows as the identity (in some order). There is 
a single “1” in every row and column. The most common permutation matrix is P = I (it 
exchanges nothing). The product of two permutation matrices is another permutation— 
the rows of I get reordered twice. 
After P = I, the simplest permutations exchange two rows. Other permutations exchange 
more rows. There are n! = (n)(n.1) . . . (1) permutations of size n. Row 1 has 
n choices, then row 2 has n.1 choices, and finally the last row has only one choice. We 
can display all 3 by 3 permutations (there are 3! = (3)(2)(1) = 6 matrices): 
I = 
2
64
1 
1 
1
3
75
P21 = 
2
64
1 
1 
1
3
75
P32P21 = 
2
641 
1 
1 
3
75 
P31 = 
2
64
1 
1 
1 
3
75
P32 = 
2
64
1 
1 
1 
3
75
P21P32 = 
2
64
1 
1 
1 
3
75
: 
There will be 24 permutation matrices of order n = 4. There are only two permutation 
matrices of order 2, namely 
"
1 0 
0 1
# 
and 
"
0 1 
1 0
#
: 
When we know about inverses and transposes (the next section defines A.1 and AT), 
we discover an important fact: P.1 is always the same as PT. 
A zero in the pivot location raises two possibilities: The trouble may be easy to fix, 
or it may be serious. This is decided by looking below the zero. If there is a nonzero 
entry lower down in the same column, then a row exchange is carried out. The nonzero 
entry becomes the needed pivot, and elimination can get going again: 
A = 
2
64
0 a b 
0 0 c 
d e f
3
75
d = 0 =) no first pivot 
a = 0 =) no second pivot 
c = 0 =) no third pivot:
1.5 Triangular Factors and Row Exchanges 43 
If d = 0, the problem is incurable and this matrix is singular. There is no hope for a 
unique solution to Ax = b. If d is not zero, an exchange P13 of rows 1 and 3 will move 
d into the pivot. However the next pivot position also contains a zero. The number a is 
now below it (the e above it is useless). If a is not zero then another row exchange P23 is 
called for: 
P13 = 
2
64
0 0 1 
0 1 0 
1 0 0
3
75
and P23 = 
2
64
1 0 0 
0 0 1 
0 1 0
3
75
and P23P13A = 
2
64
d e f 
0 a b 
0 0 c
3
75 
One more point: The permutation P23P13 will do both row exchanges at once: 
P13 acts first P23P13 = 
2
64
1 0 0 
0 0 1 
0 1 0
3
75 
2
64
0 0 1 
0 1 0 
1 0 0
3
75
= 
2
64
0 0 1 
1 0 0 
0 1 0
3
75
= P: 
If we had known, we could have multiplied A by P in the first place. With the rows in 
the right order PA, any nonsingular matrix is ready for elimination. 
Elimination in a Nutshell: PA = LU 
The main point is this: If elimination can be completed with the help of row exchanges, 
then we can imagine that those exchanges are done first (by P). The matrix PA will not 
need row exchanges. In other words, PA allows the standard factorization into L times 
U. The theory of Gaussian elimination can be summarized in a few lines: 
1J In the nonsingular case, there is a permutation matrix P that reorders 
the rows of A to avoid zeros in the pivot positions. Then Ax = b has a unique 
solution: 
With the rows reordered in advance, PA can be factored into LU. 
In the singular case, no P can produce a full set of pivots: elimination fails. 
In practice, we also consider a row exchange when the original pivot is near zero— 
even if it is not exactly zero. Choosing a larger pivot reduces the roundoff error. 
You have to be careful with L. Suppose elimination subtracts row 1 from row 2, 
creating `21 = 1. Then suppose it exchanges rows 2 and 3. If that exchange is done in 
advance, the multiplier will change to `31 = 1 in PA = LU. 
Example 7. 
A = 
2
64
1 1 1 
1 1 3 
2 5 8
3
75
!
2
64
1 1 1 
0 0 2 
0 3 6
3
75
!
2
64
1 1 1 
0 3 6 
0 0 2
3
75
=U: (10)
44 Chapter 1 Matrices and Gaussian Elimination 
That row exchange recovers LU—but now `31 = 1 and `21 = 2: 
P = 
2
64
1 0 0 
0 0 1 
0 1 0
3
75
and L = 
2
64
1 0 0 
2 1 0 
1 0 1
3
75
and PA = LU: (11) 
In MATLAB, A([r k] :) exchanges row k with row r below it (where the kth pivot has 
been found). We update the matrices L and P the same way. At the start, P = I and sign 
= +1: 
A([r k], :) = A([k r], :); 
L([r k], 1:k-1) = L([k r], 1:k-1); 
P([r k], :) = P([k r], :); 
sign = -sign 
The “sign” of P tells whether the number of row exchanges is even (sign = +1) or odd 
(sign = .1). A row exchange reverses sign. The final value of sign is the determinant 
of P and it does not depend on the order of the row exchanges. 
To summarize: A good elimination code saves L and U and P. Those matrices carry 
the information that originally came in A—and they carry it in a more usable form. Ax = 
b reduces to two triangular systems. This is the practical equivalent of the calculation 
we do next—to find the inverse matrix A.1 and the solution x = A.1b. 
Problem Set 1.5 
1. When is an upper triangular matrix nonsingular (a full set of pivots)? 
2. What multiple `32 of row 2 of A will elimination subtract from row 3 of A? Use the 
factored form 
A = 
2
64
1 0 0 
2 1 0 
1 4 1
3
75 
2
64
5 7 8 
0 2 3 
0 0 6
3
75
: 
What will be the pivots? Will a row exchange be required? 
3. Multiply the matrix L = E.1F.1G.1 in equation (6) by GFE in equation (3): 
2
64
1 0 0 
2 1 0 
.1 .1 1
3
75
times 
2
64
1 0 0 
.2 1 0 
.1 1 1
3
75
: 
Multiply also in the opposite order. Why are the answers what they are?
1.5 Triangular Factors and Row Exchanges 45 
4. Apply elimination to produce the factors L and U for 
A = 
"
2 1 
8 7
# 
and A = 
2
64
3 1 1 
1 3 1 
1 1 3
3
75
and A = 
2
64
1 1 1 
1 4 4 
1 4 8
3
75
: 
5. Factor A into LU, and write down the upper triangular system Ux = c which appears 
after elimination, for 
Ax = 
2
64
2 3 3 
0 5 7 
6 9 8
3
75 
2
64
u
v
w
3
75
= 
2
64
2
2
5
3
75
: 
6. Find E2 and E8 and E.1 if 
E = 
"
1 0 
6 1
#
: 
7. Find the products FGH and HGF if (with upper triangular zeros omitted) 
F = 
2
6664 
1
2 1 
0 0 1 
0 0 0 1
3
7775
G = 
2
6664 
1
0 1 
0 2 1 
0 0 0 1
3
7775
H = 
2
6664 
1
0 1 
0 0 1 
0 0 2 1
3
7775: 
8. (Second proof of A = LU) The third row of U comes from the third row of A by 
subtracting multiples of rows 1 and 2 (of U!): 
row 3 of U = row 3 of A.`31(row 1 of U).`32(row 2 of U): 
(a) Why are rows of U subtracted off and not rows of A? Answer: Because by the 
time a pivot row is used, . 
(b) The equation above is the same as 
row 3 of A = `31(row 1 of U)+`32(row 2 of U)+1(row 3 of U): 
Which rule for matrix multiplication makes this row 3 of L times U? 
The other rows of LU agree similarly with the rows of A. 
9. (a) Under what conditions is the following product nonsingular? 
A = 
2
641 0 0 
.1 1 0 
0 .1 1
3
75 
2
64
d1 
d2 
d3
3
75 
2
64
1 .1 0 
0 1 .1 
0 0 1 
3
75
: 
(b) Solve the system Ax = b starting with Lc = b: 
2
64
1 0 0 
.1 1 0 
0 .1 1
3
75 
2
64
c1 
c2 
c3
3
75
= 
2
64
0
0
1
3
75
= b:
46 Chapter 1 Matrices and Gaussian Elimination 
10. (a) Why does it take approximately n2=2 multiplication-subtraction steps to solve 
each of Lc = b and Ux = c? 
(b) How many steps does elimination use in solving 10 systems with the same 60 by 
60 coefficient matrix A? 
11. Solve as two triangular systems, without multiplying LU to find A: 
LUx = 
2
64
1 0 0 
1 1 0 
1 0 1
3
75 
2
64
2 4 4 
0 1 2 
0 0 1
3
75 
2
64
u
v
w
3
75
= 
2
64
2
0
2
3
75
: 
12. How could you factor A into a product UL, upper triangular times lower triangular? 
Would they be the same factors as in A = LU? 
13. Solve by elimination, exchanging rows when necessary: 
u + 4v + 2w = .2 
.2u . 8v + 3w = 32 
v + w = 1 
and 
v + w = 0 
u + v = 0 
u + v + w = 1: 
Which permutation matrices are required? 
14. Write down all six of the 3 by 3 permutation matrices, including P = I. Identify their 
inverses, which are also permutation matrices. The inverses satisfy PP.1 = I and are 
on the same list. 
15. Find the PA = LDU factorizations (and check them) for 
A = 
2
64
0 1 1 
1 0 1 
2 3 4
3
75
and A = 
2
64
1 2 1 
2 4 2 
1 1 1
3
75
: 
16. Find a 4 by 4 permutation matrix that requires three row exchanges to reach the end 
of elimination (which is U = I). 
17. The less familiar form A = LPU exchanges rows only at the end: 
A = 
2
64
1 1 1 
1 1 3 
2 5 8
3
75
!L.1A = 
2
64
1 1 1 
0 0 2 
0 3 6
3
75
= PU = 
2
64
1 0 0 
0 0 1 
0 1 0
3
75 
2
64
1 1 1 
0 3 6 
0 0 2
3
75
: 
What is L is this case? Comparing with PA = LU in Box 1J, the multipliers now stay 
in place (`21 is 1 and `31 is 2 when A = LPU). 
18. Decide whether the following systems are singular or nonsingular, and whether they 
have no solution, one solution, or infinitely many solutions: 
v . w = 2 
u . v = 2 
u . w = 2 
and 
v . w = 0 
u . v = 0 
u . w = 0 
and 
v + w = 1 
u + v = 1 
u + w = 1:
1.5 Triangular Factors and Row Exchanges 47 
19. Which numbers a, b, c lead to row exchanges? Which make the matrix singular? 
A = 
2
64
1 2 0 
a 8 3 
0 b 5
3
75
and A = 
"
c 2 
6 4
#
: 
Problems 20–31 compute the factorization A = LU (and also A = LDU). 
20. Forward elimination changes 
. 
1 1 
1 2 
¤
x = b to a triangular 
. 1 1 
0 1 
¤
x = c: 
x + y = 5 
x + 2y = 7 
! 
x + y = 5 
y = 2 
"
1 1 5 
1 2 7
#
!
"
1 1 5 
0 1 2
#
: 
That step subtracted `21 = times row 1 from row 2. The reverse step adds `21 
times row 1 to row 2. The matrix for that reverse step is L = . Multiply this L 
times the triangular system 
. 1 1 
0 1 
¤
x = 
.
52
¤ 
to get = . In letters, L multiplies 
Ux = c to give . 
21. (Move to 3 by 3) Forward elimination changes Ax = b to a triangular Ux = c: 
x+y+z = 5 
x+2y+3z = 7 
x+3y+6z = 11 
x+y+z = 5 
y+2z = 2 
2y+5z = 6 
x+y+z = 5 
y+2z = 2 
z = 2: 
The equation z = 2 in Ux = c comes from the original x+3y+6z = 11 in Ax = b by 
subtracting `31 = times equation 1 and `32 = times the final equation 2. 
Reverse that to recover [1 3 6 11] in [A b] from the final [1 1 1 5] and [0 1 2 2] 
and [0 0 1 2] in [U c]: 
Row 3 of 
h
A b
i 
= (`31 Row 1 +`32 Row 2+1 Row 3) of 
h
U c
i
: 
In matrix notation this is multiplication by L. So A = LU and b = Lc. 
22. What are the 3 by 3 triangular systems Lc = b and Ux = c from Problem 21? Check 
that c = (5;2;2) solves the first one. Which x solves the second one? 
23. What two elimination matrices E21 and E32 put A into upper triangular form E32E21A= 
U? Multiply by E.1 
31 and E.1 
21 to factor A into LU = E.1 
21 E.1 
32 U: 
A = 
2
64
1 1 1 
2 4 5 
0 4 0
3
75
: 
24. What three elimination matrices E21, E31, E32 put A into upper triangular form 
E32E31E21A = U? Multiply by E.1 
32 , E.1 
31 and E.1 
21 to factor A into LU where L = 
E.1 
21 E.1 
31 E.1 
32 . Find L and U: 
A = 
2
64
1 0 1 
2 2 2 
3 4 5
3
75
:
48 Chapter 1 Matrices and Gaussian Elimination 
25. When zero appears in a pivot position, A = LU is not possible! (We need nonzero 
pivots d, f , i in U.) Show directly why these are both impossible: 
"
0 1 
2 3
# 
= 
"
1 0 
` 1
#"
d e 
0 f 
# 2
64
1 1 0 
1 1 2 
1 2 1
3
75
= 
2
64
1
` 1 
m n 1
3
75 
2
64
d e g 
f h
i
3
75
: 
26. Which number c leads to zero in the second pivot position? A row exchange is 
needed and A=LU is not possible. Which c produces zero in the third pivot position? 
Then a row exchange can’t help and elimination fails: 
A = 
2
64
1 c 0 
2 4 1 
3 5 1
3
75
: 
27. What are L and D for this matrix A? What is U in A = LU and what is the new U in 
A = LDU? 
A = 
2
64
2 4 8 
0 3 9 
0 0 7
3
75
: 
28. A and B are symmetric across the diagonal (because 4 = 4). Find their triple factorizations 
LDU and say how U is related to L for these symmetric matrices: 
A = 
"
2 4 
4 11
# 
and B = 
2
64
1 4 0 
4 12 4 
0 4 0
3
75
: 
29. (Recommended) Compute L and U for the symmetric matrix 
A = 
2
6664 a a a a 
a b b b 
a b c c 
a b c d
3
7775
: 
Find four conditions on a, b, c, d to get A = LU with four pivots. 
30. Find L and U for the nonsymmetric matrix 
A = 
2
6664 
a r r r 
a b s s 
a b c t 
a b c d
3
7775
: 
Find the four conditions on a, b, c, d, r, s, t to get A = LU with four pivots.
1.5 Triangular Factors and Row Exchanges 49 
31. Tridiagonal matrices have zero entries except on the main diagonal and the two 
adjacent diagonals. Factor these into A = LU and A = LDV: 
A = 
2
64
1 1 0 
1 2 1 
0 1 2
3
75
and A = 
2
64
a a 0 
a a+b b 
0 b b+c
3
75
: 
32. Solve the triangular system Lc = b to find c. Then solve Ux = c to find x: 
L = 
"
1 0 
4 1
# 
and U = 
"
2 4 
0 1
# 
and b = 
" 
2 
11
#
: 
For safety find A = LU and solve Ax = b as usual. Circle c when you see it. 
33. Solve Lc = b to find c. Then solve Ux = c to find x. What was A? 
L = 
2
64
1 0 0 
1 1 0 
1 1 1
3
75
and U = 
2
64
1 1 1 
0 1 1 
0 0 1
3
75
and b = 
2
64
4
5
6
3
75
: 
34. If A and B have nonzeros in the positions marked by x, which zeros are still zero in 
their factors L and U? 
A = 
2
6664 
x x x x 
x x x 0 
0 x x x 
0 0 x x
3
7775
and B = 
2
6664 
x x x 0 
x x 0 x 
x 0 x x 
0 x x x
3
7775: 
35. (Important) If A has pivots 2, 7, 6 with no row exchanges, what are the pivots for the 
upper left 2 by 2 submatrix B (without row 3 and column 3)? Explain why. 
36. Starting from a 3 by 3 matrix A with pivots 2, 7, 6, add a fourth row and column to 
produce M. What are the first three pivots for M, and why? What fourth row and 
column are sure to produce 9 as the fourth pivot? 
37. Use chol(pascal(5)) to find the triangular factors of MATLAB’s pascal(5). Row 
exchanges in [L, U] = lu(pascal(5)) spoil Pascal’s pattern! 
38. (Review) For which numbers c is A = LU impossible—with three pivots? 
A = 
2
64
1 2 0 
3 c 1 
0 1 1
3
75
: 
39. Estimate the time difference for each new right-hand side b when n = 800. Create A 
= rand(800) and b = rand(800,1) and B = rand(800,9). Compare the times from 
tic; Anb; toc and tic; AnB; toc (which solves for 9 right sides). 
Problems 40–48 are about permutation matrices.
50 Chapter 1 Matrices and Gaussian Elimination 
40. There are 12 “even” permutations of (1;2;3;4), with an even number of exchanges. 
Two of them are (1;2;3;4) with no exchanges and (4;3;2;1) with two exchanges. 
List the other ten. Instead of writing each 4 by 4 matrix, use the numbers 4, 3, 2, 1 
to give the position of the 1 in each row. 
41. How many exchanges will permute (5;4;3;2;1) back to (1;2;3;4;5)? How many 
exchanges to change (6;5;4;3;2;1) to (1;2;3;4;5;6)? One is even and the other is 
odd. For (n; : : : ;1) to (1; : : : ;n), show that n = 100 and 101 are even, n = 102 and 
103 are odd. 
42. If P1 and P2 are permutation matrices, so is P1P2. This still has the rows of I in some 
order. Give examples with P1P2 6= P2P1 and P3P4 = P4P3. 
43. (Try this question.) Which permutation makes PA upper triangular? Which permutations 
make P1AP2 lower triangular? Multiplying A on the right by P2 exchanges 
the of A. 
A = 
2
64
0 0 6 
1 2 3 
0 4 5
3
75 
44. Find a 3 by 3 permutation matrix with P3 = I (but not P = I). Find a 4 by 4 permutation 
bP with bP4 6= I. 
45. If you take powers of a permutation, why is some Pk eventually equal to I? Find a 5 
by 5 permutation P so that the smallest power to equal I is P6. (This is a challenge 
question. Combine a 2 by 2 block with a 3 by 3 block.) 
46. The matrix P that multiplies (x;y; z) to give (z;x;y) is also a rotation matrix. Find P 
and P3. The rotation axis a = (1;1;1) doesn’t move, it equals Pa. What is the angle 
of rotation from v = (2;3;.5) to Pv = (.5;2;3)? 
47. If P is any permutation matrix, find a nonzero vector x so that (I .P)x = 0. (This 
will mean that I.P has no inverse, and has determinant zero.) 
48. If P has 1s on the antidiagonal from (1;n) to (n;1), describe PAP. 
1.6 Inverses and Transposes 
The inverse of an n by n matrix is another n by n matrix. The inverse of A is written A.1 
(and pronounced “A inverse”). The fundamental property is simple: If you multiply by A 
and then multiply by A.1, you are back where you started: 
Inverse matrix If b = Ax then A.1b = x:
1.6 Inverses and Transposes 51 
Thus A.1Ax = x. The matrix A.1 times A is the identity matrix. Not all matrices have 
inverses. An inverse is impossible when Ax is zero and x is nonzero. Then A.1 would 
have to get back from Ax = 0 to x. No matrix can multiply that zero vector Ax and 
produce a nonzero vector x. 
Our goals are to define the inverse matrix and compute it and use it, when A.1 
exists—and then to understand which matrices don’t have inverses. 
1K The inverse of A is a matrix B such that BA = I and AB = I. There is at 
most one such B, and it is denoted by A.1: 
A.1A = I and AA.1 = I: (1) 
Note 1. The inverse exists if and only if elimination produces n pivots (row exchanges 
allowed). Elimination solves Ax = b without explicitly finding A.1. 
Note 2. The matrix A cannot have two different inverses, Suppose BA = I and also 
AC = I. Then B =C, according to this “proof by parentheses”: 
B(AC) = (BA)C gives BI = IC which is B =C: (2) 
This shows that a left-inverse B (multiplying from the left) and a right-inverse C (multiplying 
A from the right to give AC = I) must be the same matrix. 
Note 3. If A is invertible, the one and only solution to Ax = b is x = A.1b: 
Multiply Ax = b by A.1: Then x = A.1Ax = A.1b: 
Note 4. (Important) Suppose there is a nonzero vector x such that Ax = 0. Then A 
cannot have an inverse. To repeat: No matrix can bring 0 back to x. 
If A is invertible, then Ax = 0 can only have the zero solution x = 0. 
Note 5. A 2 by 2 matrix is invertible if and only if ad.bc is not zero: 
2 by 2 inverse 
"
a b 
c d
#.1 
= 
1 
ad.bc 
" 
d .b 
.c a 
#
: (3) 
This number ad .bc is the determinant of A. A matrix is invertible if its determinant 
is not zero (Chapter 4). In MATLAB, the invertibility test is to find n nonzero pivots. 
Elimination produces those pivots before the determinant appears. 
Note 6. A diagonal matrix has an inverse provided no diagonal entries are zero: 
If A = 
2
64
d1 
. . . 
dn
3
75
then A.1 = 
2
64
1=d1 
. . . 
1=dn
3
75
and AA.1 = I: 
When two matrices are involved, not much can be done about the inverse of A+B. 
The sum might or might not be invertible. Instead, it is the inverse of their product
52 Chapter 1 Matrices and Gaussian Elimination 
AB which is the key formula in matrix computations. Ordinary numbers are the same: 
(a+b).1 is hard to simplify, while 1=ab splits into 1=a times 1=b. But for matrices the 
order of multiplication must be correct—if ABx = y then Bx = A.1y and x = B.1A.1y. 
The inverses come in reverse order. 
1L A product AB of invertible matrices is inverted by B.1A.1: 
Inverse of AB (AB).1 = B.1A.1: (4) 
Proof. To show that B.1A.1 is the inverse of AB, we multiply them and use the associative 
law to remove parentheses. Notice how B sits next to B.1: 
(AB)(B.1A.1) = ABB.1A.1 = AIA.1 = AA.1 = I 
(B.1A.1)(AB) = B.1A.1AB = B.1IB = B.1B = I: 
A similar rule holds with three or more matrices: 
Inverse of ABC (ABC).1 =C.1B.1A.1: 
We saw this change of order when the elimination matrices E, F, G were inverted to 
come back from U to A. In the forward direction, GFEA was U. In the backward 
direction, L = E.1F.1G.1 was the product of the inverses. Since G came last, G.1 
comes first. Please check that A.1 would be U.1GFE. 
The Calculation of A.1: The Gauss-Jordan Method 
Consider the equation AA.1 = I. If it is taken a column at a time, that equation determines 
each column of A.1. The first column of A.1 is multiplied by A, to yield the 
first column of the identity: Ax1 = e1. Similarly Ax2 = e2 and Ax3 = e3 the e’s are the 
columns of I. In a 3 by 3 example, A times A.1 is I: 
Axi = ei 
2
64
2 1 1 
4 .6 0 
.2 7 2
3
75
h
x1 x2 x3
i 
= 
h
e1 e2 e3
i 
= 
2
64
1 0 0 
0 1 0 
0 0 1
3
75
: (5) 
Thus we have three systems of equations (or n systems). They all have the same coefficient 
matrix A. The right-hand sides e1, e2, e3 are different, but elimination is possible 
on all systems simultaneously. This is the Gauss-Jordan method. Instead of stopping 
at U and switching to back-substitution, it continues by subtracting multiples of a row 
from the rows above. This produces zeros above the diagonal as well as below. When it 
reaches the identity matrix we have found A.1. 
The example keeps all three columns e1, e2, e3, and operates on rows of length six:
1.6 Inverses and Transposes 53 
Example 1. Using the Gauss-Jordan Method to Find A.1 
h
A e1 e2 e3
i 
= 
2
64
2 1 1 1 0 0 
4 .6 0 0 1 0 
.2 7 2 0 0 1
3
75 
pivot = 2!
2
64
2 1 1 1 0 0 
0 .8 .2 .2 1 0 
0 8 3 1 0 1
3
75 
pivot = .8!
2
64
2 1 1 1 0 0 
0 .8 .2 .2 1 0 
0 0 1 .1 1 1
3
75
= 
h
U L.1
i
: 
This completes the first half—forward elimination. The upper triangular U appears in 
the first three columns. The other three columns are the same as L.1. (This is the effect 
of applying the elementary operations GFE to the identity matrix.) Now the second half 
will go from U to I (multiplying by U.1). That takes L.1 to U.1L.1 which is A.1. 
Creating zeros above the pivots, we reach A.1: 
Second half 
h
U L.1
i
!
2
64
2 1 0 2 .1 .1 
0 .8 0 .4 3 2 
0 0 1 .1 1 1 
3
75 
zeros above pivots!
2
64
2 0 0 12 
8 .58
.68 0 .8 0 .4 3 2 
0 0 1 .1 1 1 
3
75 
divide by pivots!
2
64
1 0 0 12 
16 . 5 
16 . 6 
16 
0 1 0 48.38
.28 
0 0 1 .1 1 1 
3
75
= 
h
I A.1
i
: 
At the last step, we divided the rows by their pivots 2 and .8 and 1. The coefficient 
matrix in the left-hand half became the identity. Since A went to I, the same operations 
on the right-hand half must have carried I into A.1. Therefore we have computed the 
inverse. 
A note for the future: You can see the determinant .16 appearing in the denominators 
of A.1. The determinant is the product of the pivots (2)(.8)(1). It enters at the end 
when the rows are divided by the pivots. 
Remark 1. In spite of this brilliant success in computing A.1, I don’t recommend it, I 
admit that A.1 solves Ax = b in one step. Two triangular steps are better: 
x = A.1b separates into Lc = b and Ux = c: 
We could write c = L.1b and then x = U.1c = U.1L.1b. But note that we did not 
explicitly form, and in actual computation should not form, these matrices L.1 andU.1.
54 Chapter 1 Matrices and Gaussian Elimination 
It would be a waste of time, since we only need back-substitution for x (and forward 
substitution produced c). 
A similar remark applies to A.1; the multiplication A.1b would still take n2 steps. It 
is the solution that we want, and not all the entries in the inverse. 
Remark 2. Purely out of curiosity, we might count the number of operations required 
to find A.1. The normal count for each new right-hand side is n2, half in the forward 
direction and half in back-substitution. With n right-hand sides e1; : : : ;en this makes n3. 
After including the n3=3 operations on A itself, the total seems to be 4n3=3. 
This result is a little too high because of the zeros in the e j. Forward elimination 
changes only the zeros below the 1. This part has only n. j components, so the count 
for e j is effectively changed to (n. j)2=2. Summing over all j, the total for forward 
elimination is n3=6. This is to be combined with the usual n3=3 operations that are 
applied to A, and the n(n2=2) back-substitution steps that finally produce the columns x j 
of A.1. The final count of multiplications for computing A.1 is n3: 
Operation count 
n3 
6 
+ 
n3 
3 
+n
µ
n2 
2 
¶ 
= n3: 
This count is remarkably low. Since matrix multiplication already takes n3 steps, it 
requires as many operations to compute A2 as it does to compute A.1! That fact seems 
almost unbelievable (and computing A3 requires twice as many, as far as we can see). 
Nevertheless, if A.1 is not needed, it should not be computed. 
Remark 3. In the Gauss-Jordan calculation we went all the way forward to U, before 
starting backward to produce zeros above the pivots. That is like Gaussian elimination, 
but other orders are possible. We could have used the second pivot when we were there 
earlier, to create a zero above it as well as below it. This is not smart. At that time 
the second row is virtually full, whereas near the end it has zeros from the upward row 
operations that have already taken place. 
Invertible = Nonsingular (n pivots) 
Ultimately we want to know which matrices are invertible and which are not. This 
question is so important that it has many answers. See the last page of the book! 
Each of the first five chapters will give a different (but equivalent) test for invertibility. 
Sometimes the tests extend to rectangular matrices and one-sided inverses: Chapter 2 
looks for independent rows and independent columns, Chapter 3 inverts AAT or ATA. 
The other chapters look for nonzero determinants or nonzero eigenvalues or nonzero 
pivots. This last test is the one we meet through Gaussian elimination. We want to show 
(in a few theoretical paragraphs) that the pivot test succeeds. 
Suppose A has a full set of n pivots. AA.1 = I gives n separate systems Axi = ei 
for the columns of A.1. They can be solved by elimination or by Gauss-Jordan. Row 
exchanges may be needed, but the columns of A.1 are determined.
1.6 Inverses and Transposes 55 
Strictly speaking, we have to show that the matrix A.1 with those columns is also 
a left-inverse. Solving AA.1 = I has at the same time solved A.1A = I, but why? A 
1-sided inverse of a square matrix is automatically a 2-sided inverse. To see why, 
notice that every Gauss-Jordan step is a multiplication on the left by an elementary 
matrix. We are allowing three types of elementary matrices: 
1. Ei j to subtract a multiple ` of row j from row i 
2. Pi j to exchange rows i and j 
3. D (or D.1) to divide all rows by their pivots. 
The Gauss-Jordan process is really a giant sequence of matrix multiplications: 
(D.1 . . .E . . .P. . .E)A = I: (6) 
That matrix in parentheses, to the left of A, is evidently a left-inverse! It exists, it equals 
the right-inverse by Note 2, so every nonsingular matrix is invertible. 
The converse is also true: If A is invertible, it has n pivots. In an extreme case that 
is clear: A cannot have a whole column of zeros. The inverse could never multiply a 
column of zeros to produce a column of I. In a less extreme case, suppose elimination 
starts on an invertible matrix A but breaks down at column 3: 
Breakdown 
No pivot in column 3 
A0 = 
2
6664 
d1 x x x 
0 d2 x x 
0 0 0 x 
0 0 0 x
3
7775
: 
This matrix cannot have an inverse, no matter what the x’s are. One proof is to use 
column operations (for the first time?) to make the whole third column zero. By subtracting 
multiples of column 2 and then of column 1, we reach a matrix that is certainly 
not invertible. Therefore the original A was not invertible. Elimination gives a complete 
test: An n by n matrix is invertible if and only if it has n pivots. 
The Transpose Matrix 
We need one more matrix, and fortunately it is much simpler than the inverse. The 
transpose of A is denoted by AT. Its columns are taken directly from the rows of A—the 
ith row of A becomes the ith column of AT: 
Transpose If A = 
"
2 1 4 
0 0 3
# 
then AT = 
2
64
2 0 
1 0 
4 3
3
75
: 
At the same time the columns of A become the rows of AT, If A is an m by n matrix, then 
AT is n by m. The final effect is to flip the matrix across its main diagonal, and the entry
56 Chapter 1 Matrices and Gaussian Elimination 
in row i, column j of AT comes from row j, column i of A: 
Entries of AT (AT)i j = Aji: (7) 
The transpose of a lower triangular matrix is upper triangular. The transpose of AT brings 
us back to A. 
If we add two matrices and then transpose, the result is the same as first transposing 
and then adding: (A+B)T is the same as AT+BT. But what is the transpose of a product 
AB or an inverse A.1? Those are the essential formulas of this section: 
1M 
(i) The transpose of AB is (AB)T = BTAT, 
(ii) The transpose of A.1 is (A.1)T = (AT).1. 
Notice how the formula for (AB)T resembles the one for (AB).1. In both cases we 
reverse the order, giving BTAT and B.1A.1. The proof for the inverse was easy, but this 
one requires an unnatural patience with matrix multiplication. The first row of (AB)T is 
the first column of AB. So the columns of A are weighted by the first column of B. This 
amounts to the rows of AT weighted by the first row of BT. That is exactly the first row 
of BTAT. The other rows of (AB)T and BTAT also agree. 
Start from AB = 
"
1 0 
1 1
#"
3 3 3 
2 2 2
# 
= 
"
3 3 3 
5 5 5
# 
Transpose to BTAT = 
2
64
3 2 
3 2 
3 2
3
75 
"
1 1 
0 1
# 
= 
2
64
3 5 
3 5 
3 5
3
75
: 
To establish the formula for (A.1)T, start from AA.1 = I and A.1A = I and take transposes. 
On one side, IT = I. On the other side, we know from part (i) the transpose of a 
product. You see how (A.1)T is the inverse of AT, proving (ii): 
Inverse of AT = Transpose of A.1 (A.1)TAT = I: (8) 
Symmetric Matrices 
With these rules established, we can introduce a special class of matrices, probably 
the most important class of all. A symmetric matrix is a matrix that equals its own 
transpose: AT = A. The matrix is necessarily square. Each entry on one side of the 
diagonal equals its “mirror image” on the other side: ai j = aji. Two simple examples are 
A and D (and also A.1): 
Symmetric matrices A=
"
1 2 
2 8
# 
and D=
"
1 0 
0 4
# 
and A.1 = 
1
4 
" 
8 .2 
.2 1 
#
:
1.6 Inverses and Transposes 57 
A symmetric matrix need not be invertible; it could even be a matrix of zeros. But if 
A.1 exists it is also symmetric. From formula (ii) above, the transpose of A.1 always 
equals (AT).1; for a symmetric matrix this is just A.1. A.1 equals its own transpose; it 
is symmetric whenever A is. Now we show that multiplying any matrix R by RT gives a 
symmetric matrix. 
Symmetric Products RTR, RRT, and LDLT 
Choose any matrix R, probably rectangular. Multiply RT times R. Then the product RTR 
is automatically a square symmetric matrix: 
The transpose of RTR is RT(RT)T; which is RTR. (9) 
That is a quick proof of symmetry for RTR. Its i, j entry is the inner product of row i 
of RT (column i of R) with column j of R. The ( j; i) entry is the same inner product, 
column j with column i. So RTR is symmetric. 
RRT is also symmetric, but it is different from RTR. In my experience, most scientific 
problems that start with a rectangular matrix R end up with RTR or RRT or both. 
Example 2. R = [1 2] and RT = [12
] produce RTR = 
. 
1 2 
2 4 
¤ 
and RRT = [5]. 
The product RTR is n by n. In the opposite order, RRT is m by m. Even if m = n, it is not 
very likely that RTR = RRT. Equality can happen, but it’s not normal. 
Symmetric matrices appear in every subject whose laws are fair. “Each action has an 
equal and opposite reaction.” The entry ai j that gives the action of i onto j is matched 
by aji. We will see this symmetry in the next section, for differential equations. Here, 
LU misses the symmetry but LDLT captures it perfectly. 
1N Suppose A = AT can be factored into A = LDU without row exchanges. 
ThenU is the transpose of L. The symmetric factorization becomes A=LDLT. 
The transpose of A = LDU gives AT = UTDTLT. Since A = AT, we now have two 
factorizations of A into lower triangular times diagonal times upper triangular. (LT is 
upper triangular with ones on the diagonal, exactly like U.) Since the factorization is 
unique (see Problem 17), LT must be identical to U. 
LT =U and A = LDLT 
"
1 2 
2 8
# 
= 
"
1 0 
2 1
#"
1 0 
0 4
#"
1 2 
0 1
# 
= LDLT: 
When elimination is applied to a symmetric matrix, AT =A is an advantage. The smaller 
matrices stay symmetric as elimination proceeds, and we can work with half the matrix! 
The lower right-hand corner remains symmetric: 
2
64
a b c 
b d e 
c e f
3
75
!
2
64
a b c 
0 d. b2 
a e. bc 
a 
0 e. bc 
a f . c2 
a 
3
75
:
58 Chapter 1 Matrices and Gaussian Elimination 
The work of elimination is reduced from n3=3 to n3=6. There is no need to store entries 
from both sides of the diagonal, or to store both L and U. 
Problem Set 1.6 
1. Find the inverses (no special system required) of 
A1 = 
"
0 2 
3 0
#
; A2 = 
"
2 0 
4 2
#
; A3 = 
"
cosq .sinq 
sinq cosq 
#
: 
2. (a) Find the inverses of the permutation matrices 
P = 
2
64
0 0 1 
0 1 0 
1 0 0
3
75
and P = 
2
64
0 0 1 
1 0 0 
0 1 0
3
75
: 
(b) Explain for permutations why P.1 is always the same as PT. Show that the 1s 
are in the right places to give PPT = I. 
3. From AB =C find a formula for A.1. Also find A.1 from PA = LU. 
4. (a) If A is invertible and AB = AC, prove quickly that B =C. 
(b) If A = [ 1 0 
0 0 ], find an example with AB = AC but B 6=C. 
5. If the inverse of A2 is B, show that the inverse of A is AB. (Thus A is invertible 
whenever A2 is invertible.) 
6. Use the Gauss-Jordan method to invert 
A1 = 
2
64
1 0 0 
1 1 1 
0 0 1
3
75
; A2 = 
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75
; A3 = 
2
64
0 0 1 
0 1 1 
1 1 1
3
75
: 
7. Find three 2 by 2 matrices, other than A = I and A = .I, that are their own inverses: 
A2 = I. 
8. Show that A = [ 1 1 
3 3 ] has no inverse by solving Ax = 0, and by failing to solve 
"
1 1 
3 3
#"
a b 
c d
# 
= 
"
1 0 
0 1
#
: 
9. Suppose elimination fails because there is no pivot in column 3: 
Missing pivot A = 
2
6664 
2 1 4 6 
0 3 8 5 
0 0 0 7 
0 0 0 9
3
7775
:
1.6 Inverses and Transposes 59 
Show that A cannot be invertible. The third row of A.1, multiplying A, should give 
the third row [0 0 1 0] of A.1A = I. Why is this impossible? 
10. Find the inverses (in any legal way) of 
A1 = 
2
6664 
0 0 0 1 
0 0 2 0 
0 3 0 0 
4 0 0 0
3
7775
; A2 = 
2
6664 
1 0 0 0 
.12
1 0 0 
0 .23
1 0 
0 0 .34
1
3
7775
; A3 = 
2
6664 
a b 0 0 
c d 0 0 
0 0 a b 
0 0 c d
3
7775
: 
11. Give examples of A and B such that 
(a) A+B is not invertible although A and B are invertible. 
(b) A+B is invertible although A and B are not invertible. 
(c) all of A, B, and A+B are invertible. 
(d) In the last case use A.1(A+B)B.1 = B.1+A.1 to show that C = B.1+A.1 is 
also invertible—and find a formula for C.1. 
12. If A is invertible, which properties of A remain true for A.1? 
(a) A is triangular. (b) A is symmetric. (c) A is tridiagonal. (d) All entries are whole 
numbers. (e) All entries are fractions (including numbers like 31
). 
13. If A = [31
] and B = [22
], compute ATB, BTA, ABT, and BAT. 
14. If B is square, show that A = B+BT is always symmetric and K = B.BT is always 
skew-symmetric—which means that KT = .K. Find these matrices A and K when 
B = [ 1 3 
1 1 ], and write B as the sum of a symmetric matrix and a skew-symmetric 
matrix. 
15. (a) How many entries can be chosen independently in a symmetric matrix of order 
n? 
(b) How many entries can be chosen independently in a skew-symmetric matrix 
(KT = .K) of order n? The diagonal of K is zero! 
16. (a) If A = LDU, with 1s on the diagonals of L and U, what is the corresponding 
factorization of AT? Note that A and AT (square matrices with no row exchanges) 
share the same pivots. 
(b) What triangular systems will give the solution to ATy = b? 
17. If A = L1D1U1 and A = L2D2U2, prove that L1 = L2, D1 = D2, and U1 =U2. If A is 
invertible, the factorization is unique. 
(a) Derive the equation L.1 
1 L2D2 = D1U1U.1 
2 , and explain why one side is lower 
triangular and the other side is upper triangular. 
(b) Compare the main diagonals and then compare the off-diagonals.
60 Chapter 1 Matrices and Gaussian Elimination 
18. Under what conditions on their entries are A and B invertible? 
A = 
2
64
a b c 
d e 0 
f 0 0
3
75
B = 
2
64
a b 0 
c d 0 
0 0 e
3
75
: 
19. Compute the symmetric LDLT factorization of 
A = 
2
64
1 3 5 
3 12 18 
5 18 30
3
75
and A = 
"
a b 
b d
#
: 
20. Find the inverse of 
A = 
2
6664 
1 0 0 0 
14
1 0 0 
13 
13
1 0 
12 
12 
12
1
3
7775
: 
21. (Remarkable) If A and B are square matrices, show that I.BA is invertible if I.AB 
is invertible. Start from B(I.AB) = (1.BA)B. 
22. Find the inverses (directly or from the 2 by 2 formula) of A, B, C: 
A = 
"
0 3 
4 6
# 
and B = 
"
a b 
b 0
# 
and C = 
"
3 4 
5 7
#
: 
23. Solve for the columns of A.1 = 
"
x t 
y z
#
: 
"
10 20 
20 50
#"
x
y
# 
= 
"
1
0
# 
and 
"
10 20 
20 50
#"
t
z
# 
= 
"
0
1
#
: 
24. Show that [ 1 2 
3 6 ] has no inverse by trying to solve for the column (x;y): 
"
1 2 
3 6
#"
x t 
y z
# 
= 
"
1 0 
0 1
# 
must include 
"
1 2 
3 6
#"
x
y
# 
= 
"
1
0
#
: 
25. (Important) If A has row 1 + row 2 = row 3, show that A is not invertible: 
(a) Explain why Ax = (1;0;0) cannot have a solution. 
(b) Which right-hand sides (b1;b2;b3) might allow a solution to Ax = b? 
(c) What happens to row 3 in elimination? 
26. If A has column 1 + column 2 = column 3, show that A is not invertible:
1.6 Inverses and Transposes 61 
(a) Find a nonzero solution x to Ax = 0. The matrix is 3 by 3. 
(b) Elimination keeps column 1 + column 2 = column 3. Explain why there is no 
third pivot. 
27. Suppose A is invertible and you exchange its first two rows to reach B. Is the new 
matrix B invertible? How would you find B.1 from A.1? 
28. If the product M = ABC of three square matrices is invertible, then A, B, C are 
invertible. Find a formula for B.1 that involves M.1 and A and C. 
29. Prove that a matrix with a column of zeros cannot have an inverse. 
30. Multiply [ a b 
c d ] times [ d .b 
.c a ]. What is the inverse of each matrix if ad 6= bc? 
31. (a) What matrix E has the same effect as these three steps? Subtract row 1 from row 
2, subtract row 1 from row 3, then subtract row 2 from row 3. 
(b) What single matrix L has the same effect as these three reverse steps? Add row 
2 to row 3, add row 1 to row 3, then add row 1 to row 2. 
32. Find the numbers a and b that give the inverse of 5 ¤ eye(4) . ones(4,4): 
2
6664 
4 .1 .1 .1 
.1 4 .1 .1 
.1 .1 4 .1 
.1 .1 .1 4 
3
7775 
.1 
= 
2
6664 
a b b b 
b a b b 
b b a b 
b b b a
3
7775
: 
What are a and b in the inverse of 6 ¤ eye(5) . ones(5,5)? 
33. Show that A = 4 ¤ eye(4) . ones(4,4) is not invertible: Multiply A ¤ ones(4,1). 
34. There are sixteen 2 by 2 matrices whose entries are 1s and 0s. How many of them 
are invertible? 
Problems 35–39 are about the Gauss-Jordan method for calculating A.1. 
35. Change I into A.1 as you reduce A to I (by row operations): 
h
A I
i 
= 
"
1 3 1 0 
2 7 0 1
# 
and 
h
A I
i 
= 
"
1 4 1 0 
3 9 0 1
#
: 
36. Follow the 3 by 3 text example but with plus signs in A. Eliminate above and below 
the pivots to reduce [A I] to [I A.1]: 
h
A I
i 
= 
2
64
2 1 0 1 0 0 
1 2 1 0 1 0 
0 1 2 0 0 1
3
75
:
62 Chapter 1 Matrices and Gaussian Elimination 
37. Use Gauss-Jordan elimination on [A I] to solve AA.1 = I: 
2
64
1 a b 
0 1 c 
0 0 1
3
75
h
x1 x2 x3
i 
= 
2
64
1 0 0 
0 1 0 
0 0 1
3
75
: 
38. Invert these matrices A by the Gauss-Jordan method starting with [A I]: 
A = 
2
64
1 0 0 
2 1 3 
0 0 1
3
75
and A = 
2
64
1 1 1 
1 2 2 
1 2 3
3
75
: 
39. Exchange rows and continue with Gauss-Jordan to find A.1: 
h
A I
i 
= 
"
0 2 1 0 
2 2 0 1
#
: 
40. True or false (with a counterexample if false and a reason if true): 
(a) A 4 by 4 matrix with a row of zeros is not invertible. 
(b) A matrix with Is down the main diagonal is invertible. 
(c) If A is invertible then A.1 is invertible. 
(d) If AT is invertible then A is invertible. 
41. For which three numbers c is this matrix not invertible, and why not? 
A = 
2
64
2 c c 
c c c 
8 7 c
3
75
: 
42. Prove that A is invertible if a 6= 0 and a 6= b (find the pivots and A.1): 
A = 
2
64
a b b 
a a b 
a a a
3
75
: 
43. This matrix has a remarkable inverse. Find A.1 by elimination on [A I]. Extend to a 
5 by 5 “alternating matrix” and guess its inverse: 
A = 
2
6664 
1 .1 1 .1 
0 1 .1 1 
0 0 1 .1 
0 0 0 1 
3
7775
:
1.6 Inverses and Transposes 63 
44. If B has the columns of A in reverse order, solve (A.B)x = 0 to show that A.B is 
not invertible. An example will lead you to x. 
45. Find and check the inverses (assuming they exist) of these block matrices: 
"
I 0 
C I
# "
A 0 
C D
# "
0 I 
I D
#
: 
46. Use inv(S) to invert MATLAB’s 4 by 4 symmetric matrix S = pascal(4). Create 
Pascal’s lower triangular A = abs(pascal(4,1)) and test inv(S) = inv(A’) ¤ inv(A). 
47. If A = ones(4,4) and b = rand(4,1), how does MATLAB tell you that Ax = b has 
no solution? If b = ones(4,1), which solution to Ax = b is found by Anb? 
48. M.1 shows the change in A.1 (useful to know) when a matrix is subtracted from A. 
Check part 3 by carefully multiplying MM.1 to get I: 
1. M = I.uvT and M.1 = I+uvT=(1.vTu). 
2. M = A.uvT and M.1 = A.1+A.1uvTA.1=(1.vTA.1u). 
3. M = I.UV and M.1 = In+U(Im.VU).1V. 
4. M = A.UW.1V and M.1 = A.1+A.1U(W .VA.1U).1VA.1. 
The four identities come from the 1, 1 block when inverting these matrices: 
" 
I u 
vT 1
# " 
A u 
vT 1
# "
In U 
V Im
# "
A U 
V W
#
: 
Problems 49–55 are about the rules for transpose matrices. 
49. Find AT and A.1 and (A.1)T and (AT).1 for 
A = 
"
1 0 
9 3
# 
and also A = 
"
1 c 
c 0
#
: 
50. Verify that (AB)T equals BTAT but those are different from ATBT: 
A = 
"
1 0 
2 1
# 
B = 
"
1 3 
0 1
# 
AB = 
"
1 3 
2 7
#
: 
In case AB = BA (not generally true!), how do you prove that BTAT = ATBT? 
51. (a) The matrix 
.
(AB).1.T comes from (A.1)T and (B.1)T. In what order? 
(b) If U is upper triangular then (U.1)T is triangular. 
52. Show that A2 = 0 is possible but ATA = 0 is not possible (unless A = zero matrix).
64 Chapter 1 Matrices and Gaussian Elimination 
53. (a) The row vector xT times A times the column y produces what number? 
xTAy = 
h
0 1
i"
1 2 3 
4 5 6
#2
64
0
1
0
3
75
= : 
(b) This is the row xTA = times the column y = (0;1;0). 
(c) This is the row xT = [0 1] times the column Ay = . 
54. When you transpose a block matrix M = [ A B 
C D] the result is MT = . Test it. 
Under what conditions on A, B, C, D is the block matrix symmetric? 
55. Explain why the inner product of x and y equals the inner product of Px and Py. 
Then (Px)T(Py) = xTy says that PTP = I for any permutation. With x = (1;2;3) and 
y = (1;4;2), choose P to show that (Px)Ty is not always equal to xT(PTy). 
Problems 56–60 are about symmetric matrices and their factorizations. 
56. If A = AT and B = BT, which of these matrices are certainly symmetric? 
(a) A2.B2 (b) (A+B)(A.B) (c) ABA (d) ABAB. 
57. If A = AT needs a row exchange, then it also needs a column exchange to stay symmetric. 
In matrix language, PA loses the symmetry of A but recovers the symmetry. 
58. (a) How many entries of A can be chosen independently, if A = AT is 5 by 5? 
(b) How do L and D (5 by 5) give the same number of choices in LDLT? 
59. Suppose R is rectangular (m by n) and A is symmetric (m by m). 
(a) Transpose RTAR to show its symmetry. What shape is this matrix? 
(b) Show why RTR has no negative numbers on its diagonal. 
60. Factor these symmetric matrices into A = LDLT. The matrix D is diagonal: 
A = 
"
1 3 
3 2
# 
and A = 
"
1 b 
b c
# 
and A = 
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75
: 
The next three problems are about applications of (Ax)Ty = xT(ATy). 
61. Wires go between Boston, Chicago, and Seattle. Those cities are at voltages xB, xC, 
xS. With unit resistances between cities, the three currents are in y: 
y = Ax is 
2
64
yBC 
yCS 
yBS
3
75
= 
2
64
1 .1 0 
0 1 .1 
1 0 .1
3
75 
2
64
xB 
xC 
xS
3
75
:
1.6 Inverses and Transposes 65 
(a) Find the total currents ATy out of the three cities. 
(b) Verify that (Ax)Ty agrees with xT(ATy)—six terms in both. 
62. Producing x1 trucks and x2 planes requires x1 +50x2 tons of steel, 40x1 +1000x2 
pounds of rubber, and 2x1+50x2 months of labor. If the unit costs y1, y2, y3 are $700 
per ton, $3 per pound, and $3000 per month, what are the values of one truck and 
one plane? Those are the components of ATy. 
63. Ax gives the amounts of steel, rubber, and labor to produce x in Problem 62. Find A. 
Then (Ax)Ty is the of inputs while xT(ATy) is the value of . 
64. Here is a new factorization of A into triangular times symmetric: 
Start from A = LDU. Then A equals L(UT).1 times UTDU. 
Why is L(UT).1 triangular? Its diagonal is all 1s. Why is UTDU symmetric? 
65. A group of matrices includes AB and A.1 if it includes A and B. “Products and 
inverses stay in the group.” Which of these sets are groups? Lower triangularmatrices 
L with is on the diagonal, symmetric matrices S, positive matrices M, diagonal 
invertible matrices D, permutation matrices P. Invent two more matrix groups. 
66. If every row of a 4 by 4 matrix contains the numbers 0, 1, 2, 3 in some order, can the 
matrix be symmetric? Can it be invertible? 
67. Prove that no reordering of rows and reordering of columns can transpose a typical 
matrix. 
68. A square northwest matrix B is zero in the southeast corner, below the antidiagonal 
that connects (1;n) to (n;1). Will BT and B2 be northwest matrices? Will B.1 be 
northwest or southeast? What is the shape of BC = northwest times southeast? 
You are allowed to combine permutations with the usual L and U (southwest and 
northeast). 
69. Compare tic; inv(A); toc for A = rand(500) and A = rand(1000). The n3 count 
says that computing time (measured by tic; toc) should multiply by 8 when n is 
doubled. Do you expect these random A to be invertible? 
70. I = eye(1000); A = rand(1000); B = triu(A); produces a random triangular matrix 
B. Compare the times for inv(B) and BnI. Backslash is engineered to use the zeros 
in B, while inv uses the zeros in I when reducing [B I] by Gauss-Jordan. (Compare 
also with inv(A) and AnI for the full matrix A.) 
71. Show that L.1 has entries j=i for i · j (the .1, 2, .1 matrix has this L): 
L = 
2
6664 
1 0 0 0 
.12
1 0 0 
0 .23
1 0 
0 0 .34
1
3
7775
and L.1 = 
2
6664 
1 0 0 0 
12
1 0 0 
13 
23
1 0 
14 
24 
34
1
3
7775
:
66 Chapter 1 Matrices and Gaussian Elimination 
Test this pattern for L = eye(5) . diag(1:5)ndiag(1:4,.1) and inv(L). 
1.7 Special Matrices and Applications 
This section has two goals. The first is to explain one way in which large linear systems 
Ax = b can arise in practice. The truth is that a large and completely realistic problem in 
engineering or economics would lead us far afield. But there is one natural and important 
application that does not require a lot of preparation. 
The other goal is to illustrate, by this same application, the special properties that coefficient 
matrices frequently have. Large matrices almost always have a clear pattern— 
frequently a pattern of symmetry, and very many zero entries. Since a sparse matrix 
contains far fewer than n2 pieces of information, the computations ought to be fast. We 
look at band matrices, to see how concentration near the diagonal speeds up elimination. 
In fact we look at one special tridiagonal matrix. 
The matrix itself can be seen in equation (6). It comes from changing a differential 
equation to a matrix equation. The continuous problem asks for u(x) at every x, and a 
computer cannot solve it exactly. It has to be approximated by a discrete problem—the 
more unknowns we keep, the better will be the accuracy and the greater the expense. 
As a simple but still very typical continuous problem, our choice falls on the differential 
equation 
.
d2u 
dx2 = f (x); 0 · x · 1: (1) 
This is a linear equation for the unknown function u(x). Any combination C+Dx 
could be added to any solution, since the second derivative ofC+Dx contributes nothing. 
The uncertainty left by these two arbitrary constants C and D is removed by a “boundary 
condition” at each end of the interval: 
u(0) = 0; u(1) = 0: (2) 
The result is a two-point boundary-value problem, describing not a transient but a steadystate 
phenomenon—the temperature distribution in a rod, for example, with ends fixed 
at 0. and with a heat source f (x). 
Remember that our goal is to produce a discrete problem—in other words, a problem 
in linear algebra. For that reason we can only accept a finite amount of information about 
f (x), say its values at n equally spaced points x = h;x = 2h; : : : ;x = nh. We compute 
approximate values u1; : : : ;un for the true solution u at these same points. At the ends 
x = 0 and x = 1 = (n+1)h, the boundary values are u0 = 0 and un+1 = 0. 
The first question is: How do we replace the derivative d2u=dx2? The first derivative 
can be approximated by stopping Du=Dx at a finite stepsize, and not permitting h (or Dx)
1.7 Special Matrices and Applications 67 
to approach zero. The difference Du can be forward, backward, or centered: 
.u 
.x 
= 
u(x+h).u(x) 
h 
or 
u(x).u(x.h) 
h 
or 
u(x+h).u(x.h) 
2h 
: (3) 
The last is symmetric about x and it is the most accurate. For the second derivative there 
is just one combination that uses only the values at x and x§h: 
Second difference 
d2u 
dx2 . 
.2u 
.x2 = 
u(x+h).2u(x)+u(x.h) 
h2 : (4) 
This also has the merit of being symmetric about x. To repeat, the right-hand side approaches 
the true value of d2u=dx2 as h!0, but we have to stop at a positive h. 
At each meshpoint x = jh, the equation .d2u=dx2 = f (x) is replaced by its discrete 
analogue (5). We multiplied through by h2 to reach n equations Au = b: 
Difference equation .uj+1+2uj .uj.1 = h2 f ( jh) for j = 1; : : : ;n: (5) 
The first and last equations ( j = 1 and j = n) include u0 = 0 and un+1 = 0, which are 
known from the boundary conditions. These values would be shifted to the right-hand 
side of the equation if they were not zero. The structure of these n equations (5) can be 
better visualized in matrix form. We choose h = 16
, to get a 5 by 5 matrix A: 
Matrix equation 
2
666664 
2 .1 
.1 2 .1 
.1 2 .1 
.1 2 .1 
.1 2 
3
777775 
2
666664 
u1 
u2 
u3 
u4 
u5
3
777775
= h2
2
666664 
f (h) 
f (2h) 
f (3h) 
f (4h) 
f (5h)
3
777775
: (6) 
From now on, we will work with equation (6). It has a very regular coefficient matrix, 
whose order n can be very large. The matrix A possesses many special properties, and 
three of those properties are fundamental: 
1. The matrix A is tridiagonal. All nonzero entries lie on the main diagonal and the 
two adjacent diagonals. Outside this band all entries are ai j = 0. These zeros will 
bring a tremendous simplification to Gaussian elimination. 
2. The matrix is symmetric. Each entry ai j equals its mirror image aji, so that AT =A. 
The upper triangular U will be the transpose of the lower triangular L, and A = 
LDLT. This symmetry of A reflects the symmetry of d2u=dx2. An odd derivative 
like du=dx or d3u=dx3 would destroy the symmetry. 
3. The matrix is positive definite. This extra property says that the pivots are positive. 
Row exchanges are unnecessary in theory and in practice. This is in contrast to the 
matrix B at the end of this section, which is not positive definite. Without a row 
exchange it is totally vulnerable to roundoff. 
Positive definiteness brings this whole course together (in Chapter 6)!
68 Chapter 1 Matrices and Gaussian Elimination 
We return to the fact that A is tridiagonal. What effect does this have on elimination? 
The first stage of the elimination process produces zeros below the first pivot: 
Elimination 
on A: Step 1 
2
666664 
2 .1 
.1 2 .1 
.1 2 .1 
.1 2 .1 
.1 2 
3
777775
!
2
666664 
2 .1 
0 32
.1 
.1 2 .1 
.1 2 .1 
.1 2 
3
777775
: 
Compared with a general 5 by 5 matrix, that step displays two major simplifications: 
1. There was only one nonzero entry below the pivot. 
2. The pivot row was very short. 
The multiplier `21 = .12
came from one division. The new pivot 32
came from a single 
multiplication-subtraction. Furthermore, the tridiagonal pattern is preserved: Every 
stage of elimination admits the simplifications (a) and (b). 
The final result is the LDU = LDLT factorization of A. Notice the pivots! 
A = 
2
666664 
1 
.1
2 1 
.23
1 
.34
1 
.45
1
3
777775 
2
666664 
2
1 
32
43
54
65 
3
777775 
2
666664 
1 .12 
1 .23 1 .34 
1 .45 
1 
3
777775
: 
The L and U factors of a tridiagonal matrix are bidiagonal. The three factors together 
have the same band structure of three essential diagonals (3n.2 parameters) as A. Note 
too that L and U are transposes of one another, as expected from the symmetry. The 
pivots 2/1, 3/2, 4/3, 5/4, 6/5 are all positive. Their product is the determinant of A: 
detA = 6. The pivots are obviously converging to 1, as n gets large. Such matrices make 
a computer very happy. 
These sparse factors L and U completely change the usual operation count. Elimination 
on each column needs only two operations, as above, and there are n columns. In 
place of n3=3 operations we need only 2n. Tridiagonal systems Ax = b can be solved 
almost instantly. The cost of solving a tridiagonal system is proportional to n. 
A band matrix has ai j = 0 except in the band ji. jj < w (Figure 1.8). The “half 
bandwidth” is w = 1 for a diagonal matrix, w = 2 for a tridiagonal matrix, and w = n 
for a full matrix. For each column, elimination requires w(w.1) operations: a row 
of length w acts on w.1 rows below. Elimination on the n columns of a band matrix 
requires about w2n operations. 
As w approaches n, the matrix becomes full, and the count is roughly n3. For an exact 
count, the lower right-hand corner has no room for bandwidth w. The precise number of 
divisions and multiplication-subtractions that produce L, D, and U (without assuming a
1.7 Special Matrices and Applications 69 
w w 
A = = w 
w 
= LU 
Figure 1.8: A band matrix A and its factors L and U. 
symmetric A) is P = 13
w(w.1)(3n.2w+1). For a full matrix with w = n, we recover 
P = 13
n(n.1)(n+1). This is a whole number, since n.1, n, and n+1 are consecutive 
integers, and one of them is divisible by 3. 
That is our last operation count, and we emphasize the main point. A finite-difference 
matrix like A has a full inverse. In solving Ax = b, we are actually much worse off 
knowing A.1 than knowing L and U. Multiplying A.1 by b takes n2 steps, whereas 4n 
are sufficient for the forward elimination and back-substitution that produce x =U.1c= 
U.1L.1b = A.1b. 
We hope this example reinforced the reader’s understanding of elimination (which 
we now assume to be perfectly understood!). It is a genuine example of the large linear 
systems that are actually met in practice. The next chapter turns to the existence and the 
uniqueness of x, for m equations in n unknowns. 
Roundoff Error 
In theory the nonsingular case is completed. There is a full set of pivots (with row exchanges). 
In practice, more row exchanges may be equally necessary—or the computed 
solution can easily become worthless. We will devote two pages (entirely optional in 
class) to making elimination more stable—why it is needed and how it is done. 
For a system of moderate size, say 100 by 100, elimination involves a third of a million 
operations (13
n3). With each operation we must expect a roundoff error. Normally, 
we keep a fixed number of significant digits (say three, for an extremely weak computer). 
Then adding two numbers of different sizes gives an error: 
Roundoff Error :456+:00123!:457 loses the digits 2 and 3. 
How do all these individual errors contribute to the final error in Ax = b? 
This is not an easy problem. It was attacked by John von Neumann, who was the 
leading mathematician at the time when computers suddenly made a million operations 
possible. In fact the combination of Gauss and von Neumann gives the simple elimination 
algorithm a remarkably distinguished history, although even von Neumann overes-
70 Chapter 1 Matrices and Gaussian Elimination 
timated the final roundoff error. It wasWilkinson who found the right way to answer the 
question, and his books are now classics. 
Two simple examples will illustrate three important points about roundoff error. The 
examples are 
Ill-conditioned A = 
"
1: 1: 
1: 1:0001
# 
Well-conditioned B = 
"
:0001 1: 
1: 1:
#
: 
A is nearly singular whereas B is far from singular. If we slightly change the last entry 
of A to a22 = 1, it is singular. Consider two very close right-hand sides b: 
u + v = 2 
u + 1:0001v = 2 
and 
u + v = 2 
u + 1:0001v = 2:0001 
The solution to the first is u = 2, v = 0. The solution to the second is u = v = 1. A 
change in the fifth digit of b was amplified to a change in the first digit of the solution. No 
numerical method can avoid this sensitivity to small perturbations. The ill-conditioning 
can be shifted from one place to another, but it cannot be removed. The true solution is 
very sensitive, and the computed solution cannot be less so. 
The second point is as follows. 
1O Even a well-conditioned matrix like B can be ruined by a poor algorithm. 
We regret to say that for the matrix B, direct Gaussian elimination is a poor algorithm. 
Suppose .0001 is accepted as the first pivot. Then 10,000 times the first row is subtracted 
from the second. The lower right entry becomes .9999, but roundoff to three places 
would give .10,000. Every trace of the entry 1 would disappear: 
Elimination on B 
with small pivot 
:0001u+v = 1 
u+v = 2 
.! 
:0001u+v = 1 
.9999v = .9998: 
Roundoff will produce .10;000v = .10;000, or v = 1. This is correct to three decimal 
places. Back-substitution with the right v = :9999 would leave u = 1: 
Correct result :0001u+:9999 = 1; or u = 1: 
Instead, accepting v = 1, which is wrong only in the fourth place, we obtain u = 0: 
Wrong result :0001u+1 = 1; or u = 0: 
The computed u is completely mistaken. B is well-conditioned but elimination is violently 
unstable. L, D, and U are completely out of scale with B: 
B = 
" 
1 0 
10;000 1
#"
:0001 0 
0 .9999
#"
1 10;000 
0 1 
#
: 
The small pivot .0001 brought instability, and the remedy is clear—exchange rows.
1.7 Special Matrices and Applications 71 
1P A small pivot forces a practical change in elimination. Normally we 
compare each pivot with all possible pivots in the same column. Exchanging 
rows to obtain the largest possible pivot is called partial pivoting. 
For B, the pivot .0001 would be compared with the possible pivot I below it. A row 
exchange would take place immediately. In matrix terms, this is multiplication by a 
permutation matrix P = [ 0 1 
1 0 ]. The new matrix C = PB has good factors: 
C = 
" 
1 1 
:0001 1
# 
= 
" 
1 0 
:0001 1
#"
1 0 
0 :9999
#"
1 1 
0 1
# 
The pivots for C are 1 and .9999, much better than .0001 and .9999 for B. 
The strategy of complete pivoting looks also in all later columns for the largest possible 
pivot. Not only a row but also a column exchange may be needed. (This is 
postmultiplication by a permutation matrix.) The difficulty with being so conservative 
is the expense, and partial pivoting is quite adequate. 
We have finally arrived at the fundamental algorithm of numerical linear algebra: 
elimination with partial pivoting. Some further refinements, such as watching to see 
whether a whole row or column needs to be resealed, are still possible. But essentially 
the reader now knows what a computer does with a system of linear equations. Compared 
with the “theoretical” description—find A.1, and multiply A.1b—our description 
has consumed a lot of the reader’s time (and patience). I wish there were an easier way 
to explain how x is actually found, but I do not think there is. 
Problem Set 1.7 
1. Write out the LDU = LDLT factors of A in equation (6) when n = 4. Find the determinant 
as the product of the pivots in D. 
2. Modify a11 in equation (6) from a11 = 2 to a11 = 1, and find the LDU factors of this 
new tridiagonal matrix. 
3. Find the 5 by 5 matrix A0 (h = 16) that approximates 
.
d2u 
dx2 = f (x); 
du 
dx 
(0) = 
du 
dx 
(1) = 0; 
replacing these boundary conditions by u0 = u1 and u6 = u5. Check that your A0 
times the constant vector (C;C;C;C;C), yields zero; A0 is singular. Analogously, if 
u(x) is a solution of the continuous problem, then so is u(x)+C. 
4. Write down the 3 by 3 finite-difference matrix equation (h = 14
) for 
.
d2u 
dx2 +u = x; u(0) = u(1) = 0:
72 Chapter 1 Matrices and Gaussian Elimination 
5. With h = 14
and f (x) = 4p2 sin2px, the difference equation (5) is 
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75 
2
64
u1 
u2 
u3
3
75
= 
p2 
4 
2
64
1
0 
.1
3
75
: 
Solve for u1, u2, u3 and find their error in comparison with the true solution u = 
sin2px at x = 14
, x = 12
, and x = 34
. 
6. What 5 by 5 system replaces (6) if the boundary conditions are changed to u(0) = 1, 
u(1) = 0? 
Problems 7–11 are about roundoff error and row exchanges. 
7. Compute H.1 in two ways for the 3 by 3 Hilbert matrix 
H = 
2
64
1 12 
13
12 
13 
14
13 
14 
15 
3
75
; 
first by exact computation and second by rounding off each number to three figures. 
This matrix H is ill-conditioned and row exchanges don’t help. 
8. For the same matrix H, compare the right-hand sides of Hx = b when the solutions 
are x = (1;1;1) and x = (0;6;.3:6). 
9. Solve Hx = b = (1;0; : : : ;0) for the 10 by 10 Hilbert matrix with hi j = 1=(i+ j.1), 
using any computer code for linear equations. Then change an entry of b by .0001 
and compare the solutions. 
10. Compare the pivots in direct elimination to those with partial pivoting for 
A = 
"
:001 0 
1 1000
#
: 
(This is actually an example that needs rescaling before elimination.) 
11. Explain why partial pivoting produces multipliers `i j in L that satisfy j`i jj · 1. Can 
you construct a 3 by 3 example with all jai jj · 1 whose last pivot is 4? This is the 
worst possible, since each entry is at most doubled when j`i jj · 1. 
Review Exercises 
1.1 (a) Write down the 3 by 3 matrices with entries 
ai j = i. j and bi j = 
i
j 
:
1.7 Special Matrices and Applications 73 
(b) Compute the products AB and BA and A2. 
1.2 For the matrices 
A = 
"
1 0 
2 1
# 
and B = 
"
1 2 
0 1
#
; 
compute AB and BA and A.1 and B.1 and (AB).1. 
1.3 Find examp1es of 2 by 2 matrices with a12 = 12
for which (a) A2 = I: (b) 
A.1 = AT: (c) A2 = A. 
1.4 Solve by elimination and back-substitution: 
u + w = 4 
u + v = 3 
u + v + w = 6 
and 
v + w = 0 
u + w = 0 
u + v = 6: 
1.5 Factor the preceding matrices into A = LU or PA = LU. 
1.6 (a) There are sixteen 2 by 2 matrices whose entries are 1s and 0s. How many are 
invertible? 
(b) (Much harder!) If you put 1s and 0s at random into the entries of a 10 by 10 
matrix, is it more likely to be invertible or singular? 
1.7 There are sixteen 2 by 2 matrices whose entries are 1s and .1s. How many are 
invertible? 
1.8 How are the rows of EA related to the rows of A in the following cases? 
E = 
2
64
1 0 0 
0 2 0 
4 0 1
3
75
or E = 
"
1 1 1 
0 0 0
# 
or E = 
2
64
0 0 1 
0 1 0 
1 0 0
3
75
: 
1.9 Write down a 2 by 2 system with infinitely many solutions. 
1.10 Find inverses if they exist, by inspection or by Gauss-Jordan: 
A = 
2
64
1 0 1 
1 1 0 
0 1 1
3
75and A = 
2
64
2 1 0 
1 2 1 
0 1 2
3
75
and A = 
2
64
1 1 .2 
1 .2 1 
.2 1 1 
3
75 
1.11 If E is 2 by 2 and it adds the first equation to the second, what are E2 and E8 and 
8E? 
1.12 True or false, with reason if true or counterexample if false: 
(1) If A is invertible and its rows are in reverse order in B, then B is invertible.
74 Chapter 1 Matrices and Gaussian Elimination 
(2) If A and B are symmetric then AB is symmetric. 
(3) If A and B are invertible then BA is invertible. 
(4) Every nonsingular matrix can be factored into the product A = LU of a lower 
triangular L and an upper triangular U. 
1.13 Solve Ax = b by solving the triangular systems Lc = b and Ux = c: 
A = LU = 
2
64
1 0 0 
4 1 0 
1 0 1
3
75 
2
64
2 2 4 
0 1 3 
0 0 1
3
75
; b = 
2
64
0
0
1
3
75
: 
What part of A.1 have you found, with this particular b? 
1.14 If possible, find 3 by 3 matrices B such that 
(1) BA = 2A for every A. 
(2) BA = 2B for every A. 
(3) BA has the first and last rows of A reversed. 
(4) BA has the first and last columns of A reversed. 
1.15 Find the value for c in the following n by n inverse: 
if A = 
2
6664 
n .1 . .1 
.1 n . .1 
. . . .1 
.1 .1 .1 n 
3
7775
then A.1 = 
1 
n+1 
2
6664 c 1 . 1 
1 c . 1 
. . . 1 
1 1 1 c
3
7775
: 
1.16 For which values of k does 
kx + y = 1 
x + ky = 1 
have no solution, one solution, or infinitely many solutions? 
1.17 Find the symmetric factorization A = LDLT of 
A = 
2
64
1 2 0 
2 6 4 
0 4 11
3
75
and A = 
"
a b 
b c
#
: 
1.18 Suppose A is the 4 by 4 identity matrix except for a vector v in column 2: 
A = 
2
6664 
1 v1 0 0 
0 v2 0 0 
0 v3 1 0 
0 v4 0 1
3
7775
:
1.7 Special Matrices and Applications 75 
(a) Factor A into LU, assuming v2 6= 0. 
(b) Find A.1, which has the same form as A. 
1.19 Solve by elimination, or show that there is no solution: 
u + v + w = 0 
u + 2v + 3w = 0 
3u + 5v + 7w = 1 
and 
u + v + w = 0 
u + u + 3w = 0 
3u + 5v + 7w = 1: 
1.20 The n by n permutation matrices are an important example of a “group.” If you 
multiply them you stay inside the group; they have inverses in the group; the identity 
is in the group; and the law P1(P2P3) = (P1P2)P3 is true—because it is true for all 
matrices. 
(a) How many members belong to the groups of 4 by 4 and n by n permutation 
matrices? 
(b) Find a power k so that all 3 by 3 permutation matrices satisfy Pk = I. 
1.21 Describe the rows of DA and the columns of AD if D = [ 2 0 
0 5 ]. 
1.22 (a) If A is invertible what is the inverse of AT? 
(b) If A is also symmetric what is the transpose of A.1? 
(c) Illustrate both formulas when A = [ 2 1 
1 1 ]. 
1.23 By experiment with n = 2 and n = 3, find 
"
2 3 
0 0
#n 
; 
"
2 3 
0 1
#n 
; 
"
2 3 
0 1
#.1 
: 
1.24 Starting with a first plane u+2v.w = 6, find the equation for 
(a) the parallel plane through the origin. 
(b) a second plane that also contains the points (6;0;0) and (2;2;0). 
(c) a third plane that meets the first and second in the point (4;1;0). 
1.25 What multiple of row 2 is subtracted from row 3 in forward elimination of A? 
A = 
2
64
1 0 0 
2 1 0 
0 5 1
3
75 
2
64
1 2 0 
0 1 5 
0 0 1
3
75
: 
How do you know (without multiplying those factors) that A is invertible, symmetric, 
and tridiagonal? What are its pivots? 
1.26 (a) What vector x will make Ax= column 1 of A + 2(column 3), for a 3 by 3 matrix 
A?
76 Chapter 1 Matrices and Gaussian Elimination 
(b) Construct a matrix that has column 1 + 2(column 3) = 0. Check that A is 
singular (fewer than 3 pivots) and explain why that must be the case. 
1.27 True or false, with reason if true and counterexample if false: 
(1) If L1U1 = L2U2 (upper triangular U’s with nonzero diagonal, lower triangular 
L’s with unit diagonal), then L1 = L2 and U1 = U2. The LU factorization is 
unique. 
(2) If A2+A = I then A.1 = A+I. 
(3) If all diagonal entries of A are zero, then A is singular. 
1.28 By experiment or the Gauss-Jordan method compute 
2
64
1 0 0 
` 1 0 
m 0 1
3
75 
n 
; 
2
64
1 0 0 
` 1 0 
m 0 1
3
75 
.1 
; 
2
64
1 0 0 
` 1 0 
0 m 1
3
75 
.1 
: 
1.29 Write down the 2 by 2 matrices that 
(a) reverse the direction of every vector. 
(b) project every vector onto the x2 axis. 
(c) turn every vector counterclockwise through 90°. 
(d) reflect every vector through the 45° line x1 = x2.
Chapter 2 
Vector Spaces 
2.1 Vector Spaces and Subspaces 
Elimination can simplify, one entry at a time, the linear system Ax = b. Fortunately it 
also simplifies the theory. The basic questions of existence and uniqueness—Is there 
one solution, or no solution, or an infinity of solutions?—are much easier to answer 
after elimination, We need to devote one more section to those questions, to find every 
solution for an m by n system. Then that circle of ideas will be complete. 
But elimination produces only one kind of understanding of Ax = b. Our chief object 
is to achieve a different and deeper understanding. This chapter may be more difficult 
than the first one. It goes to the heart of linear algebra. 
For the concept of a vector space, we start immediately with the most important 
spaces. They are denoted by R1;R2;R3; : : :; the space Rn consists of all column vectors 
with n components. (We write R because the components are real numbers.) R2 is 
represented by the usual x-y plane; the two components of the vector become the x and 
y coordinates of the corresponding point. The three components of a vector in R3 give a 
point in three-dimensional space. The one-dimensional space R1 is a line. 
The valuable thing for linear algebra is that the extension to n dimensions is so 
straightforward. For a vector in R7 we just need the seven components, even if the 
geometry is hard to visualize. Within all vector spaces, two operations are possible: 
We can add any two vectors, and we can multiply all vectors by scalars. 
In other words, we can take linear combinations. 
Addition obeys the commutative law x+y = y+x; there is a “zero vector” satisfying 
0+x = x; and there is a vector “.x” satisfying .x+x = 0. Eight properties (including 
those three) are fundamental; the full list is given in Problem 5 at the end of this section. 
A real vector space is a set of vectors together with rules for vector addition and multiplication 
by real numbers. Addition and multiplication must produce vectors in the 
space, and they must satisfy the eight conditions.
78 Chapter 2 Vector Spaces 
Normally our vectors belong to one of the spaces Rn; they are ordinary column vectors. 
If x = (1;0;0;3), then 2x (and also x+x) has components 2, 0, 0, 6. The formal 
definition allows other things to be “vectors”-provided that addition and scalar multiplication 
are all right. We give three examples: 
1. The infinite-dimensional space R.. Its vectors have infinitely many components, as 
in x = (1;2;1;2; : : :). The laws for x+y and cx stay unchanged. 
2. The space of 3 by 2 matrices. In this case the “vectors” are matrices! We can add 
two matrices, and A+B = B+A, and there is a zero matrix, and so on. This space 
is almost the same as R6. (The six components are arranged in a rectangle instead 
of a column.) Any choice of m and n would give, as a similar example, the vector 
space of all m by n matrices. 
3. The space of functions f (x). Here we admit all functions f that are defined on 
a fixed interval, say 0 · x · 1. The space includes f (x) = x2, g(x) = sin x, their 
sum ( f +g)(x) = x2+sin x, and all multiples like 3x2 and .sin x. The vectors are 
functions, and the dimension is somehow a larger infinity than for R.. 
Other examples are given in the exercises, but the vector spaces we need most are 
somewhere else—they are inside the standard spaces Rn. We want to describe them 
and explain why they are important. Geometrically, think of the usual three-dimensional 
R3 and choose any plane through the origin. That plane is a vector space in its own 
right. If we multiply a vector in the plane by 3, or .3, or any other scalar, we get a 
vector in the same plane. If we add two vectors in the plane, their sum stays in the 
plane. This plane through (0;0;0) illustrates one of the most fundamental ideas in linear 
algebra; it is a subspace of the original space R3. 
Definition. A subspace of a vector space is a nonempty subset that satisfies the requirements 
for a vector space: Linear combinations stay in the subspace. 
(i) If we add any vectors x and y in the subspace, x+y is in the subspace. 
(ii) If we multiply any vector x in the subspace by any scalar c, cx is in the subspace. 
Notice our emphasis on the word space. A subspace is a subset that is “closed” under 
addition and scalar multiplication. Those operations follow the rules of the host space, 
keeping us inside the subspace. The eight required properties are satisfied in the larger 
space and will automatically be satisfied in every subspace. Notice in particular that the 
zero vector will belong to every subspace. That comes from rule (ii): Choose the scalar 
to be c = 0. 
The smallest subspace Z contains only one vector, the zero vector. It is a “zerodimensional 
space,” containing only the point at the origin. Rules (i) and (ii) are satisfied,
2.1 Vector Spaces and Subspaces 79 
since the sum 0+0 is in this one-point space, and so are all multiples c0. This is the 
smallest possible vector space: the empty set is not allowed. At the other extreme. the 
largest subspace is the whole of the original space. If the original space is R3, then the 
possible subspaces are easy to describe: R3 itself, any plane through the origin, any line 
through the origin, or the origin (the zero vector) alone. 
The distinction between a subset and a subspace is made clear by examples. In each 
case, can you add vectors and multiply by scalars, without leaving the space? 
Example 1. Consider all vectors in R2 whose components are positive or zero. This 
subset is the first quadrant of the x-y plane; the coordinates satisfy x . 0 and y . 0. It 
is not a subspace, even though it contains zero and addition does leave us within the 
subset. Rule (ii) is violated, since if the scalar is .1 and the vector is [1 1], the multiple 
cx = [.1 .1] is in the third quadrant instead of the first. 
If we include the third quadrant along with the first, scalar multiplication is all right. 
Every multiple cx will stay in this subset. However, rule (i) is now violated, since adding 
[1 2]+[.2 .1] gives [.1 1], which is not in either quadrant. The smallest subspace 
containing the first quadrant is the whole space R2. 
Example 2. Start from the vector space of 3 by 3 matrices. One possible subspace is 
the set of lower triangular matrices. Another is the set of symmetric matrices. A+B 
and cA are lower triangular if A and B are lower triangular, and they are symmetric if A 
and B are symmetric. Of course, the zero matrix is in both subspaces. 
The Column Space of A 
We now come to the key examples, the column space and the nullspace of a matrix 
A. The column space contains all linear combinations of the columns of A. It is a 
subspace of Rm. We illustrate by a system of m = 3 equations in n = 2 unknowns: 
Combination of columns equals b 
2
64
1 0 
5 4 
2 4
3
75 
"
u
v
# 
= 
2
64
b1 
b2 
b3
3
75
: (1) 
With m > n we have more equations than unknowns—and usually there will be no solution. 
The system will be solvable only for a very “thin” subset of all possible b’s. One 
way of describing this thin subset is so simple that it is easy to overlook. 
2A The system Ax = b is solvable if and only if the vector b can be expressed 
as a combination of the columns of A. Then b is in the column space. 
This description involves nothing more than a restatement of Ax = b, by columns: 
Combination of columns u
2
64
1
5
2
3
75
+v
2
64
0
4
4
3
75
= 
2
64
b1 
b2 
b3
3
75
: (2)
80 Chapter 2 Vector Spaces 
264 
0
4
4
375 
column 1 =
264 
1
5
2
375 
264 
0
0
0
375
b 
column space 
perpendicular 
to plane 
Figure 2.1: The column space C(A), a plane in three-dimensional space. 
These are the same three equations in two unknowns. Now the problem is: Find numbers 
u and v that multiply the first and second columns to produce b. The system is solvable 
exactly when such coefficients exist, and the vector (u;v) is the solution x. 
We are saying that the attainable right-hand sides b are all combinations of the columns 
of A. One possible right-hand side is the first column itself; the weights are u = 1 and 
v = 0. Another possibility is the second column: u = 0 and v = 1. A third is the righthand 
side b = 0. With u = 0 and v = 0, the vector b = 0 will always be attainable. 
We can describe all combinations of the two columns geometrically: Ax = b can be 
solved if and only if b lies in the plane that is spanned by the two column vectors (Figure 
2.1). This is the thin set of attainable b. If b lies off the plane, then it is not a combination 
of the two columns. In that case Ax = b has no solution. 
What is important is that this plane is not just a subset of R3 it is a subspace. It is 
the column space of A, consisting of all combinations of the columns. It is denoted by 
C(A). Requirements (i) and (ii) for a subspace of Rm are easy to check: 
(i) Suppose b and b0 lie in the column space, so that Ax = b for some x and Ax0 = b0 
for some x0. Then A(x+x0) = b+b0, so that b+b0 is also a combination of the 
columns. The column space of all attainable vectors b is closed under addition. 
(ii) If b is in the column space C(A), so is any multiple cb. If some combination 
of columns produces b (say Ax = b), then multiplying that combination by c will 
produce cb. In other words, A(cx) = cb. 
For another matrix A, the dimensions in Figure 2.1 may be very different. The smallest 
possible column space (one vector only) comes from the zero matrix A = 0. The
2.1 Vector Spaces and Subspaces 81 
only combination of the columns is b = 0. At the other extreme, suppose A is the 5 by 
5 identity matrix. Then C(I) is the whole of R5; the five columns of I can combine to 
produce any five-dimensional vector b. This is not at all special to the identity matrix. 
Any 5 by 5 matrix that is nonsingular will have the whole of R5 as its column space. 
For such a matrix we can solve Ax = b by Gaussian elimination; there are five pivots. 
Therefore every b is in C(A) for a nonsingular matrix. 
You can see how Chapter 1 is contained in this chapter. There we studied n by n 
matrices whose column space is Rn. Now we allow singular matrices, and rectangular 
matrices of any shape. Then C(A) can be somewhere between the zero space and 
the whole space Rm. Together with its perpendicular space, it gives one of our two 
approaches to understanding Ax = b. 
The Nullspace of A 
The second approach to Ax = b is “dual” to the first. We are concerned not only with 
attainable right-hand sides b, but also with the solutions x that attain them. The righthand 
side b = 0 always allows the solution x = 0, but there may be infinitely many other 
solutions. (There always are, if there are more unknowns than equations, n > m.) The 
solutions to Ax = 0 form a vector space—the nullspace of A. 
The nullspace of a matrix consists of all vectors x such that Ax = 0. It is 
denoted by N(A). It is a subspace of Rn, just as the column space was a 
subspace of Rm. 
Requirement (i) holds: If Ax = 0 and Ax0 = 0, then A(x+x0) = 0. Requirement (ii) also 
holds: If Ax=0 then A(cx)=0. Both requirements fail if the right-hand side is not zero! 
Only the solutions to a homogeneous equation (b = 0) form a subspace. The nullspace 
is easy to find for the example given above; it is as small as possible: 
2
64
1 0 
5 4 
2 4
3
75 
"
u
v
# 
= 
2
64
0
0
0
3
75
: 
The first equation gives u = 0, and the second equation then forces v = 0. The nullspace 
contains only the vector (0;0). This matrix has “independent columns”—a key idea that 
comes soon. 
The situation is changed when a third column is a combination of the first two: 
Larger nullspace B = 
2
64
1 0 1 
5 4 9 
2 4 6
3
75
: 
B has the same column space as A. The new column lies in the plane of Figure 2.1; it is 
the sum of the two column vectors we started with. But the nullspace of B contains the
82 Chapter 2 Vector Spaces 
vector (1;1;.1) and automatically contains any multiple (c;c;.c): 
Nullspace is a line 
2
64
1 0 1 
5 4 9 
2 4 6
3
75
h
c c .c
i 
= 
2
64
0
0
0
3
75
: 
The nullspace of B is the line of all points x = c, y = c, z = .c. (The line goes through 
the origin, as any subspace must.) We want to be able, for any system Ax = b, to find 
C(A) and N(A): all attainable right-hand sides b and all solutions to Ax = 0. 
The vectors b are in the column space and the vectors x are in the nullspace. We shall 
compute the dimensions of those subspaces and a convenient set of vectors to generate 
them. We hope to end up by understanding all four of the subspaces that are intimately 
related to each other and to A—the column space of A, the nullspace of A, and their two 
perpendicular spaces. 
Problem Set 2.1 
1. Construct a subset of the x-y plane R2 that is 
(a) closed under vector addition and subtraction, but not scalar multiplication. 
(b) closed under scalar multiplication but not under vector addition. 
Hint: Starting with u and v, add and subtract for (a). Try cu and cv for (b). 
2. Which of the following subsets of R3 are actually subspaces? 
(a) The plane of vectors (b1;b2;b3) with first component b1 = 0. 
(b) The plane of vectors b with b1 = 1. 
(c) The vectors b with b2b3 = 0 (this is the union of two subspaces, the plane b2 = 0 
and the plane b3 = 0). 
(d) All combinations of two given vectors (1;1;0) and (2;0;1). 
(e) The plane of vectors (b1;b2;b3) that satisfy b3.b2+3b1 = 0. 
3. Describe the column space and the nullspace of the matrices 
A = 
"
1 .1 
0 0 
# 
and B = 
"
0 0 3 
1 2 3
# 
and C = 
"
0 0 0 
0 0 0
#
: 
4. What is the smallest subspace of 3 by 3 matrices that contains all symmetric matrices 
and all lower triangular matrices? What is the largest subspace that is contained in 
both of those subspaces? 
5. Addition and scalar multiplication are required to satisfy these eight rules:
2.1 Vector Spaces and Subspaces 83 
1. x+y = y+x. 
2. x+(y+z) = (x+y)+z. 
3. There is a unique “zero vector” such that x+0 = x for all x. 
4. For each x there is a unique vector .x such that x+(.x) = 0. 
5. 1x = x. 
6. (c1c2)x = c1(c2x). 
7. c(x+y) = cx+cy. 
8. (c1+c2)x = c1x+c2x. 
(a) Suppose addition in R2 adds an extra 1 to each component, so that (3;1)+(5;0) 
equals (9;2) instead of (8;1). With scalar multiplication unchanged, which rules 
are broken? 
(b) Show that the set of all positive real numbers, with x+y and cx redefined to equal 
the usual xy and xc, is a vector space. What is the “zero vector”? 
(c) Suppose (x1;x2)+(y1;y2) is defined to be (x1 +y2;x2 +y1). With the usual 
cx = (cx1;cx2), which of the eight conditions are not satisfied? 
6. Let P be the plane in 3-space with equation x+2y+z = 6. What is the equation of 
the plane P0 through the origin parallel to P? Are P and P0 subspaces of R3? 
7. Which of the following are subspaces of R.? 
(a) All sequences like (1;0;1;0; : : :) that include infinitely many zeros. 
(b) All sequences (x1;x2; : : :) with x j = 0 from some point onward. 
(c) All decreasing sequences: x j+1 · x j for each j. 
(d) All convergent sequences: the x j have a limit as j!.. 
(e) All arithmetic progressions: x j+1.x j is the same for all j. 
(f) All geometric progressions (x1;kx1;k2x1; : : :) allowing all k and x1. 
8. Which of the following descriptions are correct? The solutions x of 
Ax = 
"
1 1 1 
1 0 2
#2
64
x1 
x2 
x3
3
75
= 
"
0
0
# 
form 
(a) a plane. 
(b) a line. 
(c) a point. 
(d) a subspace.
84 Chapter 2 Vector Spaces 
(e) the nullspace of A. 
(f) the column space of A. 
9. Show that the set of nonsingular 2 by 2 matrices is not a vector space. Show also that 
the set of singular 2 by 2 matrices is not a vector space. 
10. The matrix A = 
. 2 .2 
2 .2 
¤ 
is a “vector” in the space M of all 2 by 2 matrices. Write the 
zero vector in this space, the vector 12
A, and the vector .A. What matrices are in the 
smallest subspace containing A? 
11. (a) Describe a subspace of M that contains A = 
. 1 0 
0 0 
¤ 
but not B = 
. 0 0 
0 .1 
¤
. 
(b) If a subspace of M contains A and B, must it contain I? 
(c) Describe a subspace of M that contains no nonzero diagonal matrices. 
12. The functions f (x) = x2 and g(x) = 5x are “vectors” in the vector space F of all real 
functions. The combination 3 f (x).4g(x) is the function h(x) = . Which rule 
is broken if multiplying f (x) by c gives the function f (cx)? 
13. If the sum of the “vectors” f (x) and g(x) in F is defined to be f (g(x)), then the “zero 
vector” is g(x) = x. Keep the usual scalar multiplication c f (x), and find two rules 
that are broken. 
14. Describe the smallest subspace of the 2 by 2 matrix space M that contains 
(a) 
"
1 0 
0 0
# 
and 
"
0 1 
0 0
#
: (b) 
"
1 0 
0 0
# 
and 
"
1 0 
0 1
#
: 
(c) 
"
1 1 
0 0
#
. (d) 
"
1 1 
0 0
#
; 
"
1 0 
0 1
#
; 
"
0 1 
0 1
#
: 
15. Let P be the plane in R3 with equation x+y.2z = 4. The origin (0;0;0) is not in 
P! Find two vectors in P and check that their sum is not in P. 
16. P0 is the plane through (0;0;0) parallel to the plane P in Problem 15. What is the 
equation for P0? Find two vectors in P0 and check that their sum is in P0. 
17. The four types of subspaces of R3 are planes, lines, R3 itself, or Z containing only 
(0;0;0). 
(a) Describe the three types of subspaces of R2. 
(b) Describe the five types of subspaces of R4. 
18. (a) The intersection of two planes through (0;0;0) is probably a but it could 
be a . It can’t be the zero vector Z! 
(b) The intersection of a plane through (0;0;0) with a line through (0;0;0) is probably 
a but it could be a .
2.1 Vector Spaces and Subspaces 85 
(c) If S and T are subspaces of R5, their intersection S \ T (vectors in both subspaces) 
is a subspace of R5. Check the requirements on x+y and cx. 
19. Suppose P is a plane through (0;0;0) and L is a line through (0;0;0). The smallest 
vector space containing both P and L is either or . 
20. True or false for M= all 3 by 3 matrices (check addition using an example)? 
(a) The skew-symmetric matrices in M (with AT = .A) form a subspace. 
(b) The unsymmetric matrices in M (with AT 6= A) form a subspace. 
(c) The matrices that have (1;1;1) in their nullspace form a subspace. 
Problems 21–30 are about column spaces C(A) and the equation Ax = b. 
21. Describe the column spaces (lines or planes) of these particular matrices: 
A = 
2
64
1 2 
0 0 
0 0
3
75
and B = 
2
64
1 0 
0 2 
0 0
3
75
and C = 
2
64
1 0 
2 0 
0 0
3
75
: 
22. For which right-hand sides (find a condition on b1, b2, b3) are these systems solvable? 
(a) 
2
64
1 4 2 
2 8 4 
.1 .4 .2
3
75 
2
64
x1 
x2 
x3
3
75
= 
2
64
b1 
b2 
b3
3
75
: (b) 
2
64
1 4 
2 9 
.1 .4
3
75 
"
x1 
x2
# 
= 
2
64
b1 
b2 
b3
3
75
: 
23. Adding row 1 of A to row 2 produces B. Adding column 1 to column 2 produces C. 
A combination of the columns of is also a combination of the columns of A. 
Which two matrices have the same column ? 
A = 
"
1 2 
2 4
# 
and B = 
"
1 2 
3 6
# 
and C = 
"
1 3 
2 6
#
: 
24. For which vectors (b1;b2;b3) do these systems have a solution? 
2
64
1 1 1 
0 1 1 
0 0 1
3
75 
2
64
x1 
x2 
x3
3
75
= 
2
64b1 
b2 
b3
3
75
and 
2
64
1 1 1 
0 1 1 
0 0 0
3
75 
2
64
x1 
x2 
x3
3
75
= 
2
64
b1 
b2 
b3
3
75
: 
25. (Recommended) If we add an extra column b to a matrix A, then the column space 
gets larger unless . Give an example in which the column space gets larger and 
an example in which it doesn’t. Why is Ax = b solvable exactly when the column 
space doesn’t get larger by including b? 
26. The columns of AB are combinations of the columns of A. This means: The column 
space of AB is contained in (possibly equal to) the column space of A. Give an 
example where the column spaces of A and AB are not equal.
86 Chapter 2 Vector Spaces 
27. If A is any 8 by 8 invertible matrix, then its column space is . Why? 
28. True or false (with a counterexample if false)? 
(a) The vectors b that are not in the column space C(A) form a subspace. 
(b) If C(A) contains only the zero vector, then A is the zero matrix. 
(c) The column space of 2A equals the column space of A. 
(d) The column space of A.I equals the column space of A. 
29. Construct a 3 by 3 matrix whose column space contains (1;1;0) and (1;0;1) but not 
(1;1;1). Construct a 3 by 3 matrix whose column space is only a line. 
30. If the 9 by 12 system Ax = b is solvable for every b, then C(A) = . 
31. Why isn’t R2 a subspace of R3? 
2.2 Solving Ax = 0 and Ax = b 
Chapter 1 concentrated on square invertible matrices. There was one solution to Ax = b 
and it was x = .A.1b. That solution was found by elimination (not by computing A.1). 
A rectangular matrix brings new possibilities—U may not have a full set of pivots. This 
section goes onward from U to a reduced form R—the simplest matrix that elimination 
can give. R reveals all solutions immediately. 
For an invertible matrix, the nullspace contains only x = 0 (multiply Ax = 0 by A.1). 
The column space is the whole space (Ax = b has a solution for every b). The new questions 
appear when the nullspace contains more than the zero vector and/or the column 
space contains less than all vectors: 
1. Any vector xn in the nullspace can be added to a particular solution xp. The solutions 
to all linear equations have this form, x = xp+xn: 
Complete solution Axp = b and Axn = 0 produce A(xp+xn) = b. 
2. When the column space doesn’t contain every b in Rm, we need the conditions on 
b that make Ax = b solvable. 
A 3 by 4 example will be a good size. We will write down all solutions to Ax = 0. We 
will find the conditions for b to lie in the column space (so that Ax = b is solvable). The 
1 by 1 system 0x = b, one equation and one unknown, shows two possibilities: 
0x = b has no solution unless b = 0. The column space of the 1 by 1 zero 
matrix contains only b = 0. 
0x = 0 has infinitely many solutions. The nullspace contains all x. A particular 
solution is xp = 0, and the complete solution is x = xp+xn = 0+(any x).
2.2 Solving Ax = 0 and Ax = b 87 
Simple, I admit. If you move up to 2 by 2, it’s more interesting. The matrix 
. 
1 1 
2 2 
¤ 
is not 
invertible: y+z = b1 and 2y+2z = b2 usually have no solution. 
There is no solution unless b2 = 2b1. The column space of A contains only 
those b’s, the multiples of (1;2). 
When b2 = 2b1 there are infinitely many solutions. A particular solution to 
y+z = 2 and 2y+2z = 4 is xp = (1;1). The nullspace of A in Figure 2.2 
contains (.1;1) and all its multiples xn = (.c;c): 
Complete 
solution 
y + z = 2 
2y + 2z = 4 
is solved by xp+xn =
"
1
1
#
+c
"
.1 
1 
#
=
"
1.c 
1+c
#
: 
y 
z
b 
b b 
b 
 .1 
1   1
1  = shortest particular solution xp 
 2
0  = MATLAB’s particular solution A\b 
all xn line of all solutions x = xp + xn 
nullspace Axn = 0 
Figure 2.2: The parallel lines of solutions to Axn = 0 and 
. 1 1 
2 2 
¤ 
[yz] = 
.24
¤
. 
Echelon Form U and Row Reduced Form R 
We start by simplifying this 3 by 4 matrix, first to U and then further to R: 
Basic example A = 
2
64
1 3 3 2 
2 6 9 7 
.1 .3 3 4
3
75
: 
The pivot a11 = 1 is nonzero. The usual elementary operations will produce zeros in the 
first column below this pivot. The bad news appears in column 2: 
No pivot in column 2 A!
2
64
1 3 3 2 
0 0 3 3 
0 0 6 6
3
75
: 
The candidate for the second pivot has become zero: unacceptable. We look below that 
zero for a nonzero entry—intending to carry out a row exchange. In this case the entry 
below it is also zero. If A were square, this would signal that the matrix was singular. 
With a rectangular matrix, we must expect trouble anyway, and there is no reason to stop.
88 Chapter 2 Vector Spaces 
All we can do is to go on to the next column, where the pivot entry is 3. Subtracting twice 
the second row from the third, we arrive at U: 
Echelon matrix U U = 
2
64
1 3 3 2 
0 0 3 3 
0 0 0 0
3
75
: 
Strictly speaking, we proceed to the fourth column. A zero is in the third pivot position, 
and nothing can be done. U is upper triangular, but its pivots are not on the main diagonal. 
The nonzero entries of U have a “staircase pattern,” or echelon form. For the 5 by 
8 case in Figure 2.3, the starred entries may or may not be zero. 
U = 
2
6666666664 
. ¤ ¤ ¤ ¤ ¤ ¤ ¤ 
0 . ¤ ¤ ¤ ¤ ¤ ¤ 
0 0 0 . ¤ ¤ ¤ ¤ 
0 0 0 0 0 0 0 . 
0 0 0 0 0 0 0 0 
3
7777777775 
R = 
2
6666666664 
1 0 ¤ 0 ¤ ¤ ¤ 0 
0 1 ¤ 0 ¤ ¤ ¤ 0 
0 0 0 1 ¤ ¤ ¤ 0 
0 0 0 0 0 0 0 1 
0 0 0 0 0 0 0 0 
3
7777777775 
Figure 2.3: The entries of a 5 by 8 echelon matrix U and its reduced form R. 
We can always reach this echelon form U, with zeros below the pivots: 
1. The pivots are the first nonzero entries in their rows. 
2. Below each pivot is a column of zeros, obtained by elimination. 
3. Each pivot lies to the right of the pivot in the row above. This produces the staircase 
pattern, and zero rows come last. 
Since we started with A and ended with U, the reader is certain to ask: Do we have 
A = LU as before? There is no reason why not, since the elimination steps have not 
changed. Each step still subtracts a multiple of one row from a row beneath it. The 
inverse of each step adds back the multiple that was subtracted. These inverses come in 
the right order to put the multipliers directly into L: 
Lower triangular L = 
2
64
1 0 0 
2 1 0 
.1 2 1
3
75
and A = LU: 
Note that L is square. It has the same number of rows as A and U. 
The only operation not required by our example, but needed in general, is row exchange 
by a permutation matrix P. Since we keep going to the next column when no 
pivots are available, there is no need to assume that A is nonsingular. Here is PA = LU 
for all matrices:
2.2 Solving Ax = 0 and Ax = b 89 
2B For any m by n matrix A there is a permutation P, a lower triangular L 
with unit diagonal, and an m by n echelon matrix U, such that PA = LU. 
Now comes R. We can go further than U, to make the matrix even simpler. Divide 
the second row by its pivot 3, so that all pivots are 1. Then use the pivot row to produce 
zero above the pivot. This time we subtract a row from a higher row. The final result 
(the best form we can get) is the reduced row echelon form R: 
2
64
1 3 3 2 
0 0 3 3 
0 0 0 0
3
75
.!
2
64
1 3 3 2 
0 0 1 1 
0 0 0 0
3
75
.!
2
64
1 3 0 -1 
0 0 1 1 
0 0 0 0 
3
75
= R: 
This matrix R is the final result of elimination on A. MATLAB would use the command 
R = rref(A). Of course rref(R) would give R again! 
What is the row reduced form of a square invertible matrix? In that case R is the 
identity matrix. There is a full set of pivots, all equal to 1, with zeros above and below. 
So rref(A) = I, when A is invertible. 
For a 5 by 8 matrix with four pivots, Figure 2.3 shows the reduced form R. It still 
contains an identity matrix, in the four pivot rows and four pivot columns. From R 
we will quickly find the nullspace of A. Rx = 0 has the same solutions as Ux = 0 and 
Ax = 0. 
Pivot Variables and Free Variables 
Our goal is to read off all the solutions to Rx = 0. The pivots are crucial: 
Nullspace of R 
(pivot columns 
in boldface) 
Rx = 
2
64
1 3 0 .1 
0 0 1 1 
0 0 0 0 
3
75 
2
6664 
u
v
w
y 
3
7775
= 
2
64
0
0
0
3
75
: 
The unknowns u, v, w, y go into two groups. One group contains the pivot variables, 
those that correspond to columns with pivots. The first and third columns contain the 
pivots, so u and w are the pivot variables. The other group is made up of the free 
variables, corresponding to columns without pivots. These are the second and fourth 
columns, so v and y are free variables. 
To find the most general solution to Rx=0 (or, equivalently, to Ax=0) we may assign 
arbitrary values to the free variables. Suppose we call these values simply v and y. The 
pivot variables are completely determined in terms of v and y: 
Rx = 0 u+3v.y = 0 yields u = .3v+y 
w+y = 0 yields w = .y 
(1)
90 Chapter 2 Vector Spaces 
There is a “double infinity” of solutions, with v and y free and independent. The complete 
solution is a combination of two special solutions: 
Nullspace contains 
all combinations 
of special solutions 
x = 
2
6664 
.3v+y 
v 
.y 
y 
3
7775
= v
2
6664 
.3 
1
0
0 
3
7775
+y
2
6664 
1
0 
.1 
1 
3
7775
: (2) 
Please look again at this complete solution to Rx = 0 and Ax = 0. The special solution 
(.3;1;0;0) has free variables v = 1, y = 0. The other special solution (1;0;.1;1) has 
v = 0 and y = 1. All solutions are linear combinations of these two. The best way to find 
all solutions to Ax = 0 is from the special solutions: 
1. After reaching Rx = 0, identify the pivot variables and free variables. 
2. Give one free variable the value 1, set the other free variables to 0, and solve Rx = 0 
for the pivot variables. This x is a special solution. 
3. Every free variable produces its own “special solution” by step 2. The combinations 
of special solutions form the nullspace—all solutions to Ax = 0. 
Within the four-dimensional space of all possible vectors x, the solutions to Ax = 0 
form a two-dimensional subspace—the nullspace of A, In the example, N(A) is generated 
by the special vectors (.3;1;0;0) and (1;0;.1;1). The combinations of these two 
vectors produce the whole nullspace. 
Here is a little trick. The special solutions are especially easy from R. The numbers 3 
and 0 and .1 and 1 lie in the “nonpivot columns” of R. Reverse their signs to find the 
pivot variables (not free) in the special solutions. I will put the two special solutions 
from equation (2) into a nullspace matrix N, so you see this neat pattern: 
Nullspace matrix 
(columns are 
special solutions) 
N = 
2
6664 
.3 1 
1 0 
0 .1 
0 1 
3
7775 
not free 
free 
not free 
free 
The free variables have values 1 and 0. When the free columns moved to the righthand 
side of equation (2), their coefficients 3 and 0 and .1 and 1 switched sign. That 
determined the pivot variables in the special solutions (the columns of N). 
This is the place to recognize one extremely important theorem. Suppose a matrix has 
more columns than rows, n > m. Since m rows can hold at most m pivots, there must be 
at least n.m free variables. There will be even more free variables if some rows of R 
reduce to zero; but no matter what, at least one variable must be free. This free variable 
can be assigned any value, leading to the following conclusion: 
2C If Ax = 0 has more unknowns than equations (n > m), it has at least one 
special solution: There are more solutions than the trivial x = 0.
2.2 Solving Ax = 0 and Ax = b 91 
There must be infinitely many solutions, since any multiple cx will also satisfy A(cx)= 
0. The nullspace contains the line through x. And if there are additional free variables, 
the nullspace becomes more than just a line in n-dimensional space. The nullspace has 
the same “dimension” as the number of free variables and special solutions. 
This central idea—the dimension of a subspace—is made precise in the next section. 
We count the free variables for the nullspace. We count the pivot variables for the column 
space! 
Solving Ax = b, Ux = c, and Rx = d 
The case b 6= 0 is quite different from b = 0. The row operations on A must act also 
on the right-hand side (on b). We begin with letters (b1;b2;b3) to find the solvability 
condition—for b to lie in the column space. Then we choose b = (1;5;5) and find all 
solutions x. 
For the original example Ax = b = (b1;b2;b3), apply to both sides the operations that 
led from A to U. The result is an upper triangular system Ux = c: 
Ux = c 
2
64
1 3 3 2 
0 0 3 3 
0 0 0 0
3
75 
2
6664 
u
v
w
y
3
7775
= 
2
64
b1 
b2.2b1 
b3.2b2+5b1
3
75
: (3) 
The vector c on the right-hand side, which appeared after the forward elimination steps, 
is just L.1b as in the previous chapter. Start now with Ux = c. 
It is not clear that these equations have a solution. The third equation is very much 
in doubt, because its left-hand side is zero. The equations are inconsistent unless b3. 
2b2+5b1 = 0. Even though there are more unknowns than equations, there may be no 
solution. We know another way of answering the same question: Ax =b can be solved if 
and only if b lies in the column space of A. This subspace comes from the four columns 
of A (not of U!):
Columns of A 
“span” the 
column space 
2
641
2 
.1
3
75
; 
2
64
3
6 
.3
3
75
; 
2
64
3
9
3
3
75
; 
2
64
2
7
4
3
75
: 
Even though there are four vectors, their combinations only fill out a plane in threedimensional 
space. Column 2 is three times column 1. The fourth column equals the 
third minus the first. These dependent columns, the second and fourth, are exactly the 
ones without pivots. 
The column space C(A) can be described in two different ways. On the one hand, 
it is the plane generated by columns 1 and 3. The other columns lie in that plane, 
and contribute nothing new. Equivalently, it is the plane of all vectors b that satisfy 
b3.2b2+5b1 = 0; this is the constraint if the system is to be solvable. Every column
92 Chapter 2 Vector Spaces 
satisfies this constraint, so it is forced on b! Geometrically, we shall see that the vector 
(5;.2;1) is perpendicular to each column. 
If b belongs to the column space, the solutions of Ax = b are easy to find. The last 
equation in Ux = c is 0 = 0. To the free variables v and y, we may assign any values, 
as before. The pivot variables u and w are still determined by back-substitution. For a 
specific example with b3.2b2+5b1 = 0, choose b = (1;5;5): 
Ax = b 
2
64
1 3 3 2 
2 6 9 7 
.1 .3 3 4
3
75 
2
6664 
u
v
w
y
3
7775
= 
2
64
1
5
5
3
75
: 
Forward elimination produces U on the left and c on the right: 
Ux = c 
2
64
1 3 3 2 
0 0 3 3 
0 0 0 0
3
75 
2
6664 
u
v
w
y
3
7775
= 
2
64
1
3
0
3
75
: 
The last equation is 0 = 0, as expected. Back-substitution gives 
3w+3y = 3 or w = 1.y 
u+3v+3w+2y = 1 or u = .2.3v+y: 
Again there is a double infinity of solutions: v and y are free, u and w are not: 
Complete solution 
x = xp+xn 
x = 
2
6664 
u
v
w
y
3
7775
= 
2
6664 
.2 
0
1
0 
3
7775
+v
2
6664 
.3 
1
0
0 
3
7775
+y
2
6664 
1
0 
.1 
1 
3
7775
: (4) 
This has all solutions to Ax = 0, plus the new xp = (.2;0;1;0). That xp is a particular 
solution to Ax = b. The last two terms with v and y yield more solutions (because they 
satisfy Ax = 0). Every solution to Ax = b is the sum of one particular solution and a 
solution to Ax = 0: 
xcomplete = xparticular+xnullspace 
The particular solution in equation (4) comes from solving the equation with all free 
variables set to zero. That is the only new part, since the nullspace is already computed. 
When you multiply the highlighted equation by A, you get Axcomplete = b+0. 
Geometrically, the solutions again fill a two-dimensional surface—but it is not a subspace. 
It does not contain x = 0. It is parallel to the nullspace we had before, shifted 
by the particular solution xp as in Figure 2.2. Equation (4) is a good way to write the 
answer: 
1. Reduce Ax = b to Ux = c.
2.2 Solving Ax = 0 and Ax = b 93 
2. With free variables = 0, find a particular solution to Axp = b and Uxp = c. 
3. Find the special solutions to Ax = 0 (or Ux = 0 or Rx = 0). Each free variable, in 
turn, is 1. Then x = xp+(any combination xn of special solutions). 
When the equation was Ax=0, the particular solution was the zero vector! It fits the pattern, 
but xparticular = 0 was not written in equation (2). Now xp is added to the nullspace 
solutions, as in equation (4). 
Question: How does the reduced form R make this solution even clearer? You will 
see it in our example. Subtract equation 2 from equation 1, and then divide equation 2 
by its pivot. On the left-hand side, this produces R, as before. On the right-hand side, 
these operations change c = (1;3;0) to a new vector d = (.2;1;0): 
Reduced equation 
Rx = d 
2
64
1 3 0 .1 
0 0 1 1 
0 0 0 0 
3
75 
2
6664 
u
v
w
y
3
7775
= 
2
64
.2 
1
0 
3
75
: (5) 
Our particular solution xp, (one choice out of many) has free variables v = y = 0. 
Columns 2 and 4 can be ignored. Then we immediately have u = .2 and w = 1, exactly 
as in equation (4). The entries of d go directly into xp. This is because the identity 
matrix is sitting in the pivot columns of R! 
Let me summarize this section, before working a new example. Elimination reveals 
the pivot variables and free variables. If there are r pivots, there are r pivot variables 
and n.r free variables. That important number r will be given a name—it is the rank 
of the matrix. 
2D Suppose elimination reduces Ax = b to Ux = c and Rx = d, with r pivot 
rows and r pivot columns. The rank of those matrices is r. The last m.r 
rows of U and R are zero, so there is a solution only if the last m.r entries of 
c and d are also zero. 
The complete solution is x = xp +xn. One particular solution xp has all free 
variables zero. Its pivot variables are the first r entries of d, so Rxp = d. 
The nullspace solutions xn are combinations of n.r special solutions, with 
one free variable equal to 1. The pivot variables in that special solution can be 
found in the corresponding column of R (with sign reversed). 
You see how the rank r is crucial. It counts the pivot rows in the “row space” and the 
pivot columns in the column space. There are n.r special solutions in the nullspace. 
There are m.r solvability conditions on b or c or d.
94 Chapter 2 Vector Spaces 
Another Worked Example 
The full picture uses elimination and pivot columns to find the column space, nullspace, 
and rank. The 3 by 4 matrix A has rank 2: 
Ax = b is 
1x1 + 2x2 + 3x3 + 5x4 = b1 
2x1 + 4x2 + 8x3 + 12x4 = b2 
3x1 + 6x2 + 7x3 + 13x4 = b3 
(6) 
1. Reduce [A b] to [U c], to reach a triangular system Ux = c. 
2. Find the condition on b1, b2, b3 to have a solution. 
3. Describe the column space of A: Which plane in R3? 
4. Describe the nullspace of A: Which special solutions in R4? 
5. Find a particular solution to Ax = (0;6;.6) and the complete xp+xn. 
6. Reduce [U c] to [R d]: Special solutions from R and xp from d. 
Solution. (Notice how the right-hand side is included as an extra column!) 
1. The multipliers in elimination are 2 and 3 and .1, taking [A b] to [U c]. 
2
64
1 2 3 5 b1 
2 4 8 12 b2 
3 6 7 13 b3 
3
75
!
2
64
1 2 3 5 b1 
0 0 2 2 b2.2b1 
0 0 .2 .2 b3.3b1 
3
75!
2
64
1 2 3 5 b1 
0 0 2 2 b2.2b1 
0 0 0 0 b3+b2.5b1 
3
75
: 
2. The last equation shows the solvability condition b3+b2.5b1 = 0. Then 0 = 0. 
3. The column space of A is the plane containing all combinations of the pivot columns 
(1;2;3) and (3;8;7). 
Second description: The column space contains all vectors with b3+b2.5b1 =0. 
That makes Ax = b solvable, so b is in the column space. All columns of A pass this 
test b3+b2.5b1 = 0. This is the equation for the plane (in the first description of 
the column space). 
4. The special solutions in N have free variables x2 = 1, x4 = 0 and x2 = 0, x4 = 1: 
Nullspace matrix 
Special solutions to Ax = 0 
Back-substitution in Ux = 0 
Just switch signs in Rx = 0 
N = 
2
6664 
.2 .2 
1 0 
0 .1 
0 1 
3
7775
:
2.2 Solving Ax = 0 and Ax = b 95 
5. Choose b = (0;6;.6), which has b3 +b2 .5b1 = 0. Elimination takes Ax = b to 
Ux = c = (0;6;0). Back-substitute with free variables = 0: 
Particular solution to Axp = (0;6;.6) xp = 
2
6664 
.9 
0
3
0 
3
7775
free 
free 
The complete solution to Ax = (0;6;.6) is (this xp) + (all xn). 
6. In the reduced R, the third column changes from (3;2;0) to (0;1;0). The right-hand 
side c = (0;6;0) becomes d = (.9;3;0). Then .9 and 3 go into xp: 
h
U c
i 
= 
2
64
1 2 3 5 0 
0 0 2 2 6 
0 0 0 0 0 
3
75
.!
h
R d
i 
= 
2
64
1 2 0 2 .9 
0 0 1 1 3 
0 0 0 0 0 
3
75
: 
That final matrix [R d] is rref([A b]) = rref([U c]). The numbers 2 and 0 and 2 
and 1 in the free columns of R have opposite sign in the special solutions (the nullspace 
matrix N). Everything is revealed by Rx = d. 
Problem Set 2.2 
1. Construct a system with more unknowns than equations, but no solution. Change the 
right-hand side to zero and find all solutions xn. 
2. Reduce A and B to echelon form, to find their ranks. Which variables are free? 
A = 
2
64
1 2 0 1 
0 1 1 0 
1 2 0 1
3
75
B = 
2
64
1 2 3 
4 5 6 
7 8 9
3
75
: 
Find the special solutions to Ax = 0 and Bx = 0. Find all solutions. 
3. Find the echelon form U, the free variables, and the special solutions: 
A = 
"
0 1 0 3 
0 2 0 6
#
; b = 
"
b1 
b2
#
: 
Ax = b is consistent (has a solution) when b satisfies b2 = . Find the complete 
solution in the same form as equation (4).
96 Chapter 2 Vector Spaces 
4. Carry out the same steps as in the previous problem to find the complete solution of 
Mx = b: 
M = 
2
6664 
0 0 
1 2 
0 0 
3 6
3
7775
; b = 
2
6664 
b1 
b2 
b3 
b4
3
7775
: 
5. Write the complete solutions x = xp+xn to these systems, as in equation (4): 
"
1 2 2 
2 4 5
#2
64
u
v
w
3
75
= 
"
1
4
# "
1 2 2 
2 4 4
#2
64
u
v
w
3
75
= 
"
1
4
#
: 
6. Describe the set of attainable right-hand sides b (in the column space) for 
2
64
1 0 
0 1 
2 3
3
75 
"
u
v
# 
= 
2
64
b1 
b2 
b3
3
75
; 
by finding the constraints on b that turn the third equation into 0 = 0 (after elimination). 
What is the rank, and a particular solution? 
7. Find the value of c that makes it possible to solve Ax = b, and solve it: 
u + v + 2w = 2 
2u + 3v . w = 5 
3u + 4v + w = c: 
8. Under what conditions on b1 and b2 (if any) does Ax = b have a solution? 
A = 
"
1 2 0 3 
2 4 0 7
#
; b = 
"
b1 
b2
#
: 
Find two vectors in the nullspace of A, and the complete solution to Ax = b. 
9. (a) Find the special solutions to Ux = 0. Reduce U to R and repeat: 
Ux = 
2
64
1 2 3 4 
0 0 1 2 
0 0 0 0
3
75 
2
6664 
x1 
x2 
x3 
x4
3
7775
= 
2
64
0
0
0
3
75
: 
(b) If the right-hand side is changed from (0;0;0) to (a;b;0), what are all solutions? 
10. Find a 2 by 3 system Ax = b whose complete solution is 
x = 
2
64
1
2
0
3
75
+w
2
64
1
3
1
3
75
:
2.2 Solving Ax = 0 and Ax = b 97 
Find a 3 by 3 system with these solutions exactly when b1+b2 = b3. 
11. Write a 2 by 2 system Ax = b with many solutions xn but no solution xp. (Therefore 
the system has no solution.) Which b’s allow an xp? 
12. Which of these rules give a correct definition of the rank of A? 
(a) The number of nonzero rows in R. 
(b) The number of columns minus the total number of rows. 
(c) The number of columns minus the number of free columns. 
(d) The number of 1s in R. 
13. Find the reduced row echelon forms R and the rank of these matrices: 
(a) The 3 by 4 matrix of all 1s. 
(b) The 4 by 4 matrix with ai j = (.1)i j. 
(c) The 3 by 4 matrix with ai j = (.1) j. 
14. Find R for each of these (block) matrices, and the special solutions: 
A = 
2
64
0 0 0 
0 0 3 
2 4 6
3
75
B = 
h
A A
i 
C = 
"
A A 
A 0
#
: 
15. If the r pivot variables come first, the reduced R must look like 
R = 
"
I F 
0 0
# 
I is r by r 
F is r by n.r 
What is the nullspace matrix N containing the special solutions? 
16. Suppose all r pivot variables come last. Describe the four blocks in the m by n 
reduced echelon form (the block B should be r by r): 
R = 
"
A B 
C D
#
: 
What is the nullspace matrix N of special solutions? What is its shape? 
17. (Silly problem) Describe all 2 by 3 matrices A1 and A2 with row echelon forms R1 
and R2, such that R1+R2 is the row echelon form of A1+A2. Is it true that R1 = A1 
and R2 = A2 in this case? 
18. If A has r pivot columns, then AT has r pivot columns. Give a 3 by 3 example for 
which the column numbers are different for A and AT.
98 Chapter 2 Vector Spaces 
19. What are the special solutions to Rx = 0 and RTy = 0 for these R? 
R = 
2
64
1 0 2 3 
0 1 4 5 
0 0 0 0
3
75
R = 
2
64
0 1 2 
0 0 0 
0 0 0
3
75
: 
20. If A has rank r, then it has an r by r submatrix S that is invertible. Find that submatrix 
S from the pivot rows and pivot columns of each A: 
A = 
"
1 2 3 
1 2 4
# 
A = 
"
1 2 3 
2 4 6
# 
A = 
2
64
0 1 0 
0 0 0 
0 0 1
3
75
: 
21. Explain why the pivot rows and pivot columns of A (not R) always give an r by r 
invertible submatrix of A. 
22. Find the ranks of AB and AM (rank 1 matrix times rank 1 matrix): 
A = 
"
1 2 
2 4
# 
and B = 
"
2 1 4 
3 1:5 6
# 
and M = 
"
1 b 
c bc
#
: 
23. Multiplying the rank 1 matrices A = uvT and B = wzT gives uzT times the number 
. AB has rank 1 unless = 0. 
24. Every column of AB is a combination of the columns of A. Then the dimensions of 
the column spaces give rank(AB) · rank(A). 
Problem: Prove also that rank(AB) · rank(B). 
25. (Important) Suppose A and B are n by n matrices, and AB=I. Prove from rank(AB)· 
rank(A) that the rank of A is n. So A is invertible and B must be its two-sided inverse. 
Therefore BA = I (which is not so obvious!). 
26. If A is 2 by 3 and C is 3 by 2, show from its rank that CA 6= I. Give an example in 
which AC = I. For m < n, a right inverse is not a left inverse. 
27. Suppose A and B have the same reduced-row echelon form R. Explain how to change 
A to B by elementary row operations. So B equals an matrix times A. 
28. Every m by n matrix of rank r reduces to (m by r) times (r by n): 
A = (pivot columns of A)(first r rows of R) = (COL)(ROW): 
Write the 3 by 4 matrix A at the start of this section as the product of the 3 by 2 
matrix from the pivot columns and the 2 by 4 matrix from R: 
A = 
2
64
1 3 3 2 
2 6 9 7 
.1 .3 3 4
3
75
2.2 Solving Ax = 0 and Ax = b 99 
29. Suppose A is an m by n matrix of rank r. Its reduced echelon form is R. Describe 
exactly the reduced row echelon form of RT (not AT). 
30. (Recommended) Execute the six steps following equation (6) to find the column 
space and nullspace of A and the solution to Ax = b: 
A = 
2
64
2 4 6 4 
2 5 7 6 
2 3 5 2
3
75
b = 
2
64
b1 
b2 
b3
3
75
= 
2
64
4
3
5
3
75
: 
31. For every c, find R and the special solutions to Ax = 0: 
A = 
2
64
1 1 2 2 
2 2 4 4 
1 c 2 2
3
75
and A = 
"
1.c 2 
0 2.c
#
: 
32. What is the nullspace matrix N (of special solutions) for A, B, C? 
A = 
h
I I
i 
and B = 
"
I I 
0 0
# 
and C = 
h
I I I
i
: 
Problems 33–36 are about the solution of Ax = b. Follow the steps in the text to 
xp and xn. Reduce the augmented matrix [A b]. 
33. Find the complete solutions of 
x+3y+3z = 1 
2x+6y+9z = 5 
.x.3y+3z = 5 
and 
2
64
1 3 1 2 
2 6 4 8 
0 0 2 4
3
75 2
6664 
x
y
z
t
3
7775
= 
2
64
1
3
1
3
75
: 
34. Under what condition on b1, b2, b3 is the following system solvable? Include b as a 
fourth column in [A b]. Find all solutions when that condition holds: 
x+2y.2z = b1 
2x+5y.4z = b2 
4x+9y.8z = b3: 
35. What conditions on b1, b2, b3, b4 make each system solvable? Solve for x: 
2
6664 
1 2 
2 4 
2 5 
3 9
3
7775 
"
x1 
x2
# 
= 
2
6664 
b1 
b2 
b3 
b4
3
7775 
2
6664 
1 2 3 
2 4 6 
2 5 7 
3 9 12
3
7775 
2
64
x1 
x2 
x3
3
75
= 
2
6664 
b1 
b2 
b3 
b4
3
7775
:
100 Chapter 2 Vector Spaces 
36. Which vectors (b1;b2;b3) are in the column space of A? Which combinations of the 
rows of A give zero? 
(a) A = 
2
64
1 2 1 
2 6 3 
0 2 5
3
75
(b) A = 
2
64
1 1 1 
1 2 4 
2 4 8
3
75
: 
37. Why can’t a 1 by 3 system have xp = (2;4;0) and xn = any multiple of (1;1;1)? 
38. (a) If Ax = b has two solutions x1 and x2, find two solutions to Ax = 0. 
(b) Then find another solution to Ax = b. 
39. Explain why all these statements are false: 
(a) The complete solution is any linear combination of xp and xn. 
(b) A system Ax = b has at most one particular solution. 
(c) The solution xp with all free variables zero is the shortest solution (minimum 
length kxk). (Find a 2 by 2 counterexample.) 
(d) If A is invertible there is no solution xn in the nullspace. 
40. Suppose column 5 of U has no pivot. Then x5 is a variable. The zero vector 
(is) (is not) the only solution to Ax = 0. If Ax = b has a solution, then it has 
solutions. 
41. If you know xp (free variables = 0) and all special solutions for Ax = b, find xp and 
all special solutions for these systems: 
Ax = 2b 
h
A A
i"
x
X
# 
= b 
"
A
A
#h
x
i 
= 
"
b
b
#
: 
42. If Ax = b has infinitely many solutions, why is it impossible for Ax = B (new righthand 
side) to have only one solution? Could Ax = B have no solution? 
43. Choose the number q so that (if possible) the ranks are (a) 1, (b) 2, (c) 3: 
A = 
2
64
6 4 2 
.3 .2 .1 
9 6 q 
3
75
and B = 
"
3 1 3 
q 2 q
#
: 
44. Give examples of matrices A for which the number of solutions to Ax = b is 
(a) 0 or 1, depending on b. 
(b) ., regardless of b. 
(c) 0 or ., depending on b. 
(d) 1, regardless of b.
2.2 Solving Ax = 0 and Ax = b 101 
45. Write all known relations between r and m and n if Ax = b has 
(a) no solution for some b. 
(b) infinitely many solutions for every b. 
(c) exactly one solution for some b, no solution for other b. 
(d) exactly one solution for every b. 
46. Apply Gauss-Jordan elimination (right-hand side becomes extra column) to Ux = 0 
and Ux = c. Reach Rx = 0 and Rx = d: 
h
U 0
i 
= 
"
1 2 3 0 
0 0 4 0
# 
and 
h
U c
i 
= 
"
1 2 3 5 
0 0 4 8
#
: 
Solve Rx = 0 to find xn (its free variable is x2 = 1). Solve Rx = d to find xp (its free 
variable is x2 = 0). 
47. Apply elimination with the extra column to reach Rx = 0 and Rx = d: 
h
U 0
i 
= 
2
64
3 0 6 0 
0 0 2 0 
0 0 0 0
3
75
and 
h
U c
i 
= 
2
64
3 0 6 9 
0 0 2 4 
0 0 0 5
3
75: 
Solve Rx = 0 (free variable = 1). What are the solutions to Rx = d? 
48. Reduce to Ux = c (Gaussian elimination) and then Rx = d: 
Ax = 
2
64
1 0 2 3 
1 3 2 0 
2 0 4 9
3
75 
2
6664 
x1 
x2 
x3 
x4
3
7775= 
2
642
5 
10
3
75
= b: 
Find a particular solution xp and all nullspace solutions xn. 
49. Find A and B with the given property or explain why you can’t. 
(a) The only solution to Ax = 
h123 
i 
is x = 
.01
¤
. 
(b) The only solution to Bx = 
.01
¤ 
is x = 
h123 
i
. 
50. The complete solution to Ax = 
.13
¤ 
is x = 
.10
¤
+c 
.01
¤
. Find A. 
51. The nullspace of a 3 by 4 matrix A is the line through (2;3;1;0). 
(a) What is the rank of A and the complete solution to Ax = 0? 
(b) What is the exact row reduced echelon form R of A?
102 Chapter 2 Vector Spaces 
52. Reduce these matrices A and B to their ordinary echelon forms U: 
(a) A = 
2
64
1 2 2 4 6 
1 2 3 6 9 
0 0 1 2 3
3
75
(b) B = 
2
64
2 4 2 
0 4 4 
0 8 8
3
75
: 
Find a special solution for each free variable and describe every solution to Ax = 0 
and Bx = 0. Reduce the echelon forms U to R, and draw a box around the identity 
matrix in the pivot rows and pivot columns. 
53. True or False? (Give reason if true, or counterexample to show it is false.) 
(a) A square matrix has no free variables. 
(b) An invertible matrix has no free variables. 
(c) An m by n matrix has no more than n pivot variables. 
(d) An m by n matrix has no more than m pivot variables. 
54. Is there a 3 by 3 matrix with no zero entries for which U = R = I? 
55. Put as many 1s as possible in a 4 by 7 echelon matrix U and in a reduced form R 
whose pivot columns are 2, 4, 5. 
56. Suppose column 4 of a 3 by 5 matrix is all 0s. Then x4 is certainly a variable. 
The special solution for this variable is the vector x = . 
57. Suppose the first and last columns of a 3 by 5 matrix are the same (nonzero). Then 
is a free variable. Find the special solution for this variable. 
58. The equation x.3y.z = 0 determines a plane in R3. What is the matrix A in this 
equation? Which are the free variables? The special solutions are (3;1;0) and . 
The parallel plane x.3y.z = 12 contains the particular point (12;0;0). All points 
on this plane have the following form (fill in the first components): 
2
64
x
y
z
3
75= 
2
6 40
0
3
75
+y
2
6 41
0
3
75
+z
2
6 40
1
3
75
: 
59. Suppose column 1 + column 3 + column 5 = 0 in a 4 by 5 matrix with four pivots. 
Which column is sure to have no pivot (and which variable is free)? What is the 
special solution? What is the nullspace? 
Problems 60–66 ask for matrices (if possible) with specific properties. 
60. Construct a matrix whose nullspace consists of all combinations of (2;2;1;0) and 
(3;1;0;1). 
61. Construct a matrix whose nullspace consists of all multiples of (4;3;2;1).
2.3 Linear Independence, Basis, and Dimension 103 
62. Construct a matrix whose column space contains (1;1;5) and (0;3:1) and whose 
nullspace contains (1;1;2). 
63. Construct a matrix whose column space contains (1;1;0) and (0;1;1) and whose 
nullspace contains (1;0;1) and (0;0;1). 
64. Construct a matrix whose column space contains (1;1;1) and whose nullspace is the 
line of multiples of (1;1;1;1). 
65. Construct a 2 by 2 matrix whose nullspace equals its column space. 
66. Why does no 3 by 3 matrix have a nullspace that equals its column space? 
67. The reduced form R of a 3 by 3 matrix with randomly chosen entries is almost sure 
to be . What R is virtually certain if the random A is 4 by 3? 
68. Show by example that these three statements are generally false: 
(a) A and AT have the same nullspace. 
(b) A and AT have the same free variables. 
(c) If R is the reduced form rref(A) then RT is rref(AT). 
69. If the special solutions to Rx = 0 are in the columns of these N, go backward to find 
the nonzero rows of the reduced matrices R: 
N = 
2
64
2 3 
1 0 
0 1
3
75
and N = 
2
64
0
0
1
3
75
and N = 
2
64 
3
75(empty 3 by 1). 
70. Explain why A and .A always have the same reduced echelon form R. 
2.3 Linear Independence, Basis, and Dimension 
By themselves, the numbers m and n give an incomplete picture of the true size of a 
linear system. The matrix in our example had three rows and four columns, but the third 
row was only a combination of the first two. After elimination it became a zero row, It 
had no effect on the homogeneous problem Ax = 0. The four columns also failed to be 
independent, and the column space degenerated into a two-dimensional plane. 
The important number that is beginning to emerge (the true size) is the rank r. The 
rank was introduced as the number of pivots in the elimination process. Equivalently, 
the final matrix U has r nonzero rows. This definition could be given to a computer. But 
it would be wrong to leave it there because the rank has a simple and intuitive meaning: 
The rank counts the number of genuinely independent rows in the matrix A. We want 
definitions that are mathematical rather than computational. 
The goal of this section is to explain and use four ideas:
104 Chapter 2 Vector Spaces 
1. Linear independence or dependence. 
2. Spanning a subspace. 
3. Basis for a subspace (a set of vectors). 
4. Dimension of a subspace (a number). 
The first step is to define linear independence. Given a set of vectors v1; : : : ;vk, we 
look at their combinations c1v1 +c2v2 +. . .+ckvk. The trivial combination, with all 
weights ci = 0, obviously produces the zero vector: 0v1+. . .+0vk = 0. The question is 
whether this is the only way to produce zero. If so, the vectors are independent. 
If any other combination of the vectors gives zero, they are dependent. 
2E Suppose c1v1+. . .+ckvk = 0 only happens when c1 = . . . = ck = 0. Then 
the vectors v1; : : : ;vk are linearly independent. If any c’s are nonzero, the v’s 
are linearly dependent. One vector is a combination of the others. 
Linear dependence is easy to visualize in three-dimensional space, when all vectors 
go out from the origin. Two vectors are dependent if they lie on the same line. Three 
vectors are dependent if they lie in the same plane. A random choice of three vectors, 
without any special accident, should produce linear independence (not in a plane). Four 
vectors are always linearly dependent in R3. 
Example 1. If v1 = zero vector, then the set is linearly dependent. We may choose 
c1 = 3 and all other ci = 0; this is a nontrivial combination that produces zero. 
Example 2. The columns of the matrix 
A = 
2
64
1 3 3 2 
2 6 9 5 
.1 .3 3 0
3
75 
are linearly dependent, since the second column is three times the first. The combination 
of columns with weights .3, 1, 0, 0 gives a column of zeros. 
The rows are also linearly dependent; row 3 is two times row 2 minus five times row 
1. (This is the same as the combination of b1, b2, b3, that had to vanish on the right-hand 
side in order for Ax = b to be consistent. Unless b3.2b2+5b1 = 0, the third equation 
would not become 0 = 0.) 
Example 3. The columns of this triangular matrix are linearly independent: 
No zeros on the diagonal A = 
2
64
3 4 2 
0 1 5 
0 0 2
3
75
:
2.3 Linear Independence, Basis, and Dimension 105 
Look for a combination of the columns that makes zero: 
Solve Ac = 0 c1
2
64
3
0
0
3
75
+c2
2
64
4
1
0
3
75
+c3
2
64
2
5
2
3
75
= 
2
64
0
0
0
3
75
: 
We have to show that c1, c2, c3 are all forced to be zero. The last equation gives 
c3 =0. Then the next equation gives c2 =0, and substituting into the first equation forces 
c1 = 0. The only combination to produce the zero vector is the trivial combination. The 
nullspace of A contains only the zero vector c1 = c2 = c3 = 0. 
The columns of A are independent exactly when N(A) = fzero vectorg. 
A similar reasoning applies to the rows of A, which are also independent. Suppose 
c1(3;4;2)+c2(0;1;5)+c3(0;0;2) = (0;0;0): 
From the first components we find 3c1 = 0 or c1 = 0. Then the second components give 
c2 = 0, and finally c3 = 0. 
The nonzero rows of any echelon matrix U must be independent. Furthermore, if we 
pick out the columns that contain the pivots, they also are linearly independent. In our 
earlier example, with 
Two independent rows 
Two independent columns 
U = 
2
64
1 3 3 2 
0 0 3 1 
0 0 0 0
3
75
; 
the pivot columns 1 and 3 are independent. No set of three columns is independent, and 
certainly not all four. It is true that columns 1 and 4 are also independent, but if that 
last 1 were changed to 0 they would be dependent. It is the columns with pivots that are 
guaranteed to be independent. The general rule is this: 
2F The r nonzero rows of an echelon matrix U and a reduced matrix R are 
linearly independent. So are the r columns that contain pivots. 
Example 4. The columns of the n by n identity matrix are independent: 
I = 
2
6664 
1 0 . 0 
0 1 . 0 
. . . 0 
0 0 0 1
3
7775
: 
These columns e1; : : : ;en represent unit vectors in the coordinate directions; in R4, 
e1 = 
2
6664 
1
0
0
0
3
7775
; e2 = 
2
6664 
0
1
0
0
3
7775
; e3 = 
2
6664 
0
0
1
0
3
7775
; e4 = 
2
6664 
0
0
0
1
3
7775
:
106 Chapter 2 Vector Spaces 
Most sets of four vectors in R4 are independent. Those e’s might be the safest. 
To check any set of vectors v1; : : : ;vn for independence, put them in the columns of A. 
Then solve the system Ac = 0; the vectors are dependent if there is a solution other than 
c = 0. With no free variables (rank n), there is no nullspace except c = 0; the vectors are 
independent. If the rank is less than n, at least one free variable can be nonzero and the 
columns are dependent. 
One case has special importance. Let the n vectors have m components, so that A is an 
m by n matrix. Suppose now that n>m. There are too many columns to be independents 
There cannot be n pivots, since there are not enough rows to hold them. The rank will 
be less than n. Every system Ac = 0 with more unknowns than equations has solutions 
c 6= 0. 
2G A set of n vectors in Rm must be linearly dependent if n > m. 
The reader will recognize this as a disguised form of 2C: Every m by n system Ax = 0 
has nonzero solutions if n > m. 
Example 5. These three columns in R2 cannot be independent: 
A = 
"
1 2 1 
1 3 2
#
: 
To find the combination of the columns producing zero we solve Ac = 0: 
A!U = 
"
1 2 1 
0 1 1
#
: 
If we give the value 1 to the free variable c3, then back-substitution in Uc = 0 gives 
c2 = .1, c1 = 1. With these three weights, the first column minus the second plus the 
third equals zero: Dependence. 
Spanning a Subspace 
Now we define what it means for a set of vectors to span a space. The column space of 
A is spanned by the columns. Their combinations produce the whole space: 
2H If a vector space V consists of all linear combinations of w1; : : : ;w`, then 
these vectors span the space. Every vector v in V is some combination of the 
w’s: 
Every v comes from w’s v = c1w1+. . .+c`w` for some coefficients ci: 
It is permitted that a different combination of w’s could give the same vector v. The 
c’s need not be unique, because the spanning set might be excessively large—it could 
include the zero vector, or even all vectors.
2.3 Linear Independence, Basis, and Dimension 107 
Example 6. The vectors w1 = (1;0;0), w2 = (0;1;0), and w3 = (.2;0;0) span a plane 
(the x-y plane) in R3. The first two vectors also span this plane, whereas w1 and w3 span 
only a line. 
Example 7. The column space of A is exactly the space that is spanned by its columns. 
The row space is spanned by the rows. The definition is made to order. Multiplying A 
by any x gives a combination of the columns; it is a vector Ax in the column space. 
The coordinate vectors e1; : : : ;en coming from the identity matrix span Rn. Every 
vector b = (b1; : : : ;bn) is a combination of those columns. In this example the weights 
are the components bi themselves: b = b1e1 +. . .+bnen. But the columns of other 
matrices also span Rn! 
Basis for a Vector Space 
To decide if b is a combination of the columns, we try to solve Ax = b. To decide if 
the columns are independent, we solve Ax = 0. Spanning involves the column space, 
and independence involves the nullspace. The coordinate vectors e1; : : : ;en span Rn 
and they are linearly independent. Roughly speaking, no vectors in that set are wasted. 
This leads to the crucial idea of a basis. 
2I A basis for V is a sequence of vectors having two properties at once: 
1. The vectors are linearly independent (not too many vectors). 
2. They span the space V (not too few vectors). 
This combination of properties is absolutely fundamental to linear algebra. It means 
that every vector in the space is a combination of the basis vectors, because they span. 
It also means that the combination is unique: If v = a1v1 +. . .+akvk and also v = 
b1v1 +. . .+bkvk, then subtraction gives 0 = a(ai .bi)vi. Now independence plays its 
part; every coefficient ai .bi must be zero. Therefore ai = bi. There is one and only 
one way to write v as a combination of the basis vectors. 
We had better say at once that the coordinate vectors e1; : : : ;en are not the only basis 
for Rn. Some things in linear algebra are unique, but not this. A vector space has 
infinitely many different bases. Whenever a square matrix is invertible, its columns are 
independent—and they are a basis for Rn. The two columns of this nonsingular matrix 
are a basis for R2: 
A = 
"
1 1 
2 3
# 
Every two-dimensional vector is a combination of those (independent!) columns. 
Example 8. The x-y plane in Figure 2.4 is just R2. The vector v1 by itself is linearly 
independent, but it fails to span R2. The three vectors v1, v2, v3 certainly span R2, but 
are not independent. Any two of these vectors, say v1 and v2, have both properties—they
108 Chapter 2 Vector Spaces 
span, and they are independent. So they form a basis. Notice again that a vector space 
does not have a unique basis. 
y 
x 
v3 
v2 
v1 
Figure 2.4: A spanning set v1, v2, v3. Bases v1, v2 and v1, v3 and v2, v3. 
Example 9. These four columns span the column space ofU, but they are not independent: 
Echelon matrix U = 
2
64
1 3 3 2 
0 0 3 1 
0 0 0 0
3
75
: 
There are many possibilities for a basis, but we propose a specific choice: The columns 
that contain pivots (in this case the first and third, which correspond to the basic variables) 
are a basis for the column space. These columns are independent, and it is easy 
to see that they span the space. In fact, the column space of U is just the x-y plane 
within R3. C(U) is not the same as the column space C(A) before elimination—but the 
number of independent columns didn’t change. 
To summarize: The columns of any matrix span its column space. If they are independent, 
they are a basis for the column space—whether the matrix is square or rectangular. 
If we are asking the columns to be a basis for the whole space Rn, then the matrix must 
be square and invertible. 
Dimension of a Vector Space 
A space has infinitely many different bases, but there is something common to all of 
these choices. The number of basis vectors is a property of the space itself: 
2J Any two bases for a vector space V contain the same number of vectors. 
This number, which is shared by all bases and expresses the number of 
“degrees of freedom” of the space, is the dimension of V. 
We have to prove this fact: All possible bases contain the same number of vectors. 
The x-y plane in Figure 2.4 has two vectors in every basis; its dimension is 2. In three
2.3 Linear Independence, Basis, and Dimension 109 
dimensions we need three vectors, along the x-y-z axes or in three other (linearly independent!) 
directions. The dimension of the space Rn is n. The column space of U 
in Example 9 had dimension 2; it was a “two-dimensional subspace of R3.” The zero 
matrix is rather exceptional, because its column space contains only the zero vector. By 
convention, the empty set is a basis for that space, and its dimension is zero. 
Here is our first big theorem in linear algebra: 
2K If v1; : : : ;vm and w1; : : : ;wn are both bases for the same vector space, then 
m = n. The number of vectors is the same. 
Proof. Suppose there are more w’s than v’s (n > m). We will arrive at a contradiction. 
Since the v’s form a basis, they must span the space. Every wj can be written as a 
combination of the v’s: If w1 = a11v1+. . .+am1vm, this is the first column of a matrix 
multiplication VA: 
W = 
h
w1 w2 . . . wn
i 
= 
h
v1 . . . vm
i
2
64
a11 
... 
am1 
3
75
=VA: 
We don’t know each ai j, but we know the shape of A (it is m by n). The second vector 
w2 is also a combination of the v’s. The coefficients in that combination fill the second 
column of A. The key is that A has a row for every v and a column for every w. A is a 
short, wide matrix, since n > m. There is a nonzero solution to Ax = 0. Then VAx = 0 
which isWx = 0. A combination of the w’s gives zero! The w’s could not be a basis—so 
we cannot have n > m. 
If m > n we exchange the v’s and w’s and repeat the same steps. The only way to 
avoid a contradiction is to have m = n. This completes the proof that m = n. To repeat: 
The dimension of a space is the number of vectors in every basis. 
This proof was used earlier to show that every set of m+1 vectors in Rm must be dependent. 
The v’s and w’s need not be column vectors—the proof was all about the matrix 
A of coefficients. In fact we can see this general result: In a subspace of dimension k, 
no set of more than k vectors can be independent, and no set of more than k vectors can. 
span the space. 
There are other “dual” theorems, of which we mention only one. We can start with a 
set of vectors that is too small or too big, and end up with a basis: 
2L Any linearly independent set in V can be extended to a basis, by adding 
more vectors if necessary. 
Any spanning set in V can be reduced to a basis, by discarding vectors if 
necessary. 
The point is that a basis is a maximal independent set. It cannot be made larger without 
losing independence. A basis is also a minimal spanning set. It cannot be made smaller 
and still span the space.
110 Chapter 2 Vector Spaces 
You must notice that the word “dimensional” is used in two different ways. We speak 
about a four-dimensional vector, meaning a vector in R4. Now we have defined a fourdimensional 
subspace; an example is the set of vectors in R6 whose first and last components 
are zero. The members of this four-dimensional subspace are six-dimensional 
vectors like (0;5;1;3;4;0). 
One final note about the language of linear algebra. We never use the terms “basis of a 
matrix” or “rank of a space” or “dimension of a basis.” These phrases have no meaning. 
It is the dimension of the column space that equals the rank of the matrix, as we prove 
in the coming section. 
Problem Set 2.3 
Problems 1–10 are about linear independence and linear dependence. 
1. Show that v1, v2, v3 are independent but v1, v2, v3, v4 are dependent: 
v1 = 
2
64
1
0
0
3
75
v2 = 
2
64
1
1
0
3
75
v3 = 
2
64
1
1
1
3
75
v4 = 
2
64
2
3
4
3
75
: 
Solve c1v1+. . .+c4v4 = 0 or Ac = 0. The v’s go in the columns of A. 
2. Find the largest possible number of independent vectors among 
v1 =
2
6664 
1 
.1 
0
0 
3
7775
v2 =
2
6664 
1
0 
.1 
0 
3
7775
v3 =
2
6664 
1
0
0 
.1
3
7775
v4 =
2
6664 
0
1 
.1 
0 
3
7775
v5 =
2
6664 
0
1
0 
.1
3
7775
v6 =
2
6664 
0
0
1 
.1
3
7775
: 
This number is the of the space spanned by the v’s. 
3. Prove that if a = 0, d = 0, or f = 0 (3 cases), the columns of U are dependent: 
U = 
2
64
a b c 
0 d e 
0 0 f
3
75
: 
4. If a, d, f in Problem 3 are all nonzero, show that the only solution toUx =0 is x =0. 
Then U has independent columns. 
5. Decide the dependence or independence of 
(a) the vectors (1;3;2), (2;1;3), and (3:2;1). 
(b) the vectors (1;.3;2), (2;1;.3), and (.3;2;1).
2.3 Linear Independence, Basis, and Dimension 111 
6. Choose three independent columns ofU. Then make two other choices. Do the same 
for A. You have found bases for which spaces? 
U = 
2
6664 
2 3 4 1 
0 6 7 0 
0 0 0 9 
0 0 0 0
3
7775
and A = 
2
6664 
2 3 4 1 
0 6 7 0 
0 0 0 9 
4 6 8 2
3
7775
: 
7. If w1, w2, w3 are independent vectors, show that the differences v1 = w2.w3, v2 = 
w1.w3, and v3 = w1.w2 are dependent. Find a combination of the v’s that gives 
zero. 
8. If w1, w2, w3 are independent vectors, show that the sums v1 =w2+w3, v2 =w1+w3, 
and v3 = w1+w2 are independent. (Write c1v1+c2v2+c3v3 = 0 in terms of the w’s. 
Find and solve equations for the c’s.) 
9. Suppose v1, v2, v3, v4 are vectors in R3. 
(a) These four vectors are dependent because . 
(b) The two vectors v1 and v2 will be dependent if . 
(c) The vectors v1 and (0;0;0) are dependent because . 
10. Find two independent vectors on the plane x+2y.3z.t = 0 in R4. Then find three 
independent vectors. Why not four? This plane is the nullspace of what matrix? 
Problems 11–18 are about the space spanned by a set of vectors. Take all linear 
combinations of the vectors 
11. Describe the subspace of R3 (is it a line or a plane or R3?) spanned by 
(a) the two vectors (1;1;.1) and (.1;.1;1). 
(b) the three vectors (0;1;1) and (1;1;0) and (0;0;0). 
(c) the columns of a 3 by 5 echelon matrix with 2 pivots. 
(d) all vectors with positive components. 
12. The vector b is in the subspace spanned by the columns of A when there is a solution 
to . The vector c is in the row space of A when there is a solution to . True 
or false: If the zero vector is in the row space, the rows are dependent. 
13. Find the dimensions of (a) the column space of A, (b) the column space of U, (c) the 
row space of A, (d) the row space of U. Which two of the spaces are the same? 
A = 
2
64
1 1 0 
1 3 1 
3 1 .1
3
75
and U = 
2
64
1 1 0 
0 2 1 
0 0 0
3
75
:
112 Chapter 2 Vector Spaces 
14. Choose x = (x1;x2;x3;x4) in R4. It has 24 rearrangements like (x2;x1;x3;x4) and 
(x4;x3;x1;x2). Those 24 vectors, including x itself, span a subspace S. Find specific 
vectors x so that the dimension of S is: (a) 0, (b) 1, (c) 3, (d) 4. 
15. v+w and v.w are combinations of v and w. Write v and w as combinations of v+w 
and v.w. The two pairs of vectors the same space. When are they a basis for 
the same space? 
16. Decide whether or not the following vectors are linearly independent, by solving 
c1v1+c2v2+c3v3+c4v4 = 0: 
v1 = 
2
6664 
1
1
0
0
3
7775
; v2 = 
2
6664 
1
0
1
0
3
7775
; v3 = 
2
6664 
0
0
1
1
3
7775
; v4 = 
2
6664 
0
1
0
1
3
7775
: 
Decide also if they span R4, by trying to solve c1v1+. . .+c4v4 = (0;0;0;1). 
17. Suppose the vectors to be tested for independence are placed into the rows instead 
of the columns of A, How does the elimination process from A to U decide for or 
against independence? 
18. To decide whether b is in the sub space spanned by w1; : : : ;wn, let the vectors w be 
the columns of A and try to solve Ax = b. What is the result for 
(a) w1 = (1;1;0), w2 = (2;2;1), w3 = (0;0;2), b = (3;4;5)? 
(b) w1 = (1;2;0), w2 = (2;5;0), w3 = (0;0;2), w4 = (0;0;0), and any b? 
Problems 19–37 are about the requirements for a basis. 
19. If v1; : : : ;vn are linearly independent, the space they span has dimension . These 
vectors are a for that space. If the vectors are the columns of an m by n matrix, 
then m is than n. 
20. Find a basis for each of these subspaces of R4: 
(a) All vectors whose components are equal. 
(b) All vectors whose components add to zero. 
(c) All vectors that are perpendicular to (1;1;0;0) and (1;0;1;1). 
(d) The column space (in R2) and nullspace (in R5) of U = 
. 1 0 1 0 1 
0 1 0 1 0 
¤
. 
21. Find three different bases for the column space of U above. Then find two different 
bases for the row space of U. 
22. Suppose v1;v2; : : : ;v6 are six vectors in R4. 
(a) Those vectors (do)(do not)(might not) span R4.
2.3 Linear Independence, Basis, and Dimension 113 
(b) Those vectors (are)(are not)(might be) linearly independent. 
(c) Any four of those vectors (are)(are not)(might be) a basis for R4. 
(d) If those vectors are the columns of A, then Ax = b (has) (does not have) (might 
not have) a solution. 
23. The columns of A are n vectors from Rm. If they are linearly independent, what is 
the rank of A? If they span Rm, what is the rank? If they are a basis for Rm, what 
then? 
24. Find a basis for the plane x.2y+3z = 0 in R3. Then find a basis for the intersection 
of that plane with the xy-plane. Then find a basis for all vectors perpendicular to the 
plane. 
25. Suppose the columns of a 5 by 5 matrix A are a basis for R5. 
(a) The equation Ax = 0 has only the solution x = 0 because . 
(b) If b is in R5 then Ax = b is solvable because . 
Conclusion: A is invertible. Its rank is 5. 
26. Suppose S is a five-dimensional subspace of R6. True or false? 
(a) Every basis for S can be extended to a basis for R6 by adding one more vector. 
(b) Every basis for R6 can be reduced to a basis for S by removing one vector. 
27. U comes from A by subtracting row 1 from row 3: 
A = 
2
64
1 3 2 
0 1 1 
1 3 2
3
75
and U = 
2
64
1 3 2 
0 1 1 
0 0 0
3
75
: 
Find bases for the two column spaces. Find bases for the two row spaces. Find bases 
for the two nullspace. 
28. True or false (give a good reason)? 
(a) If the columns of a matrix are dependent, so are the rows. 
(b) The column space of a 2 by 2 matrix is the same as its row space. 
(c) The column space of a 2 by 2 matrix has the same dimension as its row space. 
(d) The columns of a matrix are a basis for the column space. 
29. For which numbers c and d do these matrices have rank 2? 
A = 
2
64
1 2 5 0 5 
0 0 c 2 2 
0 0 0 d 2
3
75
and B = 
"
c d 
d c
#
:
114 Chapter 2 Vector Spaces 
30. By locating the pivots, find a basis for the column space of 
U = 
2
6664 
0 5 4 3 
0 0 2 1 
0 0 0 0 
0 0 0 0
3
7775
: 
Express each column that is not in the basis as a combination of the basic columns, 
Find also a matrix A with this echelon form U, but a different column space. 
31. Find a counterexample to the following statement: If v1, v2, v3, v4 is a basis for the 
vector space R4, and ifWis a subspace, then some subset of the v’s is a basis forW. 
32. Find the dimensions of these vector spaces: 
(a) The space of all vectors in R4 whose components add to zero. 
(b) The nullspace of the 4 by 4 identity matrix. 
(c) The space of all 4 by 4 matrices. 
33. Suppose V is known to have dimension k. Prove that 
(a) any k independent vectors in V form a basis; 
(b) any k vectors that span V form a basis. 
In other words, if the number of vectors is known to be correct, either of the two 
properties of a basis implies the other. 
34. Prove that if V and W are three-dimensional subspaces of R5, then V and W must 
have a nonzero vector in common. Hint: Start with bases for the two subspaces, 
making six vectors in all. 
35. True or false? 
(a) If the columns of A are linearly independent, then Ax=b has exactly one solution 
for every b. 
(b) A 5 by 7 matrix never has linearly independent columns, 
36. If A is a 64 by 17 matrix of rank 11, how many independent vectors satisfy Ax = 0? 
How many independent vectors satisfy ATy = 0? 
37. Find a basis for each of these subspaces of 3 by 3 matrices: 
(a) All diagonal matrices. 
(b) All symmetric matrices (AT = A). 
(c) All skew-symmetric matrices (AT = .A). 
Problems 38–42 are about spaces in which the “vectors” are functions.
2.4 The Four Fundamental Subspaces 115 
38. (a) Find all functions that satisfy dy 
dx = 0. 
(b) Choose a particular function that satisfies dy 
dx = 3. 
(c) Find all functions that satisfy dy 
dx = 3. 
39. The cosine space F3 contains all combinations y(x) = Acos x+Bcos2x+Ccos3x. 
Find a basis for the subspace that has y(0) = 0. 
40. Find a basis for the space of functions that satisfy 
(a) 
dy 
dx 
.2y = 0: 
(b) 
dy 
dx 
. 
y
x 
= 0: 
41. Suppose y1(x), y2(x), y3(x) are three different functions of x. The vector space they 
span could have dimension 1, 2, or 3. Give an example of y1, y2, y3 to show each 
possibility. 
42. Find a basis for the space of polynomials p(x) of degree · 3. Find a basis for the 
subspace with p(1) = 0. 
43. Write the 3 by 3 identity matrix as a combination of the other five permutation matrices! 
Then show that those five matrices are linearly independent. (Assume a combi 
nation gives zero, and check entries to prove each term is zero.) The five permutations 
are a basis for the subspace of 3 by 3 matrices with row and column sums all 
equal. 
44. Review: Which of the following are bases for R3? 
(a) (1;2;0) and (0;1;.1). 
(b) (1;1;.1), (2;3;4), (4;1;.1), (0;1;.1). 
(c) (1;2;2), (.1;2;1), (0;8;0). 
(d) (1;2;2), (.1;2;1), (0;8;6). 
45. Review: Suppose A is 5 by 4 with rank 4. Show that Ax = b has no solution when the 
5 by 5 matrix [A b] is invertible. Show that Ax = b is solvable when [A b] is singular. 
2.4 The Four Fundamental Subspaces 
The previous section dealt with definitions rather than constructions. We know what a 
basis is, but not how to find one. Now, starting from an explicit description of a subspace, 
we would like to compute an explicit basis. 
Subspaces can be described in two ways. First, we may be given a set of vectors that 
span the space. (Example: The columns span the column space.) Second, we may be
116 Chapter 2 Vector Spaces 
told which conditions the vectors in the space must satisfy. (Example: The nullspace 
consists of all vectors that satisfy Ax = 0.) 
The first description may include useless vectors (dependent columns). The second 
description may include repeated conditions (dependent rows). We can’t write a basis 
by inspection, and a systematic procedure is necessary. 
The reader can guess what that procedure will be. When elimination on A produces 
an echelon matrix U or a reduced R, we will find a basis for each of the subspaces 
associated with A. Then we have to look at the extreme case of full rank: 
When the rank is as large as possible, r = n or r = m or r = m = n, the matrix has a 
left-inverse B or a right-inverse C or a two-sided A.1. 
To organize the whole discussion, we take each of the four subspaces in turn. Two of 
them are familiar and two are new. 
1. The column space of A is denoted by C(A). Its dimension is the rank r. 
2. The nullspace of A is denoted by N(A). Its dimension is n.r. 
3. The row space of A is the column space of AT. It is C(AT), and it is spanned by the 
rows of A. Its dimension is also r. 
4. The left nullspace of A is the nullspace of AT. It contains all vectors y such that 
ATy = 0, and it is written N(AT). Its dimension is . 
The point about the last two subspaces is that they come from AT. If A is an m by n 
matrix, you can see which “host” spaces contain the four subspaces by looking at the 
number of components: 
The nullspace N(A) and row space C(AT) are subspaces of Rn. 
The left nullspace N(AT) and column space C(A) are subspaces of Rm. 
The rows have n components and the columns have m. For a simple matrix like 
A =U = R = 
"
1 0 0 
0 0 0
#
; 
the column space is the line through [10
]. The row space is the line through [1 0 0]T. It 
is in R3. The nullspace is a plane in R3 and the left nullspace is a line in R2: 
N(A) contains 
2
64
0
1
0
3
75
and 
2
64
0
0
1
3
75
; N(AT) contains 
"
0
1
#
:
2.4 The Four Fundamental Subspaces 117 
Note that all vectors are column vectors. Even the rows are transposed, and the row 
space of A is the column space of AT, Our problem will be to connect the four spaces for 
U (after elimination) to the four spaces for A: 
Basic 
example 
U = 
2
64
1 3 3 2 
0 0 3 3 
0 0 0 0
3
75
came from A = 
2
64
1 3 3 2 
2 6 9 7 
.1 .3 3 4
3
75
: 
For novelty, we take the four subspaces in a more interesting order. 
3. The row space of A For an echelon matrix like U, the row space is clear. It contains 
all combinations of the rows, as every row space does—but here the third row contributes 
nothing. The first two rows are a basis for the row space. A similar rule applies to every 
echelon matrixU or R, with r pivots and r nonzero rows: The nonzero rows are a basis, 
and the row space has dimension r. That makes it easy to deal with the original matrix 
A. 
2M The row space of A has the same dimension r as the row space of U, 
and it has the same bases, because the row spaces of A and U (and R) are the 
same. 
The reason is that each elementary operation leaves the row space unchanged. The rows 
in U are combinations of the original rows in A. Therefore the row space of U contains 
nothing new. At the same time, because every step can be reversed, nothing is lost; the 
rows of A can be recovered from U. It is true that A and U have different rows, but the 
combinations of the rows are identical: same space! 
Note that we did not start with the m rows of A, which span the row space, and discard 
m.r of them to end up with a basis. According to 2L, we could have done so. But it 
might be hard to decide which rows to keep and which to discard, so it was easier just to 
take the nonzero rows of U. 
2. The nullspace of A Elimination simplifies a system of linear equations without 
changing the solutions. The system Ax = 0 is reduced to Ux = 0, and this process is 
reversible. The nullspace of A is the same as the nullspace of U and R. Only r of 
the equations Ax = 0 are independent. Choosing the n.r “special solutions” to Ax = 0 
provides a definite basis for the nullspace: 
2N The nullspace N(A) has dimension n.r. The “special solutions” are a 
basis—each free variable is given the value 1, while the other free variables 
are 0. Then Ax = 0 or Ux = 0 or Rx = 0 gives the pivot variables by backsubstitution. 
This is exactly the way we have been solving Ux = 0. The basic example above has 
pivots in columns 1 and 3. Therefore its free variables are the second and fourth v and y.
118 Chapter 2 Vector Spaces 
The basis for the nullspace is 
Special solutions 
v = 1 
y = 0 
x1 = 
2
6664 
.3 
1
0
0 
3
7775
; 
v = 0 
y = 1 
x2 = 
2
6664 
1
0 
.1 
1 
3
7775
: 
Any combination c1x1+c2x2 has c1 as its v component, and c2 as its y component. The 
only way to have c1x1+c2x2 =0 is to have c1 =c2 =0, so these vectors are independent. 
They also span the nullspace; the complete solution is vx1+yx2. Thus the n.r = 4.2 
vectors are a basis. 
The nullspace is also called the kernel of A, and its dimension n.r is the nullity. 
1. The column space of A The column space is sometimes called the range. This 
is consistent with the usual idea of the range, as the set of all possible values f (x); x is 
in the domain and f (x) is in the range. In our case the function is f (x) = Ax. Its domain 
consists of all x in Rn; its range is all possible vectors Ax, which is the column space. 
(In an earlier edition of this book we called it R(A).) 
Our problem is to find bases for the column spaces of U and A. Those spaces are 
different (just look at the matrices!) but their dimensions are the same. 
The first and third columns of U are a basis for its column space. They are the 
columns with pivots. Every other column is a combination of those two. Furthermore, 
the same is true of the original A—even though its columns are different. The pivot 
columns of A are a basis for its column space. The second column is three times 
the first, just as in U. The fourth column equals (column 3) . (column 1). The same 
nullspace is telling us those dependencies. 
The reason is this: Ax = 0 exactly when Ux = 0. The two systems are equivalent and 
have the same solutions. The fourth column of U was also (column 3) . (column 1). 
Every linear dependence Ax = 0 among the columns of A is matched by a dependence 
Ux = 0 among the columns of U, with exactly the same coefficients. If a set of columns 
of A is independent, then so are the corresponding columns of U, and vice versa. 
To find a basis for the column space C(A), we use what is already done for U. The 
r columns containing pivots are a basis for the column space of U. We will pick those 
same r columns in A: 
2O The dimension of the column space C(A) equals the rank r, which also 
equals the dimension of the row space: The number of independent columns 
equals the number of independent rows. A basis for C(A) is formed by the r 
columns of A that correspond, in U, to the columns containing pivots. 
The row space and the column space have the same dimension r! This is one of 
the most important theorems in linear algebra. It is often abbreviated as “row rank = 
column rank.” It expresses a result that, for a random 10 by 12 matrix, is not at all
2.4 The Four Fundamental Subspaces 119 
obvious. It also says something about square matrices: If the rows of a square matrix 
are linearly independent, then so are the columns (and vice versa). Again, that does not 
seem self-evident (at least, not to the author). 
To see once more that both the row and column spaces of U have dimension r, consider 
a typical situation with rank r = 3. The echelon matrix U certainly has three 
independent rows: 
U = 
2
6664 
d1 ¤ ¤ ¤ ¤ ¤ 
0 0 0 d2 ¤ ¤ 
0 0 0 0 0 d3 
0 0 0 0 0 0 
3
7775
: 
We claim that U also has three independent columns, and no more, The columns have 
only three nonzero components. If we can show that the pivot columns—the first, fourth, 
and sixth—are linearly independent, they must be a basis (for the column space of U, 
not A!). Suppose a combination of these pivot columns produced zero: 
c1
2
6664 
d1 
0
0
0 
3
7775
+c2
2
6664 
¤ 
d2 
0
0 
3
7775
+c3
2
6664 
¤
¤ 
d3 
0 
3
7775
= 
2
6664 
0
0
0
0
3
7775
: 
Working upward in the usual way, c3 must be zero because the pivot d3 6=0, then c2 must 
be zero because d2 6=0, and finally c1 =0. This establishes independence and completes 
the proof. Since Ax = 0 if and only if Ux = 0, the first, fourth, and sixth columns of A— 
whatever the original matrix A was, which we do not even know in this example—are a 
basis for C(A). 
The row space and column space both became clear after elimination on A. Now 
comes the fourth fundamental subspace, which has been keeping quietly out of sight. 
Since the first three spaces were C(A), N(A), and C(AT), the fourth space must be 
N(AT), It is the nullspace of the transpose, or the left nullspace of A. ATy = 0 means 
yTA = 0, and the vector appears on the left-hand side of A. 
4. The left nullspace of A (= the nullspace of AT) If A is an m by n matrix, then 
AT is n by m. Its nullspace is a subspace of Rm; the vector y has m components. Written 
as yTA = 0, those components multiply the rows of A to produce the zero row: 
yTA = 
h
y1 . . . ym
ih 
A 
i 
= 
h
0 . . . 0
i
: 
The dimension of this nullspace N(AT) is easy to find, For any matrix, the number 
of pivot variables plus the number of free variables must match the total number of 
columns. For A, that was r+(n.r) = n. In other words, rank plus nullity equals n: 
dimension of C(A)+dimension of N(A) = number of columns:
120 Chapter 2 Vector Spaces 
This law applies equally to AT, which has m columns. AT is just as good a matrix as A. 
But the dimension of its column space is also r, so 
r+dimension 
.
N(AT)
. 
= m: (1) 
2P The left nullspace N(AT) has dimension m.r. 
The m.r solutions to yTA = 0 are hiding somewhere in elimination. The rows of A 
combine to produce the m.r zero rows of U. Start from PA = LU, or L.1PA =U. The 
last m.r rows of the invertible matrix L.1P must be a basis of y’s in the left nullspace— 
because they multiply A to give the zero rows in U. 
In our 3 by 4 example, the zero row was row 3 . 2(row 2) + 5(row 1). Therefore 
the components of y are 5, .2, 1. This is the same combination as in b3.2b2+5b1 on 
the right-hand side, leading to 0 = 0 as the final equation. That vector y is a basis for 
the left nullspace, which has dimension m.r = 3.2 = 1. It is the last row of L.1P, 
and produces the zero row in U—and we can often see it without computing L.1. When 
desperate, it is always possible just to solve ATy = 0. 
I realize that so far in this book we have given no reason to care about N(AT). It is 
correct but not convincing if I write in italics that the left nullspace is also important. The 
next section does better by finding a physical meaning for y from Kirchhoff’s Current 
Law. 
Now we know the dimensions of the four spaces. We can summarize them in a table, 
and it even seems fair to advertise them as the 
Fundamental Theorem of Linear Algebra, Part I 
1. C(A) = column space of A; dimension r. 
2. N(A) = nullspace of A; dimension n.r. 
3. C(AT) = row space of A; dimension r. 
4. N(AT) = left nullspace of A; dimension m.r. 
Example 1. A = 
"
1 2 
3 6
# 
has m = n = 2, and rank r = 1. 
1. The column space contains all multiples of 
.13
¤
. The second column is in the same 
direction and contributes nothing new. 
2. The nullspace contains all multiples of 
..2 
1 
¤
. This vector satisfies Ax = 0. 
3. The row space contains all multiples of 
.
12
¤
. I write it as a column vector, since 
strictly speaking it is in the column space of AT. 
4. The left nullspace contains all multiples of y = 
..3 
1 
¤
. The rows of A with coefficients 
.3 and 1 add to zero, so ATy = 0.
2.4 The Four Fundamental Subspaces 121 
In this example all four subspaces are lines. That is an accident, coming from r = 1 and 
n.r = 1 and m.r = 1. Figure 2.5 shows that two pairs of lines are perpendicular. That 
is no accident!
Figure 2.5: The four fundamental subspaces (lines) for the singular matrix A. 
If you change the last entry of A from 6 to 7, all the dimensions are different. The 
column space and row space have dimension r = 2. The nullspace and left nullspace 
contain only the vectors x = 0 and y = 0. The matrix is invertible. 
Existence of Inverses 
We know that if A has a left-inverse (BA = I) and a right-inverse (AC = I), then the two 
inverses are equal: B = B(AC)(BA)C =C. Now, from the rank of a matrix, it is easy to 
decide which matrices actually have these inverses. Roughly speaking, an inverse exists 
only when the rank is as large as possible. 
The rank always satisfies r · m and also r · n. An m by n matrix cannot have more 
than m independent rows or n independent columns. There is not space for more than m 
pivots, or more than n. We want to prove that when r = m there is a right-inverse, and 
Ax = b always has a solution. When r = n there is a left-inverse, and the solution (if it 
exists) is unique. 
Only a square matrix can have both r = m and r = n, and therefore only a square 
matrix can achieve both existence and uniqueness. Only a square matrix has a two-sided 
inverse. 
2Q EXISTENCE: Full row rank r = m. Ax = b has at least one solution x 
for every b if and only if the columns span Rm. Then A has a right-inverse C 
such that AC = Im (m by m). This is possible only if m · n. 
UNIQUENESS: Full column rank r = n. Ax = b has at most one solution x 
for every b if and only if the columns are linearly independent. Then A has an 
n by m left-inverse B such that BA = In. This is possible only if m . n.
122 Chapter 2 Vector Spaces 
In the existence case, one possible solution is x =Cb, since then Ax = ACb = b. But 
there will be other solutions if there are other right-inverses. The number of solutions 
when the columns span Rm is 1 or .. 
In the uniqueness case, if there is a solution to Ax = b, it has to be x = BAx = Bb. But 
there may be no solution. The number of solutions is 0 or 1. 
There are simple formulas for the best left and right inverses, if they exist: 
One-sided inverses B = (ATA).1AT and C = AT(AAT).1: 
Certainly BA = I and AC = I. What is not so certain is that ATA and AAT are actually 
invertible. We show in Chapter 3 that ATA does have an inverse if the rank is n, and AAT 
has an inverse when the rank is m. Thus the formulas make sense exactly when the rank 
is as large as possible, and the one-sided inverses are found. 
Example 2. Consider a simple 2 by 3 matrix of rank 2: 
A = 
"
4 0 0 
0 5 0
#
: 
Since r = m = 2, the theorem guarantees a right-inverse C: 
AC = 
"
4 0 0 
0 5 0
#2
64 
14
0 
0 15 
c31 c32
3
75
= 
"
1 0 
0 1
#
: 
There are many right-inverses because the last row of C is completely arbitrary. This is 
a case of existence but not uniqueness. The matrix A has no left-inverse because the last 
column of BA is certain to be zero. The specific right-inverse C = AT(AAT).1 chooses 
c31 and c32 to be zero: 
Best right-inverse AT(AAT).1 = 
2
64
4 0 
0 5 
0 0
3
75 " 
1 
16 0 
0 1 
25
# 
= 
2
64 
14
0 
0 15 
0 0
3
75
=C: 
This is the pseudoinverse—a way of choosing the best C in Section 6.3. The transpose 
of A yields an example with infinitely many left-inverses: 
BAT = 
"
14
0 b13 
0 15
b23
#2
64
4 0 
0 5 
0 0
3
75
= 
"
1 0 
0 1
#
: 
Now it is the last column of B that is completely arbitrary. The best left-inverse (also the 
pseudoinverse) has b13 = b23 = 0. This is a “uniqueness case,” when the rank is r = n. 
There are no free variables, since n.r = 0. If there is a solution it will be the only one. 
You can see when this example has one solution or no solution: 
2
64
4 0 
0 5 
0 0
3
75 
"
x1 
x2
# 
= 
2
64
b1 
b2 
b3
3
75
is solvable exactly when b3 = 0:
2.4 The Four Fundamental Subspaces 123 
A rectangular matrix cannot have both existence and uniqueness. If m is different from 
n, we cannot have r = m and r = n. 
A square matrix is the opposite. If m = n, we cannot have one property without the 
other. A square matrix has a left-inverse if and only if it has a right-inverse. There is 
only one inverse, namely B = C = A.1. Existence implies uniqueness and uniqueness 
implies existence, when the matrix is square. The condition for invertibility is full rank: 
r = m = n. Each of these conditions is a necessary and sufficient test: 
1. The columns span Rn, so Ax = b has at least one solution for every b. 
2. The columns are independent, so Ax = 0 has only the solution x = 0. 
This list can be made much longer, especially if we look ahead to later chapters. Every 
condition is equivalent to every other, and ensures that A is invertible. 
3. The rows of A span Rn. 
4. The rows are linearly independent. 
5. Elimination can be completed: PA = LDU, with all n pivots. 
6. The determinant of A is not zero. 
7. Zero is not an eigenvalue of A. 
8. ATA is positive definite. 
Here is a typical application to polynomials P(t) of degree n.1. The only such 
polynomial that vanishes at t1; : : : ; tn is P(t).0. No other polynomial of degree n.1 can 
have n roots. This is uniqueness, and it implies existence: Given any values b1; : : : ;bn, 
there exists a polynomial of degree n.1 interpolating these values: P(ti) = bi. The 
point is that we are dealing with a square matrix; the number n of coefficients in P(t) = 
x1+x2t +. . .+xntn.1 matches the number of equations: 
Interpolation 
P(ti) = bi 
2
6664 
1 t1 t2
1 . . . tn.1 
1 
1 t2 t2
2 . . . tn.1 
2 ... 
... 
... 
... 
... 
1 tn t2
n . . . tn.1 
n 
3
7775 
2
6664 
x1 
x2
... 
xn
3
7775
= 
2
6664 
b1 
b2
... 
bn
3
7775
: 
That Vandermonde matrix is n by n and full rank. Ax = b always has a solution—a 
polynomial can be passed through any bi at distinct points ti. Later we shall actually find 
the determinant of A; it is not zero. 
Matrices of Rank 1 
Finally comes the easiest case, when the rank is as small as possible (except for the zero 
matrix with rank 0), One basic theme of mathematics is, given something complicated,
124 Chapter 2 Vector Spaces 
to show how it can be broken into simple pieces. For linear algebra, the simple pieces 
are matrices of rank 1: 
Rank 1 A = 
2
6664 
2 1 1 
4 2 2 
8 4 4 
.2 .1 .1
3
7775
has r = 1: 
Every row is a multiple of the first row, so the row space is one-dimensional. In fact, we 
can write the whole matrix as the product of a column vector and a row vector: 
A = (column)(row) 
2
6664 
2 1 1 
4 2 2 
8 4 4 
.2 .1 .1
3
7775
= 
2
6664 
1
2
4 
.1
3
7775 
h
2 1 1
i
: 
The product of a 4 by 1 matrix and a 1 by 3 matrix is a 4 by 3 matrix. This product has 
rank 1. At the same time, the columns are all multiples of the same column vector; the 
column space shares the dimension r = 1 and reduces to a line. 
Every matrix of rank 1 has the simple form A = uvT = column times row. 
The rows are all multiples of the same vector vT, and the columns are all multiples of u. 
The row space and column space are lines—the easiest case. 
Problem Set 2.4 
1. True or false: If m = n, then the row space of A equals the column space. If m < n, 
then the nullspace has a larger dimension than . 
2. Find the dimension and construct a basis for the four subspaces associated with each 
of the matrices 
A = 
"
0 1 4 0 
0 2 8 0
# 
and U = 
"
0 1 4 0 
0 0 0 0
#
: 
3. Find the dimension and a basis for the four fundamental subspaces for 
A = 
2
64
1 2 0 1 
0 1 1 0 
1 2 0 1
3
75
and U = 
2
64
1 2 0 1 
0 1 1 0 
0 0 0 0
3
75
:
2.4 The Four Fundamental Subspaces 125 
4. Describe the four subspaces in three-dimensional space associated with 
A = 
2
64
0 1 0 
0 0 1 
0 0 0
3
75
: 
5. If the product AB is the zero matrix, AB = 0, show that the column space of B is 
contained in the nullspace of A. (Also the row space of A is in the left nullspace of 
B, since each row of A multiplies B to give a zero row.) 
6. Suppose A is an m by n matrix of rank r. Under what conditions on those numbers 
does 
(a) A have a two-sided inverse: AA.1 = A.1A = I? 
(b) Ax = b have infinitely many solutions for every b? 
7. Why is there no matrix whose row space and nullspace both contain (1;1;1)? 
8. Suppose the only solution to Ax = 0 (m equations in n unknowns) is x = 0. What is 
the rank and why? The columns of A are linearly . 
9. Find a 1 by 3 matrix whose nullspace consists of all vectors in R3 such that x1 + 
2x2+4x3 = 0. Find a 3 by 3 matrix with that same nullspace. 
10. If Ax = b always has at least one solution, show that the only solution to ATy = 0 is 
y = 0. Hint: What is the rank? 
11. If Ax = 0 has a nonzero solution, show that ATy = f fails to be solvable for some 
right-hand sides f . Construct an example of A and f . 
12. Find the rank of A and write the matrix as A = uvT: 
A = 
2
64
1 0 0 3 
0 0 0 0 
2 0 0 6
3
75
and A = 
"
2 .2 
6 .6
#
: 
13. If a, b, c are given with a 6= 0, choose d so that 
A = 
"
a b 
c d
# 
= uvT 
has rank 1. What are the pivots? 
14. Find a left-inverse and/or a right-inverse (when they exist) for 
A = 
"
1 1 0 
0 1 1
# 
and M = 
2
64
1 0 
1 1 
0 1
3
75
and T = 
"
a b 
0 a
#
:
126 Chapter 2 Vector Spaces 
15. If the columns of A are linearly independent (A is m by n), then the rank is , the 
nullspace is , the row space is , and there exists a -inverse. 
16. (A paradox) Suppose A has a right-inverse B. Then AB = I leads to ATAB = AT or 
B(ATA).1AT. But that satisfies BA=I; it is a left-inverse. Which step is not justified? 
17. Find a matrix A that has V as its row space, and a matrix B that has V as its nullspace, 
if V is the subspace spanned by 
2
64
1
1
0
3
75
; 
2
64
1
2
0
3
75
; 
2
64
1
5
0
3
75
: 
18. Find a basis for each of the four subspaces of 
A = 
2
64
0 1 2 3 4 
0 1 2 4 6 
0 0 0 1 2
3
75
= 
2
64
1 0 0 
1 1 0 
0 1 1
3
75 
2
64
0 1 2 3 4 
0 0 0 1 2 
0 0 0 0 0
3
75
: 
19. If A has the same four fundamental subspaces as B, does A = cB? 
20. (a) If a 7 by 9 matrix has rank 5, what are the dimensions of the four subspaces? 
What is the sum of all four dimensions? 
(b) If a 3 by 4 matrix has rank 3, what are its column space and left nullspace? 
21. Construct a matrix with the required property, or explain why you can’t. 
(a) Column space contains 
h110 
i
, 
h001 
i
, row space contains 
.
12
¤
, 
.25
¤
. 
(b) Column space has basis 
h123 
i
, nullspace has basis 
h321 
i
. 
(c) Dimension of nullspace = 1+ dimension of left nullspace. 
(d) Left nullspace contains 
.13
¤
, row space contains 
.31
¤
. 
(e) Row space = column space, nullspace 6= left nullspace. 
22. Without elimination, find dimensions and bases for the four subspaces for 
A = 
2
64
0 3 3 3 
0 0 0 0 
0 1 0 1
3
75
and B = 
2
64
1 1 
4 4 
5 5
3
75
: 
23. Suppose the 3 by 3 matrix A is invertible. Write bases for the four subspaces for A, 
and also for the 3 by 6 matrix B = [A A]. 
24. What are the dimensions of the four subspaces for A, B, and C, if I is the 3 by 3 
identity matrix and 0 is the 3 by 2 zero matrix? 
A = 
h
I 0
i 
and B = 
" 
I I 
0T 0T
# 
and C = 
h
0
i
:
2.4 The Four Fundamental Subspaces 127 
25. Which subspaces are the same for these matrices of different sizes? 
(a) 
h
A
i 
and 
"
A
A
#
. (b) 
"
A
A
# 
and 
"
A A 
A A
#
: 
Prove that all three matrices have the same rank r. 
26. If the entries of a 3 by 3 matrix are chosen randomly between 0 and 1, what are the 
most likely dimensions of the four subspaces? What if the matrix is 3 by 5? 
27. (Important) A is an m by n matrix of rank r. Suppose there are right-hand sides b for 
which Ax = b has no solution. 
(a) What inequalities (< or ·) must be true between m, n, and r? 
(b) How do you know that ATy = 0 has a nonzero solution? 
28. Construct a matrix with (1;0;1) and (1;2;0) as a basis for its row space and its 
column space. Why can’t this be a basis for the row space and nullspace? 
29. Without computing A, find bases for the four fundamental subspaces: 
A = 
2
64
1 0 0 
6 1 0 
9 8 1
3
75 
2
64
1 2 3 4 
0 1 2 3 
0 0 1 2
3
75
: 
30. If you exchange the first two rows of a matrix A, which of the four subspaces stay 
the same? If y = (1;2;3;4) is in the left nullspace of A, write down a vector in the 
left nullspace of the new matrix. 
31. Explain why v = (1;0;.1) cannot be a row of A and also be in the nullspace. 
32. Describe the four subspaces of R3 associated with 
A = 
2
64
0 1 0 
0 0 1 
0 0 0
3
75
and I+A = 
2
64
1 1 0 
0 1 1 
0 0 1
3
75
: 
33. (Left nullspace) Add the extra column b and reduce A to echelon form: 
h
A b
i 
= 
2
64
1 2 3 b1 
4 5 6 b2 
7 8 9 b3
3
75
!
2
64
1 2 3 b1 
0 .3 .6 b2.4b1 
0 0 0 b3.2b2+b1
3
75
: 
A combination of the rows of A has produced the zero row. What combination is it? 
(Look at b3.2b2+b1 on the right-hand side.) Which vectors are in the nullspace of 
AT and which are in the nullspace of A?
128 Chapter 2 Vector Spaces 
34. Following the method of Problem 33, reduce A to echelon form and look at zero 
rows. The b column tells which combinations you have taken of the rows: 
(a) 
2
64
1 2 b1 
3 4 b2 
4 6 b3
3
75
. (b) 
2
6664 
1 2 b1 
2 3 b2 
2 4 b3 
2 5 b4
3
7775
. 
From the b column after elimination, read off m.r basis vectors in the left nullspace 
of A (combinations of rows that give zero). 
35. Suppose A is the sum of two matrices of rank one: A = uvT+wzT. 
(a) Which vectors span the column space of A? 
(b) Which vectors span the row space of A? 
(c) The rank is less than 2 if or if . 
(d) Compute A and its rank if u = z = (1;0;0) and v = w = (0;0;1). 
36. Without multiplying matrices, find bases for the row and column spaces of A: 
A = 
2
64
1 2 
4 5 
2 7
3
75 
"
3 0 3 
1 1 2
#
: 
How do you know from these shapes that A is not invertible? 
37. True or false (with a reason or a counterexample)? 
(a) A and AT have the same number of pivots. 
(b) A and AT have the same left nullspace. 
(c) If the row space equals the column space then AT = A. 
(d) If AT = .A then the row space of A equals the column space. 
38. If AB = 0, the columns of B are in the nullspace of A. If those vectors are in Rn, 
prove that rank(A)+rank(B) · n. 
39. Can tic-tac-toe be completed (5 ones and 4 zeros in A) so that rank(A)=2 but neither 
side passed up a winning move? 
40. Construct any 2 by 3 matrix of rank 1. Copy Figure 2.5 and put one vector in each 
subspace (two in the nullspace). Which vectors are orthogonal? 
41. Redraw Figure 2.5 for a 3 by 2 matrix of rank r = 2. Which subspace is Z (zero 
vector only)? The nullspace part of any vector x in R2 is xn = .
2.5 Graphs and Networks 129 
2.5 Graphs and Networks 
I am not entirely happy with the 3 by 4 matrix in the previous section. From a theoretical 
point of view it was very satisfactory; the four subspaces were computable and their 
dimensions r, n.r, r, m.r were nonzero. But the example was not produced by a 
genuine application. It did not show how fundamental those subspaces really are. 
This section introduces a class of rectangular matrices with two advantages. They 
are simple, and they are important. They are incidence matrices of graphs, and every 
entry is 1, .1, or 0. What is remarkable is that the same is true of L and U and basis 
vectors for all four subspaces. Those subspaces play a central role in network theory. 
We emphasize that the word “graph” does not refer to the graph of a function (like a 
parabola for y = x2). There is a second meaning, completely different, which is closer to 
computer science than to calculus—and it is easy to explain. This section is optional, but 
it gives a chance to see rectangular matrices in action—and how the square symmetric 
matrix ATA turns up in the end. 
A graph consists of a set of vertices or nodes, and a set of edges that connect them. 
The graph in Figure 2.6 has 4 nodes and 5 edges. It does not have an edge between 
nodes 1 and 4 (and edges from a node to itself are forbidden). This graph is directed, 
because of the arrow in each edge. 
The edgenode incidence matrix is 5 by 4, with a row for every edge. If the edge goes 
from node j to node k, then that row has .1 in column j and +1 in column k. The 
incidence matrix A is shown next to the graph (and you could recover the graph if you 
only had A). Row 1 shows the edge from node 1 to node 2. Row 5 comes from the fifth 
edge, from node 3 to node 4. 
Figure 2.6: A directed graph (5 edges, 4 nodes, 2 loops) and its incidence matrix A. 
Notice the columns of A. Column 3 gives information about node 3—it tells which 
edges enter and leave. Edges 2 and 3 go in, edge 5 goes out (with the minus sign). A is 
sometimes called the connectivity matrix, or the topology matrix. When the graph has m 
edges and n nodes, A is m by n (and normally m > n). Its transpose is the “node-edge” 
incidence matrix. 
Each of the four fundamental subspaces has a meaning in terms of the graph. We can 
do linear algebra, or write about voltages and currents. We do both!
130 Chapter 2 Vector Spaces 
Nullspace of A: Is there a combination of the columns that gives Ax = 0? Normally 
the answer comes from elimination, but here it comes at a glance. The columns add up 
to the zero column. The nullspace contains x = (1;1;1;1), since Ax = 0. The equation 
Ax = b does not have a unique solution (if it has a solution at all). Any “constant vector” 
x = (c;c;c;c) can be added to any particular solution of Ax = b. The complete solution 
has this arbitrary constant c (like the +C when we integrate in calculus). 
This has a meaning if we think of x1, x2, x3, x4 as the potentials (the voltages) at the 
nodes. The five components of Ax give the differences in potential across the five edges. 
The difference across edge 1 is x2.x1, from the §1 in the first row. 
The equation Ax = b asks: Given the differences b1; : : : ;b5, find the actual potentials 
x1; : : : ;x4. But that is impossible to do! We can raise or lower all the potentials by the 
same constant c, and the differences will not change—confirming that x=(c;c;c;c) is in 
the nullspace of A. Those are the only vectors in the nullspace, since Ax=0 means equal 
potentials across every edge. The nullspace of this incidence matrix is one-dimensional. 
The rank is 4.1 = 3. 
Column Space: For which differences b1; : : : ;b5 can we solve Ax = b? To find a 
direct test, look back at the matrix. Row 1 plus row 3 equals row 2. On the right-hand 
side we need b1+b3 = b2, or no solution is possible. Similarly, row 3 plus row 5 is row 
4. The right-hand side must satisfy b3+b5 = b4, for elimination to arrive at 0 = 0. To 
repeat, if b is in the column space, then 
b1.b2+b3 = 0 and b3.b4+b5 = 0: (1) 
Continuing the search, we also find that rows 1+4 equal rows 2+5. But this is nothing 
new; subtracting the equations in (1) already produces b1 +b4 = b2 +b5. There are 
two conditions on the five components, because the column space has dimension 5.2. 
Those conditions would come from elimination, but here they have a meaning on the 
graph. 
Loops: Kirchhoff’s Voltage Law says that potential differences around a loop must 
add to zero, Around the upper loop in Figure 2.6, the differences satisfy (x2.x1)+(x3. 
x2) = (x3.x1). Those differences are b1+b3 = b2. To circle the lower loop and arrive 
back at the same potential, we need b3+b5 = b4. 
2R The test for b to be in the column space is Kirchhoff’s Voltage Law: 
The sum of potential differences around a loop must be zero. 
Left Nullspace: To solve ATy = 0, we find its meaning on the graph. The vector y has 
five components, one for each edge. These numbers represent currents flowing along 
the five edges. Since AT is 4 by 5, the equations ATy = 0 give four conditions on those
2.5 Graphs and Networks 131 
five currents. They are conditions of “conservation” at each node: Flow in equals flow 
out at every node: 
ATy = 0 
.y1.y2 = 0 
y1.y3.y4 = 0 
y2+y3.y5 = 0 
y4+y5 = 0 
Total current to node 1 is zero 
to node 2 
to node 3 
to node 4 
The beauty of network theory is that both A and AT have important roles. 
Solving ATy=0 means finding a set of currents that do not “pile up” at any node. The 
traffic keeps circulating, and the simplest solutions are currents around small loops. 
Our graph has two loops, and we send 1 amp of current around each loop: 
Loop vectors yT1
= 
h
1 .1 1 0 0
i 
and yT2
= 
h
0 0 1 .1 1
i
: 
Each loop produces a vector y in the left nullspace. The component +1 or .1 indicates 
whether the current goes with or against the arrow. The combinations of y1 and y2 fill 
the left nullspace, so y1 and y2 are a basis (the dimension had to be m.r = 5.3 = 2). 
In fact y1.y2 = (1;.1;0;1;.1) gives the big loop around the outside of the graph. 
The column space and left nullspace are closely related. The left nullspace contains 
y1 = (1;1;1;0;0), and the vectors in the column space satisfy b1 .b2 +b3 = 0. Then 
yTb = 0: Vectors in the column space and left nullspace are perpendicular! That is soon 
to become Part Two of the “Fundamental Theorem of Linear Algebra.” 
Row Space: The row space of A contains vectors in R4, but not all vectors. Its 
dimension is the rank r = 3. Elimination will find three independent rows, and we can 
also look to the graph. The first three rows are dependent (row 1 + row 3 = row 2, and 
those edges form a loop). Rows 1;2;4 are independent because edges 1;2;4 contain no 
loops. 
Rows 1, 2, 4 are a basis for the row space. In each row the entries add to zero. Every 
combination ( f1; f2; f3; f4) in the row space will have that same property: 
f in row space f1+ f2+ f3+ f4 = 0 x in nullspace x = c(1;1;1;1) (2) 
Again this illustrates the Fundamental Theorem: The row space is perpendicular to the 
nullspace. If f is in the row space and x is in the nullspace then f Tx = 0. 
For AT, the basic law of network theory is Kirchhoff’s Current Law. The total flow 
into every node is zero. The numbers f1, f2, f3, f4 are current sources into the nodes. The 
source f1 must balance .y1.y2, which is the flow leaving node 1 (along edges 1 and 2). 
That is the first equation in ATy = f . Similarly at the other three nodes—conservation 
of charge requires flow in = flow out. The beautiful thing is that AT is exactly the right 
matrix for the Current Law. 
2S The equations ATy = f at the nodes express Kirchhoff’s Current Law:
132 Chapter 2 Vector Spaces 
The net current into every node is zero. Flow in = Flow out. 
This law can only be satisfied if the total current from outside is f1+ f2+ f3+ 
f4 = 0. With f = 0, the law ATy = 0 is satisfied by a current that goes around 
a loop. 
Spanning Trees and Independent Rows 
Every component of y1 and y2 in the left nullspace is 1 or .1 or 0 (from loop flows). 
The same is true of x = (1;1;1;1) in the nullspace, and all the entries in PA = LDU! The 
key point is that every elimination step has a meaning for the graph. 
You can see it in the first step for our matrix A: subtract row 1 from row 2. This 
replaces edge 2 by a new edge “1 minus 2”: That elimination step destroys an edge and 
b edge 1 
edge 2 
edge 1.2 
row 1 .1 1 0 0 
row 2 .1 0 1 0 
row 1.2 0 1 .1 0 
creates a new edge. Here the new edge “1.2” is just the old edge 3 in the opposite 
direction. The next elimination step will produce zeros in row 3 of the matrix. This 
shows that rows 1, 2, 3 are dependent. Rows are dependent if the corresponding edges 
contain a loop. 
At the end of elimination we have a full set of r independent rows. Those r edges 
form a tree—a graph with no loops. Our graph has r = 3, and edges 1, 2, 4 form one 
possible tree. The full name is spanning tree because the tree “spans” all nodes of the 
graph. A spanning tree has n.1 edges if the graph is connected, and including one more 
edge will produce a loop. 
In the language of linear algebra, n.1 is the rank of the incidence matrix A. The row 
space has dimension n.1. The spanning tree from elimination gives a basis for that row 
space—each edge in the tree corresponds to a row in the basis. 
The fundamental theorem of linear algebra connects the dimensions of the subspaces: 
Nullspace: dimension 1, contains x = (1; : : : ;1). 
Column space: dimension r = n.1, any n.1 columns are independent. 
Row space: dimension r = n.1, independent rows from any spanning tree. 
Left nullspace: dimension m.r = m.n+1, contains y’s from the loops. 
Those four lines give Euler’s formula, which in some way is the first theorem in topology. 
It counts zero-dimensional nodes minus one-dimensional edges plus two-dimensional
2.5 Graphs and Networks 133 
loops. Now it has a linear algebra proof for any connected graph: 
(# of nodes).(# of edges)+(# of loops) = (n).(m)+(m.n+1) = 1: (3) 
For a single loop of 10 nodes and 10 edges, the Euler number is 10.10+1. If those 10 
nodes are each connected to an eleventh node in the center, then 11.20+10 is still 1. 
Every vector f in the row space has xT f = f1+. . .+ fn =0—the currents from outside 
add to zero. Every vector b in the column space has yTb = 0—the potential differences 
add to zero around all loops. In a moment we link x to y by a third law (Ohm’s law for 
each resistor). First we stay with the matrix A for an application that seems frivolous 
but is not. 
The Ranking of Football Teams 
At the end of the season, the polls rank college football teams. The ranking is mostly an 
average of opinions, and it sometimes becomes vague after the top dozen colleges. We 
want to rank all teams on a more mathematical basis. 
The first step is to recognize the graph. If team j played team k, there is an edge 
between them. The teams are the nodes, and the games are the edges. There are a few 
hundred nodes and a few thousand edges—which will be given a direction by an arrow 
from the visiting team to the home team. Figure 2.7 shows part of the Ivy League, 
and some serious teams, and also a college that is not famous for big time football. 
Fortunately for that college (from which I am writing these words) the graph is not 
connected. Mathematically speaking, we cannot prove that MIT is not number 1 (unless 
it happens to play a game against somebody). 
b b 
b 
Harvard Yale 
Princeton 
b )b
b b b 
b b 
b 
Purdue Ohio State 
MIT 
Michigan USC Texas 
Notre Dame Georgia Tech 
Figure 2.7: Part of the graph for college football. 
If football were perfectly consistent, we could assign a “potential” x j to every team. 
Then if visiting team v played home team h, the one with higher potential would win. In 
the ideal case, the difference b in the score would exactly equal the difference xh.xv in 
their potentials. They wouldn’t even have to play the game! There would be complete 
agreement that the team with highest potential is the best. 
This method has two difficulties (at least). We are trying to find a number x for every 
team, and we want xh.xv = bi, for every game. That means a few thousand equations
134 Chapter 2 Vector Spaces 
and only a few hundred unknowns. The equations xh .xv = bi go into a linear system 
Ax = b, in which A is an incidence matrix. Every game has a row, with +1 in column h 
and .1 in column v—to indicate which teams are in that game. 
First difficulty: If b is not in the column space there is no solution. The scores must 
fit perfectly or exact potentials cannot be found. Second difficulty: If A has nonzero 
vectors in its nullspace, the potentials x are not well determined. In the first case x does 
not exist; in the second case x is not unique. Probably both difficulties are present. 
The nullspace always contains the vector of 1s, since A looks only at the differences 
xh.xv. To determine the potentials we can arbitrarily assign zero potential to Harvard. 
(I am speaking mathematically, not meanly.) But if the graph is not connected, every 
separate piece of the graph contributes a vector to the nullspace. There is even the vector 
with xMIT = 1 and all other x j = 0. We have to ground not only Harvard but one team 
in each piece. (There is nothing unfair in assigning zero potential; if all other potentials 
are below zero then the grounded team ranks first.) The dimension of the nullspace is 
the number of pieces of the graph—and there will be no way to rank one piece against 
another, since they play no games. 
The column space looks harder to describe. Which scores fit perfectly with a set of 
potentials? Certainly Ax = b is unsolvable if Harvard beats Yale, Yale beats Princeton, 
and Princeton beats Harvard. More than that, the score differences in that loop of games 
have to add to zero: 
Kirchhoff’s law for score differences bHY+bYP+bPH = 0: 
This is also a law of linear algebra. Ax=b can be solved when b satisfies the same linear 
dependencies as the rows of A. Then elimination leads to 0 = 0. 
In reality, b is almost certainly not in the column space. Football scores are not that 
consistent. To obtain a ranking we can use least squares: Make Ax as close as possible 
to b. That is in Chapter 3, and we mention only one adjustment. The winner gets a bonus 
of 50 or even 100 points on top of the score difference. Otherwise winning by 1 is too 
close to losing by 1. This brings the computed rankings very close to the polls, and Dr. 
Leake (Notre Dame) gave a full analysis in Management Science in Sports (1976). 
After writing that subsection, I found the following in the New York Times: 
In its final rankings for 1985, the computer placed Miami (10-2) in the seventh 
spot above Tennessee (9-1-2). A few days after publication, packages 
containing oranges and angry letters from disgruntled Tennessee fans began 
arriving at the Times sports department. The irritation stems from the fact that 
Tennessee thumped Miami 35-7 in the Sugar Bowl. Final AP and UPI polls 
ranked Tennessee fourth, with Miami significantly lower. 
Yesterday morning nine cartons of oranges arrived at the loading dock. They 
were sent to Bellevue Hospital with a warning that the quality and contents of 
the oranges were uncertain.
2.5 Graphs and Networks 135 
So much for that application of linear algebra. 
Networks and Discrete Applied Mathematics 
A graph becomes a network when numbers c1; : : : ;cm are assigned to the edges. The 
number ci can be the length of edge i, or its capacity, or its stiffness (if it contains a 
spring), or its conductance (if it contains a resistor). Those numbers go into a diagonal 
matrix C, which is m by m. C reflects “material properties,” in contrast to the incidence 
matrix A—which gives information about the connections. 
Our description will be in electrical terms. On edge i, the conductance is ci and the 
resistance is 1=ci. Ohm’s Law says that the current yi through the resistor is proportional 
to the voltage drop ei: 
Ohm’s Law yi = ciei (current) = (conductance)(voltage drop): 
This is also written E = IR, voltage drop equals current times resistance. As a vector 
equation on all edges at once, Ohm’s Law is y =Ce. 
We need Kirchhoff’s Voltage Law and Current Law to complete the framework: 
KVL: The voltage drops around each loop add to zero. 
KCL: The currents yi (and fi) into each node add to zero. 
The voltage law allows us to assign potentials x1; : : : ;xn to the nodes. Then the differences 
around a loop give a sum like (x2 .x1)+(x3 .x2)+(x1 .x3) = 0, in which 
everything cancels. The current law asks us to add the currents into each node by the 
multiplication ATy. If there are no external sources of current, Kirchhoff’s Current Law 
is ATy = 0. 
The other equation is Ohm’s Law, but we need to find the voltage drop e across 
the resistor. The multiplication Ax gave the potential difference between the nodes. 
Reversing the signs, .Ax gives the drop in potential. Part of that drop may be due to a 
battery in the edge of strength bi. The rest of the drop is e = b.Ax across the resistor: 
Ohm’s Law y =C(b.Ax) or C.1y+Ax = b: (4) 
The fundamental equations of equilibrium combine Ohm and Kirchhoff into a central 
problem of applied mathematics. These equations appear everywhere: 
Equilibrium equations 
C.1y + Ax = b 
ATy = f : 
(5) 
That is a linear symmetric system, from which e has disappeared. The unknowns are the 
currents y and the potentials x. You see the symmetric block matrix: 
Block form 
"
C.1 A 
AT 0
#"
y
x
# 
= 
"
b
f 
#
: (6)
136 Chapter 2 Vector Spaces 
For block elimination the pivot is C.1, the multiplier is ATC, and subtraction knocks out 
AT below the pivot. The result is 
"
C.1 A 
0 .ATCA
#"
y
x
# 
= 
" 
b 
f .ATCb
# 
The equation for x alone is in the bottom row, with the symmetric matrix ATCA: 
Fundamental equation ATCAx = ATCbl f : (7) 
Then back-substitution in the first equation produces y. Nothing mysterious—substitute 
y =C(b.Ax) into ATy = f to reach (7). 
Important Remark One potential must be fixed in advance: xn = 0. The nth node 
is grounded, and the nth column of the original incidence matrix is removed. The resulting 
matrix is what we now mean by A: its n.1 columns are independent. The square 
matrix ATCA, which is the key to solving equation (7) for x, is an invertible matrix of 
order n.1: 
h 
AT 
i 
(n.1).m 
2
64
C 
3
75 
m.m 
2
64
A 
3
75 
m.(n.1) 
= 
2
64
ATCA 
3
75 (n.1).(n.1) 
Example 1. Suppose a battery b3 and a current source f2 (and five resistors) connect 
four nodes. Node 4 is grounded and the potential x4 = 0 is fixed. The first thing is the 
current law ATy = f at nodes 1, 2, 3: 
.y1 . y3 . y5 = 0 
y1 . y2 = f2 
y2 + y3 . y4 = 0 
and AT = 
2
64
.1 0 .1 0 .1 
1 .1 0 0 0 
0 1 1 .1 0 
3
75
: 
No equation is written for node 4, where the current law is y4+y5+ f2 =0. This follows 
from adding the other three equations. 
The other equation is C.1y+Ax = b. The potentials x are connected to the currents 
y by Ohm’s Law. The diagonal matrix C contains the five conductances ci = 1=Ri. The
2.5 Graphs and Networks 137 
right-hand side accounts for the battery of strength b3 in edge 3. The block form has 
C.1y+Ax = b above ATy = f : 
"
C.1 A 
AT 0
#"
y
x
# 
= 
2
6666666666664 
R1 .1 1 0 
R2 0 .1 1 
R3 .1 0 1 
R4 0 0 .1 
R5 .1 0 0 
.1 0 .1 0 .1 
1 .1 0 0 0 
0 1 1 .1 0 
3
7777777777775 
2
6666666666664 
y1 
y2 
y3 
y4 
y5 
x1 
x2 
x3
3
7777777777775 
= 
2
6666666666664 
0
0 
b3 
0
0
0
f2 
0 
3
7777777777775 
The system is 8 by 8, with five currents and three potentials. Elimination of y’s reduces 
to the 3 by 3 system ATCAx = ATCb. f . The matrix ATCA contains the reciprocals 
ci = 1=Ri (because in elimination you divide by the pivots). We also show the fourth 
row and column, from the grounded node, outside the 3 by 3 matrix: 
ATCA = 
2
64
c1+c3+c5 .c1 .c3 
.c1 c1+c2 .c2 
.c3 .c2 c2+c3+c4
3
75 
.c5 0 .c4 
.c5 (node 1) 
0 (node 2) 
.c4 (node 3) 
c4+c5 (node 4) 
The first entry is 1+1+1, or c1 +c3 +c5 when C is included, because edges 1, 3, 5 
touch node 1. The next diagonal entry is 1+1 or c1+c2, from the edges touching node 
2. Off the diagonal the c’s appear with minus signs. The edges to the grounded node 
4 belong in the fourth row and column, which are deleted when column 4 is removed 
from A (making ATCA invertible). The 4 by 4 matrix would have all rows and columns 
adding to zero, and (1;1;1;1) would be in its nullspace. 
Notice that ATCA is symmetric. It has positive pivots and it comes from the basic 
framework of applied mathematics illustrated in Figure 2.8. 
x 
e = b . Ax 
ATy = f 
A (Voltage Law) AT (Current Law) 
b y = Ce 
f 
C (Ohm’s Law) 
Figure 2.8: The framework for equilibrium: sources b and f , three steps to ATCA. 
In mechanics, x and y become displacements and stresses. In fluids, the unknowns 
are pressure and flow rate. In statistics, e is the error and x is the best least-squares fit to
138 Chapter 2 Vector Spaces 
the data. These matrix equations and the corresponding differential equations are in our 
textbook Introduction to Applied Mathematics, and the new Applied Mathematics and 
Scientific Computing. (See www.wellesleycambridge.com.) 
We end this chapter at that high point—the formulation of a fundamental problem in 
applied mathematics. Often that requires more insight than the solution of the problem. 
We solved linear equations in Chapter 1, as the first step in linear algebra. To set up the 
equations has required the deeper insight of Chapter 2. The contribution of mathematics, 
and of people, is not computation but intelligence. 
Problem Set 2.5 
1. For the 3-node triangular graph in the figure following, write the 3 by 3 incidence 
matrix A. Find a solution to Ax = 0 and describe all other vectors in the nullspace of 
A. Find a solution to ATy = 0 and describe all other vectors in the left nullspace of 
A. 
b b 
b 
edge 1 edge 3 
node 1 
node 2 edge 2 node 3 
b b 
b
b 
y1 y2 
x1 
x2 y3 x3 
x4 y4 y6 
y5 
2. For the same 3 by 3 matrix, show directly from the columns that every vector b in 
the column space will satisfy b1+b2.b3 = 0. Derive the same thing from the three 
rows—the equations in the system Ax = b. What does that mean about potential 
differences around a loop? 
3. Show directly from the rows that every vector f in the row space will satisfy f1 + 
f2+ f3 = 0. Derive the same thing from the three equations ATy = f . What does that 
mean when the f ’s are currents into the nodes? 
4. Compute the 3 by 3 matrix ATA, and show that it is symmetric but singular—what 
vectors are in its nullspace? Removing the last column of A (and last row of AT) 
leaves the 2 by 2 matrix in the upper left corner; show that it is not singular. 
5. Put the diagonal matrix C with entries c1, c2, c3 in the middle and compute ATCA. 
Show again that the 2 by 2 matrix in the upper left corner is invertible. 
6. Write the 6 by 4 incidence matrix A for the second graph in the figure. The vector 
(1;1;1;1) is in the nullspace of A, but now there will be m.n+1 = 3 independent 
vectors that satisfy ATy = 0. Find three vectors y and connect them to the loops in 
the graph.
2.5 Graphs and Networks 139 
7. If that second graph represents six games between four teams, and the score differences 
are b1; : : : ;b6, when is it possible to assign potentials x1; : : : ;x4 so that the 
potential differences agree with the b’s? You are finding (from Kirchhoff or from 
elimination) the conditions that make Ax = b solvable. 
8. Write down the dimensions of the four fundamental subspaces for this 6 by 4 incidence 
matrix, and a basis for each subspace. 
9. Compute ATA and ATCA, where the 6 by 6 diagonal matrix C has entries c1; : : : ;c6. 
How can you tell from the graph where the c’s will appear on the main diagonal of 
ATCA? 
10. Draw a graph with numbered and directed edges (and numbered nodes) whose incidence 
matrix is 
A = 
2
6664 
.1 1 0 0 
.1 0 1 0 
0 1 0 .1 
0 0 .1 1 
3
7775
: 
Is this graph a tree? (Are the rows of A independent?) Show that removing the last 
edge produces a spanning tree. Then the remaining rows are a basis for ? 
11. With the last column removed from the preceding A, and with the numbers 1. 2, 2, 1 
on the diagonal of C, write out the 7 by 7 system 
C.1y + Ax = 0 
ATy = f : 
Eliminating y1, y2, y3, y4 leaves three equations ATCAx = .f for x1, x2, x3. Solve 
the equations when f = (1;1;6). With those currents entering nodes 1, 2, 3 of the 
network, what are the potentials at the nodes and currents on the edges? 
12. If A is a 12 by 7 incidence matrix from a connected graph, what is its rank? How 
many free variables are there in the solution to Ax = b? How many free variables 
are there in the solution to ATy = f ? How many edges must be removed to leave a 
spanning tree? 
13. In the graph above with 4 nodes and 6 edges, find all 16 spanning trees. 
14. If MIT beats Harvard 35-0, Yale ties Harvard, and Princeton beats Yale 7-6, what 
score differences in the other 3 games (H-P MIT-P, MIT-Y) will allow potential differences 
that agree with the score differences? If the score differences are known for 
the games in a spanning tree, they are known for all games. 
15. In our method for football rankings, should the strength of the opposition be considered— 
or is that already built in?
140 Chapter 2 Vector Spaces 
16. If there is an edge between every pair of nodes (a complete graph), how many edges 
are there? The graph has n nodes, and edges from a node to itself are not allowed. 
17. For both graphs drawn below, verify Euler’s formula: 
(# of nodes) . (# of edges) + (# of loops) = 1. 
18. Multiply matrices to find ATA, and guess how its entries come from the graph: 
(a) The diagonal of ATA tells how many into each node. 
(b) The off-diagonals .1 or 0 tell which pairs of nodes are . 
19. Why does the nullspace of ATA contain (1;1;1;1)? What is its rank? 
20. Why does a complete graph with n = 6 nodes have m = 15 edges? A spanning tree 
connecting all six nodes has edges. There are nn.2 = 64 spanning trees! 
21. The adjacency matrix of a graph has Mi j = 1 if nodes i and j are connected by an 
edge (otherwise Mi j = 0). For the graph in Problem 6 with 6 nodes and 4 edges, 
write down M and also M2. Why does (M2)i j count the number of 2-step paths from 
node i to node j? 
2.6 Linear Transformations 
We know how a matrix moves subspaces around when we multiply by A. The nullspace 
goes into the zero vector. All vectors go into the column space, since Ax is always a 
combination of the columns. You will soon see something beautiful—that A takes its 
row space into its column space, and on those spaces of dimension r it is 100 percent invertible. 
That is the real action of A. It is partly hidden by nullspaces and left nullspaces, 
which lie at right angles and go their own way (toward zero). 
What matters now is what happens inside the space—which means inside n-dimensional 
space, if A is n by n. That demands a closer look. 
Suppose x is an n-dimensional vector. When A multiplies x, it transforms that vector 
into a new vector Ax. This happens at every point x of the n-dimensional space Rn. 
The whole space is transformed, or “mapped into itself,” by the matrix A. Figure 2.9 
illustrates four transformations that come from matrices:
2.6 Linear Transformations 141 
A = 
"
c 0 
0 c
# 1. A multiple of the identity matrix, A = cI, stretches every vector 
by the same factor c. The whole space expands or contracts (or 
somehow goes through the origin and out the opposite side, when 
c is negative). 
A = 
"
0 .1 
1 0 
# 2. A rotation matrix turns the whole space around the origin. This 
example turns all vectors through 90°, transforming every point 
(x;y) to (.y;x). 
A = 
"
0 1 
1 0
# 3. A reflection matrix transforms every vector into its image on 
the opposite side of a mirror. In this example the mirror is the 
45° line y = x, and a point like (2;2) is unchanged. A point like 
(2;.2) is reversed to (.2;2). On a combination like v = (2;2)+ 
(2;.2) = (4;0), the matrix leaves one part and reverses the other 
part. The output is Av = (2;2)+(.2;2) = (0;4) 
That reflection matrix is also a permutation matrix! It is algebraically 
so simple, sending (x;y) to (y;x), that the geometric picture 
was concealed. 
A = 
"
1 0 
0 0
# 4. A projection matrix takes the whole space onto a lowerdimensional 
subspace (not invertible). The example transforms 
each vector (x;y) in the plane to the nearest point (x;0) on the horizontal 
axis. That axis is the column space of A. The y-axis that 
projects to (0;0) is the nullspace. 
(cx, cy) 
(x, y) 
stretching 
(.y, x) 
(x, y) 
90° rotation 
(y, x) 
(x, y) 
reflection (45° mirror) 
(x, y) 
(x, 0) 
projection on axis 
Figure 2.9: Transformations of the plane by four matrices. 
Those examples could be lifted into three dimensions. There are matrices to stretch 
the earth or spin it or reflect it across the plane of the equator (forth pole transforming to 
south pole). There is a matrix that projects everything onto that plane (both poles to the 
center). It is also important to recognize that matrices cannot do everything, and some 
transformations T(x) are not possible with Ax: 
(i) It is impossible to move the origin, since A0 = 0 for every matrix. 
(ii) If the vector x goes to x0, then 2x must go to 2x0. in general cx must go to cx0, since 
A(cx) = c(Ax). 
(iii) If the vectors x and y go to x0 and y0, then their sum x+y must go to x0+y0—since 
A(x+y) = Ax+Ay. 
Matrix multiplication imposes those rules on the transformation. The second rule contains 
the first (take c = 0 to get A0 = 0). We saw rule (iii) in action when (4;0) was
142 Chapter 2 Vector Spaces 
reflected across the 45° line. It was split into (2;2)+(2;.2) and the two parts were 
reflected separately. The same could be done for projections: split, project separately, 
and add the projections. These rules apply to any transformation that comes from a 
matrix. 
Their importance has earned them a name: Transformations that obey rules (i)–(iii) 
are called linear transformations. The rules can be combined into one requirement: 
2T For all numbers c and d and all vectors x and y, matrix multiplication 
satisfies the rule of linearity: 
A(cx+dy) = c(Ax)+d(Ay): (1) 
Every transformation T(x) that meets this requirement is a linear transformation. 
Any matrix leads immediately to a linear transformation. The more interesting question 
is in the opposite direction: Does every linear transformation lead to a matrix? The 
object of this section is to find the answer, yes. This is the foundation of an approach 
to linear algebra—starting with property (1) and developing its consequences—that is 
much more abstract than the main approach in this book. We preferred to begin directly 
with matrices, and now we see how they represent linear transformations. 
A transformation need not go from Rn to the same space Rn. It is absolutely permitted 
to transform vectors in Rn to vectors in a different space Rm. That is exactly what is done 
by an m by n matrix! The original vector x has n components, and the transformed vector 
Ax has m components. The rule of linearity is equally satisfied by rectangular matrices, 
so they also produce linear transformations. 
Having gone that far, there is no reason to stop. The operations in the linearity condition 
(1) are addition and scalar multiplication, but x and y need not be column vectors 
in Rn. Those are not the only spaces. By definition, any vector space allows the combinations 
cx+dy—the “vectors” are x and y, but they may actually be polynomials or 
matrices or functions x(t) and y(t). As long as the transformation satisfies equation (1), 
it is linear. 
We take as examples the spaces Pn, in which the vectors are polynomials p(t) of 
degree n. They look like p = a0+a1t+. . .+antn, and the dimension of the vector space 
is n+1 (because with the constant term, there are n+1 coefficients). 
Example 1. The operation of differentiation, A = d=dt, is linear: 
Ap(t) = 
d 
dt 
(a0+a1t +. . .+antn) = a1+. . .+nantn.1: (2) 
The nullspace of this A is the one-dimensional space of constants: da0=dt = 0. The 
column space is the n-dimensional space Pn.1; the right-hand side of equation (2) is 
always in that space. The sum of nullity (= 1) and rank (= n) is the dimension of the 
original space Pn.
2.6 Linear Transformations 143 
Example 2. Integration from 0 to t is also linear (it takes Pn to Pn+1): 
Ap(t) = 
Z t 
0 
(a0+. . .+antn)dt = a0t +. . .+ 
an 
n+1
tn+1: (3) 
This time there is no nullspace (except for the zero vector, as always!) but integration 
does not produce all polynomials in Pn+1. The right side of equation (3) has no constant 
term. Probably the constant polynomials will be the left nullspace. 
Example 3. Multiplication by a fixed polynomial like 2+3t is linear: 
Ap(t) = (2+3t)(a0+. . .+antn) = 2a0+. . .+3antn+1: 
Again this transforms Pn to Pn+1, with no nullspace except p = 0. 
In these examples (and in almost all examples), linearity is not difficult to verify. It 
hardly even seems interesting. If it is there, it is practically impossible to miss. Nevertheless, 
it is the most important property a transformation can have1. Of course most 
transformations are not linear—for example, to square the polynomial (Ap = p2), or to 
add 1 (Ap = p+1), or to keep the positive coefficients (A(t .t2) = t). It will be linear 
transformations, and only those, that lead us back to matrices. 
Transformations Represented by Matrices 
Linearity has a crucial consequence: If we know Ax for each vector in a basis, then we 
know Ax for each vector in the entire space. Suppose the basis consists of the n vectors 
x1; : : : ;xn. Every other vector x is a combination of those particular vectors (they span 
the space). Then linearity determines Ax: 
Linearity If x = c1x1+. . .+cnxn then Ax = c1(Ax1)+. . .+cn(Axn): (4) 
The transformation T(x) = Ax has no freedom left, after it has decided what to do with 
the basis vectors. The rest is determined by linearity. The requirement (1) for two vectors 
x and y leads to condition (4) for n vectors x1; : : : ;xn. The transformation does have a 
free hand with the vectors in the basis (they are independent). When those are settled, 
the transformation of every vector is settled. 
Example 4. What linear transformation takes x1 and x2 to Ax1 and Ax2? 
x1 = 
"
1
0
# 
goes to Ax1 = 
2
64
2
3
4
3
75
; x2 = 
"
0
1
# 
goes to Ax2 = 
2
64
4
6
8
3
75
: 
It must be multiplication T(x) = Ax by the matrix 
A = 
2
64
2 4 
3 6 
4 8
3
75
: 
1Invertibility is perhaps in second place as an important property.
144 Chapter 2 Vector Spaces 
Starting with a different basis (1;1) and (2;.1), this same A is also the only linear 
transformation with 
A
"
1
1
# 
= 
2
64
6
9 
12
3
75
and A
" 
2 
.1
# 
= 
2
64
0
0
0
3
75
: 
Next we find matrices that represent differentiation and integration. First we must 
decide on a basis. For the polynomials of degree 3 there is a natural choice for the four 
basis vectors: 
Basis for P3 p1 = 1; p2 = t; p3 = t2; p4 = t3: 
That basis is not unique (it never is), but some choice is necessary and this is the most 
convenient. The derivatives of those four basis vectors are 0, 1, 2t, 3t2: 
Action of d=dt Ap1 = 0; Ap2 = p1; Ap3 = 2p2; Ap4 = 3p3: (5) 
“d=dt” is acting exactly like a matrix, but which matrix? Suppose we were in the usual 
four-dimensional space with the usual basis—the coordinate vectors p1 = (1;0;0;0), 
p2 = (0;1;0;0), p3 = (0;0;1;0), p4 = (0;0;0;1). The matrix is decided by equation (5): 
Differentiation matrix Adiff = 
2
6664 
0 1 0 0 
0 0 2 0 
0 0 0 3 
0 0 0 0
3
7775
: 
Ap1 is its first column, which is zero. Ap2 is the second column, which is p1. Ap3 is 
2p2 and Ap4 is 3p3. The nullspace contains p1 (the derivative of a constant is zero). 
The column space contains p1, p2, p3 (the derivative of a cubic is a quadratic). The 
derivative of a combination like p = 2+t .t2.t3 is decided by linearity, and there is 
nothing new about that—it is the way we all differentiate. It would be crazy to memorize 
the derivative of every polynomial. 
The matrix can differentiate that p(t), because matrices build in linearity! 
d p 
dt 
= Ap .!
2
6664 
0 1 0 0 
0 0 2 0 
0 0 0 3 
0 0 0 0
3
7775 
2
6664 
2
1 
.1 
.1
3
7775
= 
2
6664 
1 
.2 
.3 
0 
3
7775
.!1.2t .3t2: 
In short, the matrix carries all the essential information. If the basis is known, and the 
matrix is known, then the transformation of every vector is known. 
The coding of the information is simple. To transform a space to itself, one basis is 
enough. A transformation from one space to another requires a basis for each.
2.6 Linear Transformations 145 
2U Suppose the vectors x1; : : : ;xn are a basis for the space V, and vectors 
y1; : : : ;ym are a basis for W. Each linear transformation T from V to W is 
represented by a matrix A. The jth column is found by applying T to the jth 
basis vector x j, and writing T(x j) as a combination of the y’s: 
Column j of A T(x j) = Axj = a1 jy1+a2 jy2+. . .+amjym: (6) 
For the differentiation matrix, column 1 came from the first basis vector p1 = 1. Its 
derivative is zero, so column 1 is zero. The last column came from (d=dt)t3 =3t2. Since 
3t2 =0p1+0p2+3p3+0p4, the last column contained 0, 0, 3. 0. The rule (6) constructs 
the matrix, a column at a time. 
We do the same for integration. That goes from cubics to quartics, transforming 
V = P3 into W = P4, so we need a basis for W. The natural choice is y1 = 1, y2 = t, 
y3 = t2, y4 = t3, y5 = t4, spanning the polynomials of degree 4. The matrix A will be m 
by n, or 5 by 4. It comes from applying integration to each basis vector of V: 
Z t 
0 
1dt = t or Ax1 = y2; : : : ; 
Z t 
0 
t3dt = 
1
4
t4 or Ax4 = 
1
4
y5: 
Integration matrix Aint = 
2
666664 
0 0 0 0 
1 0 0 0 
0 120 0 
0 0 13
0 
0 0 0 14 
3
777775
: 
Differentiation and integration are inverse operations. Or at least integration followed 
by differentiation brings back the original function. To make that happen for matrices, 
we need the differentiation matrix from quartics down to cubics, which is 4 by 5: 
Adiff = 
2
6664 
0 1 0 0 0 
0 0 2 0 0 
0 0 0 3 0 
0 0 0 0 4
3
7775
and AdiffAint = 
2
6664 
1 
1 
1 
1
3
7775
: 
Differentiation is a left-inverse of integration. Rectangular matrices cannot have twosided 
inverses! In the opposite order, AintAdiff = I cannot be true. The 5 by 5 product has 
zeros in column 1. The derivative of a constant is zero. In the other columns AintAdiff is 
the identity and the integral of the derivative of tn is tn.
146 Chapter 2 Vector Spaces 
Rotations Q, Projections P, and Reflections H 
This section began with 90° rotations, projections onto the x-axis, and reflections through 
the 45° line. Their matrices were especially simple: 
Q = 
"
0 .1 
1 0 
# 
(rotation) 
P = 
"
1 0 
0 0
# 
(projection) 
H = 
"
0 1 
1 0
# 
(reflection) 
: 
The underlying linear transformations of the x-y plane are also simple. But rotations 
through other angles, projections onto other lines, and reflections in other mirrors are 
almost as easy to visualize, They are still linear transformations, provided that the origin 
is fixed: A0 = 0. They must be represented by matrices. Using the natural basis 
.10
¤ 
. and 01
¤
, we want to discover those matrices. 
1. Rotation Figure 2.10 shows rotation through an angle q . It also shows the effect on 
the two basis vectors. The first one goes to (cosq ; sinq ), whose length is still 1; it 
lies on the “q -line.” The second basis vector (0;1) rotates into (.sinq ;cosq ). By 
rule (6), those numbers go into the columns of the matrix (we use c and s for cosq 
and sinq ). This family of rotations Qq is a perfect chance to test the correspondence 
between transformations and matrices: 
Does the inverse of Qq equal Q.q (rotation backward through q )? Yes. 
QqQ.q = 
"
c .s 
s c 
#" 
c s 
.s c
# 
= 
"
1 0 
0 1
#
: 
Does the square of Qq equal Q2q (rotation through a double angle)? Yes. 
Q2q
= 
"
c .s 
s c 
#"
c .s 
s c 
# 
= 
"
c2.s2 .2cs 
2cs c2.s2
# 
= 
"
cos2q .sin2q 
sin2q cos2q 
#
: 
Does the product of Qq and Qj equal Qq+j (rotation through q then j)? 
Yes. 
QqQj = 
"
cosq cosj .sinq sinj . . . 
sinq cosj +cosq sinj . . .
# 
= 
"
cos(q +j) . . . 
sin(q +j) . . .
#
: 
The last case contains the first two. The inverse appears when j is .q , and the 
square appears when j is +q . All three questions were decided by trigonometric 
identities (and they give a new way to remember those identities). It was no accident 
that all the answers were yes. Matrix multiplication is defined exactly so that the 
product of the matrices corresponds to the product of the transformations. 
2V Suppose A and B are linear transformations from V to W and from U 
to V. Their product AB starts with a vector u in U, goes to Bu in V, and
2.6 Linear Transformations 147 
 
 
 1
0  
 0
1  
[ c
s ] 
[ .s 
c ] 
R =24
c .s 
s c
35 
P =24
c2 cs 
cs s2
35 
b 
b 
b 
b 
 1
0  
 0
1  
1 
1 
s [ c
s ] 
c [ c
s ] 
c
 
s 
Figure 2.10: Rotation through q (left). Projection onto the q -line (right). 
finishes with ABu in W. This “composition” AB is again a linear transformation 
(from U to W). Its matrix is the product of the individual matrices 
representing A and B. 
For AdiffAint, the composite transformation was the identity (and AintAdiff annihilated 
all constants). For rotations, the order of multiplication does not matter. Then U = 
V = W is the x-y plane, and QqQj is the same as QjQq . For a rotation and a 
reflection, the order makes a difference. 
Technical note: To construct the matrices, we need bases for V and W, and then for 
U and V. By keeping the same basis for V, the product matrix goes correctly from 
the basis in U to the basis in W. If we distinguish the transformation A from its 
matrix (call that [A]), then the product rule 2V becomes extremely concise: [AB] = 
[A][B]. The rule for multiplying matrices in Chapter 1 was totally determined by this 
requirement—it must match the product of linear transformations. 
2. Projection Figure 2.10 also shows the projection of (1;0) onto the q -line. The 
length of the projection is c=cosq . Notice that the point of projection is not (c; s), as 
I mistakenly thought; that vector has length 1 (it is the rotation), so we must multiply 
by c. Similarly the projection of (0;1) has length s, and falls at s(c; s)=(cs; s2), That 
gives the second column of the projection matrix P: 
Projection onto q -line P = 
"
c2 cs 
cs s2
#
: 
This matrix has no inverse, because the transformation has no inverse. Points on the 
perpendicular line are projected onto the origin; that line is the nullspace of P. Points 
on the q -line are projected to themselves! Projecting twice is the same as projecting 
once, and P2 = P: 
P2 = 
"
c2 cs 
cs s2
#2 
= 
"
c2(c2+s2) cs(c2+s2) 
cs(c2+s2) s2(c2+s2)
# 
= P:
148 Chapter 2 Vector Spaces 
b 
b 
b 
b 
b 
b 
2c c
s
 . 1
0
 = 2c2 
. 1 
2cs 
 
2s c
s
 . 0
1
 =  2cs 
2s2 
. 1
 
1
0
 
0
1
 
H = 2P . I = 2c2 
. 1 2cs 
2cs 2s2 
. 1
 
Image + original = 2 . projection 
Hx + x = 2Px 

Figure 2.11: Reflection through the q -line: the geometry and the matrix. 
Of course c2+s2 = cos2q +sin2q = 1. A projection matrix equals its own square. 
3. Reflection Figure 2.11 shows the reflection of (1;0) in the q -line. The length of the 
reflection equals the length of the original, as it did after rotation—but here the q - 
line stays where it is. The perpendicular line reverses direction; all points go straight 
through the mirror, Linearity decides the rest. 
Reflection matrix H = 
"
2c2.1 2cs 
2cs 2s2.1
#
: 
This matrix H has the remarkable property H2 = I. Two reflections bring back 
the original. A reflection is its own inverse, H = H.1, which is clear from the 
geometry but less clear from the matrix. One approach is through the relationship of 
reflections to projections: H = 2P.I. This means that Hx+x = 2Px—the image 
plus the original equals twice the projection. It also confirms that H2 = I: 
H2 = (2P.I)2 = 4P2.4P+I = I; since P2 = P: 
Other transformations Ax can increase the length of x; stretching and shearing are in 
the exercises. Each example has a matrix to represent it—which is the main point of this 
section. But there is also the question of choosing a basis, and we emphasize that the 
matrix depends on the choice of basis. Suppose the first basis vector is on the q -line and 
the second basis vector is perpendicular: 
(i) The projection matrix is back to P = 
. 1 0 
0 0 
¤
. This matrix is constructed as always: 
its first column comes from the first basis vector (projected to itself). The second 
column comes from the basis vector that is projected to zero.
2.6 Linear Transformations 149 
(ii) For reflections, that same basis gives H = 
. 1 0 
0 .1 
¤
. The second basis vector is reflected 
onto its negative, to produce this second column. The matrix H is still 2P.I 
when the same basis is used for H and P. 
(iii) For rotations, the matrix is not changed. Those lines are still rotated through q , and 
Q = [ c .s 
s c ] as before. 
The whole question of choosing the best basis is absolutely central, and we come back 
to it in Chapter 5. The goal is to make the matrix diagonal, as achieved for P and H. To 
make Q diagonal requires complex vectors, since all real vectors are rotated. 
We mention here the effect on the matrix of a change of basis, while the linear transformation 
stays the same. The matrix A (or Q or P or H) is altered to S.1AS. Thus a 
single transformation is represented by different matrices (via different bases, accounted 
for by S). The theory of eigenvectors will lead to this formula S.1AS, and to the best 
basis. 
Problem Set 2.6 
1. What matrix has the effect of rotating every vector through 90° and then projecting 
the result onto the x-axis? What matrix represents projection onto the x-axis followed 
by projection onto the y-axis? 
2. Does the product of 5 reflections and 8 rotations of the x-y plane produce a rotation 
or a reflection? 
3. The matrix A = 
. 2 0 
0 1 
¤ 
produces a stretching in the x-direction. Draw the circle x2+ 
y2 = 1 and sketch around it the points (2x;y) that result from multiplication by A. 
What shape is that curve? 
4. Every straight line remains straight after a linear transformation. If z is halfway 
between x and y, show that Az is halfway between Ax and Ay. 
5. The matrix A = 
. 1 0 
3 1 
¤ 
yields a shearing transformation, which leaves the y-axis unchanged. 
Sketch its effect on the x-axis, by indicating what happens to (1;0) and 
(2;0) and (.1;0)—and how the whole axis is transformed. 
6. What 3 by 3 matrices represent the transformations that 
(a) project every vector onto the x-y plane? 
(b) reflect every vector through the x-y plane? 
(c) rotate the x-y plane through 90°, leaving the z-axis alone? 
(d) rotate the x-y plane, then x-z, then y-z, through 90°? 
(e) carry out the same three rotations, but each one through 180°?
150 Chapter 2 Vector Spaces 
7. On the space P3 of cubic polynomials, what matrix represents d2=dt2? Construct 
the 4 by 4 matrix from the standard basis 1, t, t2, t3. Find its nullspace and column 
space. What do they mean in terms of polynomials? 
8. From the cubics P3 to the fourth-degree polynomials P4, what matrix represents 
multiplication by 2+3t? The columns of the 5 by 4 matrix A come from applying 
the transformation to 1, t, t2, t3. 
9. The solutions to the linear differential equation d2u=dt2 = u form a vector space 
(since combinations of solutions are still solutions). Find two independent solutions, 
to give a basis for that solution space. 
10. With initial values u = x and du=dt = y at t = 0, what combination of basis vectors 
in Problem 9 solves u00 = u? This transformation from initial values to solution is 
linear. What is its 2 by 2 matrix (using x = 1, y = 0 and x = 0, y = 1 as basis for V, 
and your basis for W)? 
11. Verify directly from c2+s2 = 1 that reflection matrices satisfy H2 = 1. 
12. Suppose A is a linear transformation from the x-y plane to itself. Why does A.1(x+ 
y) = A.1x+A.1y? If A is represented by the matrix M, explain why A.1 is represented 
by M.1. 
13. The product (AB)C of linear transformations starts with a vector x and produces 
u =Cx. Then rule 2V applies AB to u and reaches (AB)Cx. 
(a) Is this result the same as separately applying C then B then A? 
(b) Is the result the same as applying BC followed by A? Parentheses are unnecessary 
and the associative law (AB)C = A(BC) holds for linear transformations. This is 
the best proof of the same law for matrices. 
14. Prove that T2 is a linear transformation if T is linear (from R3 to R3). 
15. The space of all 2 by 2 matrices has the four basis “vectors” 
"
1 0 
0 0
#
; 
"
0 1 
0 0
#
; 
"
0 0 
1 0
#
; 
"
0 0 
0 1
#
: 
For the linear transformation of transposing, find its matrix A with respect to this 
basis. Why is A2 = I? 
16. Find the 4 by 4 cyclic permutation matrix: (x1;x2;x3;x4) is transformed to Ax = 
(x2;x3;x4;x1). What is the effect of A2? Show that A3 = A.1. 
17. Find the 4 by 3 matrix A that represents a right shift: (x1;x2;x3) is transformed to 
(0;x1;x2;x3). Find also the left shift matrix B from R4 back to R3, transforming 
(x1;x2;x3;x4) to (x2;x3;x4). What are the products AB and BA?
2.6 Linear Transformations 151 
18. In the vector space P3 of all p(x) = a0 +a1x+a2x2 +a3x3, let S be the subset of 
polynomials with 
R 1 
0 p(x)dx = 0. Verify that S is a subspace and find a basis. 
19. A nonlinear transformation is invertible if T(x) = b has exactly one solution for 
every b. The example T(x) = x2 is not invertible because x2 = b has two solutions 
for positive b and no solution for negative b. Which of the following transformations 
(from the real numbers R1 to the real numbers R1) are invertible? None are linear, 
not even (c). 
(a) T(x) = x3. (b) T(x) = ex. 
(c) T(x) = x+11. (d) T(x) = cos x. 
20. What is the axis and the rotation angle for the transformation that takes (x1;x2;x3) 
into (x2;x3;x1)? 
21. A linear transformation must leave the zero vector fixed: T(0) = 0. Prove this from 
T(v+w) = T(v)+T(w) by choosing w = . Prove it also from the requirement 
T(cv) = cT (v) by choosing c = 
22. Which of these transformations is not linear? The input is v = (v1;v2). 
(a) T(v) = (v2;v1). (b) T(v) = (v1;v1). 
(c) T(v) = (0;v1). (d) T(v) = (0;1). 
23. If S and T are linear with S(v) = T(v) = v, then S(T(v)) = v or v2? 
24. Suppose T(v) = v, except that T(0;v2) = (0;0). Show that this transformation satisfies 
T(cv) = cT (v) but not T(v+w) = T(v)+T(w). 
25. Which of these transformations satisfy T(v+w) = T(v)+T(w), and which satisfy 
T(cv) = cT (v)? 
(a) T(v) = v=kvk. (b) T(v) = v1+v2+v3. 
(c) T(v) = (v1;2v2;3v3). (d) T(v) = largest component of v. 
26. For these transformations of V = R2 to W= R2, find T(T(v)). 
(a) T(v) = .v. 
(b) T(v) = v+(1;1). 
(c) T(v) = 90° rotation = (.v2;v1). 
(d) T(v) = projection = 
µ
v1+v2 
2 
; 
v1+v2 
2 
¶
. 
27. The “cyclic” transformation T is defined by T(v1;v2;v3) = (v2;v3;v1). What is 
T(T(T(v)))? What is T100(v)?
152 Chapter 2 Vector Spaces 
28. Find the range and kernel (those are new words for the column space and nullspace) 
of T. 
(a) T(v1;v2) = (v2;v1). (b) T(v1;v2;v3) = (v1;v2). 
(c) T(v1;v2) = (0;0). (d) T(v1;v2) = (v1;v1). 
29. A linear transformation from V to W has an inverse from W to V when the range 
is all of W and the kernel contains only v = 0. Why are these transformations not 
invertible? 
(a) T(v1;v2) = (v2;v2) W= R2. 
(b) T(v1;v2) = (v1;v2;v1+v2) W= R3. 
(c) T(v1;v2) = v1 W= R1. 
30. Suppose a linear T transforms (1;1) to (2;2) and (2;0) to (0;0). Find T(v) when 
(a) v = (2;2). (b) v = (3;1). (c) v = (.1;1). (d) v = (a;b). 
Problems 31–35 may be harder. The input space V contains all 2 by 2 matrices 
M. 
31. M is any 2 by 2 matrix and A = 
. 1 2 
3 4 
¤
. The linear transformation T is defined by 
T(M) = AM. What rules of matrix multiplication show that T is linear? 
32. Suppose A = 
. 1 2 
3 6 
¤
. Show that the identity matrix I is not in the range of T. Find a 
nonzero matrix M such that T(M) = AM is zero. 
33. Suppose T transposes every matrix M. Try to find a matrix A that gives AM = 
MT for every M. Show that no matrix A will do it. To professors: Is this a linear 
transformation that doesn’t come from a matrix? 
34. The transformation T that transposes every matrix is definitely linear. Which of these 
extra properties are true? 
(a) T2 = identity transformation. 
(b) The kernel of T is the zero matrix. 
(c) Every matrix is in the range of T. 
(d) T(M) = .M is impossible. 
35. Suppose T(M) = 
. 1 0 
0 0 
¤ 
[M] 
. 0 0 
0 1 
¤
. Find a matrix with T(M) 6= 0. Describe all matrices 
with T(M) = 0 (the kernel of T) and all output matrices T(M) (the range of 
T). 
Problems 36–40 are about changing the basis 
36. (a) What matrix transforms (1;0) into (2;5) and transforms (0;1) to (1;3)? 
(b) What matrix transforms (2;5) to (1;0) and (1;3) to (0;1)?
2.6 Linear Transformations 153 
(c) Why does no matrix transform (2;6) to (1;0) and (1;3) to (0;1)? 
37. (a) What matrix M transforms (1;0) and (0;1) to (r; t) and (s;u)? 
(b) What matrix N transforms (a;c) and (b;d) to (1;0) and (0;1)? 
(c) What condition on a, b, c, d will make part (b) impossible? 
38. (a) How do M and N in Problem 37 yield the matrix that transforms (a;c) to (r; t) 
and (b;d) to (s;u)? 
(b) What matrix transforms (2;5) to (1;1) and (1;3) to (0;2)? 
39. If you keep the same basis vectors but put them in a different order, the change-ofbasis 
matrix M is a matrix. If you keep the basis vectors in order but change 
their lengths, M is a matrix. 
40. The matrix that transforms (1;0) and (0;1) to (1;4) and (1;5) is M = . The 
combination a(1;4)+b(1;5) that equals (1;0) has (a;b) = ( ; ). How are 
those new coordinates of (1;0) related to M or M.1? 
41. What are the three equations for A, B, C if the parabola Y = A+Bx+Cx2 equals 4 
at x = a, 5 at x = b, and 6 at x = c? Find the determinant of the 3 by 3 matrix. For 
which numbers a, b, c will it be impossible to find this parabola Y? 
42. Suppose v1, v2, v3 are eigenvectors for T. This means T(vi) = livi for i = 1;2;3. 
What is the matrix for T when the input and output bases are the v’s? 
43. Every invertible linear transformation can have I as its matrix. For the output basis 
just choose wi = T(vi). Why must T be invertible? 
44. Suppose T is reflection across the x-axis and S is reflection across the y-axis. The 
domain V is the x-y plane. If v = (x;y) what is S(T(v))? Find a simpler description 
of the product ST. 
45. Suppose T is reflection across the 45° line, and S is reflection across the y-axis, If 
v = (2;1) then T(v) = (1;2). Find S(T(v)) and T(S(v)). This shows that generally 
ST 6= TS. 
46. Show that the product ST of two reflections is a rotation. Multiply these reflection 
matrices to find the rotation angle: 
"
cos2q sin2q 
sin2q .cos2q 
# "
cos2a sin2a 
sin2a .cos2a
#
: 
47. The 4 by 4 Hadamard matrix is entirely +1 and .1: 
H = 
2
6664 
1 1 1 1 
1 .1 1 .1 
1 1 .1 .1 
1 .1 .1 1 
3
7775
:
154 Chapter 2 Vector Spaces 
Find H.1 and write v = (7;5;3;1) as a combination of the columns of H. 
48. Suppose we have two bases v1; : : : ;vn and w1; : : : ;wn for Rn. If a vector has coefficients 
bi in one basis and ci in the other basis, what is the change-of-basis matrix in 
b = Mc? Start from 
b1v1+. . .+bnvn =Vb = c1w1+. . .+cnwn =Wc: 
Your answer represents T(v) = v with input basis of v’s and output basis of w’s. 
Because of different bases, the matrix is not I. 
49. True or false: If we know T(v) for n different nonzero vectors in R2, then we know 
T(v) for every vector in Rn. 
50. (Recommended) Suppose all vectors x in the unit square 0 · x1 · 1, 0 · x2 · 1 are 
transformed to Ax (A is 2 by 2). 
(a) What is the shape of the transformed region (all Ax)? 
(b) For which matrices A is that region a square? 
(c) For which A is it a line? 
(d) For which A is the new area still 1? 
Review Exercises 
1.1 Find a basis for the following subspaces of R4: 
(a) The vectors for which x1 = 2x4. 
(b) The vectors for which x1+x2+x3 = 0 and x3+x4 = 0. 
(c) The subspace spanned by (1;1;1;1), (1;2;3;4), and (2;3;4;5). 
1.2 By giving a basis, describe a two-dimensional subspace of R3 that contains none of 
the coordinate vectors (1;0;0), (0;1;0), (0;0;1). 
1.3 True or false, with counterexample if false: 
(a) If the vectors x1; : : : ;xm span a subspace S, then dimS = m. 
(b) The intersection of two subspaces of a vector space cannot be empty. 
(c) If Ax = Ay, then x = y. 
(d) The row space of A has a unique basis that can be computed by reducing A to 
echelon form. 
(e) If a square matrix A has independent columns, so does A2.
2.6 Linear Transformations 155 
1.4 What is the echelon form U of A? 
A = 
2
64
1 2 0 2 1 
.1 .2 1 1 0 
1 2 .3 .7 .2
3
75
: 
What are the dimensions of its four fundamental subspaces? 
1.5 Find the rank and the nullspace of 
A = 
2
64
0 0 1 
0 0 1 
1 1 1
3
75
and B = 
2
64
0 0 1 2 
0 0 1 2 
1 1 1 0
3
75
: 
1.6 Find bases for the four fundamental subspaces associated with 
A = 
"
1 2 
3 6
#
; B = 
"
0 0 
1 2
#
; C = 
"
1 1 0 0 
0 1 0 1
#
: 
1.7 What is the most general solution to u+v+w = 1, u.w = 2? 
1.8 (a) Construct a matrix whose nullspace contains the vector x = (1;1;2). 
(b) Construct a matrix whose left nullspace contains y = (1;5). 
(c) Construct a matrix whose column space is spanned by (1;1;2) and whose row 
space is spanned by (1;5). 
(d) If you are given any three vectors in R6 and any three vectors in R5, is there a 
6 by 5 matrix whose column space is spanned by the first three and whose row 
space is spanned by the second three? 
1.9 In the vector space of 2 by 2 matrices, 
(a) is the set of rank 1 matrices a subspace? 
(b) what subspace is spanned by the permutation matrices? 
(c) what subspace is spanned by the positive matrices (all ai j > 0)? 
(d) what subspace is spanned by the invertible matrices? 
1.10 Invent a vector space that contains all linear transformations from Rn to Rn. You 
have to decide on a rule for addition. What is its dimension? 
1.11 (a) Find the rank of A, and give a basis for its nullspace. 
A = LU = 
2
6664 
1
2 1 
2 1 2 
3 2 4 1
3
7775 
2
6664 
1 2 0 1 2 1 
0 0 2 2 0 0 
0 0 0 0 0 1 
0 0 0 0 0 0
3
7775
:
156 Chapter 2 Vector Spaces 
(b) The first 3 rows of U are a basis for the row space of A—true or false? 
Columns 1, 3, 6 of U are a basis for the column space of A—true or false? 
The four rows of A are a basis for the row space of A—true or false? 
(c) Find as many linearly independent vectors b as possible for which Ax = b has a 
solution. 
(d) In elimination on A, what multiple of the third row is subtracted to knock out 
the fourth row? 
1.12 If A is an n by n.1 matrix, and its rank is n.2, what is the dimension of its 
nullspace? 
1.13 Use elimination to find the triangular factors in A = LU, if 
A = 
2
6664 
a a a a 
a b b b 
a b c c 
a b c d
3
7775
: 
Under what conditions on the numbers a, b, c, d are the columns linearly independent? 
1.14 Do the vectors (1;1;3), (2;3;6), and (1;4;3) form a basis for R3? 
1.15 What do you know about C(A) when the number of solutions to Ax = b is 
(a) 0 or 1, depending on b. 
(b) ., independent of b. 
(c) 0 or ., depending on b. 
(d) 1, regardless of b. 
1.16 In the previous exercise, how is r related to m and n in each example? 
1.17 If x is a vector in Rn, and xTy = 0 for every y, prove that x = 0. 
1.18 If A is an n by n matrix such that A2 = A and rankA = n, prove that A = I. 
1.19 What subspace of 3 by 3 matrices is spanned by the elementary matrices Ei j, with 
1s on the diagonal and at most one nonzero entry below? 
1.20 How many 5 by 5 permutation matrices are there? Are they linearly independent? 
Do they span the space of all 5 by 5 matrices? No need to write them all down. 
1.21 What is the rank of the n by n matrix with every entry equal to 1? How about the 
“checkerboard matrix,” with ai j = 0 when i+ j is even, ai j = 1 when i+ j is odd?
2.6 Linear Transformations 157 
1.22 (a) Ax = b has a solution under what conditions on b, for the following A and b? 
A = 
2
64
1 2 0 3 
0 0 0 0 
2 4 0 1
3
75
and b = 
2
64
b1 
b2 
b3
3
75
: 
(b) Find a basis for the nullspace of A. 
(c) Find the general solution to Ax = b, when a solution exists. 
(d) Find a basis for the column space of A. 
(e) What is the rank of AT? 
1.23 How can you construct a matrix that transforms the coordinate vectors e1;e2;e3 into 
three given vectors v1;v2;v3? When will that matrix be invertible? 
1.24 If e1;e2;e3 are in the column space of a 3 by 5 matrix, does it have a left-inverse? 
Does it have a right-inverse? 
1.25 Suppose T is the linear transformation on R3 that takes each point (u;v;w) to (u+ 
v+w;u+v;u), Describe what T.1 does to the point (x;y; z). 
1.26 True or false? 
(a) Every subspace of R4 is the nullspace of some matrix. 
(b) If A has the same nullspace as AT, the matrix must be square. 
(c) The transformation that takes x to mx+b is linear (from R1 to R1). 
1.27 Find bases for the four fundamental subspaces of 
A1 = 
2
6664 
1 2 0 3 
0 2 2 2 
0 0 0 0 
0 0 0 4
3
7775
and A2 = 
2
64
1
1
1
3
75
h
1 4
i
: 
1.28 (a) If the rows of A are linearly independent (A is m by n) then the rank is , the 
column space is , and the left nullspace is . 
(b) If A is 8 by 10 with a two-dimensional nullspace, show that Ax=b can be solved 
for every b. 
1.29 Describe the linear transformations of the x-y plane that are represented with standard 
basis (1;0) and (0;1) by the matrices 
A1 = 
"
1 0 
0 .1
#
; A2 = 
"
1 0 
2 1
#
; A3 = 
" 
0 1 
.1 0
#
: 
1.30 (a) If A is square, show that the nullspace of A2 contains the nullspace of A.
158 Chapter 2 Vector Spaces 
(b) Show also that the column space of A2 is contained in the column space of A. 
1.31 When does the rank-1 matrix A = uvT have A2 = 0? 
1.32 (a) Find a basis for the space of all vectors in R6 with x1+x2 = x3+x4 = x5+x6. 
(b) Find a matrix with that subspace as its nullspace. 
(c) Find a matrix with that subspace as its column space. 
1.33 Suppose the matrices in PA = LU are 
2
6664 
0 1 0 0 
1 0 0 0 
0 0 0 1 
0 0 1 0
3
7775 
2
6664 
0 0 1 .3 2 
2 .1 4 2 1 
4 .2 9 1 4 
2 .1 5 .1 5
3
7775
= 
2
6664 
1 0 0 0 
0 1 0 0 
1 1 1 0 
2 1 0 1
3
7775 
2
6664 
2 .1 4 2 1 
0 0 1 .3 2 
0 0 0 0 2 
0 0 0 0 0
3
7775
: 
(a) What is the rank of A? 
(b) What is a basis for the row space of A? 
(c) True or false: Rows 1, 2, 3 of A are linearly independent. 
(d) What is a basis for the column space of A? 
(e) What is the dimension of the left nullspace of A? 
(f) What is the general solution to Ax = 0?
Chapter 3 
Orthogonality 
3.1 Orthogonal Vectors and Subspaces 
A basis is a set of independent vectors that span a space. Geometrically, it is a set of 
coordinate axes. A vector space is defined without those axes, but every time I think of 
the x-y plane or three-dimensional space or Rn, the axes are there. They are usually perpendicular! 
The coordinate axes that the imagination constructs are practically always 
orthogonal. In choosing a basis, we tend to choose an orthogonal basis. 
The idea of an orthogonal basis is one of the foundations of linear algebra. We need 
a basis to convert geometric constructions into algebraic calculations, and we need an 
orthogonal basis to make those calculations simple. A further specialization makes the 
basis just about optimal: The vectors should have length 1. For an orthonormal basis 
(orthogonal unit vectors), we will find 
1. the length kxk of a vector; 
2. the test xTy = 0 for perpendicular vectors; and 
3. how to create perpendicular vectors from linearly independent vectors. 
More than just vectors, subspaces can also be perpendicular. We will discover, so 
beautifully and simply that it will be a delight to see, that the fundamental subspaces 
meet at right angles. Those four subspaces are perpendicular in pairs, two in Rm and 
two in Rn. That will complete the fundamental theorem of linear algebra. 
The first step is to find the length of a vector. It is denoted by kxk, and in two 
dimensions it comes from the hypotenuse of a right triangle (Figure 3.1a). The square 
of the length was given a long time ago by Pythagoras: kxk2 = x2
1+x2
2. 
In three-dimensional space, x = (x1;x2;x3) is the diagonal of a box (Figure 3.1b). Its 
length comes from two applications of the Pythagorean formula. The two-dimensional 
case takes care of (x1;x2;0) = (1;2;0) across the base. This forms a right angle with the 
vertical side (0;0;x3)= (0;0;3). The hypotenuse of the bold triangle (Pythagoras again)
160 Chapter 3 Orthogonality 
b 
1 
2 
p5 
(1, 0) 
(0, 2) 
(1, 2) 
kxk
2 = x2
1 + x2
2 + x2
3 
5 = 12 + 22 
14 = 12 + 22 + 32 
(a) (b) 
x 
(0, 0, 3) 
(1, 2, 3) has length 
p
14 
(1, 0, 0) 
(0, 2, 0) 
(1, 2, 0) has length 
p
5 
Figure 3.1: The length of vectors (x1;x2) and (x1;x2;x3). 
is the length kxk we want: 
Length in 3D kxk2 = 12+22+32 and kxk =
q
x2
1+x2
2+x2
3: 
The extension to x = (x1; : : : ;xn) in n dimensions is immediate. By Pythagoras n.1 
times, the length kxk in Rn is the positive square root of xTx: 
Length squared kxk2 = x2
1+x2
2+. . .+x2
n = xTx: (1) 
The sum of squares matches xTx—and the length of x = (1;2;.3) is 
p
14: 
xTx = 
h
1 2 .3
i
2
64
1
2 
.3
3
75
= 12+22+(.3)2 = 14: 
Orthogonal Vectors 
How can we decide whether two vectors x and y are perpendicular? What is the test 
for orthogonality in Figure 3.2? In the plane spanned by x and y, those vectors are 
orthogonal provided they form a right triangle. We go back to a2+b2 = c2: 
Sides of a right triangle kxk2+kyk2 = kx.yk2: (2) 
Applying the length formula (1), this test for orthogonality in Rn becomes 
.
x2
1+. . .+x2
n
.
+
.
y21
+. . .+y2n
. 
= (x1.y1)2+. . .+(xn.yn)2: 
The right-hand side has an extra .2xiyi from each (xi.yi)2: 
right-hand side = 
.
x2
1+. . .+x2
n
.
.2(x1y1+. . .+xnyn)+
.
y21
+. . .+y2n
.
:
3.1 Orthogonal Vectors and Subspaces 161 
y = .1 
2 
 x = 4
2
 
p
25 
p
20 
p
5 
xTy = 0 
b 
Right angle 
xTy = 0 
greater than 90° 
xTy < 0 
less than 90° 
xTy > 0 
Figure 3.2: A right triangle with 5+20 = 25. Dotted angle 100°, dashed angle 30°. 
We have a right triangle when that sum of cross-product terms xiyi is zero: 
Orthogonal vectors xTy = x1y1+. . .+xnyn = 0: (3) 
This sum is xTy = axiyi = yTx, the row vector xT times the column vector y: 
Inner product xTy = 
h
x1 . . . xn
i
2
64
y1
... 
yn
3
75
= x1y1+. . .+xnyn: (4) 
This number is sometimes called the scalar product or dot product, and denoted by (x;y) 
or x . y. We will use the name inner product and keep the notation xTy. 
3A The inner product xTy is zero if and only if x and y are orthogonal vectors. 
If xTy > 0, their angle is less than 90°. If xTy < 0, their angle is greater than 
90°. 
The length squared is the inner product of x with itself: xTx = x2
1+. . .+x2
n = kxk2. The 
only vector with length zero—the only vector orthogonal to itself—is the zero vector. 
This vector x = 0 is orthogonal to every vector in Rn. 
Example 1. (2;2;.1) is orthogonal to (.1;2;2). Both have length 
p
4+4+1 = 3. 
Useful fact: If nonzero vectors v1; : : : ;vk are mutually orthogonal (every vector is 
perpendicular to every other), then those vectors are linearly independent. 
Proof. Suppose c1v1 +. . .+ckvk = 0. To show that c1 must be zero, take the inner 
product of both sides with v1. Orthogonality of the v’s leaves only one term: 
vT1
(c1v1+. . .+ckvk) = c1vT1
v1 = 0: (5) 
The vectors are nonzero, so vT1
v1 6= 0 and therefore c1 = 0. The same is true of every ci. 
The only combination of the v’s producing zero has all ci = 0: independence! 
The coordinate vectors e1; : : : ;en in Rn are the most important orthogonal vectors. 
Those are the columns of the identity matrix. They form the simplest basis for Rn, and
162 Chapter 3 Orthogonality 
they are unit vectors—each has length keik=1. They point along the coordinate axes. If 
these axes are rotated, the result is a new orthonormal basis: a new system of mutually 
orthogonal unit vectors. In R2 we have cos2q +sin2q = 1: 
Orthonormal vectors in R2 v1 = (cosq ; sinq ) and v2 = (.sinq ;cosq ): 
Orthogonal Subspaces 
We come to the orthogonality of two subspaces. Every vector in one subspace must be 
orthogonal to every vector in the other subspace. Subspaces of R3 can have dimension 
0, 1, 2, or 3. The subspaces are represented by lines or planes through the origin— 
and in the extreme cases, by the origin alone or the whole space. The subspace f0g 
is orthogonal to all subspaces. A line can be orthogonal to another line, or it can be 
orthogonal to a plane, but a plane cannot be orthogonal to a plane. 
I have to admit that the front wall and side wall of a room look like perpendicular 
planes in R3. But by our definition, that is not so! There are lines v and w in the front 
and side walls that do not meet at a right angle. The line along the corner is in both 
walls, and it is certainly not orthogonal to itself. 
3B Two subspaces V and W of the same space Rn are orthogonal if every 
vector v in V is orthogonal to every vector w in W: vTw = 0 for all v and w. 
Example 2. Suppose V is the plane spanned by v1 = (1;0;0;0) and v2 = (1;1;0;0). If 
W is the line spanned by w = (0;0;4;5), then w is orthogonal to both v’s. The line W 
will be orthogonal to the whole plane V. 
In this case, with subspaces of dimension 2 and 1 in R4, there is room for a third 
subspace. The line L through z = (0;0;5;.4) is perpendicular to V and W. Then the 
dimensions add to 2+1+1 = 4. What space is perpendicular to all of V, W, and L? 
The important orthogonal subspaces don’t come by accident, and they come two at 
a time. In fact orthogonal subspaces are unavoidable: They are the fundamental subspaces! 
The first pair is the nullspace and row space. Those are subspaces of Rn—the 
rows have n components and so does the vector x in Ax = 0. We have to show, using 
Ax = 0, that the rows of A are orthogonal to the nullspace vector x. 
3C Fundamental theorem of orthogonality The row space is orthogonal 
to the nullspace (in Rn). The column space is orthogonal to the left nullspace 
(in Rm). 
First Proof. Suppose x is a vector in the nullspace. Then Ax = 0, and this system of m
3.1 Orthogonal Vectors and Subspaces 163 
equations can be written out as rows of A multiplying x: 
Every row is 
orthogonal to x 
Ax = 
2
6664 
. . . row 1 . . . 
. . . row 2 . . . 
... 
... 
... 
. . . row m . . .
3
7775 
2
6664 
x1 
x2
... 
xn
3
7775
= 
2
6664 
0
0... 
0
3
7775
: (6) 
The main point is already in the first equation: row 1 is orthogonal to x. Their inner 
product is zero; that is equation 1. Every right-hand side is zero, so x is orthogonal to 
every row. Therefore x is orthogonal to every combination of the rows. Each x in the 
nullspace is orthogonal to each vector in the row space, so N(A)?C(AT). 
The other pair of orthogonal subspaces comes from ATy = 0, or yTA = 0: 
yTA = 
h
y1 . . . ym
i
2
6666664 
c c 
o o 
l l 
u . . . u 
m m 
n n 
1 n
3
7777775 
= 
h
0 . . . 0
i
: (7) 
The vector y is orthogonal to every column. The equation says so, from the zeros on 
the right-hand side. Therefore y is orthogonal to every combination of the columns. 
It is orthogonal to the column space, and it is a typical vector in the left nullspace: 
N(AT)?C(A). This is the same as the first half of the theorem, with A replaced by 
AT. 
Second Proof. The contrast with this “coordinate-free proof” should be useful to the 
reader. It shows a more “abstract” method of reasoning. I wish I knew which proof is 
clearer, and more permanently understood. 
If x is in the nullspace then Ax = 0. If v is in the row space, it is a combination of the 
rows: v = ATz for some vector z. Now, in one line: 
Nullspace ? Row space vTx = (ATz)Tx = zTAx = zT0 = 0: (8) 
Example 3. Suppose A has rank 1, so its row space and column space are lines: 
Rank-1 matrix A = 
2
64
1 3 
2 6 
3 9
3
75
: 
The rows are multiples of (1;3). The nullspace contains x=(.3;1), which is orthogonal 
to all the rows. The nullspace and row space are perpendicular lines in R2: 
h
1 3
i" 
3 
.1
# 
= 0 and 
h
2 6
i" 
3 
.1
# 
= 0 and 
h
3 9
i" 
3 
.1
# 
= 0:
164 Chapter 3 Orthogonality 
In contrast, the other two subspaces are in R3. The column space is the line through 
(1;2;3). The left nullspace must be the perpendicular plane y1 +2y2 +3y3 = 0. That 
equation is exactly the content of yTA = 0. 
The first two subspaces (the two lines) had dimensions 1+1 = 2 in the space R2. The 
second pair (line and plane) had dimensions 1+2 = 3 in the space R3. In general, the 
row space and nullspace have dimensions that add to r+(n.r) = n. The other pair 
adds to r+(m.r) = m. Something more than orthogonality is occurring, and I have to 
ask your patience about that one further point: the dimensions. 
It is certainly true that the null space is perpendicular to the row space—but it is not 
the whole truth. N(A) contains every vector orthogonal to the row space. The nullspace 
was formed from all solutions to Ax = 0. 
Definition. Given a subspace V of Rn, the space of all vectors orthogonal to V is called 
the orthogonal complement of V. It is denoted by V? = “V perp.” 
Using this terminology, the nullspace is the orthogonal complement of the row space: 
N(A) = (C(AT))?. At the same time, the row space contains all vectors that are orthogonal 
to the nullspace. A vector z can’t be orthogonal to the nullspace but outside the row 
space. Adding z as an extra row of A would enlarge the row space, but we know that 
there is a fixed formula r+(n.r) = n: 
Dimension formula dim(row space)+dim(nullspace) = number of columns. 
Every vector orthogonal to the nullspace is in the row space: C(AT) = (N(A))?. 
The same reasoning applied to AT produces the dual result: The left nullspace N(AT) 
and the column space C(A) are orthogonal complements. Their dimensions add up to 
(m.r)+r = m, This completes the second half of the fundamental theorem of linear 
algebra. The first half gave the dimensions of the four subspaces. including the fact that 
row rank = column rank. Now we know that those subspaces are perpendicular. More 
than that, the subspaces are orthogonal complements. 
3D Fundamental Theorem of Linear Algebra, Part II 
The nullspace is the orthogonal complement of the row space in Rn. 
The left nullspace is the orthogonal complement of the column space in Rm. 
To repeat, the row space contains everything orthogonal to the nullspace. The column 
space contains everything orthogonal to the left nullspace. That is just a sentence, hidden 
in the middle of the book, but it decides exactly which equations can be solved! Looked 
at directly, Ax = b requires b to be in the column space. Looked at indirectly. Ax = b 
requires b to be perpendicular to the left nullspace. 
3E Ax = b is solvable if and only if yTb = 0 whenever yTA = 0.
3.1 Orthogonal Vectors and Subspaces 165 
The direct approach was “b must be a combination of the columns.” The indirect approach 
is “b must be orthogonal to every vector that is orthogonal to the columns.” That 
doesn’t sound like an improvement (to put it mildly). But if only one or two vectors 
are orthogonal to the columns. it is much easier to check those one or two conditions 
yTb = 0. A good example is Kirchhoff’s Voltage Law in Section 2.5. Testing for zero 
around loops is much easier than recognizing combinations of the columns. 
When the left-hand sides of Ax = b add to zero, the right-hand sides must, too: 
x1.x2 = b1 
x2.x3 = b2 
x3.x1 = b3 
is solvable if and only if b1+b2+b3 = 0: Here A = 
2
64
1 .1 0 
0 1 .1 
.1 0 1 
3
75
: 
This test b1 +b2 +b3 = 0 makes b orthogonal to y = (1;1;1) in the left nullspace. By 
the Fundamental Theorem, b is a combination of the columns! 
The Matrix and the Subspaces 
We emphasize that V and W can be orthogonal without being complements. Their 
dimensions can be too small. The line V spanned by (0;1;0) is orthogonal to the line 
W spanned by (0;0;1), but V is not W?. The orthogonal complement of W is a twodimensional 
plane, and the line is only part of W?. When the dimensions are right, 
orthogonal subspaces are necessarily orthogonal complements: 
If W= V? then V =W? and dimV+dimW= n: 
In other words V?? = V. The dimensions of V and W are right, and the whole space 
Rn is being decomposed into two perpendicular parts (Figure 3.3). 
W 
V 
Two orthogonal axes in R3 
Not orthogonal complements 
W 
V 
Line W perpendicular to plane V 
Orthogonal complements V =W? 
Figure 3.3: Orthogonal complements in R3: a plane and a line (not two lines). 
Splitting Rn into orthogonal parts will split every vector into x = v+w. The vector v 
is the projection onto the subspace V. The orthogonal component w is the projection of 
x onto W. The next sections show how to find those projections of x. They lead to what 
is probably the most important figure in the book (Figure 3.4). 
Figure 3.4 summarizes the fundamental theorem of linear algebra. It illustrates the 
true effect of a matrix—what is happening inside the multiplication Ax. The nullspace
166 Chapter 3 Orthogonality 
Figure 3.4: The true action Ax = A(xrow+xnull) of any m by n matrix. 
is carried to the zero vector. Every Ax is in the column space. Nothing is carried to the 
left nullspace. The real action is between the row space and column space, and you see 
it by looking at a typical vector x. It has a “row space component” and a “nullspace 
component,” with x = xr+xn. When multiplied by A, this is Ax = Axr+Axn: 
The nullspace component goes to zero: Axn = 0. 
The row space component goes to the column space: Axr = Ax. 
Of course everything goes to the column space—the matrix cannot do anything else. I 
tried to make the row and column spaces the same size, with equal dimension r. 
3F From the row space to the column space, A is actually invertible. Every 
vector b in the column space comes from exactly one vector xr in the row 
space. 
Proof. Every b in the column space is a combination Ax of the columns. In fact, b is 
Axr, with xr in the row space, since the nullspace component gives Axn = 0, If another 
vector x0r
in the row space gives Ax0r
= b, then A(xr .x0r
) = b.b = 0. This puts xr .x0r 
in the nullspace and the row space, which makes it orthogonal to itself. Therefore it is 
zero, and xr.x0r
. Exactly one vector in the row space is carried to b. 
Every matrix transforms its row space onto its column space. 
On those r-dimensional spaces A is invertible. On its nullspace A is zero. When A is 
diagonal, you see the invertible submatrix holding the r nonzeros. 
AT goes in the opposite direction, from Rm to Rn and from C(A) back to C(AT). 
Of course the transpose is not the inverse! AT moves the spaces correctly, but not the
3.1 Orthogonal Vectors and Subspaces 167 
individual vectors. That honor belongs to A.1 if it exists—and it only exists if r =m=n. 
We cannot ask A.1 to bring back a whole nullspace out of the zero vector. 
When A.1 fails to exist, the best substitute is the pseudoinverse A+. This inverts A 
where that is possible: A+Ax = x for x in the row space. On the left nullspace, nothing 
can be done: A+y = 0. Thus A+ inverts A where it is invertible, and has the same rank r. 
One formula for A+ depends on the singular value decomposition—for which we first 
need to know about eigenvalues. 
Problem Set 3.1 
1. Find the lengths and the inner product of x = (1;4;0;2) and y = (2;.2;1;3). 
2. Give an example in R2 of linearly independent vectors that are not orthogonal. Also, 
give an example of orthogonal vectors that are not independent. 
3. Two lines in the plane are perpendicular when the product of their slopes is .1. 
Apply this to the vectors x = (x1;x2) and y = (y1;y2), whose slopes are x2=x1 and 
y2=y1, to derive again the orthogonality condition xTy = 0. 
4. How do we know that the ith row of an invertible matrix B is orthogonal to the jth 
column of B.1, if i 6= j? 
5. Which pairs are orthogonal among the vectors v1, v2, v3, v4? 
v1 = 
2
6664 
1
2 
.2 
1 
3
7775
; v2 = 
2
6664 
4
0
4
0
3
7775
; v3 = 
2
6664 
1 
.1 
.1 
.1
3
7775
; v4 = 
2
6664 
1
1
1
1
3
7775
: 
6. Find all vectors in R3 that are orthogonal to (1;1;1) and (1;.1;0). Produce an 
orthonormal basis from these vectors (mutually orthogonal unit vectors). 
7. Find a vector x orthogonal to the row space of A, and a vector y orthogonal to the 
column space, and a vector z orthogonal to the nullspace: 
A = 
2
64
1 2 1 
2 4 3 
3 6 4
3
75
: 
8. If V andWare orthogonal subspaces, show that the only vector they have in common 
is the zero vector: V\W= f0g. 
9. Find the orthogonal complement of the plane spanned by the vectors (1;1;2) and 
(1;2;3), by taking these to be the rows of A and solving Ax = 0. Remember that the 
complement is a whole line.
168 Chapter 3 Orthogonality 
10. Construct a homogeneous equation in three unknowns whose solutions are the linear 
combinations of the vectors (1;1;2) and (1;2;3). This is the reverse of the previous 
exercise, but the two problems are really the same. 
11. The fundamental theorem is often stated in the form of Fredholm’s alternative: For 
any A and b, one and only one of the following systems has a solution: 
(i) Ax = b. 
(ii) ATy = 0, yTb 6= 0. 
Either b is in the column space C(A) or there is a y in N(AT) such that yTb 6= 0. 
Show that it is contradictory for (i) and (ii) both to have solutions. 
12. Find a basis for the orthogonal complement of the row space of A: 
A = 
"
1 0 2 
1 1 4
#
: 
Split x = (3;3;3) into a row space component xr and a nullspace component xn. 
13. Illustrate the action of AT by a picture corresponding to Figure 3.4, sending C(A) 
back to the row space and the left nullspace to zero. 
14. Show that x.y is orthogonal to x+y if and only if kxk = kyk. 
15. Find a matrix whose row space contains (1;2;1) and whose nullspace contains (1;.2;1), 
or prove that there is no such matrix. 
16. Find all vectors that are perpendicular to (1;4;4;1) and (2;9;8;2). 
17. If V is the orthogonal complement of W in Rn, is there a matrix with row space V 
and nullspace W? Starting with a basis for V, construct such a matrix. 
18. If S = f0g is the subspace of R4 containing only the zero vector, what is S?? If S is 
spanned by (0;0;0;1), what is S?? What is (S?)?? 
19. Why are these statements false? 
(a) If V is orthogonal to W, then V? is orthogonal to W?. 
(b) V orthogonal to W and W orthogonal to Z makes V orthogonal to Z. 
20. Let S be a subspace of Rn. Explain what (S?)? = S means and why it is true. 
21. Let P be the plane in R2 with equation x+2y.z = 0. Find a vector perpendicular 
to P. What matrix has the plane P as its nullspace, and what matrix has P as its row 
space? 
22. Let S be the subspace of R4 containing all vectors with x1+x2+x3+x4 = 0. Find a 
basis for the space S?, containing all vectors orthogonal to S.
3.1 Orthogonal Vectors and Subspaces 169 
23. Construct an unsymmetric 2 by 2 matrix of rank 1. Copy Figure 3.4 and put one 
vector in each subspace. Which vectors are orthogonal? 
24. Redraw Figure 3.4 for a 3 by 2 matrix of rank r = 2. Which subspace is Z (zero 
vector only)? The nullspace part of any vector x in R2 is xn = . 
25. Construct a matrix with the required property or say why that is impossible. 
(a) Column space contains 
h 12 
.3
i 
and 
h 2 
.3 
5 
i
, nullspace contains 
h111 
i
. 
(b) Row space contains 
h 12 
.3
i 
and 
h 2 
.3 
5 
i
, nullspace contains 
h111 
i
. 
(c) Ax = 
h111 
i 
has a solution and AT 
h100 
i 
= 
h000 
i
: 
(d) Every row is orthogonal to every column (A is not the zero matrix). 
(e) The columns add up to a column of 0s, the rows add to a row of 1s. 
26. If AB = 0 then the columns of B are in the of A. The rows of A are in the 
of B. Why can’t A and B be 3 by 3 matrices of rank 2? 
27. (a) If Ax = b has a solution and ATy = 0, then y is perpendicular to . 
(b) If ATy = c has a solution and Ax = 0, then x is perpendicular to . 
28. This is a system of equations Ax = b with no solution: 
x+2y+2z = 5 
2x+2y+3z = 5 
3x+4y+5z = 9: 
Find numbers y1, y2, y3 to multiply the equations so they add to 0 = 1. You have 
found a vector y in which subspace? The inner product yTb is 1. 
29. In Figure 3.4, how do we know that Axr is equal to Ax? How do we know that this 
vector is in the column space? If A = 
. 
1 1 
1 1 
¤ 
and x = 
.10
¤ 
what is xr? 
30. If Ax is in the nullspace of AT then Ax = 0. Reason: Ax is also in the of A and 
the spaces are . Conclusion: ATA has the same nullspace as A. 
31. Suppose A is a symmetric matrix (AT = A). 
(a) Why is its column space perpendicular to its nullspace? 
(b) If Ax = 0 and Az = 5z, which subspaces contain these “eigenvectors” x and z? 
Symmetric matrices have perpendicular eigenvectors (see Section 5.5). 
32. (Recommended) Draw Figure 3.4 to show each subspace for 
A = 
"
1 2 
3 6
# 
and B = 
"
1 0 
3 0
#
:
170 Chapter 3 Orthogonality 
33. Find the pieces xr and xn, and draw Figure 3.4 properly, if 
A = 
2
64
1 .1 
0 0 
0 0 
3
75
and x = 
"
2
0
#
: 
Problems 34–44 are about orthogonal subspaces. 
34. Put bases for the orthogonal subspaces V andWinto the columns of matrices V and 
W. Why does VTW = zero matrix? This matches vTw = 0 for vectors. 
35. The floor and the wall are not orthogonal subspaces because they share a nonzero 
vector (along the line where they meet). Two planes in R3 cannot be orthogonal! 
Find a vector in both column spaces C(A) and C(B): 
A = 
2
64
1 2 
1 3 
1 2
3
75
and B = 
2
64
5 4 
6 3 
5 1
3
75
: 
This will be a vector Ax and also Bbx. Think 3 by 4 with the matrix [A B]. 
36. Extend Problem 35 to a p-dimensional subspace V and a q-dimensional subspaceW 
of Rn. What inequality on p+q guarantees that V intersectsWin a nonzero vector? 
These subspaces cannot be orthogonal. 
37. Prove that every y in N(AT) is perpendicular to every Ax in the column space, using 
the matrix shorthand of equation (8). Start from ATy = 0. 
38. If S is the subspace of R3 containing only the zero vector, what is S?? If S is spanned 
by (1;1;1), what is S?? If S is spanned by (2;0;0) and (0;0;3), what is S?? 
39. Suppose S only contains (1;5;1) and (2;2;2) (not a subspace). Then S? is the 
nullspace of the matrix A = . S? is a subspace even if S is not. 
40. Suppose L is a one-dimensional subspace (a line) in R3. Its orthogonal complement 
L? is the perpendicular to L. Then (L?)? is a perpendicular to L?. In 
fact (L?)? is the same as . 
41. Suppose V is the whole space R4. Then V? contains only the vector . Then 
(V?)? is . So (V?)? is the same as . 
42. Suppose S is spanned by the vectors (1;2;2;3) and (1;3;3;2). Find two vectors that 
span S?. This is the same as solving Ax = 0 for which A? 
43. If P is the plane of vectors in R4 satisfying x1 +x2 +x3 +x4 = 0, write a basis for 
P?. Construct a matrix that has P as its nullspace. 
44. If a subspace S is contained in a subspace V, prove that S? contains V?. 
Problems 45–50 are about perpendicular columns and rows.
3.2 Cosines and Projections onto Lines 171 
45. Suppose an n by n matrix is invertible: AA.1 = I. Then the first column of A.1 is 
orthogonal to the space spanned by which rows of A? 
46. Find ATA if the columns of A are unit vectors, all mutually perpendicular. 
47. Construct a 3 by 3 matrix A with no zero entries whose columns are mutually perpendicular. 
Compute ATA. Why is it a diagonal matrix? 
48. The lines 3x+y = b1 and 6x+2y = b2 are . They are the same line if . In 
that case (b1;b2) is perpendicular to the vector . The nullspace of the matrix is 
the line 3x+y = . One particular vector in that nullspace is . 
49. Why is each of these statements false? 
(a) (1;1;1) is perpendicular to (1;1;.2), so the planes x+y+z=0 and x+y.2z= 
0 are orthogonal subspaces. 
(b) The subspace spanned by (1;1;0;0;0) and (0;0;0;1;1) is the orthogonal complement 
of the subspace spanned by (1;.1;0;0;0) and (2;.2;3;4;.4). 
(c) Two subspaces that meet only in the zero vector are orthogonal. 
50. Find a matrix with v = (1;2;3) in the row space and column space. Find another 
matrix with v in the nullspace and column space. Which pairs of subspaces can v not 
be in? 
51. Suppose A is 3 by 4, B is 4 by 5, and AB = 0. Prove rank(A)+rank(B) · 4. 
52. The command N = null(A) will produce a basis for the nullspace of A. Then the 
command B = null(N’) will produce a basis for the of A. 
3.2 Cosines and Projections onto Lines 
Vectors with xTy = 0 are orthogonal. Now we allow inner products that are not zero, 
and angles that are not right angles. We want to connect inner products to angles, and 
also to transposes. In Chapter 1 the transpose was constructed by flipping over a matrix 
as if it were some kind of pancake. We have to do better than that. 
One fact is unavoidable: The orthogonal case is the most important. Suppose we 
want to find the distance from a point b to the line in the direction of the vector a. We 
are looking along that line for the point p closest to b. The key is in the geometry: The 
line connecting b to p (the dotted line in Figure 3.5) is perpendicular to a. This fact will 
allow us to find the projection p. Even though a and b are not orthogonal, the distance 
problem automatically brings in orthogonality. 
The situation is the same when we are given a plane (or any subspace S) instead of a 
line. Again the problem is to find the point p on that subspace that is closest to b. This
172 Chapter 3 Orthogonality 
b 
b 
e = b . p a 
 p = 
projection of b 
onto line through a 
Figure 3.5: The projection p is the point (on the line through a) closest to b. 
point p is the projection of b onto the subspace. A perpendicular line from b to S meets 
the subspace at p. Geometrically, that gives the distance between points b and subspaces 
S. But there are two questions that need to be asked: 
1. Does this projection actually arise in practical applications? 
2. If we have a basis for the subspace S, is there a formula for the projection p? 
The answers are certainly yes. This is exactly the problem of the least-squares solution 
to an overdetermined system. The vector b represents the data from experiments 
or questionnaires, and it contains too many errors to be found in the subspace S. When 
we try to write b as a combination of the basis vectors for S, it cannot be done—the 
equations are inconsistent, and Ax = b has no solution. 
The least-squares method selects p as the best choice to replace b. There can be no 
doubt of the importance of this application. In economics and statistics, least squares 
enters regression analysis. In geodesy, the U.S. mapping survey tackled 2.5 million 
equations in 400,000 unknowns. 
A formula for p is easy when the subspace is a line. We will project b onto a in several 
different ways, and relate the projection p to inner products and angles. Projection onto a 
higher dimensional subspace is by far the most important case; it corresponds to a leastsquares 
problem with several parameters, and it is solved in Section 3.3. The formulas 
are even simpler when we produce an orthogonal basis for S. 
inner products and cosines 
We pick up the discussion of inner products and angles. You will soon see that it is not 
the angle, but the cosine of the angle, that is directly related to inner products. We look 
back to trigonometry in the two-dimensional case to find that relationship. Suppose the 
vectors a and b make angles a and b with the x-axis (Figure 3.6). The length kak is the 
hypotenuse in the triangle OaQ. So the sine and cosine of a are 
sina = 
a2 
kak
; cosa = 
a1 
kak
:
3.2 Cosines and Projections onto Lines 173 
b  
cos  
sin 
 
1
0
 
u 
· 
i = cos  
b 
 
  
O 
x 
y 
kbk 
kak 
kb . ak 
b = (b1, b2) 
a = (a1, a2) 
Q 
Figure 3.6: The cosine of the angle q =b .a using inner products. 
For the angle b , the sine is b2=kbk and the cosine is b1=kbk . The cosine of q =b .a 
comes from an identity that no one could forget: 
Cosine formula cosq = cosb cosa +sinb sina = 
a1b1+a2b2 
kakkbk 
: (1) 
The numerator in this formula is exactly the inner product of a and b. It gives the 
relationship between aTb and cosq : 
3G The cosine of the angle between any nonzero vectors a and b is 
Cosine of q cosq = 
aTb 
kakkbk
: (2) 
This formula is dimensionally correct; if we double the length of b, then both numerator 
and denominator are doubled, and the cosine is unchanged. Reversing the sign of b, on 
the other hand, reverses the sign of cosq —and changes the angle by 180°. 
There is another law of trigonometry that leads directly to the same result. It is not so 
unforgettable as the formula in equation (1), but it relates the lengths of the sides of any 
triangle: 
Law of Cosines kb.ak2 = kbk2+kak2.2kbkkakcosq : (3) 
When q is a right angle, we are back to Pythagoras: kb.ak2 = kbk2+kak2. For any 
angle q , the expression kb.ak2 is (b.a)T(b.a), and equation (3) becomes 
bTb.2aTb+aTa = bTb+aTa.2kbkkakcosq : 
Canceling bTb and aTa on both sides of this equation, you recognize formula (2) for the 
cosine: aTb = kakkbkcosq . In fact, this proves the cosine formula in n dimensions, 
since we only have to worry about the plane triangle Oab. 
Projection onto a Line 
Now we want to find the projection point p. This point must be some multiple p = bxa of 
the given vector a—every point on the line is a multiple of a. The problem is to compute
174 Chapter 3 Orthogonality 
b 
b 
e = b . p a 
 
p = 
b
xa = 
aTb 
aTa
a 
Figure 3.7: The projection p of b onto a, with cosq = 
Op 
Ob 
= 
aTb 
kakkbk
. 
the coefficient bx. All we need is the geometrical fact that the line from b to the closest 
point p = bxa is perpendicular to the vector a: 
(b.ba)?a; or aT(b.ba) = 0; or bx = 
aTb 
aTa
: (4) 
That gives the formula for the number bx and the projection p: 
3H The projection of the vector b onto the line in the direction of a is p = bxa: 
Projection onto a line p = bxa = 
aTb 
aTa
a: (5) 
This allows us to redraw Figure 3.5 with a correct formula for p (Figure 3.7). 
This leads to the Schwarz inequality in equation (6), which is the most important 
inequality in mathematics. A special case is the fact that arithmetic means 12
(x+y) are 
larger than geometric means 
p
xy. (It is also equivalent—see Problem 1 at the end of 
this section—to the triangle inequality for vectors.) The Schwarz inequality seems to 
come almost accidentally from the statement that kek2 = kb. pk2 in Figure 3.7 cannot 
be negative: 
°°°°
b. 
aTb 
aTa
a
°°°° 
2 
= bTb.2
(aTb)2 
aTa 
+
µ
aTb 
aTa
¶2 
aTa = 
(bTb)(aTa).(aTb)2 
(aTa) 
. 0: 
This tells us that (bTb)(aTa) . (aTb)2—and then we take square roots: 
3I All vectors a and b satisfy the Schwarz inequality, which is jcosq j · 1 in 
Rn: 
Schwarz inequality jaTbj · kakkbk: (6) 
According to formula (2), the ratio between aTb and kakkbk is exactly jcosq j. Since 
all cosines lie in the interval .1 · cosq · 1, this gives another proof of equation (6): 
the Schwarz inequality is the same as jcosq j · 1. In some ways that is a more easily 
understood proof, because cosines are so familiar. Either proof is all right in Rn, but
3.2 Cosines and Projections onto Lines 175 
notice that ours came directly from the calculation of kb. pk2. This stays nonnegative 
when we introduce new possibilities for the lengths and inner products. The name of 
Cauchy is also attached to this inequality jaTbj · kakkbk, and the Russians refer to it as 
the Cauchy-Schwarz-Buniakowsky inequality! Mathematical historians seem to agree 
that Buniakowsky’s claim is genuine. 
One final observation about jaTbj · kakkbk. Equality holds if and only if b is a 
multiple of a. The angle is q = 0° or q = 180° and the cosine is 1 or .1. In this case b 
is identical with its projection p, and the distance between b and the line is zero. 
Example 1. Project b = (1;2;3) onto the line through a = (1;1;1) to get bx and p: 
bx = 
aTb 
aTa 
= 
6
3 
= 2: 
The projection is p = bxa = (2;2;2). The angle between a and b has 
cosq = 
kpk 
kbk 
= 
p
12 
p
14 
and also cosq = 
aTb 
kakkbk 
= 
6 
p
3
p
14
: 
The Schwarz inequality jaTbj · kakkbk is 6 ·
p
3
p
14. If we write 6 as 
p
36, that is the 
same as 
p
36 · 
p
42. The cosine is less than 1, because b is not parallel to a. 
Projection Matrix of Rank 1 
The projection of b onto the line through a lies at p = a(aTb=aTa). That is our formula 
p = bxa, but it is written with a slight twist: The vector a is put before the number 
bx = aTb=aTa. There is a reason behind that apparently trivial change. Projection onto 
a line is carried out by a projection matrix P, and written in this new order we can see 
what it is. P is the matrix that multiplies b and produces p: 
P = a
aTb 
aTa 
so the projection matrix is P = 
aaT 
aTa
: (7) 
That is a column times a row—a square matrix—divided by the number aTa. 
Example 2. The matrix that projects onto the line through a = (1;1;1) is 
P = 
aaT 
aTa 
= 
1
3 
2
64
1
1
1
3
75
h
1 1 1
i 
= 
2
64 
13 
13 
13
13 
13 
13
13 
13 
13 
3
75
: 
This matrix has two properties that we will see as typical of projections: 
1. P is a symmetric matrix. 
2. Its square is itself: P2 = P. 
P2b is the projection of Pb—and Pb is already on the line! So P2b = Pb. This matrix P 
also gives a great example of the four fundamental subspaces:
176 Chapter 3 Orthogonality 
The column space consists of the line through a = (1;1;1). 
The nullspace consists of the plane perpendicular to a. 
The rank is r = 1. 
Every column is a multiple of a, and so is Pb = bxa. The vectors that project to p = 0 
are especially important. They satisfy aTb = 0—they are perpendicular to a and their 
component along the line is zero. They lie in the nullspace = perpendicular plane. 
Actually that example is too perfect. It has the nullspace orthogonal to the column 
space, which is haywire. The nullspace should be orthogonal to the row space. But 
because P is symmetric, its row and column spaces are the same. 
Remark on scaling The projection matrix aaT=aTa is the same if a is doubled: 
a = 
2
64
2
2
2
3
75
gives P = 
1 
12 
2
64
2
2
2
3
75
h
2 2 2
i 
= 
2
64 
13 
13 
13
13 
13 
13
13 
13 
13 
3
75
as before. 
The line through a is the same, and that’s all the projection matrix cares about. If a has 
unit length, the denominator is aTa = 1 and the matrix is just P = aaT. 
Example 3. Project onto the “q -direction” in the x-y plane. The line goes through 
a = (cosq ; sinq ) and the matrix is symmetric with P2 = P: 
P = 
aaT 
aTa 
= 
"
c
s
#h
c s
i 
h
c s
i"
c
s
# = 
"
c2 cs 
cs s2
#
: 
Here c is cosq , s is sinq , and c2 +s2 = 1 in the denominator. This matrix P was discovered 
in Section 2.6 on linear transformations. Now we know P in any number of 
dimensions. We emphasize that it produces the projection p: 
To project b onto a, multiply by the projection matrix P: p = Pb. 
Transposes from Inner Products 
Finally we connect inner products to AT. Up to now, AT is simply the reflection of A 
across its main diagonal; the rows of A become the columns of AT, and vice versa. The 
entry in row i, column j of AT is the ( j; i) entry of A: 
Transpose by reflection ATi
j = (A) ji: 
There is a deeper significance to AT, Its close connection to inner products gives a new 
and much more “abstract” definition of the transpose:
3.2 Cosines and Projections onto Lines 177 
3J The transpose AT can be defined by the following property: The inner 
product of Ax with y equals the inner product of x with ATy. Formally, this 
simply means that 
(Ax)Ty = xTATy = xT(ATy): (8) 
This definition gives us another (better) way to verify the formula (AB)T = BTAT, Use 
equation (8) twice: 
Move A then move B (ABx)Ty = (Bx)T(ATY) = xT(BTATy): 
The transposes turn up in reverse order on the right side, just as the inverses do in the 
formula (AB).1 = B.1A.1. We mention again that these two formulas meet to give the 
remarkable combination (A.1)T = (AT).1. 
Problem Set 3.2 
1. (a) Given any two positive numbers x and y, choose the vector b equal to (
p
x;
p
y), 
and choose a = (p
y;
p
x). Apply the Schwarz inequality to compare the arithmetic 
mean 12
(x+y) with the geometric mean 
p
xy. 
(b) Suppose we start with a vector from the origin to the point x, and then add a 
vector of length kyk connecting x to x+y. The third side of the triangle goes 
from the origin to x+y. The triangle inequality asserts that this distance cannot 
be greater than the sum of the first two: 
kx+yk · kxk+kyk: 
After squaring both sides, and expanding (x + y)T(x + y), reduce this to the 
Schwarz inequality. 
2. Verify that the length of the projection in Figure 3.7 is kpk=kbkcosq , using formula 
(5). 
3. What multiple of a = (1;1;1) is closest to the point b = (2;4;4)? Find also the point 
closest to a on the line through b. 
4. Explain why the Schwarz inequality becomes an equality in the case that a and b 
lie on the same line through the origin, and only in that case. What if they lie on 
opposite sides of the origin? 
5. In n dimensions, what angle does the vector (1;1; : : : ;1) make with the coordinate 
axes? What is the projection matrix P onto that vector? 
6. The Schwarz inequality has a one-line proof if a and b are normalized ahead of time 
to be unit vectors: 
jaTbj =
.. 
aajbj
..
·ajajjjbjj ·ajajj2+jbjj2 
2 
= 
1
2 
+ 
1
2 
= kakkbk:
178 Chapter 3 Orthogonality 
Which previous problem justifies the middle step? 
7. By choosing the correct vector b in the Schwarz inequality, prove that 
(a1+. . .+an)2 · n(a21
+. . .+a2n
): 
When does equality hold? 
8. The methane molecule CH4 is arranged as if the carbon atom were at the center of a 
regular tetrahedron with four hydrogen atoms at the vertices. If vertices are placed 
at (0;0;0), (1;1;0), (1;0;1), and (0;1;1)—note that all six edges have length 
p
2, 
so the tetrahedron is regular—what is the cosine of the angle between the rays going 
from the center (12
;12
;12
) to the vertices? (The bond angle itself is about 109.5°, an 
old friend of chemists.) 
9. Square the matrix P = aaT=aTa, which projects onto a line, and show that P2 = P. 
(Note the number aTa in the middle of the matrix aaTaaT!) 
10. Is the projection matrix P invertible? Why or why not? 
11. (a) Find the projection matrix P1 onto the line through a = [13
] and also the matrix P2 
that projects onto the line perpendicular to a. 
(b) Compute P1+P2 and P1P2 and explain. 
12. Find the matrix that projects every point in the plane onto the line x+2y = 0. 
13. Prove that the trace of P = aaT=aTa—which is the sum of its diagonal entries— 
always equals 1. 
14. What matrix P projects every point in R3 onto the line of intersection of the planes 
x+y+t = 0 and x.t = 0? 
15. Show that the length of Ax equals the length of ATx if AAT = ATA. 
16. Suppose P is the projection matrix onto the line through a. 
(a) Why is the inner product of x with Py equal to the inner product of Px with y? 
(b) Are the two angles the same? Find their cosines if a = (1;1;.1), x = (2;0;1), 
y = (2;1;2). 
(c) Why is the inner product of Px with Py again the same? What is the angle 
between those two? 
Problems 17–26 ask for projections onto lines. Also errors e = b. p and matrices 
P. 
17. Project the vector b onto the line through a. Check that e is perpendicular to a:
3.2 Cosines and Projections onto Lines 179 
(a) b = 
2
64
1
2
2
3
75
and a = 
2
64
1
1
1
3
75
: (b) b = 
2
64
1
3
1
3
75
and a = 
2
64
.1 
.3 
.1
3
75
: 
18. Draw the projection of b onto a and also compute it from p = bxa: 
(a) b = 
"
cosq 
sinq 
# 
and a = 
"
1
0
#
: (b) b = 
"
1
1
# 
and a = 
" 
1 
.1
#
: 
19. In Problem 17, find the projection matrix P = aaT=aTa onto the line through each 
vector a. Verify in both cases that P2 = P. Multiply Pb in each case to compute the 
projection p. 
20. Construct the projection matrices P1 and P2 onto the lines through the a’s in Problem 
18. Is it true that (P1+P2)2 = P1+P2? This would be true if P1P2 = 0. 
For Problems 21–26, consult the accompanying figures. 
21. Compute the projection matrices aaT=aTa onto the lines through a1 = (.1;2;2) and 
a2 = (2;2;.1), Multiply those projection matrices and explain why their product 
P1P2 is what it is. 
22. Project b = (1;0;0) onto the lines through a1 and a2 in Problem 21 and also onto 
a3 = (2;.1;2). Add the three projections p1+ p2+ p3. 
23. Continuing Problems 21–22, find the projection matrix P3 onto a3 = (2;.1;2). Verify 
that P1+P2+P3 = I. The basis a1, a2, a3 is orthogonal! 
24. Project the vector b = (1;1) onto the lines through a1 = (1;0) and a2 = (1;2). Draw 
the projections p1 and p2 and add p1+ p2. The projections do not add to b because 
the a’s are not orthogonal. 
25. In Problem 24, the projection of b onto the plane of a1 and a2 will equal b. Find 
P = A(ATA).1AT for A = [a1 a2] 
. 1 1 
0 2 
¤
.
180 Chapter 3 Orthogonality 
26. Project a1 = (1;0) onto a2 = (1;2). Then project the result back onto a1. Draw these 
projections and multiply the projection matrices P1P2: Is this a projection? 
3.3 Projections and Least Squares 
Up to this point, Ax=b either has a solution or not. If b is not in the column space C(A), 
the system is inconsistent and Gaussian elimination fails. This failure is almost certain 
when there are several equations and only one unknown: 
More equations 
than unknowns— 
no solution? 
2x = b1 
3x = b2 
4x = b3: 
This is solvable when b1, b2, b3 are in the ratio 2:3:4. The solution x will exist only if b 
is on the same line as the column a = (2;3;4). 
In spite of their unsolvability, inconsistent equations arise all the time in practice. 
They have to be solved! One possibility is to determine x from part of the system, and 
ignore the rest; this is hard to justify if all m equations come from the same source. 
Rather than expecting no error in some equations and large errors in the others, it is 
much better to choose the x that minimizes an average error E in the m equations. 
The most convenient “average” comes from the sum of squares: 
Squared error E2 = (2x.b1)2+(3x.b2)2+(4x.b3)2: 
If there is an exact solution, the minimum error is E = 0. In the more likely case that b 
is not proportional to a, the graph of E2 will be a parabola. The minimum error is at the 
lowest point, where the derivative is zero: 
dE2 
dx 
= 2
.
(2x.b1)2+(3x.b2)3+(4x.b3)4
¤ 
= 0: 
Solving for x, the least-squares solution of this model system ax = b is denoted by bx: 
Leastsquares solution ex = 
2b1+3b2+4b3 
22+32+42 = 
aTb 
aTa
: 
You recognize aTb in the numerator and aTa in the denominator. 
The general case is the same. We “solve” ax = b by minimizing 
E2 = kax.bk2 = (a1x.b1)2+. . .+(amx.bm)2: 
The derivative of E2 is zero at the point bx, if 
(a1bx.b1)a1+. . .+(ambx.bm)am = 0: 
We are minimizing the distance from b to the line through a, and calculus gives the same 
answer, bx = (a1b1+. . .+ambm)=(a21
+. . .+a2
m), that geometry did earlier:
3.3 Projections and Least Squares 181 
3K The least-squares solution to a problem ax=b in one unknown is bx= 
aTb 
aTa
. 
You see that we keep coming back to the geometrical interpretation of a least-squares 
problem—to minimize a distance. By setting the derivative of E2 to zero, calculus confirms 
the geometry of the previous section. The error vector e connecting b to p must be 
perpendicular to a: 
Orthogonality of a and e aT(b.bxa) = aTb. 
aTb 
aTa
aTa = 0: 
As a side remark, notice the degenerate case a = 0. All multiples of a are zero, and 
the line is only a point. Therefore p = 0 is the only candidate for the projection. But 
the formula for bx becomes a meaningless 0=0, and correctly reflects the fact that bx is 
completely undetermined. All values of x give the same error E = k0x.bk, so E2 is 
a horizontal line instead of a parabola. The “pseudoinverse” assigns the definite value 
bx = 0, which is a more “symmetric” choice than any other number. 
Least Squares Problems with Several Variables 
Now we are ready for the serious step, to project b onto a subspace—rather than just 
onto a line. This problem arises from Ax = b when A is an m by n matrix. Instead 
of one column and one unknown x, the matrix now has n columns. The number m of 
observations is still larger than the number n of unknowns, so it must be expected that 
Ax = b will be inconsistent. Probably, there will not exist a choice of x that perfectly 
fits the data b. In other words, the vector b probably will not be a combination of the 
columns of A; it will be outside the column space. 
Again the problem is to choose bx so as to minimize the error, and again this minimization 
will be done in the least-squares sense. The error is E = kAx.bk, and this 
is exactly the distance from b to the point Ax in the column space. Searching for the 
least-squares solution bx, which minimizes E, is the same as locating the point p = Abx 
that is closer to b than any other point in the column space. 
We may use geometry or calculus to determine bx. In n dimensions, we prefer the 
appeal of geometry; p must be the “projection of b onto the column space.” The error 
vector e = b.Abx must be perpendicular to that space (Figure 3.8). Finding bx and the 
projection p = Abx is so fundamental that we do it in two ways: 
1. All vectors perpendicular to the column space lie in the left nullspace. Thus the 
error vector e = b.Abx must be in the nullspace of AT: 
AT(b.Abx) = 0 or ATAbx = ATb:
182 Chapter 3 Orthogonality 
Figure 3.8: Projection onto the column space of a 3 by 2 matrix. 
2. The error vector must be perpendicular to each column a1; : : : ;an of A: 
aT1
(b.Abx) = 0 
... 
aTn
(b.Abx) = 0 
or 
2
64
aT1
... 
aTn 
3
75 
2
6 4b.Abx
3
75
= 0: 
This is again AT(b.Abx) = 0 and ATAbx = ATb, The calculus way is to take partial 
derivatives of E2 = (Ax.b)T(Ax.b). That gives the same 2ATAx.2ATb = 0. The 
fastest way is just to multiply the unsolvable equation Ax=b by AT. All these equivalent 
methods produce a square coefficient matrix ATA. It is symmetric (its transpose is not 
AAT!) and it is the fundamental matrix of this chapter. 
The equations ATAbx = ATb are known in statistics as the normal equations. 
3L When Ax = b is inconsistent, its least-squares solution minimizes kAx. 
bk2: 
Normal equations ATAbx = ATb: (1) 
ATA is invertible exactly when the columns of A are linearly independent! 
Then, 
Best estimate bx bx = (ATA).1ATb: (2) 
The projection of b onto the column space is the nearest point Abx: 
Projection p = Abx = A(ATA).1ATb: (3) 
We choose an example in which our intuition is as good as the formulas: 
A = 
2
64
1 2 
1 3 
0 0
3
75
; b = 
2
64
4
5
6
3
75
; 
Ax = b has no solution 
ATAbx = ATb gives the best x:
3.3 Projections and Least Squares 183 
Both columns end with a zero, so C(A) is the x-y plane within three-dimensional space 
The projection of b = (4;5;6) is p = (4;5;0)—the x and y components stay the same 
but z = 6 will disappear. That is confirmed by solving the normal equations: 
ATA = 
"
1 1 0 
2 3 0
#2
64
1 2 
1 3 
0 0
3
75
= 
"
2 5 
5 13
#
: 
bx = (ATA).1ATb = 
"
13 .5 
.5 2 
#"
1 1 0 
2 3 0
#2
64
4
5
6
3
75
= 
"
2
1
#
: 
Projection p = Abx = 
2
64
1 2 
1 3 
0 0
3
75 
"
2
1
# 
= 
2
64
4
5
0
3
75
: 
In this special case, the best we can do is to solve the first two equations of Ax = b. Then 
bx1 = 2 and bx2 = 1. The error in the equation 0x1+0x2 = 6 is sure to be 6. 
Remark 4. Suppose b is actually in the column space of A—it is a combination b = Ax 
of the columns. Then the projection of b is still b: 
b in column space p = A(ATA).1ATAx = Ax = b: 
The closest point p is just b itself—which is obvious. 
Remark 5. At the other extreme, suppose b is perpendicular to every column, so ATb = 
0. In this case b projects to the zero vector: 
b in left nullspace p = A(ATA).1ATb = A(ATA).10 = 0: 
Remark 6. When A is square and invertible, the column space is the whole space. Every 
vector projects to itself, p equals b, and bx = x: 
If A is invertible p = A(ATA).1ATb = AA.1(AT).1ATb = b: 
This is the only case when we can take apart (ATA).1, and write it as A.1(AT).1. When 
A is rectangular that is not possible. 
Remark 7. Suppose A has only one column, containing a. Then the matrix ATA is the 
number aTa and bx is aTb=aTa. We return to the earlier formula. 
The Cross-Product Matrix ATA 
The matrix ATA is certainly symmetric. Its transpose is (ATA)T = ATATT, which is ATA 
again. Its i, j entry (and j, i entry) is the inner product of column i of A with column j 
of A. The key question is the invertibility of ATA, and fortunately
184 Chapter 3 Orthogonality 
ATA has the same nullspace as A. 
Certainly if Ax = 0 then ATAx = 0. Vectors x in the nullspace of A are also in the 
nullspace of ATA. To go in the other direction, start by supposing that ATAx = 0, and 
take the inner product with x to show that Ax = 0: 
xTATAx = 0; or kAxk2 = 0; or Ax = 0: 
The two nullspaces are identical. In particular, if A has independent columns (and only 
x = 0 is in its nullspace), then the same is true for ATA: 
3M If A has independent columns, then ATA is square, symmetric, and invertible. 
We show later that ATA is also positive definite (all pivots and eigenvalues are positive). 
This case is by far the most common and most important. Independence is not so 
hard in m-dimensional space if m > n. We assume it in what follows. 
Projection Matrices 
We have shown that the closest point to b is p = A(ATA).1ATb. This formula expresses 
in matrix terms the construction of a perpendicular line from b to the column space of 
A. The matrix that gives p is a projection matrix, denoted by P: 
Projection matrix P = A(ATA).1AT: (4) 
This matrix projects any vector b onto the column space of A.1 In other words, p = Pb 
is the component of b in the column space, and the error e = b.Pb is the component 
in the orthogonal complement. (I .P is also a projection matrix! It projects b onto the 
orthogonal complement, and the projection is b.Pb.) 
In short, we have a matrix formula for splitting any b into two perpendicular components. 
Pb is in the column space C(A), and the other component (I .P)b is in the left 
nullspace N(AT)—which is orthogonal to the column space. 
These projection matrices can be understood geometrically and algebraically. 
3N The projection matrix P = A(ATA).1AT has two basic properties: 
(i) It equals its square: P2 = P. 
(ii) It equals its transpose: PT = P. 
Conversely, any symmetric matrix with P2 = P represents a projection. 
1There may be a risk of confusion with permutation matrices, also denoted by P, but the risk should be small, 
and we try never to let both appear on the same page.
3.3 Projections and Least Squares 185 
Proof. It is easy to see why P2 = P. If we start with any b, then Pb lies in the subspace 
we are projecting onto. When we project again nothing is changed. The vector Pb is 
already in the subspace, and P(Pb) is still Pb. In other words P2 = P. Two or three or 
fifty projections give the same point p as the first projection: 
P2 = A(ATA).1ATA(ATA).1AT = A(ATA).1AT = P: 
To prove that P is also symmetric, take its transpose. Multiply the transposes in 
reverse order, and use symmetry of (ATA).1, to come back to P: 
PT = (AT)T .
(ATA).1.TAT = A(ATA).1AT = P: 
For the converse, we have to deduce from P2 =P and PT =P that Pb is the projection 
of b onto the column space of P. The error vector b.Pb is orthogonal to the space. 
For any vector Pc in the space, the inner product is zero: 
(b.Pb)TPc = bT(I.P)TPc = bT(P.P2)c = 0: 
Thus b.Pb is orthogonal to the space, and Pb is the projection onto the column space. 
Example 1. Suppose A is actually invertible. If it is 4 by 4, then its four columns are 
independent and its column space is all of R4. What is the projection onto the whole 
space? It is the identity matrix. 
P = A(ATA).1AT = AA.1(AT).1AT = I: (5) 
The identity matrix is symmetric, I2 = I, and the error b.Ib is zero. 
The point of all other examples is that what happened in equation (5) is not allowed. 
To repeat: We cannot invert the separate parts AT and A when those matrices are rectangular. 
It is the square matrix ATA that is invertible. 
Least-Squares Fitting of Data 
Suppose we do a series of experiments, and expect the output b to be a linear function 
of the input t. We look for a straight line b =C+Dt. For example: 
1. At different times we measure the distance to a satellite on its way to Mars. In this 
case t is the time and b is the distance. Unless the motor was left on or gravity is 
strong, the satellite should move with nearly constant velocity v: b = b0+vt. 
2. We vary the load on a structure, and measure the movement it produces. In this 
experiment t is the load and b is the reading from the strain gauge. Unless the load 
is so great that the material becomes plastic, a linear relation b =C+Dt is normal 
in the theory of elasticity.
186 Chapter 3 Orthogonality 
3. The cost of producing t books like this one is nearly linear, b =C+Dt, with editing 
and typesetting in C and then printing and binding in D. C is the set-up cost and D 
is the cost for each additional book. 
How to compute C and D? If there is no experimental error, then two measurements 
of b will determine the line b = C+Dt. But if there is error, we must be prepared to 
“average” the experiments and find an optimal line. That line is not to be confused with 
the line through a on which b was projected in the previous section! In fact, since there 
are two unknowns C and D to be determined, we now project onto a two-dimensional 
subspace. A perfect experiment would give a perfect C and D: 
C + Dt1 = b1 
C + Dt2 = b2 
... 
C + Dtm = bm: 
(6) 
This is an overdetermined system, with m equations and only two unknowns. If errors 
are present, it will have no solution. A has two columns, and x = (C;D): 
2
6664 
1 t1 
1 t2 
... 
... 
1 tm
3
7775 
"
C
D
# 
= 
2
6664 
b1 
b2
... 
bm
3
7775
; or Ax = b: (7) 
The best solution ( b C;bD
) is the bx that minimizes the squared error E2: 
Minimize E2 = kb.Axk2 = (b1.C.Dt1)2+. . .+(bm.C.Dtm)2: 
The vector p = Abx is as close as possible to b. Of all straight lines b =C+Dt, we are 
choosing the one that best fits the data (Figure 3.9). On the graph, the errors are the 
vertical distances b.C.Dt to the straight line (not perpendicular distances!). It is the 
vertical distances that are squared, summed, and minimized. 
Example 2. Three measurements b1, b2, b3 are marked on Figure 3.9a: 
b = 1 at t = .1; b = 1 at t = 1; b = 3 at t = 2: 
Note that the values t = .1;1;2 are not required to be equally spaced. The first step is 
to write the equations that would hold if a line could go through all three points. Then 
every C+Dt would agree exactly with b: 
Ax = b is 
C . D = 1 
C + D = 1 
C + 2D = 3 
or 
2
64
1 .1 
1 1 
1 2 
3
75 
"
C
D
# 
= 
2
64
1
1
3
3
75
:
3.3 Projections and Least Squares 187 
Figure 3.9: Straight-line approximation matches the projection p of b. 
If those equations Ax=b could be solved, there would be no errors. They can’t be solved 
because the points are not on a line. Therefore they are solved by least squares: 
ATAbx = ATb is 
"
3 2 
2 6
#" 
b C
bD 
# 
= 
"
5
6
#
: 
The best solution is b C = 97
, bD
= 47
and the best line is 97
+ 47
t. 
Note the beautiful connections between the two figures. The problem is the same but 
the art shows it differently. In Figure 3.9b, b is not a combination of the columns (1;1;1) 
and (.1;1;2). In Figure 3.9, the three points are not on a line. Least squares replaces 
points b that are not on a line by points p that are! Unable to solve Ax = b, we solve 
Abx = p. 
The line 97
+47
t has heights 57
, 13 
7 , 17 
7 at the measurement times .1, 1, 2. Those points 
do lie on a line. Therefore the vector p = (57
; 13 
7 ; 17 
7 ) is in the column space. This vector 
is the projection. Figure 3.9b is in three dimensions (or m dimensions if there are m 
points) and Figure 3.9a is in two dimensions (or n dimensions if there are n parameters). 
Subtracting p from b, the errors are e = (27
;.6
7;47
). Those are the vertical errors in 
Figure 3.9a, and they are the components of the dashed vector in Figure 3.9b. This error 
vector is orthogonal to the first column (1;1;1), since .27
. 67
+ 47
= 0. It is orthogonal 
to the second column (.1;1;2), because .27
.67
+87
= 0. It is orthogonal to the column 
space, and it is in the left nullspace. 
Question: If the measurements b = (27
;.67
;47
) were those errors, what would be the 
best line and the best bx? Answer: The zero line—which is the horizontal axis—and 
bx = 0. Projection to zero. 
We can quickly summarize the equations for fitting by a straight line. The first column 
of A contains 1s, and the second column contains the times ti. Therefore ATA contains 
the sum of the 1s and the ti and the t2
i :
188 Chapter 3 Orthogonality 
3O The measurements b1; : : : ;bm are given at distinct points t1; : : : ; tm. Then 
the straight line b C+bDt which minimizes E2 comes from least squares: 
ATA
" 
b C
bD 
# 
= ATb or 
" 
m ati 
ati at2
i 
#" 
b C
bD 
# 
= 
" 
abi 
atibi
#
: 
Remark. The mathematics of least squares is not limited to fitting the data by straight 
lines. In many experiments there is no reason to expect a linear relationship, and it 
would be crazy to look for one. Suppose we are handed some radioactive material, The 
output b will be the reading on a Geiger counter at various times t. We may know that 
we are holding a mixture of two chemicals, and we may know their half-lives (or rates 
of decay), but we do not know how much of each is in our hands. If these two unknown 
amounts are C and D, then the Geiger counter readings would behave like the sum of 
two exponentials (and not like a straight line): 
b =Ce.l t +De.mt : (8) 
In practice, the Geiger counter is not exact. Instead, we make readings b1; : : : ;bm at 
times t1; : : : ; tm, and equation (8) is approximately satisfied: 
Ax = b is 
Ce.l t1 + De.mt1 . b1 
... 
Ce.l tm + De.mtm . bm: 
If there are more than two readings, m > 2, then in all likelihood we cannot solve for 
C and D. But the least-squares principle will give optimal values b C and bD
. 
The situation would be completely different if we knew the amounts C and D, and 
were trying to discover the decay rates l and m. This is a problem in nonlinear least 
squares, and it is harder. We would still form E2, the sum of the squares of the errors, 
and minimize it. But setting its derivatives to zero will not give linear equations for the 
optimal l and m. In the exercises, we stay with linear least squares. 
Weighted Least Squares 
A simple least-squares problem is the estimate bx of a patient’s weight from two observations 
x = b1 and x = b2. Unless b1 = b2, we are faced with an inconsistent system of 
two equations in one unknown: 
"
1
1
#h
x
i 
= 
"
b1 
b2
#
: 
Up to now, we accepted b1 and b2 as equally reliable. We looked for the value bx that 
minimized E2 = (x.b1)2+(x.b2)2: 
dE2 
dx 
= 0 at bx = 
b1+b2 
2 
:
3.3 Projections and Least Squares 189 
The optimal bx is the average. The same conclusion comes from ATAbx = ATb. In fact 
ATA is a 1 by 1 matrix, and the normal equation is 2bx = b1+b2. 
Now suppose the two observations are not trusted to the same degree. The value 
x = b1 may be obtained from a more accurate scale—or, in a statistical problem, from a 
larger sample—than x = b2. Nevertheless, if b2 contains some information, we are not 
willing to rely totally on b1. The simplest compromise is to attach different weights w21 
and w22
, and choose the bxW that minimizes the weighted sum of squares: 
Weighted error E2 = w21
(x.b1)2+w22
(x.b2)2: 
If w1 > w2, more importance is attached to b1. The minimizing process (derivative = 0) 
tries harder to make (x.b1)2 small: 
dE2 
dx 
= 2
.
w21
(x.b1)+w22
(x.b2)
¤ 
= 0 at bxW = 
w21
b1+w22
b2 
w21
+w22
: (9) 
Instead of the average of b1 and b2 (for w1 = w2 = 1), bxW is a weighted average of the 
data. This average is closer to b1 than to b2. 
The ordinary least-squares problem leading to bxW comes from changing Ax = b to 
the new systemWAx =Wb. This changes the solution from bx to bxW. The matrixWTW 
turns up on both sides of the weighted normal equations: 
The least squares solution toWAx =Wb is bxW: 
Weighted normal equations (ATWTWA)bxW = ATWTWb: 
What happens to the picture of b projected to Abx? The projection AbxW is still the 
point in the column space that is closest to b. But the word “closest” has a new meaning 
when the length involvesW. The weighted length of x equals the ordinary length ofWx. 
Perpendicularity no longer means yTx = 0; in the new system the test is (Wy)T(Wx) = 0. 
The matrix WTW appears in the middle. In this new sense, the projection AbxW and the 
error b.AbxW are again perpendicular. 
That last paragraph describes all inner products: They come from invertible matrices 
W. They involve only the symmetric combination C =WTW. The inner product of x 
and y is yTCx. For an orthogonal matrixW =Q, when this combination is C =QTQ =I, 
the inner product is not new or different. Rotating the space leaves the inner product 
unchanged. Every otherW changes the length and inner product. 
For any invertible matrixW, these rules define a new inner product and length: 
Weighted byW (x;y)W = (Wy)T(Wx) and kxkW = kWxk: (10) 
Since W is invertible, no vector is assigned length zero (except the zero vector). All 
possible inner products—which depend linearly on x and y and are positive when x = 
y 6= 0—are found in this way, from some matrix C =WTW.
190 Chapter 3 Orthogonality 
In practice, the important question is the choice of C. The best answer comes from 
statisticians, and originally from Gauss. We may know that the average error is zero. 
That is the “expected value” of the error in b—although the error is not really expected 
to be zero! We may also know the average of the square of the error; that is the variance. 
If the errors in the bi are independent of each other, and their variances are s 2 
i , then the 
right weights are wi = 1=si. A more accurate measurement, which means a smaller 
variance, gets a heavier weight. 
In addition to unequal reliability, the observations may not be independent. If the 
errors are coupled—the polls for President are not independent of those for Senator, 
and certainly not of those for Vice-President—then W has off-diagonal terms. The best 
unbiased matrix C =WTW is the inverse of the covariance matrix—whose i, j entry is 
the expected value of (error in bi) times (error in bj). Then the main diagonal of C.1 
contains the variances s 2 
i , which are the average of (error in bi)2. 
Example 3. Suppose two bridge partners both guess (after the bidding) the total number 
of spades they hold. For each guess, the errors .1, 0, 1 might have equal probability 
13
. Then the expected error is zero and the variance is 23
: 
E(e) = 13
(.1)+ 13
(0)+ 13
(1) = 0 
E(e2) = 13
(.1)2+ 13
(0)2+ 13
(1)2 = 23
: 
The two guesses are dependent, because they are based on the same bidding—but not 
identical, because they are looking at different hands. Say the chance that they are 
both too high or both too low is zero, but the chance of opposite errors is 13
. Then 
E(e1e2) = 13
(.1), and the inverse of the covariance matrix isWTW: 
" 
E(e21
) E(e1e2) 
E(e1e2) E(e22
) 
#.1 
= 
" 
2
3 .13 
.13 
23 
#.1 
= 
"
2 1 
1 2
# 
=C =WTW: 
This matrix goes into the middle of the weighted normal equations. 
Problem Set 3.3 
1. Find the best least-squares solution bx to 3x=10, 4x=5. What error E2 is minimized? 
Check that the error vector (10.3bx;5.4bx) is perpendicular to the column (3;4). 
2. Suppose the values b1 = 1 and b2 = 7 at times t1 = 1 and t2 = 2 are fitted by a line 
b = Dt through the origin. Solve D = 1 and 2D = 7 by least squares, and sketch the 
best line.
3.3 Projections and Least Squares 191 
3. Solve Ax = b by least squares, and find p = Abx if 
A = 
2
64
1 0 
0 1 
1 1
3
75
; b = 
2
64
1
1
0
3
75
: 
Verify that the error b. p is perpendicular to the columns of A. 
4. Write out E2 = kAx.bk2 and set to zero its derivatives with respect to u and v, if 
A = 
2
64
1 0 
0 1 
1 1
3
75
; x = 
"
u
v
#
; b = 
2
64
1
3
4
3
75
: 
Compare the resulting equations with ATAbx = ATb, confirming that calculus as well 
as geometry gives the normal equations. Find the solution bx and the projection p = 
Abx. Why is p = b? 
5. The following system has no solution: 
Ax = 
2
64
1 .1 
1 0 
1 1 
3
75 
"
C
D
# 
= 
2
64
4
5
9
3
75
= b: 
Sketch and solve a straight-line fit that leads to the minimization of the quadratic 
(C.D.4)2+(C.5)2+(C+D.9)2? What is the projection of b onto the column 
space of A? 
6. Find the projection of b onto the column space of A: 
A = 
2
64
1 1 
1 .1 
.2 4 
3
75
; b = 
2
64
1
2
7
3
75
: 
Split b into p+q, with p in the column space and q perpendicular to that space. 
Which of the four subspaces contains q? 
7. Find the projection matrix P onto the space spanned by a1 = (1;0;1) and a2 = 
(1;1;.1). 
8. If P is the projection matrix onto a k-dimensional subspace S of the whole space Rn, 
what is the column space of P and what is its rank? 
9. (a) If P = PTP, show that P is a projection matrix. 
(b) What subspace does the matrix P = 0 project onto? 
10. If the vectors a1, a2, and b are orthogonal, what are ATA and ATb? What is the 
projection of b onto the plane of a1 and a2?
192 Chapter 3 Orthogonality 
11. Suppose P is the projection matrix onto the subspace S and Q is the projection onto 
the orthogonal complement S?. What are P+Q and PQ? Show that P.Q is its own 
inverse. 
12. If V is the subspace spanned by (1;1;0;1) and (0;0;1;0), find 
(a) a basis for the orthogonal complement V?. 
(b) the projection matrix P onto V. 
(c) the vector in V closest to the vector b = (0;1;0;.1) in V?. 
13. Find the best straight-line fit (least squares) to the measurements 
b = 4 at t = .2, b = 3 at t = .1, 
b = 1 at t = 0, b = 0 at t = 2. 
Then find the projection of b = (4;3;1;0) onto the column space of 
A = 
2
6664 
1 .2 
1 .1 
1 0 
1 2 
3
7775
: 
14. The vectors a1 = (1;1;0) and a2 = (1;1;1) span a plane in R3. Find the projection 
matrix P onto the plane, and find a nonzero vector b that is projected to zero. 
15. If P is the projection matrix onto a line in the x-y plane, draw a figure to describe 
the effect of the “reflection matrix” H = I .2P. Explain both geometrically and 
algebraically why H2 = I. 
16. Show that if u has unit length, then the rank-1 matrix P = uuT is a projection matrix: 
It has properties (i) and (ii) in 3N. By choosing u = a=kak, P becomes the projection 
onto the line through a, and Pb is the point p = bxa. Rank-1 projections correspond 
exactly to least-squares problems in one unknown. 
17. What 2 by 2 matrix projects the x-y plane onto the .45° line x+y = 0? 
18. We want to fit a plane y =C+Dt +Ez to the four points 
y = 3 at t = 1; z = 1 y = 6 at t = 0; z = 3 
y = 5 at t = 2; z = 1 y = 0 at t = 0; z = 0. 
(a) Find 4 equations in 3 unknowns to pass a plane through the points (if there is 
such a plane). 
(b) Find 3 equations in 3 unknowns for the best least-squares solution. 
19. If PC = A(ATA).1AT is the projection onto the column space of A, what is the projection 
PR onto the row space? (It is not PT 
C !)
3.3 Projections and Least Squares 193 
20. If P is the projection onto the column space of A, what is the projection onto the left 
nullspace? 
21. Suppose L1 is the line through the origin in the direction of a1 and L2 is the line 
through b in the direction of a2. To find the closest points x1a1 and b+x2a2 on the 
two lines, write the two equations for the x1 and x2 that minimize kx1a1.x2a2.bk. 
Solve for x if a1 = (1;1;0), a2 = (0;1;0), b = (2;1;4). 
22. Find the best line C+Dt to fit b = 4;2;.1;0;0 at times t = .2;.1;0;1;2. 
23. Show that the best least-squares fit to a set of measurements y1; : : : ;ym by a horizontal 
line (a constant function y =C) is their average 
C = 
y1+. . .+ym 
m 
: 
24. Find the best straight-line fit to the following measurements, and sketch your solution: 
y = 2 at t = .1, y = 0 at t = 0, 
y = .3 at t = 1, y = .5 at t = 2. 
25. Suppose that instead of a straight line, we fit the data in Problem 24 by a parabola: 
y =C+Dt +Et2. In the inconsistent system Ax = b that comes from the four measurements, 
what are the coefficient matrix A, the unknown vector x, and the data 
vector b? You need not compute bx. 
26. A Middle-Aged man was stretched on a rack to lengths L = 5, 6, and 7 feet under 
applied forces of F = 1, 2, and 4 tons. Assuming Hooke’s law L = a+bF, find his 
normal length a by least squares. 
Problems 27–31 introduce basic ideas of statistics—the foundation for least 
squares. 
27. (Recommended) This problem projects b = (b1; : : : ;bm) onto the line through a = 
(1; : : : ;1). We solve m equations ax = b in 1 unknown (by least squares). 
(a) Solve aTabx = aTb to show that is the mean (the average) of the b’s, 
(b) Find e = b.abx, the variance kek2, and the standard deviation kek. 
(c) The horizontal linebb
= 3 is closest to b = (1;2;6), Check that p = (3;3;3) is 
perpendicular to e and find the projection matrix P. 
28. First assumption behind least squares: Each measurement error has mean zero. Multiply 
the 8 error vectors b.Ax = (§1;§1;§1) by (ATA).1AT to show that the 8 
vectors bx.x also average to zero. The estimate bx is unbiased.
194 Chapter 3 Orthogonality 
29. Second assumption behind least squares: The m errors ei are independent with 
variance s 2, so the average of (b.Ax)(b.Ax)T is s 2I. Multiply on the left by 
(ATA).1AT and on the right by A(ATA).1 to show that the average of (bx.x)(bx.x)T 
is s 2(ATA).1. This is the all-important covariance matrix for the error in bx. 
30. A doctor takes four readings of your heart rate. The best solution to x=b1; : : : ;x=b4 
is the average bx of b1; : : : ;b4. The matrix A is a column of 1s. Problem 29 gives the 
expected error (bx.x)2 as s 2(ATA).1 = . By averaging, the variance drops from 
s 2 to s 2=4. 
31. If you know the average bx9 of 9 numbers b1; : : : ;b9, how can you quickly find the 
average bx10 with one more number b10? The idea of recursive least squares is to 
avoid adding 10 numbers. What coefficient of bx9 correctly gives bx10? 
bx10 = 1 
10
bb
10+ bx9 = 1 
10(b1+. . .+b10): 
Problems 32–37 use four points b = (0;8;8;20) to bring out more ideas. 
32. With b=0;8;8;20 at t =0;1;3;4, set up and solve the normal equations ATAbx=ATb. 
For the best straight line as in Figure 3.9a, find its four heights pi and four errors ei. 
What is the minimum value E2 = e21
+e22
+e23
+e24
? 
33. (Line C+Dt does go through p’s) With b = 0;8;8;20 at times t = 0;1;3;4, write 
the four equations Ax = b (unsolvable). Change the measurements to p = 1;5;13;17 
and find an exact solution to Abx = p. 
34. Check that e = b. p = (.1;3;.5;3) is perpendicular to both columns of A. What 
is the shortest distance kek from b to the column space of A? 
35. For the closest parabola b =C+Dt +Et2 to the same four points, write the unsolvable 
equations Ax = b in three unknowns x = (C;D;E). Set up the three normal 
equations ATAbx = ATb (solution not required). You are now fitting a parabola to four 
points—what is happening in Figure 3.9b? 
36. For the closest cubic b =C+Dt +Et2+Ft3 to the same four points, write the four 
equations Ax = b. Solve them by elimination, This cubic now goes exactly through 
the points. What are p and e? 
37. The average of the four times isbt
= 14
(0+1+3+4) = 2. The average of the four b’s 
isbb
= 14
(0+8+8+20) = 9. 
(a) Verify that the best line goes through the center point (bt
;bb
) = (2;9). 
(b) Explain why C+Dbt
=bb
comes from the first equation in ATAbx = ATb. 
38. What happens to the weighted average bxW = (w21
b1 +w22
b2)=(w21
+w22
) if the first 
weight w1 approaches zero? The measurement b1 is totally unreliable.
3.4 Orthogonal Bases and Gram-Schmidt 195 
39. From m independent measurements b1; : : : ;bm of your pulse rate, weighted by w1; : : : ;wm, 
what is the weighted average that replaces equation (9)? It is the best estimate when 
the statistical variances are s 2 
i . 1=w2i
. 
40. IfW = 
. 2 0 
0 1 
¤
, find theW-inner product of x = (2;3) and y = (1;1), and theW-length 
of x. What line of vectors isW-perpendicular to y? 
41. Find the weighted least-squares solution bxW to Ax = b: 
A = 
2
64
1 0 
1 1 
1 2
3
75
b = 
2
64
0
1
1
3
75
W = 
2
64
2 0 0 
0 1 0 
0 0 1
3
75
: 
Check that the projection AbxW is still perpendicular (in the W-inner product!) to the 
error b.AbxW. 
42. (a) Suppose you guess your professor’s age, making errors e = .2;.1;5 with probabilities 
12
;14
;14
. Check that the expected error E(e) is zero and find the variance 
E(e2). 
(b) If the professor guesses too (or tries to remember), making errors .1, 0, 1 with 
probabilities 18
;68
;18
, what weights w1 and w2 give the reliability of your guess 
and the professor’s guess? 
3.4 Orthogonal Bases and Gram-Schmidt 
In an orthogonal basis, every vector is perpendicular to every other vector. The coordinate 
axes are mutually orthogonal. That is just about optimal, and the one possible 
improvement is easy: Divide each vector by its length, to make it a unit vector. That 
changes an orthogonal basis into an orthonormal basis of q’s: 
3P The vectors q1; : : : ;qn are orthonormal if 
qTi
qj = 
.
0 whenever i 6= j; giving the orthogonality; 
1 whenever i = j; giving the normalization. 
A matrix with orthonormal columns will be called Q. 
The most important example is the standard basis. For the x-y plane, the best-known 
axes e1 = (1;0) and e2 = (0;1) are not only perpendicular but horizontal and vertical. Q 
is the 2 by 2 identity matrix. In n dimensions the standard basis e1; : : : ;en again consists
196 Chapter 3 Orthogonality 
of the columns of Q = I: 
Standard 
basis 
e1 = 
2
6666664 
1
0
0... 
0
3
7777775 
; e2 = 
2
6666664 
0
1
0... 
0
3
7777775 
; . . . ; en = 
2
6666664 
0
0
0... 
1
3
7777775 
: 
That is not the only orthonormal basis! We can rotate the axes without changing the 
right angles at which they meet. These rotation matrices will be examples of Q. 
If we have a subspace of Rn, the standard vectors ei might not lie in that subspace. 
But the subspace always has an orthonormal basis, and it can be constructed in a simple 
way out of any basis whatsoever. This construction, which converts a skewed set of axes 
into a perpendicular set, is known as Gram-Schmidt orthogonalization. 
To summarize, the three topics basic to this section are: 
1. The definition and properties of orthogonal matrices Q. 
2. The solution of Qx = b, either n by n or rectangular (least squares). 
3. The Gram-Schmidt process and its interpretation as a new factorization A = QR. 
Orthogonal Matrices 
3Q If Q (square or rectangular) has orthonormal columns, then QTQ = I: 
Orthonormal 
columns 
2
6664 
— qT1
— 
— qT2
— 
... 
— qTn
—
3
7775 
2
64
j j j 
q1 q2 . . . qn 
j j j 
3
75
= 
2
6664 
1 0 . 0 
0 1 . 0 
. . . . 
0 0 . 1
3
7775
= I: 
(1) 
An orthogonal matrix is a square matrix with orthonormal columns.2 Then 
QT is Q.1. For square orthogonal matrices, the transpose is the inverse. 
When row i of QT multiplies column j of Q, the result is qTj
qj = 0. On the diagonal 
where i = j, we have qTi
qi = 1. That is the normalization to unit vectors of length 1. 
Note that QTQ = I even if Q is rectangular. But then QT is only a left-inverse. 
Example 1. 
Q = 
"
cosq .sinq 
sinq cosq 
#
; QT = Q.1 = 
" 
cosq sinq 
.sinq cosq 
#
: 
2Orthonormal matrix would have been a better name, but it is too late to change. Also, there is no accepted word 
for a rectangular matrix with orthonormal columns. We still write Q, but we won’t call it an “orthogonal matrix” 
unless it is square.
3.4 Orthogonal Bases and Gram-Schmidt 197 
Q rotates every vector through the angle q , and QT rotates it back through .q . The 
columns are clearly orthogonal, and they are orthonormal because sin2q +cos2q = 1. 
The matrix QT is just as much an orthogonal matrix as Q. 
Example 2. Any permutation matrix P is an orthogonal matrix. The columns are certainly 
unit vectors and certainly orthogonal—because the 1 appears in a different place 
in each column: The transpose is the inverse. 
If P = 
2
64
0 1 0 
0 0 1 
1 0 0
3
75
then P.1 = PT = 
2
64
0 0 1 
1 0 0 
0 1 0
3
75
: 
An anti-diagonal P, with P13 =P22 =P31 =I, takes the x-y-z axes into the z-y-x axes— 
a “right-handed” system into a “left-handed” system. So we were wrong if we suggested 
that every orthogonal Q represents a rotation. A reflection is also allowed. P = 
. 0 1 
1 0 
¤ 
reflects every point (x;y) into (y;x), its mirror image across the 45° line. Geometrically, 
an orthogonal Q is the product of a rotation and a reflection. 
There does remain one property that is shared by rotations and reflections, and in fact 
by every orthogonal matrix. It is not shared by projections, which are not orthogonal or 
even invertible. Projections reduce the length of a vector, whereas orthogonal matrices 
have a property that is the most important and most characteristic of all: 
3R Multiplication by any Q preserves lengths: 
Lengths unchanged kQxk = kxk for every vector x: (2) 
It also preserves inner products and angles, since (Qx)T(Qy)=xTQTQy=xTy. 
The preservation of lengths comes directly from QTQ = I: 
kQxk2 = kxk2 because (Qx)T(Qx) = xTQTQx = xTx: (3) 
All inner products and lengths are preserved, when the space is rotated or reflected. 
We come now to the calculation that uses the special property QT =Q.1. If we have a 
basis, then any vector is a combination of the basis vectors. This is exceptionally simple 
for an orthonormal basis, which will be a key idea behind Fourier series. The problem 
is to find the coefficients of the basis vectors: 
Write b as a combination b = x1q1+x2q2+. . .+xnqn. 
To compute x1 there is a neat trick. Multiply both sides of the equation by qT1
. On the 
left-hand side is qT1
b. On the right-hand side all terms disappear (because qT1
qj = 0) 
except the first term. We are left with
qT1
b = x1qT1
q1:
198 Chapter 3 Orthogonality 
Since qT1
q1 = 1, we have found x1 = qT1
b. Similarly the second coefficient is x2 = qT2
b; 
that term survives when we multiply by qT2
. The other terms die of orthogonality. Each 
piece of b has a simple formula, and recombining the pieces gives back b: 
Every vector b is equal to (qT1
b)q1+(qT2
b)q2+. . .+(qTn
b)qn: (4) 
I can’t resist putting this orthonormal basis into a square matrix Q. The vector equation 
x1q1+. . .+xnqn = b is identical to Qx = b. (The columns of Q multiply the components 
of x.) Its solution is x = Q.1b. But since Q.1 = QT—this is where orthonormality 
enters—the solution is also x = QTb: 
x = QTb = 
2
64
— qT1
— 
... 
— qTn
—
3
75 
2
6 4b
3
75
= 
2
64
qT1
b 
... 
qTn
b
3
75
(5) 
The components of x are the inner products qTi
b, as in equation (4). 
The matrix form also shows what happens when the columns are not orthonormal. 
Expressing b as a combination x1a1+. . .+xnan is the same as solving Ax = b. The basis 
vectors go into the columns of A. In that case we need A.1, which takes work. In the 
orthonormal case we only need QT. 
Remark 1. The ratio aTb=aTa appeared earlier, when we projected b onto a line. Here a 
is q1, the denominator is 1, and the projection is (qT1
b)q1. Thus we have a new interpretation 
for formula (4): Every vector b is the sum of its one-dimensional projections onto 
the lines through the q’s. 
Since those projections are orthogonal, Pythagoras should still be correct. The square 
of the hypotenuse should still be the sum of squares of the components: 
kbk2 = (qT1
b)2+(qT2
b)2+. . .+(qTnb)2 which is kQTbk2: (6) 
Remark 2. Since QT = Q.1, we also have QQT = I. When Q comes before QT, multiplication 
takes the inner products of the rows of Q. (For QTQ it was the columns.) 
Since the result is again the identity matrix, we come to a surprising conclusion: The 
rows of a square matrix are orthonormal whenever the columns are. The rows point 
in completely different directions from the columns, and I don’t see geometrically why 
they are forced to be orthonormal—but they are. 
Orthonormal columns 
Orthonormal rows 
Q = 
2
64
1=
p
3 1=
p
2 1=
p
6 
1=
p
3 0 .2=
p
6 
1=
p
3 .1=
p
2 1=
p
6 
3
75
: 
Rectangular Matrices with Orthogonal Columns 
This chapter is about Ax = b, when A is not necessarily square. For Qx = b we now 
admit the same possibility—there may be more rows than columns. The n orthonormal
3.4 Orthogonal Bases and Gram-Schmidt 199 
vectors qi in the columns of Q have m > n components. Then Q is an m by n matrix and 
we cannot expect to solve Qx = b exactly. We solve it by least squares. 
If there is any justice, orthonormal columns should make the problem simple. It 
worked for square matrices, and now it will work for rectangular matrices. The key is to 
notice that we still have QTQ = I. So QT is still the left-inverse of Q. 
For least squares that is all we need. The normal equations came from multiplying 
Ax = b by the transpose matrix, to give ATAbx = ATb. Now the normal equations are 
QTQ = QTb. But QTQ is the identity matrix! Therefore bx = QTb, whether Q is square 
and bx is an exact solution, or Q is rectangular and we need least squares. 
3S If Q has orthonormal columns, the least-squares problem becomes easy: 
rectangular system with no solution for most b. 
Qx = b 
QTQbx = QTb 
bx = QTb 
p = Qbx 
p = QQTb 
rectangular system with no solution for most b. 
normal equation for the best bx—in which QTQ = I. 
bxi is qTi
b. 
the projection of b is (qT1
b)q1+. . .+(qTn
b)qn. 
the projection matrix is P = QQT. 
The last formulas are like p=Abx and P=A(ATA).1AT. When the columns are orthonormal, 
the “cross-product matrix” ATA becomes QTQ = I. The hard part of least squares 
disappears when vectors are orthonormal. The projections onto the axes are uncoupled, 
and p is the sum p = (qT1
b)q1+. . .+(qTn
b)qn. 
We emphasize that those projections do not reconstruct b. In the square case m = n, 
they did. In the rectangular case m > n, they don’t. They give the projection p and 
not the original vector b—which is all we can expect when there are more equations 
than unknowns, and the q’s are no longer a basis. The projection matrix is usually 
A(ATA).1AT, and here it simplifies to 
P = Q(QTQ).1QT or P = QQT: (7) 
Notice that QTQ is the n by n identity matrix, whereas QQT is an m by m projection P. 
It is the identity matrix on the columns of Q (P leaves them alone), But QQT is the zero 
matrix on the orthogonal complement (the nullspace of QT). 
Example 3. The following case is simple but typical. Suppose we project a point 
b = (x;y; z) onto the x-y plane. Its projection is p = (x;y;0), and this is the sum of the 
separate projections onto the x- and y-axes: 
q1 = 
2
64
1
0
0
3
75
and (qT1
b)q1 = 
2
64
x
0
0
3
75
; q2 = 
2
64
0
1
0
3
75
and (qT2
b)q2 = 
2
64
0
y
0
3
75
:
200 Chapter 3 Orthogonality 
The overall projection matrix is 
P = q1qT1
+q2qT2
= 
2
64
1 0 0 
0 1 0 
0 0 0
3
75
; and P
2
64
x
y
z
3
75
= 
2
64
x
y
0
3
75
: 
Projection onto a plane = sum of projections onto orthonormal q1 and q2. 
Example 4. When the measurement times average to zero, fitting a straight line leads to 
orthogonal columns. Take t1 = .3, t2 = 0, and t3 = 3. Then the attempt to fit y =C+Dt 
leads to three equations in two unknowns: 
C + Dt1 = y1 
C + Dt2 = y2 
C + Dt3 = y3 
; or 
2
64
1 .3 
1 0 
1 3 
3
75 
"
C
D
# 
= 
2
64
y1 
y2 
y3
3
75
: 
The columns (1;1;1) and (.3;0;3) are orthogonal. We can project y separately onto 
each column, and the best coefficients b C and bD
can be found separately: 
b C = 
h
1 1 1
ih
y1 y2 y3
iT 
12+12+12 ; bD
= 
h
.3 0 3
ih
y1 y2 y3
iT 
(.3)2+02+32 : 
Notice that b C = (y1 +y2 +y3)=3 is the mean of the data. b C gives the best fit by a 
horizontal line, whereas bDt is the best fit by a straight line through the origin. The 
columns are orthogonal, so the sum of these two separate pieces is the best fit by any 
straight line whatsoever. The columns are not unit vectors, so b C and bD
have the length 
squared in the denominator. 
Orthogonal columns are so much better that it is worth changing to that case. if the 
average of the observation times is not zero—it is .t = (t1+. . .+tm)=m—then the time 
origin can be shifted by .t. Instead of y =C+Dt we work with y = c+d(t..t). The best 
line is the same! As in the example, we find 
bc = 
h
1 . . . 1
ih
y1 . . . ym
iT 
12+12+. . .+12 = 
y1+. . .+ym 
m 
b d = 
h
(t1..t) . . . (tm..t)
ih
y1 . . . ym
iT 
(t1..t)2+. . .+(tm..t)2 = a(ti..t)yi 
a(ti..t)2 : 
(8) 
The best bc is the mean, and we also get a convenient formula for b d. The earlier ATA 
had the off-diagonal entries ati, and shifting the time by .t made these entries zero. This 
shift is an example of the Gram-Schmidt process, which orthogonalizes the situation in 
advance. 
Orthogonal matrices are crucial to numerical linear algebra, because they introduce 
no instability. While lengths stay the same, roundoff is under control. Orthogonalizing 
vectors has become an essential technique. Probably it comes second only to elimination. 
And it leads to a factorization A = QR that is nearly as famous as A = LU.
3.4 Orthogonal Bases and Gram-Schmidt 201 
The Gram-Schmidt Process 
Suppose you are given three independent vectors a, b, c. If they are orthonormal, life is 
easy. To project a vector v onto the first one, you compute (aTv)a. To project the same 
vector v onto the plane of the first two, you just add (aTv)a+(bTv)b. To project onto 
the span of a, b, c, you add three projections. All calculations require only the inner 
products aTv, bTv, and cTv. But to make this true, we are forced to say, “If they are 
orthonormal.” Now we propose to find a way to make them orthonormal. 
The method is simple. We are given a, b, c and we want q1, q2, q3. There is no 
problem with q1: it can go in the direction of a. We divide by the length, so that q1 = 
a=kak is a unit vector. The real problem begins with q2—which has to be orthogonal 
to q1. If the second vector b has any component in the direction of q1 (which is the 
direction of a), that component has to be subtracted: 
Second vector B = b.(qT1
b)q1 and q2 = B=kBk: (9) 
B is orthogonal to q1. It is the part of b that goes in a new direction, and not in the a. In 
Figure 3.10, B is perpendicular to q1. It sets the direction for q2. 
b 
q2 
B 
b 
q1 
a 
Figure 3.10: The qi component of b is removed; a and B normalized to q1 and q2. 
At this point q1 and q2 are set. The third orthogonal direction starts with c. It will 
not be in the plane of q1 and q2, which is the plane of a and b. However, it may have a 
component in that plane, and that has to be subtracted. (If the result is C = 0, this signals 
that a, b, c were not independent in the first place) What is left is the component C we 
want, the part that is in a new direction perpendicular to the plane: 
Third vector C = c.(qT1
c)q1.(qT2
c)q2 and q3 =C=kCk: (10) 
This is the one idea of the whole Gram-Schmidt process, to subtract from every new 
vector its components in the directions that are already settled. That idea is used over 
and over again.3 When there is a fourth vector, we subtract away its components in the 
directions of q1, q2, q3. 
3If Gram thought of it first, what was left for Schmidt?
202 Chapter 3 Orthogonality 
Example 5. Gram-Schmidt Suppose the independent vectors are a, b, c: 
a = 
2
64
1
0
1
3
75
; b = 
2
64
1
0
0
3
75
; c = 
2
64
2
1
0
3
75
: 
To find q1, make the first vector into a unit vector: q1 = a=
p
2. To find q2, subtract from 
the second vector its component in the first direction: 
B = b.(qT1
b)q1 = 
2
64
1
0
0
3
75
. 
1 
p
2 
2
64
1=
p
2 
0 
1=
p
2
3
75
= 
1
2 
2
64
1
0 
.1
3
75
: 
The normalized q2 is B divided by its length, to produce a unit vector: 
q2 = 
2
64
1=
p
2 
0 
.1=
p
2
3
75
: 
To find q3, subtract from c its components along q1 and q2: 
C = c.(qT1
c)q1.(qT2
c)q2 
= 
2
64
2
1
0
3
75
.
p
2
2
64
1=
p
2 
0 
1=
p
2
3
75
.
p
2
2
64
1=
p
2 
0 
.1=
p
2
3
75
= 
2
640
1
0
3
75
: 
This is already a unit vector, so it is q3. I went to desperate lengths to cut down the number 
of square roots (the painful part of Gram-Schmidt). The result is a set of orthonormal 
vectors q1, q2, q3, which go into the columns of an orthogonal matrix Q: 
Orthonormal basis Q = 
2
6 4q1 q2 q3
3
75
= 
2
64
1=
p
2 1=
p
2 0 
0 0 1 
1=
p
2 .1=
p
2 0
3
75
: 
3T The Gram-Schmidt process starts with independent vectors a1; : : : ;an and 
ends with orthonormal vectors q1; : : : ;qn. At step j it subtracts from aj its 
components in the directions q1; : : : ;qj.1 that are already settled: 
Aj = aj .(qT1
aj)q1.. . ..(qTj
.1aj)qj.1: (11) 
Then qj is the unit vector Aj=kAjk. 
Remark on the calculations I think it is easier to compute the orthogonal a, B, C, 
without forcing their lengths to equal one. Then square roots enter only at the end, when
3.4 Orthogonal Bases and Gram-Schmidt 203 
dividing by those lengths. The example above would have the same B and C, without 
using square roots. Notice the 12
from aTb=aTa instead of p1
2 from qTb: 
B = 
2
64
1
0
0
3
75
. 
1
2 
2
64
1
0
1
3
75
and then C = 
2
64
2
1
0
3
75
.
2
64
1
0
1
3
75
.2
2
64 
120 
.12 
3
75
: 
The Factorization A = QR 
We started with a matrix A, whose columns were a, b, c. We ended with a matrix Q, 
whose columns are q1, q2, q3. What is the relation between those matrices? The matrices 
A and Q are m by n when the n vectors are in m-dimensional space, and there has to be 
a third matrix that connects them. 
The idea is to write the a’s as combinations of the q’s. The vector b in Figure 3.10 is 
a combination of the orthonormal q1 and q2, and we know what combination it is: 
b = (qT1
b)q1+(qT2
b)q2: 
Every vector in the plane is the sum of its q1 and q2 components. Similarly c is the sum 
of its q1, q2, q3 components: c = (qT1
c)q1 +(qT2
c)q2 +(qT3
c)q3. If we express that in 
matrix form we have the new factorization A = QR: 
QR factors A = 
2
6 4a b c
3
75
= 
2
6 4q1 q2 q3
3
75 
2
64
qT1
a qT1
b qT1
c 
qT2b qT2
c 
qT3
c
3
75
= QR (12) 
Notice the zeros in the last matrix! R is upper triangular because of the way Gram- 
Schmidt was done. The first vectors a and q1 fell on the same line. Then q1, q2 were in 
the same plane as a, b. The third vectors c and q3 were not involved until step 3. 
The QR factorization is like A = LU, except that the first factor Q has orthonormal 
columns. The second factor is called R, because the nonzeros are to the right of the diagonal 
(and the letter U is already taken). The off-diagonal entries of R are the numbers 
qT1
b = 1=
p
2 and qT1
c = qT2
c = 
p
2, found above. The whole factorization is 
A = 
2
64
1 1 2 
0 0 1 
1 0 0
3
75= 
2
641=
p
2 1=
p
2 0 
0 0 1 
1=
p
2 .1=
p
2 0
3
75 
2
64 
p
2 1=
p
2 
p
2 
1=
p
2 
p
2 
1 
3
75
= QR: 
You see the lengths of a, B, C on the diagonal of R. The orthonormal vectors q1, q2, q3, 
which are the whole object of orthogonalization, are in the first factor Q. 
Maybe QR is not as beautiful as LU (because of the square roots). Both factorizations 
are vitally important to the theory of linear algebra, and absolutely central to the 
calculations. If LU is Hertz, then QR is Avis.
204 Chapter 3 Orthogonality 
The entries ri j = qTi
aj appear in formula (11), when kAjkqj is substituted for Aj: 
aj = (qT1
aj)q1+. . .+(qTj
.1aj)qj.1+kAjkqj = Q times column j of R: (13) 
3U Every m by n matrix with independent columns can be factored into 
A = QR. The columns of Q are orthonormal, and R is upper triangular and 
invertible. When m = n and all matrices are square, Q becomes an orthogonal 
matrix. 
I must not forget the main point of orthogonalization. It simplifies the least-squares 
problem Ax = b. The normal equations are still correct, but ATA becomes easier: 
ATA = RTQTQR = RTR: (14) 
The fundamental equation ATAbx = ATb simplifies to a triangular system: 
RTRbx = RTQTb or Rbx = QTb: (15) 
Instead of solving QRx = b, which can’t be done, we solve Rbx = QTb which is just 
back-substitution because R is triangular. The real cost is the mn2 operations of Gram- 
Schmidt, which are needed to find Q and R in the first place. 
The same idea of orthogonality applies to functions, The sines and cosines are orthogonal; 
the powers 1, x, x2 are not. When f (x) is written as a combination of sines and 
cosines, that is a Fourier series. Each term is a projection onto a line—the line in function 
space containing multiples of cosnx or sinnx. It is completely parallel to the vector 
case, and very important. And finally we have a job for Schmidt: To orthogonalize the 
powers of x and produce the Legendre polynomials. 
Function Spaces and Fourier Series 
This is a brief and optional section, but it has a number of good intentions: 
1. to introduce the most famous infinite-dimensional vector space (Hilbert space); 
2. to extend the ideas of length and inner product from vectors v to functions f (x): 
3. to recognize the Fourier series as a sum of one-dimensional projections (the orthogonal 
“columns” are the sines and cosines); 
4. to apply Gram-Schmidt orthogonalization to the polynomials 1;x;x2; : : :; and 
5. to find the best approximation to f (x) by a straight line. 
We will try to follow this outline, which opens up a range of new applications for 
linear algebra, in a systematic way. 
1. Hilbert Space. After studying Rn, it is natural to think of the space R.. It contains 
all vectors v = (v1;v2;v3; : : :) with an infinite sequence of components. This space
3.4 Orthogonal Bases and Gram-Schmidt 205 
is actually too big when there is no control on the size of components v j. A much better 
idea is to keep the familiar definition of length, using a sum of squares, and to include 
only those vectors that have a finite length: 
Length squared kvk2 = v21
+v22
+v23
+. . . (16) 
The infinite series must converge to a finite sum. This leaves (1;12
;13
; : : :) but not (1;1;1; : : :). 
Vectors with finite length can be added (kv+wk·kvk+kwk) and multiplied by scalars, 
so they form a vector space. It is the celebrated Hilbert space. 
Hilbert space is the natural way to let the number of dimensions become infinite, 
and at the same time to keep the geometry of ordinary Euclidean space. Ellipses become 
infinite-dimensional ellipsoids, and perpendicular lines are recognized exactly as before. 
The vectors v and w are orthogonal when their inner product is zero: 
Orthogonality vTw = v1w1+v2w2+v3w3+. . . = 0: 
This sum is guaranteed to converge, and for any two vectors it still obeys the Schwarz 
inequality jvTwj · kvkkwk. The cosine, even in Hilbert space, is never larger than 1. 
There is another remarkable thing about this space: It is found under a great many 
different disguises. Its “vectors” can turn into functions, which is the second point. 
2. Lengths and Inner Products. Suppose f (x) = sin x on the interval 0 · x · 2p. This 
f is like a vector with a whole continuum of components, the values of sin x along the 
whole interval. To find the length of such a vector, the usual rule of adding the squares 
of the components becomes impossible. This summation is replaced, in a natural and 
inevitable way, by integration: 
Length k f k of function k f k2 = 
Z 2p 
0 
( f (x))2dx = 
Z 2p 
0 
(sin x)2dx =p (17) 
Our Hilbert space has become a function space. The vectors are functions, we have a 
way to measure their length, and the space contains all those functions that have a finite 
length—just as in equation (16). It does not contain the function F(x) = 1=x, because 
the integral of 1=x2 is infinite. 
The same idea of replacing summation by integration produces the inner product of 
two functions: If f (x) = sin x and g(x) = cos x, then their inner product is 
( f ;g) = 
Z 2p 
0 
f (x)g(x)dx = 
Z 2p 
0 
sin x cos xdx = 0: (18) 
This is exactly like the vector inner product f Tg. It is still related to the length by 
( f ; f ) = k f k2. The Schwarz inequality is still satisfied: j( f ;g)j · k f kkgk. Of course, 
two functions like sin x and cos x—whose inner product is zero—will be called orthogonal. 
They are even orthonormal after division by their length 
p
p.
206 Chapter 3 Orthogonality 
3. The Fourier series of a function is an expansion into sines and cosines: 
f (x) = a0+a1 cos x+b1 sin x+a2 cos2x+b2 sin2x+. . . : 
To compute a coefficient like b1, multiply both sides by the corresponding function sin x 
and integrate from 0 to 2p. (The function f (x) is given on that interval.) In other words, 
take the inner product of both sides with sin x: 
Z 2p 
0 
f (x) sin xdx = a0 
Z 2p 
0 
sin xdx+a1 
Z 2p 
0 
cos x sin xdx+b1 
Z 2p 
0 
(sin x)2dx+. . . : 
On the right-hand side, every integral is zero except one—the one in which sin x multiplies 
itself. The sines and cosines are mutually orthogonal as in equation (18) Therefore 
b1 is the left-hand side divided by that one nonzero integral: 
b1 = 
R 2p 
0 f (x) sin xdx 
R 2p 
0 (sin x)2dx 
= 
( f ; sin x) 
(sin x; sin x): 
The Fourier coefficient a1 would have cos x in place of sin x, and a2 would use cos2x. 
The whole point is to see the analogy with projections. The component of the vector 
b along the line spanned by a is bTa=aTa. A Fourier series is projecting f (x) onto sin x. 
Its component p in this direction is exactly b1 sin x. 
The coefficient b1 is the least squares solution of the inconsistent equation b1 sin x = 
f (x). This brings b1 sin x as close as possible to f (x). All the terms in the series are 
projections onto a sine or cosine. Since the sines and cosines are orthogonal, the Fourier 
series gives the coordinates of the “vector” f (x) with respect to a set of (infinitely many) 
perpendicular axes. 
4. Gram-Schmidt for Functions. There are plenty of useful functions other than 
sines and cosines, and they are not always orthogonal. The simplest are the powers of x, 
and unfortunately there is no interval on which even 1 and x2 are perpendicular. (Their 
inner product is always positive, because it is the integral of x2.) Therefore the closest 
parabola to f (x) is not the sum of its projections onto 1, x, and x2. There will be a matrix 
like (ATA).1, and this coupling is given by the ill-conditioned Hilbert matrix. On the 
interval 0 · x · 1, 
ATA = 
2
64
(1;1) (1;x) (1;x2) 
(x;1) (x;x) (x;x2) 
(x2;1) (x2;x) (x2;x2)
3
75
= 
2
64 
R 
1 
R 
x 
R 
x2 
R 
x 
R 
x2 R 
x3 
R 
x2 R 
x3 R 
x4
3
75
= 
2
64
1 12 
13
12 
13 
14
13 
14 
15 
3
75
: 
This matrix has a large inverse, because the axes 1, x, x2 are far from perpendicular. The 
situation becomes impossible if we add a few more axes. It is virtually hopeless to solve 
ATAbx = ATb for the closest polynomial of degree ten. 
More precisely, it is hopeless to solve this by Gaussian elimination; every roundoff 
error would be amplified by more than 1013. On the other hand, we cannot just give
3.4 Orthogonal Bases and Gram-Schmidt 207 
up; approximation by polynomials has to be possible. The right idea is to switch to 
orthogonal axes (by Gram-Schmidt). We look for combinations of 1, x, and x2 that are 
orthogonal. 
It is convenient to work with a symmetrically placed interval like .1·x·1, because 
this makes all the odd powers of x orthogonal to all the even powers: 
(1;x) = 
Z 1 
.1 
xdx = 0; (x;x2) = 
Z 1 
.1 
x3dx = 0: 
Therefore the Gram-Schmidt process can begin by accepting v1 = 1 and v2 = x as the 
first two perpendicular axes. Since (x;x2) = 0, it only has to correct the angle between 1 
and x2. By formula (10), the third orthogonal polynomial is 
Orthogonalize v3 = x2. 
(1;x2) 
(1;1) 
1. 
(x;x2) 
(x;x) 
x = x2. 
R1 .1 x2dx 
R1 .1 1dx 
= x2. 
1
3
: 
The polynomials constructed in this way are called the Legendre polynomials and they 
are orthogonal to each other over the interval .1 · x · 1. 
Check 
µ
1;x2. 
1
3
¶ 
= 
Z 1 
.1
µ
x2. 
1
3
¶
dx = 
·
x3 
3 
. 
x
3
.1
.1 
= 0: 
The closest polynomial of degree ten is now computable, without disaster, by projecting 
onto each of the first 10 (or 11) Legendre polynomials. 
5. Best Straight Line. Suppose we want to approximate y = x5 by a straight line 
C+Dx between x = 0 and x = 1. There are at least three ways of finding that line, and 
if you compare them the whole chapter might become clear! 
1. Solve [1 x] 
.
C
D
¤ 
= x5 by least squares. The equation ATAbx = ATb is 
"
(1;1) (1;x) 
(x;1) (x;x)
#"
C
D
# 
= 
"
(1;x5) 
(x;x5)
# 
or 
"
1 12
12 
13 
#"
C
D
# 
= 
" 
161 
17
#
: 
2. Minimize E2 = 
R 1 
0 (x5.C.Dx)2dx = 1 
11 .26
C.27
D+C2+CD+13
D2. The derivatives 
with respect to C and D, after dividing by 2, bring back the normal equations 
of method 1 (and the solution is b C = 16
. 5 
14, bD
= 5 
17): 
.
1
6 
+C+ 
1
2
D = 0 and . 
1
7 
+ 
1
2
C+ 
1
3
D = 0: 
3. Apply Gram-Schmidt to replace x by x.(1;x)=(1;1). That is x. 12
, which is orthogonal 
to 1. Now the one-dimensional projections add to the best line: 
C+Dx = 
(x5;1) 
(1;1) 
1+ 
(x5;x. 12
) 
(x. 12
;x. 12
)
(x. 12
) = 
1
6 
+ 
5
7 
µ
x. 
1
2
¶
:
208 Chapter 3 Orthogonality 
Problem Set 3.4 
1. (a) Write the four equations for fitting y =C+Dt to the data 
y = .4 at t = .2, y = .3 at t = .1 
y = .1 at t = 1, y = 0 at t = 2. 
Show that the columns are orthogonal. 
(b) Find the optimal straight line, draw its graph, and write E2. 
(c) Interpret the zero error in terms of the original system of four equations in two 
unknowns: The right-hand side (.4;.3;.1;0) is in the space. 
2. Project b = (0;3;0) onto each of the orthonormal vectors a1 = (2
3;23
;.13
) and a2 = 
(.13
;23
;23
), and then find its projection p onto the plane of a1 and a2. 
3. Find also the projection of b = (0;3;0) onto a3 = (23
;.13
;23
), and add the three projections. 
Why is P = a1aT1
+a2aT2
+a3aT3
equal to I? 
4. If Q1 and Q2 are orthogonal matrices, so that QTQ = I, show that Q1Q2 is also 
orthogonal. If Q1 is rotation through q , and Q2 is rotation through f , what is Q1Q2? 
Can you find the trigonometric identities for sin(q +f ) and cos(q +f ) in the matrix 
multiplication Q1Q2? 
5. If u is a unit vector, show that Q = I .2uuT is a symmetric orthogonal matrix. (It 
is a reflection, also known as a Householder transformation.) Compute Q when 
uT = 
.12 
12
. 12
. 12
¤
. 
6. Find a third column so that the matrix 
Q = 
2
64
1=
p
3 1=
p
14 
1=
p
3 2=
p
14 
1=
p
3 .3=
p
14 
3
75 
is orthogonal. It must be a unit vector that is orthogonal to the other columns; how 
much freedom does this leave? Verify that the rows automatically become orthonormal 
at the same time. 
7. Show, by forming bTb directly, that Pythagoras’s law holds for any combination 
b = x1q1+. . .+xnqn of orthonormal vectors: kbk2 = x2
1+. . .+x2
n. In matrix terms, 
b = Qx, so this again proves that lengths are preserved: kQxk2 = kxk2. 
8. Project the vector b = (1;2) onto two vectors that are not orthogonal, a1 = (1;0) 
and a2 = (1;1). Show that, unlike the orthogonal case, the sum of the two onedimensional 
projections does not equal b. 
9. If the vectors q1, q2, q3 are orthonormal, what combination of q1 and q2 is closest to 
q3?
3.4 Orthogonal Bases and Gram-Schmidt 209 
10. If q1 and q2 are the outputs from Gram-Schmidt, what were the possible input vectors 
a and b? 
11. Show that an orthogonal matrix that is upper triangular must be diagonal. 
12. What multiple of a1 = 
.
11
¤ 
should be subtracted from a2 = 
.40
¤ 
to make the result 
orthogonal to a1? Factor 
. 1 4 
1 0 
¤ 
into QR with orthonormal vectors in Q. 
13. Apply the Gram-Schmidt process to 
a = 
2
64
0
0
1
3
75
; b = 
2
64
0
1
1
3
75
; c = 
2
64
1
1
1
3
75 
and write the result in the form A = QR. 
14. From the nonorthogonal a, b, c, find orthonormal vectors q1, q2, q3: 
a = 
2
64
1
1
0
3
75
; b = 
2
64
1
0
1
3
75
; c = 
2
64
0
1
1
3
75
: 
15. Find an orthonormal set q1, q2, q3 for which q1, q2 span the column space of 
A = 
2
64
1 1 
2 .1 
.2 4 
3
75
: 
Which fundamental subspace contains q3? What is the least-squares solution of 
Ax = b if b = [1 2 7]T? 
16. Express the Gram-Schmidt orthogonalization of a1, a2 as A = QR: 
a1 = 
2
64
1
2
2
3
75; a2 = 
2
64
1
3
1
3
75
: 
Given n vectors ai with m components, what are the shapes of A, Q, and R? 
17. With the same matrix A as in Problem 16, and with b = [1 1 1]T, use A = QR to 
solve the least-squares problem Ax = b. 
18. If A = QR, find a simple formula for the projection matrix P onto the column space 
of A. 
19. Show that these modified Gram-Schmidt steps produce the same C as in equation 
(10): 
C¤ = c.(qT1
c)q1 and C =C¤.(qT2
C¤)q2: 
This is much more stable, to subtract the projections one at a time.
210 Chapter 3 Orthogonality 
20. In Hilbert space, find the length of the vector v = (1=
p
2;1=
p
4;1=
p
8; : : :) and the 
length of the function f (x) = ex (over the interval 0 · x · 1). What is the inner 
product over this interval of ex and e.x? 
21. What is the closest function acos x+bsin x to the function f (x) = sin2x on the interval 
from .p to p? What is the closest straight line c+dx? 
22. By setting the derivative to zero, find the value of b1 that minimizes 
kb1 sin x.cos xk2 = 
Z 2p 
0 
(b1 sin x.cos x)2dx: 
Compare with the Fourier coefficient b1. 
23. Find the Fourier coefficients a0, a1, b1 of the step function y(x), which equals 1 on 
the interval 0 · x ·p and 0 on the remaining interval p < x < 2p: 
a0 = 
(y;1) 
(1;1) 
a1 = 
(y;cos x) 
(cos x;cos x) 
b1 = 
(y; sin x) 
(sin x; sin x): 
24. Find the fourth Legendre polynomial. It is a cubic x3+ax2+bx+c that is orthogonal 
to 1, x, and x2. 13
over the interval .1 · x · 1. 
25. What is the closest straight line to the parabola y = x2 over .1 · x · 1? 
26. In the Gram-Schmidt formula (10), verify that C is orthogonal to q1 and q2. 
27. Find an orthonormal basis for the subspace spanned by a1 = (1;.1;0;0), a2 = 
(0;1;.1;0), a3 = (0;0;1;.1). 
28. Apply Gram-Schmidt to (1;.1;0), (0;1;.1), and (1;0;.1), to find an orthonormal 
basis on the plane x1+x2+x3 = 0. What is the dimension of this subspace, and how 
many nonzero vectors come out of Gram-Schmidt? 
29. (Recommended) Find orthogonal vectors A, B, C by Gram-Schmidt from a, b, c: 
a = (1;.1;0;0) b = (0;1;.1;0) c = (0;0;1;.1): 
A, B, C and a, b, c are bases for the vectors perpendicular to d = (1;1;1;1). 
30. If A = QR then ATA = RTR = triangular times triangular. Gram-Schmidt 
on A corresponds to elimination on ATA. Compare 
A = 
2
6664 
1 0 0 
.1 1 0 
0 .1 1 
0 0 .1
3
7775
with ATA = 
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75
: 
For ATA, the pivots are 2, 32
, 43
and the multipliers are .12
and .23
.
3.5 The Fast Fourier Transform 211 
(a) Using those multipliers in A, show that column 1 of A and B = column 2 . 
12
(column 1) and C = column 3. 23
(column 2) are orthogonal. 
(b) Check that kcolumn 1k2 = 2, kBk2 = 32
, and kCk2 = 43
, using the pivots. 
31. True or false (give an example in either case): 
(a) Q.1 is an orthogonal matrix when Q is an orthogonal matrix. 
(b) If Q (3 by 2) has orthonormal columns then kQxk always equals kxk. 
32. (a) Find a basis for the subspace S in R4 spanned by all solutions of 
x1+x2+x3.x4 = 0: 
(b) Find a basis for the orthogonal complement S?. 
(c) Find b1 in S and b2 in S? so that b1+b2 = b = (1;1;1;1). 
3.5 The Fast Fourier Transform 
The Fourier series is linear algebra in infinite dimensions. The “vectors” are functions 
f (x); they are projected onto the sines and cosines; that produces the Fourier coefficients 
ak and bk. From this infinite sequence of sines and cosines, multiplied by ak and bk, we 
can reconstruct f (x). That is the classical case, which Fourier dreamt about, but in actual 
calculations it is the discrete Fourier transform that we compute. Fourier still lives, but 
in finite dimensions. 
This is pure linear algebra, based on orthogonality. The input is a sequence of numbers 
y0; : : : ;yn.1, instead of a function f (x). The output c0; : : : ;cn.1 has the same length 
n. The relation between y and c is linear, so it must be given by a matrix. This is the 
Fourier matrix F, and the whole technology of digital signal processing depends on it. 
The Fourier matrix has remarkable properties. 
Signals are digitized, whether they come from speech or images or sonar or TV (or 
even oil exploration). The signals are transformed by the matrix F, and later they can be 
transformed back—to reconstruct. What is crucially important is that F and F.1 can be 
quick: 
F.1 must be simple. The multiplications by F and F.1 must be fast. 
Those are both true. F.1 has been known for years, and it looks just like F. In fact, 
F is symmetric and orthogonal (apart from a factor 
p
n), and it has only one drawback: 
Its entries are complex numbers. That is a small price to pay, and we pay it below. The 
difficulties are minimized by the fact that all entries of F and F.1 tare powers of a single 
number w. That number has wn = 1.
212 Chapter 3 Orthogonality 
The 4 by 4 discrete Fourier transform uses w = i (and notice i4 = 1). The success of 
the whole DFT depends on F times its complex conjugate F: 
FF = 
2
6664 
1 1 1 1 
1 i i2 i3 
1 i2 i4 i6 
1 i3 i6 i9
3
7775 
2
6664 
1 1 1 1 
1 (.i) (.i)2 (.i)3 
1 (.i)2 (.i)4 (.i)6 
1 (.i)3 (.i)6 (.i)9
3
7775
= 4I: (1) 
Immediately FF =4I tells us that F.1 =F=4. The columns of F are orthogonal (to give 
the zero entries in 4I). The n by n matrices will have FF = nI. Then the inverse of F is 
just F=n. In a moment we will look at the complex number w = e2pi=n (which equals i 
for n = 4). 
It is remarkable that F is so easy to invert. If that were all (and up to 1965 it was all), 
the discrete transform would have an important place. Now there is more. The multiplications 
by F and F.1 can be done in an extremely fast and ingenious way. Instead of 
n2 separate multiplications, coming from the n2 entries in the matrix, the matrix-vector 
products Fc and F.1y require only 12
nlogn steps. This rearrangement of the multiplication 
is called the Fast Fourier Transform. 
The section begins with w and its properties, moves on to F.1, and ends with the 
FFT—the fast transform. The great application in signal processing is filtering, and the 
key to its success is the convolution rule. In matrix language, all “circulant matrices” 
are diagonalized by F. So they reduce to two FFTs and a diagonal matrix. 
Complex Roots of Unity 
Real equations can have complex solutions. The equation x2+1 = 0 led to the invention 
of i (and also to .i!). That was declared to be a solution, and the case was closed. If 
someone asked about x2 .i = 0, there was an answer: The square roots of a complex 
number are again complex numbers. You must allow combinations x+iy, with a real 
part x and an imaginary part y, but no further inventions are necessary. Every real or 
complex polynomial of degree n has a full set of n roots (possibly complex and possibly 
repeated). That is the fundamental theorem of algebra. 
We are interested in equations like x4 = 1. That has four solutions—the fourth roots 
of unity. The two square roots of unity are 1 and .1. The fourth roots are the square 
roots of the square roots, 1 and .1, i and .i. The number i will satisfy i4 = 1 because 
it satisfies i2 = .1. For the eighth roots of unity we need the square roots of i, and that 
brings us to w = (1+i)=
p
2. Squaring w produces (1+2i+i2)=2, which is i—because 
1+i2 is zero. Then w8 = i4 = 1. There has to be a system here. 
The complex numbers cosq +i sinq in the Fourier matrix are extremely special. The 
real part is plotted on the x-axis and the imaginary part on the y-axis (Figure 3.11). Then 
the number w lies on the unit circle; its distance from the origin is cos2q +sin2q = 1.
3.5 The Fast Fourier Transform 213 
It makes an angle q with the horizontal. The whole plane enters in Chapter 5, where 
complex numbers will appear as eigenvalues (even of real matrices). Here we need only 
special points w, all of them on the unit circle, in order to solve wn = 1. 
w8 = 1 
w2 = i 
w = e2/8 = cos 2 
8 + i sin 2 
8 w3 
w4 = .1 
w5 
w6 = .i 
w7 = w 
b b 
b
b 
b b
b b 
Real axis 
2 
8 
Figure 3.11: The eight solutions to z8 = 1 are 1;w;w2; : : : ;w7 with w = (1+i)=
p
2. 
The square of w can be found directly (it just doubles the angle): 
w2 = (cosq +i sinq )2 = cos2q .sin2q +2i sinq cosq : 
The real part cos2q .sin2q is cos2q , and the imaginary part 2 sinq cosq is sin2q . 
(Note that i is not included; the imaginary part is a real number.) Thus w2 = cos2q + 
i sin2q . The square of w is still on the unit circle, but at the double angle 2q . That 
makes us suspect that wn lies at the angle nq , and we are right. 
There is a better way to take powers of w. The combination of cosine and sine is a 
complex exponential, with amplitude one and phase angle q : 
cosq +i sinq = eiq : (2) 
The rules for multiplying, like (e2)(e3)=e5, continue to hold when the exponents iq are 
imaginary. The powers of w = eiq stay on the unit circle: 
Powers of w w2 = ei2q ; wn = einq ; 
1
w 
= e.iq : (3) 
The nth power is at the angle nq . When n = .1, the reciprocal 1=w has angle .q . If 
we multiply cosq +i sinq by cos(.q )+i sin(.q ), we get the answer 1: 
eiq e.iq = (cosq +i sinq )(cosq .i sinq ) = cos2q +sin2q = 1: 
Note. I remember the day when a letter came to MIT from a prisoner in New York, 
asking if Euler’s formula (2) was true. It is really astonishing that three of the key
214 Chapter 3 Orthogonality 
functions of mathematics should come together in such a graceful way. Our best answer 
was to look at the power series for the exponential: 
eiq = 1+iq + 
(iq )2 
2! 
+ 
(iq )3 
3! 
+. . . : 
The real part 1.q 2=2+. . . is cosq . The imaginary part q .q 3=6+. . . is the sine, The 
formula is correct, and I wish we had sent a more beautiful proof. 
With this formula, we can solve wn = 1. It becomes einq = 1, so that nq must carry 
us around the unit circle and back to the start. The solution is to choose q = 2p=n: The 
“primitive” nth root of unity is 
wn = e2pi=n = cos 
2p
n 
+i sin 
2p
n 
: (4) 
Its nth power is e2pi, which equals 1. For n = 8, this root is (1+i)=
p
2: 
w4 = cos 
p
2 
+i sin 
p
2 
= i and w8 = cos 
p
4 
+i sin 
p
4 
= 
1+i 
p
2 
The fourth root is at q = 90°, which is 14
(360°). The other fourth roots are the powers 
i2 = .1, i3 = .i, and i4 = 1. The other eighth roots are the powers w28
;w38
; : : : ;w88
. The 
roots are equally spaced around the unit circle, at intervals of 2p=n. Note again that the 
square of w8 is w4, which will be essential in the Fast Fourier Transform. The roots add 
up to zero. First 1+i.1.i = 0, and then 
Sum of eighth roots 1+w8+w28
+. . .+w78
= 0: (5) 
One proof is to multiply the left side by w8, which leaves it unchanged. (It yields w8+ 
w28
+. . .+w88
and w88
equals 1.) The eight points each move through 45°, but they remain 
the same eight points. Since zero is the only number that is unchanged when multiplied 
by w8, the sum must be zero. When n is even the roots cancel in pairs (like 1+i2 = 0 
and i+i3 = 0). But the three cube roots of 1 also add to zero. 
The Fourier Matrix and Its Inverse 
In the continuous case, the Fourier series can reproduce f (x) over a whole interval. It 
uses infinitely many sines and cosines (or exponentials). In the discrete case, with only 
n coefficients c0; : : : ;cn.1 to choose, we only ask for equality at n points. That gives n 
equations. We reproduce the four values y = 2;4;6;8 when Fc = y: 
Fc = y 
c0 + c1 + c2 + c3 = 2 
c0 + ic1 + i2c2 + i3c3 = 4 
c0 + i2c1 + i4c2 + i6c3 = 6 
c0 + i3c1 + i6c2 + i9c3 = 8: 
(6)
3.5 The Fast Fourier Transform 215 
The input sequence is y = 2;4;6;8. The output sequence is c0;c1;c2;c3. The four equations 
(6) look for a four-term Fourier series that matches the inputs at four equally spaced 
points x on the interval from 0 to 2p: 
Discrete 
Fourier 
Series 
c0+c1eix+c2e2ix+c3e3ix =
8>< 
>: 
2 at x = 0 
4 at x =p=2 
6 at x =p 
8 at x = 3p=2: 
Those are the four equations in system (6). At x = 2p the series returns y0 = 2 and 
continues periodically. The Discrete Fourier Series is best written in this complex form, 
as a combination of exponentials eikx rather than sin kx and cos kx. 
For every n, the matrix connecting y to c can be inverted. It represents n equations, 
requiring the finite series c0+c1eix+. . . (n terms) to agree with y (at n points). The first 
agreement is at x = 0, where c0+. . .+cn.1 = y0. The remaining points bring powers of 
w, and the full problem is Fc = y: 
Fc = y 
2
6666664 
1 1 1 . 1 
1 w w2 . wn.1 
1 w2 w4 . w2(n.1) 
. . . . . 
1 wn.1 w2(n.1) . w(n.1)2
3
7777775 
2
666664 
c0 
c1 
c2 
. 
cn.1
3
777775
= 
2
666664 
y0 
y1 
y2 
. 
yn.1
3
777775
: (7) 
There stands the Fourier matrix F with entries Fjk = wjk. It is natural to number the 
rows and columns from 0 to n.1, instead of 1 to n. The first row has j = 0, the first 
column has k = 0, and all their entries are w0 = 1. 
To find the c’s we have to invert F. In the 4 by 4 case, F.1 was built from 1=i = .i. 
That is the general rule, that F.1 comes from the complex number w.1 = w. It lies at 
the angle .2p=n, where w was at the angle +2p=n: 
3V The inverse matrix is built from the powers of w.1 = 1=w = w: 
F.1 = 
1
n 
2
6666664 
1 1 1 . 1 
1 w.1 w.2 . w.(n.1) 
1 w.2 1 . . 
. . . . . 
1 w.(n.1) w.2(n.1) . w.(n.1)2
3
7777775 
= 
F
n 
: (8) 
Thus F = 
2
64
1 1 1 
1 e2pi=3 e4pi=3 
1 e4pi=3 e8pi=3
3
75
has F.1 = 
1
3 
2
64
1 1 1 
1 e.2pi=3 e.4pi=3 
1 e.4pi=3 e.8pi=3
3
75
: 
Row j of F times column j of F.1 is always (1+1+. . .+1)=n = 1. The harder part is 
off the diagonal, to show that row j of F times column k of F.1 gives zero: 
1 . 1+wjw.k+w2 jw.2k+. . .+w(n.1) jw.(n.1)k = 0 if j 6= k: (9)
216 Chapter 3 Orthogonality 
The key is to notice that those terms are the powers ofW = wjw.k: 
1+W +W2+. . .+Wn.1 = 0: (10) 
This number W is still a root of unity: Wn = wn jw.nk is equal to 1j1.k = 1. Since j 
is different from k, W is different from 1. It is one of the other roots on the unit circle. 
Those roots all satisfy 1+W +. . .+Wn.1 = 0. Another proof comes from 
1.Wn = (1.W)(1+W +W2+. . .+Wn.1): (11) 
Since Wn = 1, the left side is zero. But W is not 1, so the last factor must be zero. The 
columns of F are orthogonal. 
The Fast Fourier Transform 
Fourier analysis is a beautiful theory, and it is also very practical. To analyze a waveform 
into its frequencies is the best way to take a signal apart. The reverse process brings it 
back. For physical and mathematical reasons the exponentials are special, and we can 
pinpoint one central cause: If you differentiate eikx, or integrate it, or translate x to 
x+h, the result is still a multiple of eikx. Exponentials are exactly suited to differential 
equations, integral equations, and difference equations. Each frequency component goes 
its own way, as an eigenvector, and then they recombine into the solution. The analysis 
and synthesis of signals—computing c from y and y from c—is a central part of scientific 
computing. 
We want to show that Fc and F.1y can be done quickly. The key is in the relation of 
F4 to F2—or rather to two copies of F2, which go into a matrix F¤ 
2 : 
F4 = 
2
6664 
1 1 1 1 
1 i i2 i3 
1 i2 i4 i6 
1 i3 i6 i9
3
7775
is close to F¤ 
2 = 
2
6664 
1 1 
1 .1 
1 1 
1 .1
3
7775
: 
F4 contains the powers of w4 =i, the fourth root of 1. F¤ 
2 contains the powers of w2 =.1, 
the square root of 1. Note especially that half the entries in F¤ 
2 are zero. The 2 by 2 
transform, done twice, requires only half as much work as a direct 4 by 4 transform. If 
64 by 64 transform could be replaced by two 32 by 32 transforms, the work would be 
cut in half (plus the cost of reassembling the results). What makes this true, and possible 
in practice, is the simple connection between w64 and w32: 
(w64)2 = w32; or 
.
e2pi=64
.2 
= e2pi=32: 
The 32nd root is twice as far around the circle as the 64th root. If w64 =1, then (w2)32 = 
1. The mth root is the square of the nth root, if m is half of n: 
w2n
= wm if m = 12
n: (12)
3.5 The Fast Fourier Transform 217 
The speed of the FFT, in the standard form presented here, depends on working with 
highly composite numbers like 210 = 1024. Without the fast transform, it takes (1024)2 
multiplications to produce F times c (which we want to do often). By contrast, a fast 
transform can do each multiplication in only 5.1024 steps. It is 200 times faster, because 
it replaces one factor of 1024 by 5. In general it replaces n2 multiplications by 12
n`, 
when n is 2`. By connecting Fn to two copies of Fn=2, and then to four copies of Fn=4, 
and eventually to a very small F, the usual n2 steps are reduced to 12
nlog2 n. 
We need to see how y = Fnc (a vector with n components) can be recovered from two 
vectors that are only half as long. The first step is to divide c itself, by separating its 
even-numbered components from its odd-numbered components: 
c0 = (c0;c2; : : : ;cn.2) and c00 = (c1;c3; : : : ;cn.1): 
The coefficients just go alternately into c0 and c00. From those vectors, the half-size 
transform gives y0 = Fmc0 and y00 = Fmc00. Those are the two multiplications by the 
smaller matrix Fm. The central problem is to recover y from the half-size vectors y0 and 
y00, and Cooley and Tukey noticed how it could be done: 
3W The first m and the last m components of the vector y = Fnc are 
y j = y0
j +wjn
y00 
j ; j = 0; : : : ;m.1 
y j+m = y0
j .wjn
y00 
j ; j = 0; : : : ;m.1: 
(13) 
Thus the three steps are: split c into c0 and c00, transform them by Fm into y0 
and y00, and reconstruct y from equation (13). 
We verify in a moment that this gives the correct y. (You may prefer the flow graph 
to the algebra.) This idea can be repeated. We go from F1024 to F512 to F256. The final 
count is 12
n`, when starting with the power n=2` and going all the way to n=1—where 
no multiplication is needed. This number 14
n` satisfies the rule given above: twice the 
count for m, plus m extra multiplications, produces the count for n: 
2
µ
1
2
m(`.1)
¶
+m = 
1
2
n`: 
Another way to count: There are ` steps from n = 2` to n = 1. Each step needs n=2 
multiplications by Dn=2 in equation (13), which is really a factorization of Fn: 
One FFT step F1024 = 
"
I512 D512 
I512 .D512
#"
F512 
F512
#" 
even-odd 
permutation
#
: (14) 
The cost is only slightly more than linear. Fourier analysis has been completely transformed 
by the FFT. To verify equation (13), split y j into even and odd: 
y j = 
n.1 
a
k=0
wjk 
n ck is identical to 
m.1 
a
k=0 
w2k j 
n c2k+
m.1 
a
k=0 
w(2k+1) j 
n c2k+1:
218 Chapter 3 Orthogonality 
Each sum on the right has m = 12
n terms. Since w2n
is wm, the two sums are 
y j = 
m.1 
a
k=0 
wk j 
m c0
k+wjn 
m.1 
a
k=0 
wk j 
m c00 
k = y0
j +wjn
y00 
j : (15) 
For the second part of equation (13), j+m in place of j produces a sign change: 
Inside the sums, wk( j+1) 
m remains wk j 
m since wkm 
m = 1k = 1. 
Outside, wj+m 
n = .wjn
because wmn
= e2pim=n = epi = .1. 
The FFT idea is easily modified to allow other prime factors of n (not only powers of 2). 
If n itself is a prime, a completely different algorithm is used. 
Example 1. The steps from n = 4 to m = 2 are 
2
6664 
c0 
c1 
c2 
c3
3
7775
!
2
6664 
c0 
c2 
c1 
c3
3
7775
!
2
64
F2c0 
F2c00
3
75
!
2
6 4y
3
75
: 
Combined, the three steps multiply c by F4 to give y. Since each step is linear, it must 
come from a matrix, and the product of those matrices must be F4: 
2
6664 
1 1 1 1 
1 i i2 i3 
1 i2 i4 i6 
1 i3 i6 i9
3
7775
= 
2
6664 
1 1 
1 i 
1 .1 
1 .i
3
7775 
2
6664 
1 1 
1 .1 
1 1 
1 .1
3
7775 
2
6664 
1 
1 
1 
1
3
7775
: (16) 
You recognize the two copies of F2 in the center. At the right is the permutation matrix 
that separates c into c0 and c00. At the left is the matrix that multiplies by wjn
. If we 
started with F8, the middle matrix would contain two copies of F4. Each of those would 
be split as above. Thus the FFT amounts to a giant factorization of the Fourier matrix! 
The single matrix F with n2 nonzeros is a product of approximately ` = log2 n matrices 
(and a permutation) with a total of only n` nonzeros. 
The Complete FFT and the Butterfly 
The first step of the FFT changes multiplication by Fn to two multiplications by Fm. 
The even-numbered components (c0;c2) are transformed separately from (c1;c3), Figure 
3.12 gives a flow graph for n = 4. For n = 8, the key idea is to replace each F4 box by 
F2 boxes. The new factor w4 = i is the square of the old factor w = w8 = e2pi=8. The 
flow graph shows the order that the c’s enter the FFT and the log2 n stages that take them 
through it—and it also shows the simplicity of the logic. 
Every stage needs 12
n multiplications so the final count is 12
nlogn. There is an amazing 
rule for the overall permutation of c’s before entering the FFT: Write the subscripts
3.5 The Fast Fourier Transform 219 
b b b 
b b b 
b b b 
c0 b b b 
c1 
c2 
c3 
y0 
y2 
y1 
y3 
c00 
c0 
y00 
y0 
00 
10 
01 
11 
00 
01 
10 
11 
.i 
.1 
i
1 
.1 
.1 
Figure 3.12: Flow graph for the Fast Fourier Transform with n = 4. 
0; : : : ;7 in binary and reverse the order of their bits. The subscripts appear in “bitreversed 
order” on the left side of the graph. Even numbers come before odd (numbers 
ending in 0 come before numbers ending in 1). 
Problem Set 3.5 
1. What are F2 and F4 for the 4 by 4 Fourier matrix F? 
2. Find a permutation P of the columns of F that produces FP = F (n by n), Combine 
with FF = nI to find F2 and F4 for the n by n Fourier matrix. 
3. If you form a 3 by 3 submatrix of the 6 by 6 matrix F6, keeping only the entries in 
its first, third, and fifth rows and columns, what is that submatrix? 
4. Mark all the sixth roots of 1 in the complex plane. What is the primitive root w6? 
(Find its real and imaginary part.) Which power of w6 is equal to 1=w6? What is 
1+w+w2+w3+w4+w5? 
5. Find all solutions to the equation eix = .1, and all solutions to eiq = i. 
6. What are the square and the square root of w128, the primitive 128th root of 1? 
7. Solve the 4 by 4 system (6) if the right-hand sides are y0 = 2, y1 = 0, y2 = 2, y3 = 0. 
In other words, solve F4c = y. 
8. Solve the same system with y = (2;0;.2;0) by knowing F.1 
4 and computing c = 
F.1 
4 y. Verify that c0+c1eix+c2e2ix+c3e3ix takes the values 2, 0, .2, 0 at the points 
x = 0;p=2;p;3p=2. 
9. (a) If y = (1;1;1;1), show that c = (1;0;0;0) satisfies F4c = y. 
(b) Now suppose y = (1;0;0;0), and find c.
220 Chapter 3 Orthogonality 
10. For n = 2, write y0 from the first line of equation (13) and y1 from the second line. 
For n = 4, use the first line to find y0 and y1, and the second to find y2 and y3, all in 
terms of y0 and y00. 
11. Compute y = F4c by the three steps of the Fast Fourier Transform if c = (1;0;1;0). 
12. Compute y=F8c by the three steps of the Fast Fourier Transform if c=(1;0;1;0;1;0;1;0). 
Repeat the computation with c = (0;1;0;1;0;1;0;1). 
13. For the 4 by 4 matrix, write out the formulas for c0, c1, c2, c3 and verify that if f is 
odd then c is odd. The vector f is odd if fn.j = .f j; for n = 4 that means f0 = 0, 
f3 = .f1, f2 = 0 as in sin0, sinp=2, sinp, sin3p=2. This is copied by c and it leads 
to a fast sine transform. 
14. Multiply the three matrices in equation (16) and compare with F. in which six entries 
do you need to know that i2 = .1? 
15. Invert the three factors in equation (14) to find a fast factorization of F.1. 
16. F is symmetric. So transpose equation (14) to find a new Fast Fourier Transform! 
17. All entries in the factorization of F6 involve powers of w = sixth root of 1: 
F6 = 
"
I D 
I .D
#"
F3 
F3
#h 
P 
i
: 
Write these factors with 1, w, w2 in D and 1, w2, w4 in F3. Multiply! 
Problems 18–20 introduce the idea of an eigenvector and eigenvalue, when a matrix 
times a vector is a multiple of that vector. This is the theme of Chapter 5. 
18. The columns of the Fourier matrix F are the eigenvectors of the cyclic permutation 
P. Multiply PF to find the eigenvalues l0 to l3: 
2
6664 
0 1 0 0 
0 0 1 0 
0 0 0 1 
1 0 0 0
3
7775 
2
6664 
1 1 1 1 
1 i i2 i3 
1 i2 i4 i6 
1 i3 i6 i9
3
7775
= 
2
6664 
1 1 1 1 
1 i i2 i3 
1 i2 i4 i6 
1 i3 i6 i9
3
7775 
2
6664 
l0 
l1 
l2 
l3
3
7775
: 
This is PF = FL or P = FLF.1. 
19. Two eigenvectors of this circulant matrix C are (1;1;1;1) and (1; i; i2; i3). What are 
the eigenvalues e0 and e1? 
2
6664 c0 c1 c2 c3 
c3 c0 c1 c2 
c2 c3 c0c1 
c1 c2 c3 c0
3
7775 
2
6664 
1
1
1
1
3
7775
= e0
2
6664 
1
1
1
1
3
7775
and C
2
6664 
1
i 
i2 
i3
3
7775
= e1
2
6664 
1
i 
i2 
i3
3
7775
:
3.5 The Fast Fourier Transform 221 
20. Find the eigenvalues of the “periodic” .1, 2, .1 matrix C. The .1s in the corners 
of C make it periodic (a circulant matrix): 
C = 
2
6664 
2 .1 0 .1 
.1 2 .1 0 
0 .1 2 .1 
.1 0 .1 2 
3
7775
has c0 = 2; c1 = .1; c2 = 0; c3 = .1: 
21. To multiply C times x, when C =FEF.1, we can multiply F(E(F.1x)) instead. The 
direct Cx uses n2 separate multiplications. Knowing E and F, the second way uses 
only nlog2 n+n multiplications. How many of those come from E, how many from 
F, and how many from F.1? 
22. How could you quickly compute these four components of Fc starting from c0+c2, 
c0.c2, c1+c3, c1.c3? You are finding the Fast Fourier Transform! 
Fc = 
2
6664 
c0+c1+c2+c3 
c0+ic1+i2c2+i3c3 
c0+i2c1+i4c2+i6c3 
c0+i3c1+i6c2+i9c3
3
7775
: 
Review Exercises 
3.1 Find the length of a = (2;.2;1), and write two independent vectors that are perpendicular 
to a. 
3.2 Find all vectors that are perpendicular to (1;3;1) and (2;7;2), by making those the 
rows of A and solving Ax = 0. 
3.3 What is the angle between a = (2;.2;1) and b = (1;2;2)? 
3.4 What is the projection p of b = (1;2;2) onto a = (2;.2;1)? 
3.5 Find the cosine of the angle between the vectors (3;4) and (4;3), 
3.6 Where is the projection of b = (1;1;1) onto the plane spanned by (1;0;0) and 
(1;1;0)? 
3.7 The system Ax = b has a solution if and only if b is orthogonal to which of the four 
fundamental subspaces? 
3.8 Which straight line gives the best fit to the following data: b = 0 at t = 0, b = 0 at 
t = 1, b = 12 at t = 3? 
3.9 Construct the projection matrix P onto the space spanned by (1;1;1) and (0;1;3).
222 Chapter 3 Orthogonality 
3.10 Which constant function is closest to y = x4 (in the least-squares sense) over the 
interval 0 · x · 1? 
3.11 If Q is orthogonal, is the same true of Q3? 
3.12 Find all 3 by 3 orthogonal matrices whose entries are zeros and ones. 
3.13 What multiple of a1 should be subtracted from a2, to make the result orthogonal to 
a1? Sketch a figure. 
3.14 Factor "
cosq sinq 
sinq 0 
# 
into QR, recognizing that the first column is already a unit vector. 
3.15 If every entry in an orthogonal matrix is either 14
or .14
, how big is the matrix? 
3.16 Suppose the vectors q1; : : : ;qn are orthonormal. If b = c1q1 +. . .+cnqn, give a 
formula for the first coefficient c1 in terms of b and the q’s. 
3.17 What words describe the equation ATAbx = ATb, the vector p = Abx = Pb, and the 
matrix P = A(ATA).1AT? 
3.18 If the orthonormal vectors q1 = (23
;23
;.13
) and q2 = (.13
;23
;23) are the columns of 
Q, what are the matrices QTQ and QQT? Show that QQT is a projection matrix 
(onto the plane of q1 and q2). 
3.19 If v1; : : : ;vn is an orthonormal basis for Rn, show that v1vT1
+. . .+vnvTn
= I. 
3.20 True or false: If the vectors x and y are orthogonal, and P is a projection, then Px 
and Py are orthogonal. 
3.21 Try to fit a line b=C+Dt through the points b=0, t =2, and b=6, t =2, and show 
that the normal equations break down. Sketch all the optimal lines, minimizing the 
sum of squares of the two errors. 
3.22 What point on the plane x+y.z = 0 is closest to b = (2;1;0)? 
3.23 Find an orthonormal basis for R3 starting with the vector (1;1;1). 
3.24 CT scanners examine the patient from different directions and produce a matrix 
giving the densities of bone and tissue at each point. Mathematically, the problem 
is to recover a matrix from its projections. in the 2 by 2 case, can you recover the 
matrix A if you know the sum along each row and down each column? 
3.25 Can you recover a 3 by 3 matrix if you know its row sums and column sums, and 
also the sums down the main diagonal and the four other parallel diagonals?
3.5 The Fast Fourier Transform 223 
3.26 Find an orthonormal basis for the plane x.y+z = 0, and find the matrix P that 
projects onto the plane. What is the nullspace of P? 
3.27 Let A = [3 1 1], and let V be the nullspace of A. 
(a) Find a basis for V and a basis for V?. 
(b) Write an orthonormal basis for V?, and find the projection matrix P1 that projects 
vectors in R3 onto V?. 
(c) Find the projection matrix P2 that projects vectors in R3 onto V. 
3.28 Use Gram-Schmidt to construct an orthonormal pair q1, q2 from a1 = (4;5;2;2) 
and a2 = (1;2;0;0), Express a1 and a2 as combinations of q1 and q2, and find the 
triangular R in A = QR. 
3.29 For any A, b, x, and y, show that 
(a) if Ax = b and yTA = 0, then yTb = 0. 
(b) if Ax = 0 and ATy = b, then xTb = 0. 
What theorem does this prove about the fundamental subspaces? 
3.30 Is there a matrix whose row space contains (1;1;0) and whose nullspace contains 
(0;1;1)? 
3.31 The distance from a plane aTx=c (in m-dimensional space) to the origin is jcj=kak. 
How far is the plane x1+x2.x3.x4 = 8 from the origin, and what point on it is 
nearest? 
3.32 In the parallelogram with corners at 0, v, w, and v+w, show that the sum of the 
squared lengths of the four sides equals the sum of the squared lengths of the two 
diagonals. 
3.33 (a) Find an orthonormal basis for the column space of A. 
A = 
2
666664 
1 .6 
3 6 
4 8 
5 0 
7 8 
3
777775
: 
(b) Write A as QR, where Q has orthonormal columns and R is upper triangular. 
(c) Find the least-squares solution to Ax = b, if b = (.3;7;1;0;4). 
3.34 With weighting matrixW =
. 2 1 
1 0 
¤
, what is theW-inner product of (1;0) with (0;1)?
224 Chapter 3 Orthogonality 
3.35 To solve a rectangular system Ax = b, we replace A.1 (which doesn’t exist) by 
(ATA).1AT (which exists if A has independent columns). Show that this is a leftinverse 
of A but not a right-inverse. On the left of A it gives the identity; on the right 
it gives the projection P. 
3.36 Find the straight line C+Dt that best fits the measurements b = 0;1;2;5 at times 
t = 0;1;3;4. 
3.37 Find the curve y = C+D2t which gives the best least-squares fit to the measurements 
y = 6 at t = 0, y = 4 at t = 1, y = 0 at t = 2. Write the three equations that 
are solved if the curve goes through the three points, and find the best C and D. 
3.38 If the columns of A are orthogonal to each other what can you say about the form 
of ATA? If the columns are orthonormal, what can you say then? 
3.39 Under what condition on the columns of A (which may be rectangular) is ATA invertible?

Chapter 4 
Determinants 
4.1 Introduction 
Determinants are much further from the center of linear algebra than they were a hundred 
years ago. Mathematics keeps changing direction! After all, a single number can tell 
only so much about a matrix. Still, it is amazing how much this number can do. 
One viewpoint is this: The determinant provides an explicit “formula” for each entry 
of A.1 and A.1b. This formula will not change the way we compute; even the determinant 
itself is found by elimination. In fact, elimination can be regarded as the most 
efficient way to substitute the entries of an n by n matrix into the formula. What the 
formula does is to show how A.1 depends on the n2 entries of A, and how it varies when 
those entries vary. 
We can list four of the main uses of determinants: 
1. They test for invertibility. If the determinant of A is zero, then A is singular. If 
detA 6= 0, then A is invertible (and A.1 involves 1=detA). 
The most important application, and the reason this chapter is essential to the book, 
is to the family of matrices A.l I. The parameter l is subtracted all along the main 
diagonal, and the problem is to find the eigenvalues for which A.l I is singular. The 
test is det(A.l I) = 0. This polynomial of degree n in l has exactly n roots. The matrix 
has n eigenvalues, This is a fact that follows from the determinant formula, and not from 
a computer. 
2. The determinant of A equals the volume of a box in n-dimensional space. The edges 
of the box come from the rows of A (Figure 4.1). The columns of A would give an 
entirely different box with the same volume. 
The simplest box is a little cube dV = dxdydz, as in 
RRR 
f (x;y; z)dV. Suppose we 
change to cylindrical coordinates by x = r cosq , y = r sinq , z = z. Just as a small interval 
dx is stretched to (dx=du)du—when u replaces x in a single integral—so the volume 
element becomes J dr dq dz. The Jacobian determinant is the three-dimensional ana-
226 Chapter 4 Determinants 
x 
y 
z 
(a31, a32, a33) 
(a21, a22, a23) 
(a11, a12, a13) 
Figure 4.1: The box formed from the rows of A: volume = jdeterminantj. 
logue of the stretching factor dx=du: 
Jacobian J =
....... 
¶ x=¶ r ¶ x=¶q ¶ x=¶ z 
¶ y=¶ r ¶ y=¶q ¶ y=¶ z 
¶ z=¶ r ¶ z=¶q ¶ z=¶ z
.......
=
....... 
cosq .r sinq 0 
sinq r cosq 0 
0 0 1
.......
: 
The value of this determinant is J = r. It is the r in the cylindrical volume element 
r dr dq dz; this element is our little box. (It looks curved if we try to draw it, but probably 
it gets straighter as the edges become infinitesimal.) 
3. The determinant gives a formula for each pivot. Theoretically, we could predict 
when a pivot entry will be zero, requiring a row exchange. From the formula determinant 
= § (product of the pivots), it follows that regardless of the order of elimination, 
the product of the pivots remains the same apart from sign. 
Years ago, this led to the belief that it was useless to escape a very small pivot by 
exchanging rows, since eventually the small pivot would catch up with us. But what 
usually happens in practice, if an abnormally small pivot is not avoided, is that it is very 
soon followed by an abnormally large one. This brings the product back to normal but 
it leaves the numerical solution in ruins. 
4. The determinant measures the dependence of A.1b on each element of b. If one 
parameter is changed in an experiment, or one observation is corrected, the “influence 
coefficient” in A.1 is a ratio of determinants. 
There is one more problem about the determinant. It is difficult not only to decide 
on its importance, and its proper place in the theory of linear algebra, but also to choose
4.2 Properties of the Determinant 227 
the best definition. Obviously, detA will not be some extremely simple function of n2 
variables; otherwise A.1 would be much easier to find than it actually is. 
The simple things about the determinant are not the explicit formulas, but the properties 
it possesses. This suggests the natural place to begin. The determinant can be (and 
will be) defined by its three most basic properties: det I = 1, the sign is reversed by a 
row exchange, the determinant is linear in each row separately. The problem is then 
to show, by systematically using these properties, how the determinant can be computed. 
This will bring us back to the product of the pivots. 
Section 4.2 explains these three defining properties of the determinant, and their most 
important consequences. Section 4.3 gives two more formulas for the determinant—the 
“big formula” with n! terms, and a formula “by induction”. In Section 4.4 the determinant 
is applied to find A.1. Then we compute x=A.1b by Cramer’s rule. And finally, in 
an optional remark on permutations, we show that whatever the order in which the properties 
are used, the result is always the same—the defining properties are self-consistent. 
Here is a light-hearted question about permutations. How many exchanges does it 
take to change VISA into AVIS? Is this permutation odd or even? 
4.2 Properties of the Determinant 
This will be a pretty long list. Fortunately each rule is easy to understand, and even 
easier to illustrate, for a 2 by 2 example. Therefore we shall verify that the familiar 
definition in the 2 by 2 case,
det
"
a b 
c d
# 
=
.....
a b 
c d
.....= ad.bc; 
possesses every property in the list. (Notice the two accepted notations for the determinant, 
detA and jAj.) Properties 4–10 will be deduced from the previous ones. Every 
property is a consequence of the first three. We emphasize that the rules apply to 
square matrices of any size. 
1. The determinant of the identity matrix is 1. 
det I = 1 
.....
1 0 
0 1
.....
= 1 and 
....... 
1 0 0 
0 1 0 
0 0 1
.......
= 1 and: : :
228 Chapter 4 Determinants 
2. The determinant changes sign when two rows are exchanged. 
Row exchange 
.....
c d 
a b
.....
= cb.ad = .
.....
a b 
c d
.....
: 
The determinant of every permutation matrix is detP = §1. By row exchanges, we can 
turn P into the identity matrix. Each row exchange switches the sign of the determinant, 
until we reach det I = 1. Now come all other matrices! 
3. The determinant depends linearly on the first row. Suppose A, B, C are the same 
from the second row down—and row 1 of A is a linear combination of the first rows of 
B and C. Then the rule says: detA is the same combination of detB and detC. 
Linear combinations involve two operations—adding vectors and multiplying by scalars. 
Therefore this rule can be split into two parts: 
Add vectors in row 1 
.....
a+a0 b+b0 
c d 
.....
=
.....
a b 
c d
.....
+
.....
a0 b0 
c d
.....
: 
Multiply by t in row 1 
.....
ta tb 
c d
.....
= t
.....
a b 
c d
.....
: 
Notice that the first part is not the false statement det(B+C) = detB+detC. You cannot 
add all the rows: only one row is allowed to change. Both sides give the answer ad + 
a0d.bc.b0c. 
The second part is not the false statement det(tA) =t detA. The matrix tA has a factor 
t in every row (and the determinant is multiplied by tn). It is like the volume of a box, 
when all sides are stretched by 4. In n dimensions the volume and determinant go up by 
4n. If only one side is stretched, the volume and determinant go up by 4; that is rule 3. 
By rule 2, there is nothing special about the first row. 
The determinant is now settled, but that fact is not at all obvious. Therefore we gradually 
use these rules to find the determinant of any matrix. 
4. If two rows of A are equal, then detA = 0. 
Equal rows 
.....
a b 
a b
.....
= ab.ba = 0: 
This follows from rule 2, since if the equal rows are exchanged, the determinant is supposed 
to change sign. But it also has to stay the same, because the matrix stays the same. 
The only number which can do that is zero, so detA = 0. (The reasoning fails if 1 = .1, 
which is the case in Boolean algebra. Then rule 4 should replace rule 2 as one of the 
defining properties.)
4.2 Properties of the Determinant 229 
5. Subtracting a multiple of one row from another row leaves the same determinant. 
Row operation 
.....
a.`c b.`d 
c d 
.....
=
.....
a b 
c d
.....
: 
Rule 3 would say that there is a further term .`
..
c d 
c d
..
, but that term is zero by rule 4. The 
usual elimination steps do not affect the determinant! 
6. If A has a row of zeros, then detA = 0. 
Zero row 
.....
0 0 
c d
.....
= 0: 
One proof is to add some other row to the zero row. The determinant is unchanged, by 
rule 5. Because the matrix will now have two identical rows, detA = 0 by rule 4. 
7. If A is triangular then detA is the product a11a22 . . .ann of the diagonal entries. If 
the triangular A has 1s along the diagonal, then detA = 1. 
Triangular matrix 
.....
a b 
0 d
.....
= ad 
.....
a 0 
c d
.....
= ad: 
Proof. Suppose the diagonal entries are nonzero. Then elimination can remove all the 
off-diagonal entries, without changing the determinant (by rule 5). If A is lower triangular, 
the steps are downward as usual. If A is upper triangular, the last column is cleared 
out first—using multiples of ann. Either way we reach the diagonal matrix D: 
D = 
2
64
a11 
. . . 
ann
3
75
has detD = a11a22 . . .ann det I = a11a22 . . .ann: 
To find detD we patiently apply rule 3. Factoring out a11 and then a22 and finally ann 
leaves the identity matrix. At last we have a use for rule 1: det I = 1. 
If a diagonal entry is zero then elimination will produce a zero row. By rule 5 these 
elimination steps do not change the determinant. By rule 6 the zero row means a zero 
determinant. This means: When a triangular matrix is singular (because of a zero on the 
main diagonal) its determinant is zero. 
This is a key property. All singular matrices have a zero determinant. 
8. If A is singular, then detA = 0. If A is invertible, then detA 6= 0. 
Singular matrix 
"
a b 
c d
# 
is not invertible if and only if ad.bc = 0:
230 Chapter 4 Determinants 
If A is singular, elimination leads to a zero row in U. Then detA = detU = 0. If A 
is nonsingular, elimination puts the pivots d1; : : : ;dn on the main diagonal. We have a 
“product of pivots” formula for detA! The sign depends on whether the number of row 
exchanges is even or odd: 
Product of pivots detA = §detU = §d1d2 . . .dn: (1) 
The ninth property is the product rule. I would say it is the most surprising. 
9. The determinant of AB is the product of detA times det B. 
Product rule jAjjBj = jABj 
.....
a b 
c d
..... 
.....
e f 
g h
.....
=
.....
ae+bg a f +bh 
ce+dg c f +dh
.....
: 
A particular case of this rule gives the determinant of A.1. It must be 1=detA: 
detA.1 = 
1 
detA 
because (detA)(detA.1) = detAA.1 = det I = 1: (2) 
In the 2 by 2 case, the product rule could be patiently checked: 
(ad.bc)(eh. f g) = (ae+bg)(c f +dh).(a f +bh)(ce+dg): 
In the n by n case we suggest two possible proofs—since this is the least obvious rule. 
Both proofs assume that A and B are nonsingular; otherwise AB is singular, and the 
equation detAB = (detA)(detB) is easily verified. By rule 8, it becomes 0 = 0. 
(i) We prove that the ratio d(A) = detAB=detB has properties 1–3. Then d(A) must 
equal detA. For example, d(I) = detB=detB = 1; rule 1 is satisfied. If two rows 
of A are exchanged, so are the same two rows of AB, and the sign of d changes 
as required by rule 2. A linear combination in the first row of A gives the same 
linear combination in the first row of AB. Then rule 3 for the determinant of AB, 
divided by the fixed quantity detB, leads to rule 3 for the ratio d(A). Thus d(A) = 
detAB=detB coincides with detA, which is our product formula. 
(ii) This second proof is less elegant. For a diagonal matrix, detDB = (detD)(detB) 
follows by factoring each di from its row. Reduce a general matrix A to D by 
elimination—from A to U as usual, and from U to D by upward elimination. The 
determinant does not change, except for a sign reversal when rows are exchanged. 
The same steps reduce AB to DB, with precisely the same effect on the determinant. 
But for DB it is already confirmed that rule 9 is correct. 
10. The transpose of A has the same determinant as A itself: detAT = det A. 
Transpose rule 
...
A
...
=
.....
a b 
c d
.....
=
.....
a c 
b d
.....
=
...
AT
...
:
4.2 Properties of the Determinant 231 
Again the singular case is separate; A is singular if and only if AT is singular, and we 
have 0 = 0. If A is nonsingular, then it allows the factorization PA = LDU, and we apply 
rule 9 for the determinant of a product: 
detPdetA = detLdetDdetU: (3) 
Transposing PA = LDU gives ATPT =UTDTLT, and again by rule 9, 
detAT detPT = detUT detDT detLT: (4) 
This is simpler than it looks, because L, U, LT, and UT are triangular with unit diagonal. 
By rule 7, their determinants all equal 1. Also, any diagonal matrix is the same as its 
transpose: D = DT. We only have to show that detP = detPT. 
Certainly detP is 1 or .1, because P comes from I by row exchanges. Observe also 
that PPT = I. (The 1 in the first row of P matches the 1 in the first column of PT, and 
misses the 1s in the other columns.) Therefore detPdetPT = det I = 1, and P and PT 
must have the same determinant: both 1 or both .1. 
We conclude that the products (3) and (4) are the same, and detA = detAT. This 
fact practically doubles our list of properties, because every rule that applied to the rows 
can now be applied to the columns: The determinant changes sign when two columns 
are exchanged, two equal columns (or a column of zeros) produce a zero determinant, 
and the determinant depends linearly on each individual column. The proof is just to 
transpose the matrix and work with the rows. 
I think it is time to stop and call the list complete. It only remains to find a definite 
formula for the determinant, and to put that formula to use. 
Problem Set 4.2 
1. If a 4 by 4 matrix has detA = 12
, find det(2A), det(.A), det(A2), and det(A.1). 
2. If a 3 by 3 matrix has detA = .1, find det(12
A), det(.A), det(A2), and det(A.1). 
3. Row exchange: Add row 1 of A to row 2, then subtract row 2 from row 1. Then 
add row 1 to row 2 and multiply row 1 by .1 to reach B. Which rules show the 
following? 
detB =
.....
c d 
a b
.....
equals .detA = .
.....
a b 
c d
.....
: 
Those rules could replace Rule 2 in the definition of the determinant.
232 Chapter 4 Determinants 
4. By applying row operations to produce an upper triangular U, compute 
det
2
6664 
1 2 .2 0 
2 3 .4 1 
.1 .2 0 2 
0 2 5 3
3
7775
and det
2
6664 
2 .1 0 0 
.1 2 .1 0 
0 .1 2 .1 
0 0 .1 .2
3
7775
: 
Exchange rows 3 and 4 of the second matrix and recompute the pivots and determinant. 
Note. Some readers will already know a formula for 3 by 3 determinants. It has six 
terms (equation (2) of the next section), three going parallel to the main diagonal and 
three others going the opposite way with minus signs. There is a similar formula for 
4 by 4 determinants, but it contains 4! = 24 terms (not just eight). You cannot even 
be sure that a minus sign goes with the reverse diagonal, as the next exercises show. 
5. Count row exchanges to find these determinants: 
det
2
6664 
0 0 0 1 
0 0 1 0 
0 1 0 0 
1 0 0 0
3
7775
= §1 and det
2
6664 
0 1 0 0 
0 0 1 0 
0 0 0 1 
1 0 0 0
3
7775
= .1: 
6. For each n, how many exchanges will put (row n, row n.1; : : : ; row 1) into the 
normal order (row 1, : : : , row n.1, row n)? Find detP for the n by n permutation 
with 1s on the reverse diagonal. Problem 5 had n = 4. 
7. Find the determinants of: 
(a) a rank one matrix 
A = 
2
64
1
4
2
3
75
h
2 .1 2
i
: 
(b) the upper triangular matrix 
U = 
2
6664 
4 4 8 8 
0 1 2 2 
0 0 2 6 
0 0 0 2
3
7775
: 
(c) the lower triangular matrix UT. 
(d) the inverse matrix U.1.
4.2 Properties of the Determinant 233 
(e) the “reverse-triangular” matrix that results from row exchanges, 
M = 
2
6664 
0 0 0 2 
0 0 2 6 
0 1 2 2 
4 4 8 8
3
7775
: 
8. Show how rule 6 (det = 0 if a row is zero) comes directly from rules 2 and 3. 
9. Suppose you do two row operations at once, going from 
"
a b 
c d
# 
to 
"
a.mc b.md 
c.`a d.`b 
#
: 
Find the determinant of the new matrix, by rule 3 or by direct calculation. 
10. If Q is an orthogonal matrix, so that QTQ = I, prove that detQ equals +1 or .1. 
What kind of box is formed from the rows (or columns) of Q? 
11. Prove again that detQ = 1 or .1 using only the Product rule. If j detQj > 1 then 
detQn blows up. How do you know this can’t happen to Qn? 
12. Use row operations to verify that the 3 by 3 “Vandermonde determinant” is 
det
2
64
1 a a2 
1 b b2 
1 c c2
3
75
= (b.a)(c.a)(c.b): 
13. (a) A skew-symmetric matrix satisfies KT = .K, as in 
K = 
2
64
0 a b 
.a 0 c 
.b .c 0
3
75
: 
In the 3 by 3 case, why is det(.K) = (.1)3 detK? On the other hand detKT = 
detK (always). Deduce that the determinant must be zero. 
(b) Write down a 4 by 4 skew-symmetric matrix with detK not zero. 
14. True or false, with reason if true and counterexample if false: 
(a) If A and B are identical except that b11 = 2a11, then detB = 2detA. 
(b) The determinant is the product of the pivots. 
(c) If A is invertible and B is singular, then A+B is invertible. 
(d) If A is invertible and B is singular, then AB is singular. 
(e) The determinant of AB.BA is zero.
234 Chapter 4 Determinants 
15. If every row of A adds to zero, prove that detA = 0. If every row adds to 1, prove 
that det(A.I) = 0. Show by example that this does not imply detA = 1. 
16. Find these 4 by 4 determinants by Gaussian elimination: 
det
2
6664 
11 12 13 14 
21 22 23 24 
31 32 33 34 
41 42 43 44
3
7775
and det
2
6664 
1 t t2 t3 
t 1 t t2 
t2 t 1 t 
t3 t2 t 1
3
7775
: 
17. Find the determinants of 
A = 
"
4 2 
1 3
#
; A.1 = 
1 
10 
" 
3 .2 
.1 4 
#
; A.l I = 
"
4.l 2 
1 3.l 
#
: 
For which values of l is A.l I a singular matrix? 
18. Evaluate detA by reducing the matrix to triangular form (rules 5 and 7). 
A = 
2
64
1 1 3 
0 4 6 
1 5 8
3
75
; B = 
2
64
1 1 3 
0 4 6 
0 0 1
3
75
; C = 
2
64
1 1 3 
0 4 6 
1 5 9
3
75
: 
What are the determinants of B, C, AB, ATA, and CT? 
19. Suppose that CD = .DC, and find the flaw in the following argument: Taking determinants 
gives (detC)(detD) = .(detD)(detC), so either detC = 0 or detD = 0. 
Thus CD = .DC is only possible if C or D is singular. 
20. Do these matrices have determinant 0, 1, 2, or 3? 
A = 
2
64
0 0 1 
1 0 0 
0 1 0
3
75
B = 
2
64
0 1 1 
1 0 1 
1 1 0
3
75
C = 
2
64
1 1 1 
1 1 1 
1 1 1
3
75
: 
21. The inverse of a 2 by 2 matrix seems to have determinant = 1: 
detA.1 = det 
1 
ad.bc 
" 
d .b 
.c a 
# 
= 
ad.bc 
ad.bc 
= 1: 
What is wrong with this calculation? What is the correct detA.1? 
Problems 22–28 use the rules to compute specific determinants. 
22. Reduce A to U and find detA = product of the pivots: 
A = 
2
64
1 1 1 
1 2 2 
1 2 3
3
75
and A = 
2
64
1 2 3 
2 2 3 
3 3 3
3
75
:
4.2 Properties of the Determinant 235 
23. By applying row operations to produce an upper triangular U, compute 
det
2
6664 
1 2 3 0 
2 6 6 1 
.1 0 0 3 
0 2 0 7
3
7775
and det
2
6664 
2 1 1 1 
1 2 1 1 
1 1 2 1 
1 1 1 2
3
7775
: 
24. Use row operations to simplify and compute these determinants: 
det
2
64
101 201 301 
102 202 302 
103 203 303
3
75
and det
2
64
1 t t2 
t 1 t 
t2 t 1
3
75
: 
25. Elimination reduces A to U. Then A = LU: 
A = 
2
64
3 3 4 
6 8 7 
.3 5 .9
3
75
= 
2
64
1 0 0 
2 1 0 
.1 4 1
3
75 
2
64
3 3 4 
0 2 .1 
0 0 .1
3
75
= LU: 
Find the determinants of L, U, A, U.1L.1, and U.1L.1A. 
26. If ai j is i times j, show that detA = 0. (Exception when A = [1].) 
27. If ai j is i+ j, show that detA = 0. (Exception when n = 1 or 2.) 
28. Compute the determinants of these matrices by row operations: 
A = 
2
64
0 a 0 
0 0 b 
c 0 0
3
75
; B = 
2
6664 
0 a 0 0 
0 0 b 0 
0 0 0 c 
d 0 0 0
3
7775
; and C = 
2
64
a a a 
a b b 
a b c
3
75
: 
29. What is wrong with this proof that projection matrices have detP = 1? 
P = A(ATA).1AT so jPj = jAj 
1 
jATjjAj 
jATj = 1: 
30. (Calculus question) Show that the partial derivatives of ln(detA) give A.1: 
f (a;b;c;d) = ln(ad.bc) leads to 
"
¶ f =¶ a ¶ f =¶ c 
¶ f =¶ b ¶ f =¶ d
# 
= A.1: 
31. (MATLAB) The Hilbert matrix hilb(n) has i, j entry equal to 1=(i+ j .1). Print 
ti determinants of hilb(1);hilb(2); : : : ;hilb(10). Hilbert matrices are hard to work 
with! What are the pivots? 
32. (MATLAB) What is a typical determinant (experimentally) of rand(n) and randn(n) 
for n = 50;100;200;400? (And what does “Inf” mean in MATLAB?)
236 Chapter 4 Determinants 
33. Using MATLAB, find the largest determinant of a 4 by 4 matrix of 0s and 1s. 
34. If you know that detA = 6, what is the determinant of B? 
detA =
....... 
row 1 
row 2 
row 3
.......
= 6 detB =
....... 
row 1+row 2 
row 2+row 3 
row 3+row 1
.......
= 
35. Suppose the 4 by 4 matrix M has four equal rows all containing a, b, c, d. We know 
that det(M) = 0. The problem is to find det(I+M) by any method: 
det(I+M) =
......... 
1+a b c d 
a 1+b c d 
a b 1+c d 
a b c 1+d
......... 
: 
Partial credit if you find this determinant when a = b = c = d = 1. Sudden death if 
you say that det(I+M) = det I+detM. 
4.3 Formulas for the Determinant 
The first formula has already appeared. Row operations produce the pivots in D: 
4A If A is invertible, then PA = LDU and detP = §1. The product rule gives 
detA = §detLdetDdetU = §(product of the pivots): (1) 
The sign §1 depends on whether the number of row exchanges is even or odd. 
The triangular factors have detL = detU = 1 and detD = d1 . . .dn. 
In the 2 by 2 case, the standard LDU factorization is 
"
a b 
c d
# 
= 
" 
1 0 
c=a 1
#"
a 0 
0 (ad.bc)=a
#"
1 b=a 
0 1 
#
: 
The product of the pivots is ad .bc. That is the determinant of the diagonal matrix D. 
If the first step is a row exchange, the pivots are c and (.detA)=c. 
Example 1. The .1;2;.1 second difference matrix has pivots 2=1;3=2; : : : in D: 
2
666664 
2 .1 
.1 2 .1 
.1 2 . 
. . .1 
.1 2 
3
777775
= LDU = L
2
666664 
2 
3=2 
4=3 
. 
(n+1)=n
3
777775
U:
4.3 Formulas for the Determinant 237 
Its determinant is the product of its pivots. The numbers 2; : : : ;n all cancel: 
detA = 2
µ
3
2
¶µ
4
3
¶
. . .
µ
n+1 
n 
¶ 
= n+1: 
MATLAB computes the determinant from the pivots. But concentrating all information 
into the pivots makes it impossible to figure out how a change in one entry would affect 
the determinant. We want to find an explicit expression for the determinant in terms of 
the n2 entries. 
For n = 2, we will be proving that ad .bc is correct. For n = 3, the determinant 
formula is again pretty well known (it has six terms): 
....... 
a11 a12 a13 
a21 a22 a23 
a31 a32 a33
.......
= 
+a11a22a33+a12a23a31+a13a21a32 
.a11a23a32.a12a21a33.a13a22a31: 
(2) 
Our goal is to derive these formulas directly from the defining properties 1–3 of detA. If 
we can handle n = 2 and n = 3 in an organized way, you will see the pattern. 
To start, each row can be broken down into vectors in the coordinate directions: 
h
a b
i 
= 
h
a 0
i
+
h
0 b
i 
and 
h
c d
i 
= 
h
c 0
i
+
h
0 d
i
: 
Then we apply the property of linearity, first in row 1 and then in row 2: 
Separate into 
nn = 22 easy 
determinants 
.....
a b 
c d
.....
=
.....
a 0 
c d
.....
+
.....
0 b 
c d
..... 
=
.....
a 0 
c 0
.....
+
.....
a 0 
0 d
.....
+
.....
0 b 
c 0
.....
+
.....
0 b 
0 d
.....
: 
(3) 
Every row splits into n coordinate directions, so this expansion has nn terms. Most of 
those terms (all but n! = n factorial) will be automatically zero. When two rows are in 
the same coordinate direction, one will be a multiple of the other, and 
.....
a 0 
c 0
.....
= 0; 
.....
0 b 
0 d
.....
= 0: 
We pay attention only when the rows point in different directions. The nonzero terms 
have to come in different columns. Suppose the first row has a nonzero term in column 
a, the second row is nonzero in column b , and finally the nth row in column v. The 
column numbers a;b ; : : : ;v are all different. They are a reordering, or permutation, of
238 Chapter 4 Determinants 
the numbers 1;2; : : : ;n. The 3 by 3 case produces 3! = 6 determinants: 
....... 
a11 a12 a13 
a21 a22 a23 
a31 a32 a33
.......
=
....... 
a11 
a22 
a33
.......
+
....... 
a12 
a23 
a31 
.......
+
....... 
a13 
a21 
a32 
....... 
+
....... 
a11 
a23 
a32 
.......
+
....... 
a12 
a21 
a33
.......
+
....... 
a13 
a22 
a31 
.......
: 
(4) 
All but these n! determinants are zero, because a column is repeated. (There are 
n choices for the first column a, n.1 remaining choices for b , and finally only one 
choice for the last column v. All but one column will be used by that time, when we 
“snake” down the rows of the matrix). In other words, there are n! ways to permute the 
numbers 1;2; : : : ;n. The column numbers give the permutations: 
Column numbers (a;b ;v)=(1;2;3); (2;3;1); (3;1;2); (1;3;2); (2;1;3); (3;2;1): 
Those are the 3! = 6 permutations of (1;2;3); the first one is the identity. 
The determinant of A is now reduced to six separate and much simpler determinants. 
Factoring out the ai j, there is a term for every one of the six permutations: 
detA = a11a22a33
....... 
1 
1 
1
.......
+a12a23a31
....... 
1 
1 
1 
.......
+a13a21a32
....... 
1 
1 
1 
....... 
+a11a23a32
....... 
1 
1 
1 
.......
+a12a21a33
....... 
1 
1 
1
.......
+a13a22a31
....... 
1 
1 
1 
.......
: 
(5) 
Every term is a product of n=3 entries ai j, with each row and column represented once. 
If the columns come in the order (a; : : : ;v), that term is the product a1a . . .anv times the 
determinant of a permutation matrix P. The determinant of the whole matrix is the sum 
of these n! terms, and that sum is the explicit formula we are after: 
Big Formula detA = a 
all P’s
(a1a a2b . . .anv) detP: (6) 
For an n by n matrix, this sum is taken over all n! permutations (a; : : : ;v) of the numbers 
(1; : : : ;n). The permutation gives the column numbers as we go down the matrix. The is 
appear in P at the same places where the a’s appeared in A. 
It remains to find the determinant of P. Row exchanges transform it to the identity 
matrix, and each exchange reverses the sign of the determinant: 
detP = +1 or .1 for an even or odd number of row exchanges:
4.3 Formulas for the Determinant 239 
(1;3;2) is odd so 
....... 
1 
1 
1 
.......
= .1 (3;1;2) is even so 
....... 
1 
1 
1 
.......
= 1 
(1;3;2) requires one exchange and (3;1;2) requires two exchanges to recover (1;2;3). 
These are two of the six § signs. For n = 2, we only have (1;2) and (2;1): 
detA = a11a22 det
"
1 0 
0 1
#
+a12a21 det
"
0 1 
1 0
# 
= a11a22.a12a21 (or ad.bc). 
No one can claim that the big formula (6) is particularly simple. Nevertheless, it is 
possible to see why it has properties 1–3. For A = I, every product of the ai j will be 
zero, except for the column sequence (1;2; : : : ;n). This term gives det I = 1. Property 2 
will be checked in the next section, because here we are most interested in property 3: 
The determinant should depend linearly on the first row a11;a12; : : : ;a1n. 
Look at all the terms a1a a2b . . .anv involving a11. The first column is a = 1. This 
leaves some permutation (b ; : : : ;v) of the remaining columns (2; : : : ;n). We collect all 
these terms together as a11C11, where the coefficient of a11 is a smaller determinant— 
with row 1 and column 1 removed: 
Cofactor of a11 C11 =a(a2b . . .anv) detP = det(submatrix of A): (7) 
Similarly, the entry a12 is multiplied by some smaller determinant C12. Grouping all the 
terms that start with the same a1 j, formula (6) becomes 
Cofactors along row 1 detA = a11C11+a12C12+. . .+a1nC1n: (8) 
This shows that detA depends linearly on the entries a11; : : : ;a1n of the first row. 
Example 2. For a 3 by 3 matrix, this way of collecting terms gives 
detA = a11(a22a33.a23a32)+a12(a23a31.a21a33)+a13(a21a32.a22a31): (9) 
The cofactors C11, C12, C13 are the 2 by 2 determinants in parentheses. 
Expansion of detA in Cofactors 
We want one more formula for the determinant. If this meant starting again from scratch, 
it would be too much, But the formula is already discovered—it is (8), and the only point 
is to identify the cofactors C1 j that multiply a1 j. 
We know that C1 j depends on rows 2; : : : ;n. Row 1 is already accounted for by 
a1 j. Furthermore, a1 j also accounts for the jth column, so its cofactor C1 j must depend
240 Chapter 4 Determinants 
entirely on the other columns. No row or column can be used twice in the same term. 
What we are really doing is splitting the determinant into the following sum: 
Cofactor 
splitting 
....... 
a11 a12 a13 
a21 a22 a23 
a31 a32 a33
.......
=
....... 
a11 
a22 a23 
a32 a33
.......
+
....... 
a12 
a21 a23 
a31 a33
.......
+
....... 
a13 
a21 a22 
a31 a32 
.......
: 
For a determinant of order n, this splitting gives n smaller determinants (minors) of order 
n.1; you see the three 2 by 2 submatrices. The submatrix M1 j is formed by throwing 
away row 1 and column j. Its determinant is multiplied by a1 j—and by a plus or minus 
sign. These signs alternate as in detM11, .detM12, detM13: 
Cofactors of row 1 C1 j = (.1)1+j detM1 j: 
The second cofactor C12 is a23a31.a21a33, which is detM12 times .1. This same technique 
works on every n by n matrix. The splitting above confirms that C11 is the determinant 
of the lower right corner M11. 
There is a similar expansion on any other row, say row i. It could be proved by 
exchanging row i with row 1. Remember to delete row i and column j of A for Mi j: 
4B The determinant of A is a combination of any row i times its cofactors: 
detA by cofactors detA = ai1Ci1+ai2Ci2+. . .+ainCin: (10) 
The cofactor C1 j is the determinant of Mi j with the correct sign: 
delete row i and column j Ci j = (.1)i+j detMi j: (11) 
These formulas express detA as a combination of determinants of order n.1. We 
could have defined the determinant by induction on n. A 1 by 1 matrix has detA = a11, 
and then equation (10) defines the determinants of 2 by 2 matrices, 3 by 3 matrices, 
and n by n matrices. We preferred to define the determinant by its properties, which 
are much simpler to explain. The explicit formula (6) and the cofactor formula (10) 
followed directly from these properties. 
There is one more consequence of detA = detAT. We can expand in cofactors of a 
column of A, which is a row of AT. Down column j of A, 
detA = a1 jC1 j +a2 jC2 j +. . .+an jCn j: (12) 
Example 3. The 4 by 4 second difference matrix A4 has only two nonzeros in row 1: 
Use cofactors A4 = 
2
6664 
2 .1 0 0 
.1 2 .1 0 
0 .1 2 .1 
0 0 .1 2 
3
7775
:
4.3 Formulas for the Determinant 241 
C11 comes from erasing row 1 and column 1, which leaves the .1, 2, .1 pattern: 
C11 = detA3 = det
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75 
For a12 = .1 it is column 2 that gets removed, and we need its cofactor C12: 
C12 = (.1)1+2 det
2
64
.1 .1 0 
0 2 .1 
0 .1 2 
3
75
= +det
" 
2 .1 
.1 2 
# 
= detA2: 
This left us with the 2 by 2 determinant. Altogether row 1 has produced 2C11.C12: 
detA4 = 2(detA3).detA2 = 2(4).3 = 5 
The same idea applies to A5 and A6, and every An: 
Recursion by cofactors detAn = 2(detAn.1).detAn.2: (13) 
This gives the determinant of increasingly bigger matrices. At every step the determinant 
of An is n+1, from the previous determinants n and n.1: 
.1, 2, .1 matrix detAn = 2(n).(n.1) = n+1: 
The answer n+1 agrees with the product of pivots at the start of this section. 
Problem Set 4.3 
1. For these matrices, find the only nonzero term in the big formula (6): 
A = 
2
6664 
0 1 0 0 
1 0 1 0 
0 1 0 1 
0 0 1 0
3
7775and B = 
2
6664 
0 0 1 2 
0 3 4 5 
6 7 8 9 
0 0 0 1
3
7775
: 
There is only one way of choosing four nonzero entries from different rows and 
different columns. By deciding even or odd, compute detA and detB. 
2. Expand those determinants in cofactors of the first row. Find the cofactors (they 
include the signs (.1)i+j) and the determinants of A and B. 
3. True or false? 
(a) The determinant of S.1AS equals the determinant of A. 
(b) If detA = 0 then at least one of the cofactors must be zero.
242 Chapter 4 Determinants 
(c) A matrix whose entries are 0s and 1s has determinant 1, 0, or .1. 
4. (a) Find the LU factorization, the pivots, and the determinant of the 4 by 4 matrix 
whose entries are ai j = smaller of i and j. (Write out the matrix.) 
(b) Find the determinant if ai j = smaller of ni and nj, where n1 = 2, n2 = 6, n3 = 8, 
n4 = 10. Can you give a general rule for any n1 · n2 · n3 · n4? 
5. Let Fn be the determinant of the 1, 1, .1 tridiagonal matrix (n by n): 
Fn = det
2
666664 
1 .1 
1 1 .1 
1 1 .1 
. . . 
1 1
3
777775
: 
By expanding in cofactors along row 1, show that Fn = Fn.1+Fn.2. This yields the 
Fibonacci sequence 1;2;3;5;8;13; : : : for the determinants. 
6. Suppose An is the n by n tridiagonal matrix with is on the three diagonals: 
A1 = 
h
1
i
; A2 = 
"
1 1 
1 1
#
; A3 = 
2
64
1 1 0 
1 1 1 
0 1 1
3
75
; : : : 
Let Dn be the determinant of An; we want to find it. 
(a) Expand in cofactors along the first row to show that Dn = Dn.1.Dn.2. 
(b) Starting from D1 = 1 and D2 = 0, find D3;D4; : : : ;D8. By noticing how these 
numbers cycle around (with what period?) find D1000. 
7. (a) Evaluate this determinant by cofactors of row 1: 
......... 4 4 4 4 
1 2 0 1 
2 0 1 2 
1 1 0 2
......... 
: 
(b) Check by subtracting column 1 from the other columns and recomputing. 
8. Compute the determinants of A2, A3, A4. Can you predict An? 
A2 = 
"
0 1 
1 0
# 
A3 = 
2
64
0 1 1 
1 0 1 
1 1 0
3
75
A4 = 
2
6664 
0 1 1 1 
1 0 1 1 
1 1 0 1 
1 1 1 0
3
7775
: 
Use row operations to produce zeros, or use cofactors of row 1.
4.3 Formulas for the Determinant 243 
9. How many multiplications to find an n by n determinant from 
(a) the big formula (6)? 
(b) the cofactor formula (10), building from the count for n.1? 
(c) the product of pivots formula (including the elimination steps)? 
10. In a 5 by 5 matrix, does a + sign or . sign go with a15a24a33a42a51 down the reverse 
diagonal? In other words, is P=(5;4;3;2;1) even or odd? The checkerboard pattern 
of § signs for cofactors does not give detP. 
11. If A is m by n and B is n by m, explain why 
det
" 
0 A 
.B I 
# 
= detAB: 
A
Hint: Postmultiply by 
"
I 0 
B I
#
:
! 
Do an example with m < n and an example with m > n. Why does your second 
example automatically have detAB = 0? 
12. Suppose the matrix A is fixed, except that a11 varies from .. to +.. Give examples 
in which detA is always zero or never zero. Then show from the cofactor expansion 
(8) that otherwise detA = 0 for exactly one value of a11. 
Problems 13–23 use the big formula with n! terms: jAj = a§a1a a2b . . .anv. 
13. Compute the determinants of A, B, C from six terms. Independent rows? 
A = 
2
64
1 2 3 
3 1 2 
3 2 1
3
75
B = 
2
64
1 2 3 
4 4 4 
5 6 7
3
75
C = 
2
64
1 1 1 
1 1 0 
1 0 0
3
75
: 
14. Compute the determinants of A, B, C. Are their columns independent? 
A = 
2
64
1 1 0 
1 0 1 
0 1 1
3
75
B = 
2
64
1 2 3 
4 5 6 
7 8 9
3
75
C = 
"
A 0 
0 B
#
: 
15. Show that detA = 0, regardless of the five nonzeros marked by x’s: 
A = 
2
64
x x x 
0 0 x 
0 0 x
3
75
: (What is the rank of A?) 
16. This problem shows in two ways that detA = 0 (the x’s are any numbers): 
A = 
2
666664 
x x x x x 
x x x x x 
0 0 0 x x 
0 0 0 x x 
0 0 0 x x
3
777775
: 
5 by 5 matrix 
3 by 3 zero matrix 
Always singular
244 Chapter 4 Determinants 
(a) How do you know that the rows are linearly dependent? 
(b) Explain why all 120 terms are zero in the big formula for detA. 
17. Find two ways to choose nonzeros from four different rows and columns: 
A = 
2
6664 
1 0 0 1 
0 1 1 1 
1 1 0 1 
1 0 0 1
3
7775
B = 
2
6664 
1 0 0 2 
0 3 4 5 
5 4 0 3 
2 0 0 1
3
7775
: (B has the same zeros as A.) 
Is detA equal to 1+1 or 1.1 or .1.1? What is detB? 
18. Place the smallest number of zeros in a 4 by 4 matrix that will guarantee detA = 0. 
Place as many zeros as possible while still allowing detA 6= 0. 
19. (a) If a11 = a22 = a33 = 0, how many of the six terms in detA will be zero? 
(b) If a11 = a22 = a33 = a44 = 0, how many of the 24 products a1 ja2ka3`a4m are sure 
to be zero? 
20. How many 5 by 5 permutation matrices have detP = +1? Those are even permutations. 
Find one that needs four exchanges to reach the identity matrix. 
21. If detA 6= 0, at least one of the n! terms in the big formula (6) is not zero. Deduce 
that some ordering of the rows of A leaves no zeros on the diagonal. (Don’t use P 
from elimination; that PA can have zeros on the diagonal.) 
22. Prove that 4 is the largest determinant for a 3 by 3 matrix of 1s and .1s. 
23. How many permutations of (1;2;3;4) are even and what are they? Extra credit: 
What are all the possible 4 by 4 determinants of I+Peven? 
Problems 24–33 use cofactors Ci j = (.1)i+j detMi j. Delete row i, column j. 
24. Find cofactors and then transpose. Multiply CT
A and CT
B by A and B! 
A = 
"
2 1 
3 6
# 
B = 
2
64
1 2 3 
4 5 6 
7 0 0
3
75
: 
25. Find the cofactor matrix C and compare ACT with A.1: 
A = 
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75
A.1 = 
1
4 
2
64
3 2 1 
2 4 2 
1 2 3
3
75
:
4.3 Formulas for the Determinant 245 
26. The matrix Bn is the .1, 2, .1 matrix An except that b11 = 1 instead of a11 = 2. 
Using cofactors of the last row of B4, show that jB4j = 2jB3j.jB2j = 1: 
B4 = 
2
6664 
1 .1 
.1 2 .1 
.1 2 .1 
.1 2 
3
7775
B3 = 
2
64
1 .1 
.1 2 .1 
.1 2 
3
75
: 
The recursion jBnj = 2jBn.1j.jBn.2j is the same as for the A’s. The difference is in 
the starting values 1, 1, 1 for n = 1;2;3. What are the pivots? 
27. Bn is still the same as An except for b11 = 1. So use linearity in the first row, where 
[1 .1 0] equals [2 .1 0] minus [1 0 0]: 
jBnj =
......... 
1 .1 0 
.1 
An.1 
0 
......... 
=
......... 
2 .1 0 
.1 
An.1 
0 
......... 
.
......... 
1 0 0 
.1 
An.1 
0 
......... 
: 
Linearity in row 1 gives jBnj = jAnj.jAn.1j = . 
28. The n by n determinant Cn has 1s above and below the main diagonal: 
C1 =
...
0
...
C2 =
.....
0 1 
1 0
.....
C3 =
....... 
0 1 0 
1 0 1 
0 1 0
.......
C4 =
......... 0 1 0 0 
1 0 1 0 
0 1 0 1 
0 0 1 0
......... 
: 
(a) What are the determinants of C1, C2, C3, C4? 
(b) By cofactors find the relation between Cn and Cn.1 and Cn.2. Find C10. 
29. Problem 28 has 1s just above and below the main diagonal. Going down the matrix, 
which order of columns (if any) gives all 1s? Explain why that permutation is even 
for n = 4;8;12; : : : and odd for n = 2;6;10; : : : 
Cn = 0 (odd n) Cn = 1 (n = 4;8; : : :) Cn = .1 (n = 2;6; : : :): 
30. Explain why this Vandermonde determinant contains x3 but not x4 or x5: 
V4 = det
2
6664 
1 a a2 a3 
1 b b2 b3 
1 c c2 c3 
1 x x2 x3
3
7775
: 
The determinant is zero at x = , , and . The cofactor of x3 is V3 = 
(b.a)(c.a)(c.b). Then V4 = (x.a)(x.b)(x.c)V3.
246 Chapter 4 Determinants 
31. Compute the determinants S1, S2, S3 of these 1, 3, 1 tridiagonal matrices: 
S1
...
3
...
S2 =
.....
3 1 
1 3
.....
S3 =
....... 
3 1 0 
1 3 1 
0 1 3
.......
: 
Make a Fibonacci guess for S4 and verify that you are right. 
32. Cofactors of those 1, 3, 1 matrices give Sn = 3Sn.1 .Sn.2. Challenge: Show that 
Sn is the Fibonacci number F2n+2 by proving F2n+2 = 3F2n .F2n.2. Keep using 
Fibonacci’s rule Fk = Fk.1+Fk.2. 
33. Change 3 to 2 in the upper left corner of the matrices in Problem 32. Why does 
that subtract Sn.1 from the determinant Sn? Show that the determinants become the 
Fibonacci numbers 2, 5, 13 (always F2n+1). 
Problems 34–36 are about block matrices and block determinants. 
34. With 2 by 2 blocks, you cannot always use block determinants! 
.....
A B 
0 D
.....
= jAjjDj but 
.....
A B 
C D
.....6= jAjjDj.jCjjBj: 
(a) Why is the first statement true? Somehow B doesn’t enter. 
(b) Show by example that equality fails (as shown) when C enters. 
(c) Show by example that the answer det(AD.CB) is also wrong. 
35. With block multiplication, A = LU has Ak = LkUk in the upper left corner: 
A = 
"
Ak ¤ 
¤ ¤
# 
= 
"
Lk 0 
¤ ¤
#"
Uk ¤ 
0 ¤
#
: 
(a) Suppose the first three pivots of A are 2, 3, .1. What are the determinants of L1, 
L2, L3 (with diagonal 1s), U1, U2, U3, and A1, A2, A3? 
(b) If A1, A2, A3 have determinants 5, 6, 7, find the three pivots. 
36. Block elimination subtracts CA.1 times the first row [A B] from the second row 
[C D]. This leaves the Schur complement D.CA.1B in the corner: 
" 
I 0 
.CA.1 I
#"
A B 
C D
# 
= 
"
A B 
0 D.CA.1B
#
: 
Take determinants of these matrices to prove correct rules for square blocks: 
.....
A B 
C D
.....
= jAj
..
D.CA.1B
.. 
if A.1 exists 
= jAD.CBj 
if AC =CA 
:
4.4 Applications of Determinants 247 
37. A 3 by 3 determinant has three products “down to the right” and three “down to the 
left” with minus signs. Compute the six terms in the figure to find D. Then explain 
without determinants why this matrix is or is not invertible: 
38. For A4 in Problem 6, five of the 4! = 24 terms in the big formula (6) are nonzero. 
Find those five terms to show that D4 = .1. 
39. For the 4 by 4 tridiagonal matrix (entries .1, 2, .1), find the five terms in the big 
formula that give detA = 16.4.4.4+1. 
40. Find the determinant of this cyclic P by cofactors of row 1. How many exchanges 
reorder 4, 1, 2, 3 into 1, 2, 3, 4? Is jP2j = +1 or .1? 
P = 
2
6664 
0 0 0 1 
1 0 0 0 
0 1 0 0 
0 0 1 0
3
7775
P2 = 
2
6664 
0 0 1 0 
0 0 0 1 
1 0 0 0 
0 1 0 0
3
7775
= 
"
0 I 
I 0
#
: 
41. A=2¤eye(n).diag(ones(n.1, 1),1).diag(ones(n.1, 1),.1) is the .1, 2, .1 
matrix. Change A(1;1) to 1 so detA = 1. Predict the entries of A.1 based on n = 3 
and test the prediction for n = 4. 
42. (MATLAB) The .1, 2, .1 matrices have determinant n+1. Compute (n+1)A.1 
for n = 3 and 4, and verify your guess for n = 5. (Inverses of tridiagonal matrices 
have the rank-1 form uvT above the diagonal.) 
43. All Pascal matrices have determinant 1. If I subtract 1 from the n, n entry, why does 
the determinant become zero? (Use rule 3 or a cofactor.) 
det
2
6664 
1 1 1 1 
1 2 3 4 
1 3 6 10 
1 4 10 20
3
7775= 1 (known) det
2
6664 
1 1 1 1 
1 2 3 4 
1 3 6 10 
1 4 10 19
3
7775
= 0 (explain): 
4.4 Applications of Determinants 
This section follows through on four major applications: inverse of A, solving Ax = b, 
volumes of boxes, and pivots. They are among the key computations in linear algebra
248 Chapter 4 Determinants 
(done by elimination). Determinants give formulas for the answers. 
1. Computation of A.1. The 2 by 2 case shows how cofactors go into A.1: 
"
a b 
c d
#.1 
= 
1 
ad.bc 
" 
d .b 
.c a 
# 
= 
1 
detA 
"
C11 C21 
C12 C22
#
: 
We are dividing by the determinant, and A is invertible exactly when detA is nonzero. 
The number C11 = d is the cofactor of a. The number C12 = .c is the cofactor of b (note 
the minus sign). That number C12 goes in row 2, column 1! 
The row a, b times the column C11, C12 produces ad.bc. This is the cofactor expansion 
of detA. That is the clue we need: A.1 divides the cofactors by detA. 
Cofactor matrix 
C is transposed 
A.1 = 
CT 
detA 
means (A.1)i j = 
Cji 
detA
: (1) 
Our goal is to verify this formula for A.1. We have to see why ACT = (detA)I: 
2
64
a11 . . . a1n 
... 
... 
an1 . . . ann
3
75 
2
64
C11 . . . C1n 
... 
... 
Cn1 . . . Cnn
3
75
= 
2
64
detA . . . 0 
... 
... 
0 . . . detA
3
75
: (2) 
With cofactorsC11; : : : ;C1n in the first column and not the first row, they multiply a11; : : : ;a1n 
and give the diagonal entry detA. Every row of A multiplies its cofactors (the cofactor 
expansion) to give the same answer detA on the diagonal. 
The critical question is: Why do we get zeros off the diagonal? If we combine the 
entries a1 j from row 1 with the cofactors C2 j for row 2, why is the result zero? 
row 1 of A, row 2 of C a11C21+a12C22+. . .+a1nC2n = 0: (3) 
The answer is: We are computing the determinant of a new matrix B, with a new row 2. 
The first row of A is copied into the second row of B. Then B has two equal rows, and 
detB = 0. Equation (3) is the expansion of detB along its row 2, where B has exactly 
the same cofactors as A (because the second row is thrown away to find those cofactors). 
The remarkable matrix multiplication (2) is correct. 
That multiplication ACT =(detA)I immediately gives A.1. Remember that the cofactor 
from deleting row i and column j of A goes into row j and column i of CT. Dividing 
by the number detA (if it is not zero!) gives A.1 =CT=detA. 
Example 1. The inverse of a sum matrix is a difference matrix: 
A = 
2
64
1 1 1 
0 1 1 
0 0 1
3
75
has A.1 = 
CT 
detA 
= 
2
64
1 .1 0 
0 1 .1 
0 0 1 
3
75
: 
The minus signs enter because cofactors always include (.1)i+j.
4.4 Applications of Determinants 249 
2. The Solution of Ax = b. The multiplication x = A.1b is just CTb divided bydetA. 
There is a famous way in which to write the answer (x1; : : : ;xn): 
4C Cramer’s rule: The jth component of x = A.1b is the ratio 
x j = 
detBj 
detA 
; where Bj = 
2
64
a11 a12 b1 a1n 
... 
... 
... 
... 
an1 an2 bn ann
3
75
has b in column j: (4) 
Proof. Expand detBj in cofactors of its jth column (which is b). Since the cofactors 
ignore that column, detBj is exactly the jth component in the product CTb: 
detBj = b1C1 j +b2C2 j +. . .+bnCn j: 
Dividing this by detA gives x j. Each component of x is a ratio of two determinants. That 
fact might have been recognized from Gaussian elimination, but it never was. 
Example 2. The solution of 
x1 + 3x2 = 0 
2x1 + 4x2 = 6 
has 0 and 6 in the first column for x1 and in the second column for x2: 
x1 = 
.....
0 3 
6 4
.....
.....
1 3 
2 4
..... 
= 
.18 
.2 
= 9; x2 = 
.....
1 0 
2 6
.....
.....
1 3 
2 4
..... 
= 
6 
.2 
= .3: 
The denominators are always detA. For 1000 equations Cramer’s Rule would need 1001 
determinants. To my dismay I found in a book called Mathematics for the Millions that 
Cramer’s Rule was actually recommended (and elimination was thrown aside): 
To deal with a set involving the four variables u, v, w, z, we first have to 
eliminate one of them in each of three pairs to derive three equations in three 
variables and then proceed as for the three-fold left-hand set to derive values 
for two of them. The reader who does so as an exercise will begin to realize 
how formidably laborious the method of elimination becomes, when we have 
to deal with more than three variables. This consideration invites us to explore 
the possibility of a speedier method... 
3. The Volume of a Box. The connection between the determinant and the volume is 
clearest when all angles are right angles—the edges are perpendicular, and the box is 
rectangular. Then the volume is the product of the edge lengths: volume = `1`2 . . . `n.
250 Chapter 4 Determinants 
We want to obtain the same `1`2 . . . `n from detA, when the edges of that box are the 
rows of A. With right angles, these rows are orthogonal and AAT is diagonal: 
Right-angled box 
Orthogonal rows 
AAT = 
2
64
row 1 
... 
row n
3
75 
2
4 
r r 
o o 
w . . . w 
1 n
3
5 = 
2
64
`21
0 
. . . 
0 `2n 
3
75
: 
The `i are the lengths of the rows (the edges). and the zeros off the diagonal come 
because the rows are orthogonal. Using the product and transposing rules, 
Rightangle case `21
`22
. . . `2n
= det(AAT) = (detA)(detAT) = (detA)2: 
The square root of this equation says that the determinant equals the volume. The sign 
of detA will indicate whether the edges form a “right-handed” set of coordinates, as in 
the usual x-y-z system, or a left-handed system like y-x-z. 
If the angles are not 90°, the volume is not the product of the lengths. In the plane 
(Figure 4.2), the “volume” of a parallelogram equals the base ` times the height h, The 
vector b. p of length h is the second row b = (a21;a22), minus its projection p onto the 
first row. The key point is this: By rule 5, detA is unchanged when a multiple of row 1 
is subtracted from row 2. We can change the parallelogram to a rectangle, where it is 
already proved that volume = determinant. 
In n dimensions, it takes longer to make each box rectangular, but the idea is the 
same. The volume and determinant are unchanged if we subtract from each row its projection 
onto the space spanned by the preceding rows—leaving a perpendicular “height 
vector” like pb. This Gram-Schmidt process produces orthogonal rows, with volume = 
determinant. So the same equality must have held for the original rows. 
height 
h = 
|
b
. 
p
| 
p 
length ` = 
|
a
| 
b = (a21, a22) 
a = (a11, a12) 
0 
`h = det  a 
b . p
 = det a
b
 
Figure 4.2: Volume (area) of the parallelogram = ` times h = j detAj. 
This completes the link between volumes and determinants, but it is worth coming 
back one more time to the simplest case. We know that 
det
"
1 0 
0 1
# 
= 1; det
"
1 0 
c 1
# 
= 1:
4.4 Applications of Determinants 251 
These determinants give the volumes—or areas, since we are in two dimensions—drawn 
in Figure 4.3. The parallelogram has unit base and unit height; its area is also 1. 
1 
1 
row 1 = (1, 0) 
row 2 = (0, 1) 
1 
1 
row 1 = (1, 0) 
row 2 = (c, 1) 
Figure 4.3: The areas of a unit square and a unit parallelogram are both 1. 
4. A Formula for the Pivots. We can finally discover when elimination is possible 
without row exchanges. The key observation is that the first k pivots are completely 
determined by the submatrix Ak in the upper left corner of A. The remaining rows and 
columns of A have no effect on this corner of the problem: 
Elimination on A 
includes 
elimination on A2 
A = 
2
64
a b e 
c d f 
g h i
3
75
!
2
64
a b e 
0 (ad.bc)=a (a f .ec)=a 
g h i 
3
75
: 
Certainly the first pivot depended only on the first row and column, The second pivot 
(ad.bc)=a depends only on the 2 by 2 corner submatrix A2. The rest of A does not enter 
until the third pivot. Actually it is not just the pivots, but the entire upper-left corners of 
L, D, and U, that are determined by the upper-left corner of A: 
A = LDU = 
2
64
1 
c=a 1 
¤ ¤ 1
3
75 
2
64
a 
(ad.bc)=a 
¤
3
75 
2
64
1 b=a ¤ 
1 ¤
1
3
75
: 
What we see in the first two rows and columns is exactly the factorization of the corner 
submatrix A2. This is a general rule if there are no row exchanges: 
4D If A is factored into LDU, the upper left corners satisfy Ak = LkDkUk. For 
every k, the submatrix Ak is going through a Gaussian elimination of its own. 
The proof is to see that this corner can be settled first, before even looking at other 
eliminations. Or use the laws for block multiplication: 
LDU = 
"
Lk 0 
B C
#"
Dk 0 
0 E
#"
Uk F 
0 G
# 
= 
"
LkDkUk LkDkF 
BDkUk BDkF +CEG
#
: 
Comparing the last matrix with A, the corner LkDkUk coincides with Ak. Then: 
detAk = detLk detDk detUk = detDk = d1d2 . . .dk:
252 Chapter 4 Determinants 
The product of the first k pivots is the determinant of Ak. This is the same rule that 
we know already for the whole matrix. Since the determinant of Ak.1 will be given by 
d1d2 . . .dk.1, we can isolate each pivot dk as a ratio of determinants: 
Formula for pivots 
detAk 
detAk.1 
= 
d1d2 . . .dk 
d1d2 . . .dk.1 
= dk: (5) 
In our example above, the second pivot was exactly this ratio (ad .bc)=a. It is the 
determinant of A2 divided by the determinant of A1. (By convention detA0 = 1, so that 
the first pivot is a=1 = a.) Multiplying together all the individual pivots, we recover 
d1d2 . . .dn = 
detA1 
detA0 
detA2 
detA1 
. . . 
detAn 
detAn.1 
= 
detAn 
detA0 
= detA: 
From equation (5) we can finally read off the answer to our original question: The 
pivot entries are all nonzero whenever the numbers detAk are all nonzero: 
4E Elimination can be completed without row exchanges (so P = I and A = 
LU), if and only if the leading submatrices A1;A2; : : : ;An are all nonsingular. 
That does it for determinants, except for an optional remark on property 2—the sign 
reversal on row exchanges. The determinant of a permutation matrix P was the only 
questionable point in the big formula. Independent of the particular row exchanges linking 
P to I, is the number of exchanges always even or always odd? If so, its determinant 
is well defined by rule 2 as either +1 or .1. 
Starting from (3;2;1), a single exchange of 3 and 1 would achieve the natural order 
(1;2;3). So would an exchange of 3 and 2, then 3 and 1, and then 2 and 1. In both 
sequences, the number of exchanges is odd. The assertion is that an even number of 
exchanges can never produce the natural order beginning with (3;2;1). 
Here is a proof. Look at each pair of numbers in the permutation, and let N count 
the pairs in which the larger number comes first. Certainly N = 0 for the natural order 
(1;2;3). The order (3;2;1) has N = 3 since all pairs (3;2), (3;1), and (2;1) are wrong. 
We will show that every exchange alters N by an odd number. Then to arrive at N = 0 
(the natural order) takes a number of exchanges having the same evenness or oddness as 
N. 
When neighbors are exchanged, N changes by +1 or .1. Any exchange can be 
achieved by an odd number of exchanges of neighbors. This will complete the proof; 
an odd number of odd numbers is odd. To exchange the first and fourth entries below, 
which happen to be 2 and 3, we use five exchanges (an odd number) of neighbors: 
(2;1;4;3)!(1;2;4;3)!(1;4;2;3)!(1;4;3;2)!(1;3;4;2)!(3;1;4;2): 
We need `.k exchanges of neighbors to move the entry in place k to place `. Then 
`.k.1 exchanges move the one originally in place ` (and now found in place `.1) 
back down to place k. Since (`.k)+(`.k.1) is odd, the proof is complete. The 
determinant not only has all the properties found earlier, it even exists.
4.4 Applications of Determinants 253 
Problem Set 4.4 
1. Find the determinant and all nine cofactors Ci j of this triangular matrix: 
A = 
2
64
1 2 3 
0 4 0 
0 0 5
3
75
: 
Form CT and verify that ACT = (detA)I. What is A.1? 
2. Use the cofactor matrix C to invert these symmetric matrices: 
A = 
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75
and B = 
2
64
1 1 1 
1 2 2 
1 2 3
3
75
: 
3. Find x, y, and z by Cramer’s Rule in equation (4): 
ax + by = 1 
cx + dy = 0 
and 
x + 4y . z = 1 
x + y + z = 0 
2x + 3z = 0: 
4. (a) Find the determinant when a vector x replaces column j of the identity (consider 
x j = 0 as a separate case): 
if M = 
2
666664 
1 x1 
1 . 
x j 
. 1 
xn 1
3
777775
then detM = : 
(b) If Ax = b, show that AM is the matrix Bj in equation (4), with b in column j. 
(c) Derive Cramer’s rule by taking determinants in AM = Bj. 
5. (a) Draw the triangle with vertices A = (2;2), B = (.1;3), and C = (0;0). By 
regarding it as half of a parallelogram, explain why its area equals 
area(ABC) = 
1
2 
det
" 
2 2 
.1 3
#
: 
(b) Move the third vertex to C = (1;.4) and justify the formula 
area(ABC) = 
1
2 
det
2
64
x1 y1 1 
x2 y2 1 
x3 y3 1
3
75
= 
1
2 
det
2
64
2 2 1 
.1 3 1 
1 .4 1
3
75
:
254 Chapter 4 Determinants 
Hint: Subtracting the last row from each of the others leaves 
det
2
64
2 2 1 
.1 3 1 
1 .4 1
3
75
= det
2
64
1 6 0 
.2 7 0 
1 .4 1
3
75
= det
" 
1 6 
.2 7
#
: 
Sketch A0 = (1;6), B0 = (.2;7), C0 = (0;0) and their relation to A, B, C. 
6. Explain in terms of volumes why det3A = 3n detA for an n by n matrix A. 
7. Predict in advance, and confirm by elimination, the pivot entries of 
A = 
2
64
2 1 2 
4 5 0 
2 7 0
3
75
and B = 
2
64
2 1 2 
4 5 3 
2 7 0
3
75
: 
8. Find all the odd permutations of the numbers f1;2;3;4g. They come from an odd 
number of exchanges and lead to detP = .1. 
9. Suppose the permutation P takes (1;2;3;4;5) to (5;4;1;2;3). 
(a) What does P2 do to (1;2;3;4;5)? 
(b) What does P.1 do to (1;2;3;4;5)? 
10. If P is an odd permutation, explain why P2 is even but P.1 is odd. 
11. Prove that if you keep multiplying A by the same permutation matrix P, the first row 
eventually comes back to its original place. 
12. If A is a 5 by 5 matrix with all jai jj · 1, then detA · . Volumes or the big 
formula or pivots should give some upper bound on the determinant. 
Problems 13–17 are about Cramer’s Rule for x = A.1b. 
13. Solve these linear equations by Cramer’s Rule x j = detBj=detA: 
(a) 
2x1 + 5x2 = 1 
x1 + 4x2 = 2: 
(b) 
2x1 + x2 = 1 
x1 + 2x2 + x3 = 70 
x2 + 2x3 = 0: 
14. Use Cramer’s Rule to solve for y (only). Call the 3 by 3 determinant D: 
(a) 
ax + by = 1 
cx + dy = 0: 
(b) 
ax + by + cz = 1 
dx + ey . f z = 0 
gx + hy + iz = 0:
4.4 Applications of Determinants 255 
15. Cramer’s Rule breaks down when detA = 0. Example (a) has no solution, whereas 
(b) has infinitely many. What are the ratios x j = detBj=detA? 
(a) 
2x1+3x2 = 1 
4x1+6x2 = 1: 
(parallel lines) (b) 
2x1+3x2 = 1 
4x1+6x2 = 2: 
(same line) 
16. Quick proof of Cramer’s rule. The determinant is a linear function of column 1. It is 
zero if two columns are equal. When b=Ax=x1a1+x2a2+x3a3 goes into column 
1 to produce B1, the determinant is 
...
b a2 a3
...
=
...
x1a1+x2a2+x3a3 a2 a3
...
= x1
...
a1 a2 a3
...
= x1 detA: 
(a) What formula for x1 comes from left side = right side? 
(b) What steps lead to the middle equation? 
17. If the right side b is the last column of A, solve the 3 by 3 system Ax = b. Explain 
how each determinant in Cramer’s Rule leads to your solution x. 
Problems 18–26 are about A.1 =CT=detA. Remember to transpose C. 
18. Find A.1 from the cofactor formula CT=detA. Use symmetry in part (b): 
(a) A = 
2
64
1 2 0 
0 3 0 
0 4 1
3
75
: (b) A = 
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75
: 
19. If all the cofactors are zero, how do you know that A has no inverse? If none of the 
cofactors are zero, is A sure to be invertible? 
20. Find the cofactors of A and multiply ACT to find detA: 
A = 
2
64
1 1 4 
1 2 2 
1 2 5
3
75
; C = 
2
646 .3 0 
. . . 
. . .
3
75
; and ACT = : 
If you change that corner entry from 4 to 100, why is detA unchanged? 
21. Suppose detA = 1 and you know all the cofactors. How can you find A? 
22. From the formula ACT = (detA)I show that detC = (detA)n.1. 
23. (For professors only) If you know all 16 cofactors of a 4 by 4 invertible matrix A, 
how would you find A? 
24. If all entries of A are integers, and detA = 1 or .1, prove that all entries of A.1 are 
integers. Give a 2 by 2 example.
256 Chapter 4 Determinants 
25. L is lower triangular and S is symmetric. Assume they are invertible: 
L = 
2
64
a 0 0 
b c 0 
d e f
3
75
S = 
2
64
a b d 
b c e 
d e f
3
75
: 
(a) Which three cofactors of L are zero? Then L.1 is lower triangular. 
(b) Which three pairs of cofactors of S are equal? Then S.1 is symmetric. 
26. For n = 5 the matrix C contains cofactors and each 4 by 4 cofactor contains 
terms and each term needs multiplications. Compare with 53 = 125 for 
the Gauss-Jordan computation of A.1. 
Problems 27–36 are about area and volume by determinants. 
27. (a) Find the area of the parallelogram with edges v = (3;2) and w = (1;4). 
(b) Find the area of the triangle with sides v, w, and v+w. Draw it. 
(c) Find the area of the triangle with sides v, w, and w.v. Draw it. 
28. A box has edges from (0;0;0) to (3;1;1), (1;3;1), and (1;1;3). Find its volume and 
also find the area of each parallelogram face. 
29. (a) The corners of a triangle are (2;1), (3;4), and (0;5). What is the area? 
(b) A new corner at (.1;0) makes it lopsided (four sides). Find the area. 
30. The parallelogram with sides (2;1) and (2;3) has the same area as the parallelogram 
with sides (2;2) and (1;3). Find those areas from 2 by 2 determinants and say why 
they must be equal. (I can’t see why from a picture. Please write to me if you do.) 
31. The Hadamard matrix H has orthogonal rows. The box is a hypercube! 
What is detH =
......... 
1 1 1 1 
1 1 .1 .1 
1 .1 .1 1 
1 .1 1 .1
......... 
= volume of a hypercube in R4? 
32. If the columns of a 4 by 4 matrix have lengths L1, L2, L3, L4, what is the largest 
possible value for the determinant (based on volume)? If all entries are 1 or .1, 
what are those lengths and the maximum determinant? 
33. Show by a picture how a rectangle with area x1y2 minus a rectangle with area x2y1 
produces the area x1y2.x2y1 of a parallelogram. 
34. When the edge vectors a, b, c are perpendicular, the volume of the box is kak times 
kbk times kck. The matrix ATA is . Find detATA and detA.
4.4 Applications of Determinants 257 
35. An n-dimensional cube has how many corners? How many edges? How many (n. 
1)-dimensional faces? The n-cube whose edges are the rows of 2I has volume . 
A hypercube computer has parallel processors at the corners with connections along 
the edges. 
36. The triangle with corners (0;0), (1;0), (0;1) has area 12
. The pyramid with four 
corners (0;0;0), (1;0;0), (0;1;0), (0;0;1) has volume . The pyramid in R4 
with five corners at (0;0;0;0) and the rows of I has what volume? 
Problems 37–40 are about areas dA and volumes dV in calculus. 
37. Polar coordinates satisfy x = r cosq and y = r sinq . Polar area J dr dq includes J: 
J =
.....
¶ x=¶ r ¶ x=¶q 
¶ y=¶ r ¶ y=¶q
.....
=
.....
cosq .r sinq 
sinq r cosq 
.....
: 
The two columns are orthogonal. Their lengths are . Thus J = . 
38. Spherical coordinates r, f , q give x = r sinf cosq , y = r sinf sinq , z = r cosf . 
Find the Jacobian matrix of 9 partial derivatives: ¶ x=¶r, ¶ x=¶f , ¶ x=¶q are in row 
1. Simplify its determinant to J =r2 sinf . Then dV =r2 sinf dr df dq . 
39. The matrix that connects r, q to x, y is in Problem 37. Invert that matrix: 
J.1 =
.....
¶ r=¶ x ¶ r=¶ y 
¶q =¶ x ¶q =¶ y
.....
=
.....
cosq ? 
? ?
.....
=? 
It is surprising that ¶ r=¶ x =¶ x=¶ r. The product JJ.1 = I gives the chain rule 
¶ x 
¶ x 
= 
¶ x 
¶ r 
¶ r 
¶ x 
+ 
¶ x 
¶q 
¶q 
¶ x 
= 1: 
40. The triangle with corners (0;0), (6;0), and (1;4) has area . When you rotate it 
by q = 60° the area is . The rotation matrix has 
determinant =
.....
cosq .sinq 
sinq cosq 
.....
=
..... 
12
? 
? ?
.....
=? 
41. Let P = (1;0;.1), Q = (1;1;1), and R = (2;2;1). Choose S so that PQRS is a 
parallelogram, and compute its area. Choose T, U, V so that OPQRSTUV is a tilted 
box, and compute its volume. 
42. Suppose (x;y; z), (1;1;0), and (1;2;1) lie on a plane through the origin. What determinant 
is zero? What equation does this give for the plane? 
43. Suppose (x;y; z) is a linear combination of (2;3;1) and (1;2;3). What determinant 
is zero? What equation does this give for the plane of all combinations?
258 Chapter 4 Determinants 
44. If Ax = (1;0; : : : ;0) show how Cramer’s Rule gives x = first column of A.1. 
45. (VISA to AVIS) This takes an odd number of exchanges (IVSA, AVSI, AVIS). Count 
the pairs of letters in VISA and AVIS that are reversed from alphabetical order. The 
difference should be odd. 
Review Exercises 
4.1 Find the determinants of 
2
6664 
1 1 1 1 
1 1 1 2 
1 1 3 1 
1 4 1 1
3
7775
and 
2
6664 
2 .1 0 .1 
.1 2 .1 0 
0 .1 2 .1 
.1 0 .1 2 
3
7775
: 
4.2 If B = M.1AM, why is detB = detA? Show also that detA.1B = 1. 
4.3 Starting with A, multiply its first row by 3 to produce B, and subtract the first row 
of B from the second to produce C. How is detC related to detA? 
4.4 Solve 3u+2v = 7, 4u+3v = 11 by Cramer’s rule. 
4.5 If the entries of A and A.1 are all integers, how do you know that both determinants 
are 1 or .1? Hint: What is detA times detA.1? 
4.6 Find all the cofactors, and the inverse or the nullspace, of 
"
3 5 
6 9
#
; 
"
cosq .sinq 
sinq cosq 
#
; and 
"
a b 
a b
#
: 
4.7 What is the volume of the parallelepiped with four of its vertices at (0;0;0), (.1;2;2), 
(2;.1;2), and (2;2;.1)? Where are the other four vertices? 
4.8 How many terms are in the expansion of a 5 by 5 determinant, and how many are 
sure to be zero if a21 = 0? 
4.9 If P1 is an even permutation matrix and P2 is odd, deduce from P1+P2 = P1(PT 
1 + 
PT 
2 )P2 that det(P1+P2) = 0. 
4.10 If detA > 0, show that A can be connected to I by a continuous chain of matrices 
A(t) all with positive determinants. (The straight path A(t) = A+t(I .A) does go 
from A(0) = A to A(1) = I, but in between A(t) might be singular. The problem is 
not so easy, and solutions are welcomed by the author.)
4.4 Applications of Determinants 259 
4.11 Explain why the point (x;y) is on the line through (2;8) and (4;7) if 
det
2
64
x y 1 
2 8 1 
4 7 1
3
75
= 0; or x+2y.18 = 0: 
4.12 In analogy with the previous exercise, what is the equation for (x;y; z) to be on the 
plane through (2;0;0), (0;2;0), and (0;0;4)? It involves a 4 by 4 determinant. 
4.13 If the points (x;y; z), (2;1;0), and (1;1;1) lie on a plane through the origin, what 
determinant is zero? Are the vectors (1;0;.1), (2;1;0), (1;1;1) independent? 
4.14 If every row of A has either a single +1, or a single .1, or one of each (and is 
otherwise zero), show that detA = 1 or .1 or 0. 
4.15 If C = 
. a b 
c d 
¤ 
and D = [ u v 
w z ], then CD = .DC yields 4 equations Ax = 0: 
CD+DC = 0 is 
2
6664 
2a c b 0 
b a+d 0 b 
c 0 a+d c 
0 c b 2d
3
7775 
2
6664 
u
v
w
z
3
7775
= 
2
6664 
0
0
0
0
3
7775
: 
(a) Show that detA = 0 if a+d = 0. Solve for u, v, w, z, the entries of D. 
(b) Show that detA = 0 if ad = bc (so C is singular). 
In all other cases, CD = .DC is only possible with D = zero matrix. 
4.16 The circular shift permutes (1;2; : : : ;n) into (2;3; : : : ;1). What is the corresponding 
permutation matrix P, and (depending on n) what is its determinant? 
4.17 Find the determinant of A = eye(5) + ones(5) and if possible eye(n) + ones(n).
Chapter 5 
Eigenvalues and Eigenvectors 
5.1 Introduction 
This chapter begins the “second half” of linear algebra. The first half was about Ax = 
b. The new problem Ax = l x will still be solved by simplifying a matrix—making it 
diagonal if possible. The basic step is no longer to subtract a multiple of one row from 
another: Elimination changes the eigenvalues, which we don’t want. 
Determinants give a transition from Ax = b to Ax =l x. In both cases the determinant 
leads to a “formal solution”: to Cramer’s rule for x = A.1b, and to the polynomial 
det(A.l I), whose roots will be the eigenvalues. (All matrices are now square; the 
eigenvalues of a rectangular matrix make no more sense than its determinant.) The 
determinant can actually be used if n = 2 or 3. For large n, computing l is more difficult 
than solving Ax = b. 
The first step is to understand how eigenvalues can be useful, One of their applications 
is to ordinary differential equations. We shall not assume that the reader is an expert on 
differential equations! If you can differentiate xn, sin x, and ex, you know enough. As a 
specific example, consider the coupled pair of equations 
dv 
dt 
= 4v.5w; v = 8 at t = 0; 
dw 
dt 
= 2v.3w; w = 5 at t = 0: 
(1) 
This is an initial-value problem. The unknown is specified at time t = 0 by the given 
initial values 8 and 5. The problem is to find v(t) and w(t) for later times t > 0. 
It is easy to write the system in matrix form. Let the unknown vector be u(t), with 
initial value u(0). The coefficient matrix is A: 
Vector unknown u(t) = 
"
v(t) 
w(t)
#
; u(0) = 
"
8
5
#
; A = 
"
4 .5 
2 .3
#
: 
The two coupled equations become the vector equation we want: 
Matrix form 
du 
dt 
= Au with u = u(0) at t = 0: (2)
5.1 Introduction 261 
This is the basic statement of the problem. Note that it is a first-order equation—no 
higher derivatives appear—and it is linear in the unknowns, It also has constant coefficients; 
the matrix A is independent of time. 
How do we find u(t)? If there were only one unknown instead of two, that question 
would be easy to answer. We would have a scalar instead of a vector equation: 
Single equation 
du 
dt 
= au with u = u(0) at t = 0: (3) 
The solution to this equation is the one thing you need to know: 
Pure exponential u(t) = eatu(0): (4) 
At the initial time t = 0, u equals u(0) because e0 = 1. The derivative of eat has the 
required factor a, so that du=dt = au. Thus the initial condition and the equation are 
both satisfied. 
Notice the behavior of u for large times. The equation is unstable if a > 0, neutrally 
stable if a = 0, or stable if a < 0; the factor eat approaches infinity, remains bounded, 
or goes to zero. If a were a complex number, a =a +ib , then the same tests would be 
applied to the real part a. The complex part produces oscillations eib t =cosb t+i sinb t. 
Decay or growth is governed by the factor eat . 
So much for a single equation. We shall take a direct approach to systems, and look 
for solutions with the same exponential dependence on t just found in the scalar case: 
v(t) = el ty 
w(t) = el tz 
(5) 
or in vector notation 
u(t) = el tx: (6) 
This is the whole key to differential equations du=dt = Au: Look for pure exponential 
solutions. Substituting v = el ty and w = el tz into the equation, we find 
l el ty = 4el ty.5el tz 
l el tz = 2el ty.3el tz: 
The factor el t is common to every term, and can be removed. This cancellation is the 
reason for assuming the same exponent l for both unknowns; it leaves 
Eigenvalue problem 
4y.5z =l y 
2y.3z =l z: 
(7) 
That is the eigenvalue equation. In matrix form it is Ax =l x. You can see it again if we 
use u = el tx—a number el t that grows or decays times a fixed vector x. Substituting 
into du=dt = Au gives l el tx = Ael tx. The cancellation of el t produces 
Eigenvalue equation Ax =l x: (8)
262 Chapter 5 Eigenvalues and Eigenvectors 
Now we have the fundamental equation of this chapter. It involves two unknowns 
l and x. It is an algebra problem, and differential equations can be forgotten! The 
number l (lambda) is an eigenvalue of the matrix A, and the vector x is the associated 
eigenvector. Our goal is to find the eigenvalues and eigenvectors, l ’s and x’s, and to use 
them. 
The Solution of Ax =l x 
Notice that Ax =l x is a nonlinear equation; l multiplies x. If we could discover l , then 
the equation for x would be linear. In fact we could write l Ix in place of l x, and bring 
this term over to the left side: 
(A.l I)x = 0: (9) 
The identity matrix keeps matrices and vectors straight; the equation (A.l )x = 0 is 
shorter, but mixed up. This is the key to the problem: 
The vector x is in the nullspace of A.l I. 
The number l is chosen so that A.l I has a nullspace. 
Of course every matrix has a nullspace. It was ridiculous to suggest otherwise, but you 
see the point. We want a nonzero eigenvector x, The vector x = 0 always satisfies 
Ax =l x, but it is useless in solving differential equations. The goal is to build u(t) out 
of exponentials el tx, and we are interested only in those particular values l for which 
there is a nonzero eigenvector x. To be of any use, the nullspace of A.l I must contain 
vectors other than zero. In short, A.l I must be singular. 
For this, the determinant gives a conclusive test. 
5A The number l is an eigenvalue of A if and only if A.l I is singular: 
det(A.l I) = 0: (10) 
This is the characteristic equation. Each l is associated with eigenvectors x: 
(A.l I)x = 0 or Ax =l x: (11) 
In our example, we shift A by l I to make it singular: 
Subtract l I A.l I = 
"
4.l .5 
2 .3.l 
#
: 
Note that l is subtracted only from the main diagonal (because it multiplies I). 
Determinant jA.l Ij = (4.l )(.3.l )+10 or l 2.l .2: 
This is the characteristic polynomial. Its roots, where the determinant is zero, are the 
eigenvalues. They come from the general formula for the roots of a quadratic, or from
5.1 Introduction 263 
factoring into l 2 .l .2 = (l +1)(l .2). That is zero if l = .1 or l = 2, as the 
general formula confirms: 
Eigenvalues l = 
.b§
p
b2.4ac 
2a 
= 
1§
p
9 
2 
= .1 and 2: 
There are two eigenvalues, because a quadratic has two roots. Every 2 by 2 matrix 
A.l I has l 2 (and no higher power of l ) in its determinant. 
The values l =.1 and l =2 lead to a solution of Ax=l x or (A.l I)x=0. A matrix 
with zero determinant is singular, so there must be nonzero vectors x in its nullspace. In 
fact the nullspace contains a whole line of eigenvectors; it is a subspace! 
l1 = .1 : (A.l1I)x = 
"
5 .5 
2 .2
#"
y
z
# 
= 
"
0
0
#
: 
The solution (the first eigenvector) is any nonzero multiple of x1: 
Eigenvector for l1 x1 = 
"
1
1
#
: 
The computation for l2 is done separately: 
l2 = 2 : (A.l2I)x = 
"
2 .5 
2 .5
#"
y
z
# 
= 
"
0
0
#
: 
The second eigenvector is any nonzero multiple of x2: 
Eigenvector for l2 x2 = 
"
5
2
#
: 
You might notice that the columns of A.l1I give x2, and the columns of A.l2I are 
multiples of x1. This is special (and useful) for 2 by 2 matrices. 
In the 3 by 3 case, I often set a component of x equal to 1 and solve (A.l I)x = 0 for 
the other components. Of course if x is an eigenvector then so is 7x and so is .x. All 
vectors in the nullspace of A.l I (which we call the eigenspace) will satisfy Ax =l x. 
In our example the eigenspaces are the lines through x1 = (1;1) and x2 = (5;2). 
Before going back to the application (the differential equation), we emphasize the 
steps in solving Ax =l x: 
1. Compute the determinant of A.l I. With l subtracted along the diagonal, this 
determinant is a polynomial of degree n. It starts with (.l )n. 
2. Find the roots of this polynomial. The n roots are the eigenvalues of A. 
3. For each eigenvalue solve the equation (A.l I)x = 0. Since the determinant is 
zero, there are solutions other than x = 0. Those are the eigenvectors.
264 Chapter 5 Eigenvalues and Eigenvectors 
In the differential equation, this produces the special solutions u = el tx. They are the 
pure exponential solutions to du=dt = Au. Notice e.t and e2t : 
u(t) = el1tx1 = e.t 
"
1
1
# 
and u(t) = el2tx2 = e2t 
"
5
2
#
: 
These two special solutions give the complete solution. They can be multiplied by any 
numbers c1 and c2, and they can be added together. When u1 and u2 satisfy the linear 
equation du=dt = Au, so does their sum u1+u2: 
Complete solution u(t) = c1el1tx1+c2el2tx2 (12) 
This is superposition, and it applies to differential equations (homogeneous and linear) 
just as it applied to matrix equations Ax = 0. The nullspace is always a subspace, and 
combinations of solutions are still solutions. 
Now we have two free parameters c1 and c2, and it is reasonable to hope that they can 
be chosen to satisfy the initial condition u = u(0) at t = 0: 
Initial condition c1x1+c2x2 = u(0) or 
"
1 5 
1 2
#"
c1 
c2
# 
= 
"
8
5
#
: (13) 
The constants are c1 = 3 and c2 = 1, and the solution to the original equation is 
u(t) = 3e.t 
"
1
1
#
+e2t 
"
5
2
#
: (14) 
Writing the two components separately, we have v(0) = 8 and w(0) = 5: 
Solution v(t) = 3e.t +5e2t ; w(t) = 3e.t +2e2t : 
The key was in the eigenvalues l and eigenvectors x. Eigenvalues are important in 
themselves, and not just part of a trick for finding u. Probably the homeliest example 
is that of soldiers going over a bridge.1 Traditionally, they stop marching and just walk 
across. If they happen to march at a frequency equal to one of the eigenvalues of the 
bridge, it would begin to oscillate. (Just as a child’s swing does; you soon notice the 
natural frequency of a swing, and by matching it you make the swing go higher.) An 
engineer tries to keep the natural frequencies of his bridge or rocket away from those of 
the wind or the sloshing of fuel. And at the other extreme, a stockbroker spends his life 
trying to get in line with the natural frequencies of the market. The eigenvalues are the 
most important feature of practically any dynamical system. 
Summary and Examples 
To summarize, this introduction has shown how l and x appear naturally and automatically 
when solving du=dt = Au. Such an equation has pure exponential solutions 
1One which I never really believed—but a bridge did crash this way in 1831.
5.1 Introduction 265 
u=el tx; the eigenvalue gives the rate of growth or decay, and the eigenvector x develops 
at this rate. The other solutions will be mixtures of these pure solutions, and the mixture 
is adjusted to fit the initial conditions. 
The key equation was Ax = l x. Most vectors x will not satisfy such an equation. 
They change direction when multiplied by A, so that Ax is not a multiple of x. This 
means that only certain special numbers are eigenvalues, and only certain special 
vectors x are eigenvectors. We can watch the behavior of each eigenvector, and then 
combine these “normal modes” to find the solution. To say the same thing in another 
way, the underlying matrix can be diagonalized. 
The diagonalization in Section 5.2 will be applied to difference equations, Fibonacci 
numbers, and Markov processes, and also to differential equations. In every example, 
we start by computing the eigenvalues and eigenvectors; there is no shortcut to avoid 
that. Symmetric matrices are especially easy. “Defective matrices” lack a full set of 
eigenvectors, so they are not diagonalizable. Certainly they have to be discussed, but we 
will not allow them to take over the book. 
We start with examples of particularly good matrices. 
Example 1. Everything is clear when A is a diagonal matrix: 
A = 
"
3 0 
0 2
# 
has l1 = 3 with x1 = 
"
1
0
#
; l2 = 2 with x2 = 
"
0
1
#
: 
On each eigenvector A acts like a multiple of the identity: Ax1 = 3x1 and Ax2 = 2x2. 
Other vectors like x = (1;5) are mixtures x1+5x2 of the two eigenvectors, and when A 
multiplies x1 and x2 it produces the eigenvalues l1 = 3 and l2 = 2: 
A times x1+5x2 is 3x1+10x2 = 
" 
3 
10
#
: 
This is Ax for a typical vector x—not an eigenvector. But the action of A is determined 
by its eigenvectors and eigenvalues. 
Example 2. The eigenvalues of a projection matrix are 1 or 0! 
P = 
"
12 
12
12 
12 
# 
has l1 = 1 with x1 = 
"
1
1
#
; l2 = 0 with x2 = 
" 
1 
.1
#
: 
We have l = 1 when x projects to itself, and l = 0 when x projects to the zero vector. 
The column space of P is filled with eigenvectors, and so is the nullspace. If those spaces 
have dimension r and n.r, then l = 1 is repeated r times and l = 0 is repeated n.r 
times (always n l ’s): 
Four eigenvalues 
allowing repeats 
P = 
2
6664 
1 0 0 0 
0 0 0 0 
0 0 0 0 
0 0 0 1
3
7775
has l = 1;1;0;0:
266 Chapter 5 Eigenvalues and Eigenvectors 
There is nothing exceptional about l = 0. Like every other number, zero might be 
an eigenvalue and it might not. If it is, then its eigenvectors satisfy Ax = 0x. Thus x is 
in the nullspace of A. A zero eigenvalue signals that A is singular (not invertible); its 
determinant is zero. Invertible matrices have all l 6= 0. 
Example 3. The eigenvalues are on the main diagonal when A is triangular: 
det(A.l I) =
....... 
1.l 4 5 
0 34
.l 6 
0 0 12
.l
.......
= (1.l )(34
.l )(12
.l ): 
The determinant is just the product of the diagonal entries. It is zero if l = 1, l = 34
, or 
l = 12
; the eigenvalues were already sitting along the main diagonal. 
This example, in which the eigenvalues can be found by inspection, points to one 
main theme of the chapter: To transform A into a diagonal or triangular matrix without 
changing its eigenvalues. We emphasize once more that the Gaussian factorization A = 
LU is not suited to this purpose. The eigenvalues of U may be visible on the diagonal, 
but they are not the eigenvalues of A. 
For most matrices, there is no doubt that the eigenvalue problem is computationally 
more difficult than Ax = b. With linear systems, a finite number of elimination steps 
produced the exact answer in a finite time. (Or equivalently, Cramer’s rule gave an exact 
formula for the solution.) No such formula can give the eigenvalues, or Galois would 
turn in his grave. For a 5 by 5 matrix, det(A.l I) involves l 5. Galois and Abel proved 
that there can be no algebraic formula for the roots of a fifth-degree polynomial. 
All they will allow is a few simple checks on the eigenvalues, after they have been 
computed, and we mention two good ones: sum and product. 
5B The sum of the n eigenvalues equals the sum of the n diagonal entries: 
Trace of A =l1+. . .+ln = a11+. . .+ann: (15) 
Furthermore, the product of the n eigenvalues equals the determinant of A. 
The projection matrix P had diagonal entries 12
, 12
and eigenvalues 1, 0. Then 12
+ 12 
agrees with 1+0 as it should. So does the determinant, which is 0 . 1 = 0. A singular 
matrix, with zero determinant, has one or more of its eigenvalues equal to zero. 
There should be no confusion between the diagonal entries and the eigenvalues. For 
a triangular matrix they are the same—but that is exceptional. Normally the pivots, 
diagonal entries, and eigenvalues are completely different, And for a 2 by 2 matrix, the 
trace and determinant tell us everything: 
"
a b 
c d
# 
has trace a+d, and determinant ad.bc
5.1 Introduction 267 
det(A.l I) = det
.....
a.l b 
c d.l
.....
=l 2.(trace)l +determinant 
The eigenvalues are l = 
trace§
.
(trace)2.4det
¤1=2 
2 
: 
Those two l ’s add up to the trace; Exercise 9 gives ali = trace for all matrices. 
Eigshow 
There is a MATLAB demo (just type eigshow), displaying the eigenvalue problem for a 
2 by 2 matrix. It starts with the unit vector x = (1;0). The mouse makes this vector move 
around the unit circle. At the same time the screen shows Ax, in color and also moving. 
Possibly Ax is ahead of x. Possibly Ax is behind x. Sometimes Ax is parallel to x. At that 
parallel moment, Ax =l x (twice in the second figure). 
y = (0, 1) 
x = (1, 0) 
Ay = (0.3, 0.7) 
Ax = (0.8, 0.2) 
A = "0.8 0.3 
0.2 0.7
# Ax1 = x1 
x2 
Ax2 = 0.5x2 
ellipse of Ax’s 
circle of x’s 
The eigenvalue l is the length of Ax, when the unit eigenvector x is parallel. The 
built-in choices for A illustrate three possibilities: 0, 1, or 2 real eigenvectors. 
1. There are no real eigenvectors. Ax stays behind or ahead of x. This means the 
eigenvalues and eigenvectors are complex, as they are for the rotation Q. 
2. There is only one line of eigenvectors (unusual). The moving directions Ax and x 
meet but don’t cross. This happens for the last 2 by 2 matrix below. 
3. There are eigenvectors in two independent directions. This is typical! Ax crosses x 
at the first eigenvector x1, and it crosses back at the second eigenvector x2. 
Suppose A is singular (rank 1). Its column space is a line. The vector Ax has to stay on 
that line while x circles around. One eigenvector x is along the line. Another eigenvector 
appears when Ax2 = 0. Zero is an eigenvalue of a singular matrix. 
You can mentally follow x and Ax for these six matrices. How many eigenvectors and 
where? When does Ax go clockwise, instead of counterclockwise with x? 
A = 
"
2 0 
0 1
# "
2 0 
0 .1
# "
0 1 
1 0
# " 
0 1 
.1 0
# "
1 1 
1 1
# "
1 1 
0 1
#
268 Chapter 5 Eigenvalues and Eigenvectors 
Problem Set 5.1 
1. Find the eigenvalues and eigenvectors of the matrix A = 
. 1 .1 
2 4 
¤
. Verify that the trace 
equals the sum of the eigenvalues, and the determinant equals their product. 
2. With the same matrix A, solve the differential equation du=dt = Au, u(0) = 
.06
¤
. 
What are the two pure exponential solutions? 
3. If we shift to A.7I, what are the eigenvalues and eigenvectors and how are they 
related to those of A? 
B = A.7I = 
"
.6 .1 
2 .3
#
: 
4. Solve du=dt = Pu, when P is a projection: 
du 
dt 
= 
"
1
2 
12
12 
12 
#
u with u(0) = 
"
5
3
#
: 
Part of u(0) increases exponentially while the nullspace part stays fixed. 
5. Find the eigenvalues and eigenvectors of 
A = 
2
64
3 4 2 
0 1 2 
0 0 0
3
75
and B = 
2
64
0 0 2 
0 2 0 
2 0 0
3
75
: 
Check that l1+l2+l3 equals the trace and l1l2l3 equals the determinant. 
6. Give an example to show that the eigenvalues can be changed when a multiple of one 
row is subtracted from another. Why is a zero eigenvalue not changed by the steps 
of elimination? 
7. Suppose that l is an eigenvalue of A, and x is its eigenvector: Ax =l x. 
(a) Show that this same x is an eigenvector of B = A.7I, and find the eigenvalue. 
This should confirm Exercise 3. 
(b) Assuming l 6= 0, show that x is also an eigenvector of A.1—and find the eigenvalue. 
8. Show that the determinant equals the product of the eigenvalues by imagining that 
the characteristic polynomial is factored into 
det(A.l I) = (l1.l )(l2.l ) . . . (ln.l ); (16) 
and making a clever choice of l .
5.1 Introduction 269 
9. Show that the trace equals the sum of the eigenvalues, in two steps. First, find the 
coefficient of (.l )n.1 on the right side of equation (16). Next, find all the terms in 
det(A.l I) = det
2
6664 
a11.l a12 . . . a1n 
a21 a22.l . . . a2n 
... 
... 
... 
an1 an2 . . . ann.l 
3
7775 
that involve (.l )n.1. They all come from the main diagonal! Find that coefficient 
of (.l )n.1 and compare. 
10. (a) Construct 2 by 2 matrices such that the eigenvalues of AB are not the products of 
the eigenvalues of A and B, and the eigenvalues of A+B are not the sums of the 
individual eigenvalues. 
(b) Verify, however, that the sum of the eigenvalues of A+B equals the sum of all 
the individual eigenvalues of A and B, and similarly for products. Why is this 
true? 
11. The eigenvalues of A equal the eigenvalues of AT. This is because det(A.l I) 
equals det(AT.l I). That is true because . Show by an example that the eigenvectors 
of A and AT are not the same. 
12. Find the eigenvalues and eigenvectors of 
A = 
"
3 4 
4 .3
# 
and A = 
"
a b 
b a
#
: 
13. If B has eigenvalues 1, 2, 3, C has eigenvalues 4, 5, 6, and D has eigenvalues 7, 8, 9, 
what are the eigenvalues of the 6 by 6 matrix A = 
.B C 
0 D
¤
? 
14. Find the rank and all four eigenvalues for both the matrix of ones and the checker 
board matrix: 
A = 
2
6664 
1 1 1 1 
1 1 1 1 
1 1 1 1 
1 1 1 1
3
7775
and C = 
2
6664 
0 1 0 1 
1 0 1 0 
0 1 0 1 
1 0 1 0
3
7775
: 
Which eigenvectors correspond to nonzero eigenvalues? 
15. What are the rank and eigenvalues when A and C in the previous exercise are n by n? 
Remember that the eigenvalue l = 0 is repeated n.r times. 
16. If A is the 4 by 4 matrix of ones, find the eigenvalues and the determinant of A.I.
270 Chapter 5 Eigenvalues and Eigenvectors 
17. Choose the third row of the “companion matrix” 
A = 
2
64
0 1 0 
0 0 1 
. . .
3
75 
so that its characteristic polynomial jA.l Ij is .l 3+4l 2+5l +6. 
18. Suppose A has eigenvalues 0, 3, 5 with independent eigenvectors u, v, w. 
(a) Give a basis for the nullspace and a basis for the column space. 
(b) Find a particular solution to Ax = v+w. Find all solutions. 
(c) Show that Ax = u has no solution. (If it had a solution, then would be in 
the column space.) 
19. The powers Ak of this matrix A approaches a limit as k!.: 
A = 
"
:8 :3 
:2 :7
#
; A2 = 
"
:70 :45 
:30 :55
#
; and A. = 
"
:6 :6 
:4 :4
#
: 
The matrix A2 is halfway between A and A.. Explain why A2 = 12
(A+A.) from the 
eigenvalues and eigenvectors of these three matrices. 
20. Find the eigenvalues and the eigenvectors of these two matrices: 
A = 
"
1 4 
2 3
# 
and A+I = 
"
2 4 
2 4
#
: 
A+I has the eigenvectors as A. Its eigenvalues are by 1. 
21. Compute the eigenvalues and eigenvectors of A and A.1: 
A = 
"
0 2 
2 3
# 
and A.1 = 
"
.3=4 1=2 
1=2 0 
#
: 
A.1 has the eigenvectors as A. When A has eigenvalues l1 and l2, its inverse 
has eigenvalues . 
22. Compute the eigenvalues and eigenvectors of A and A2: 
A = 
"
.1 3 
2 0
# 
and A2 = 
" 
7 .3 
.2 6 
#
: 
A2 has the same as A. When A has eigenvalues l1 and l2, A2 has eigenvalues 
. 
23. (a) If you know x is an eigenvector, the way to find l is to .
5.1 Introduction 271 
(b) If you know l is an eigenvalue, the way to find x is to . 
24. What do you do to Ax =l x, in order to prove (a), (b), and (c)? 
(a) l 2 is an eigenvalue of A2, as in Problem 22. 
(b) l .1 is an eigenvalue of A.1, as in Problem 21. 
(c) l +1 is an eigenvalue of A+I, as in Problem 20. 
25. From the unit vector u = 
.16
;16
;36
;56
.
, construct the rank-1 projection matrix P = uuT. 
(a) Show that Pu = u. Then u is an eigenvector with l = 1. 
(b) If v is perpendicular to u show that Pv = zero vector. Then l = 0. 
(c) Find three independent eigenvectors of P all with eigenvalue l = 0. 
26. Solve det(Q.l I) = 0 by the quadratic formula, to reach l = cosq §i sinq : 
Q = 
"
cosq .sinq 
sinq cosq 
# 
rotates the xy-plane by the angle q : 
Find the eigenvectors of Q by solving (Q.l I)x = 0. Use i2 = .1. 
27. Every permutation matrix leaves x = (1;1; : : : ;1) unchanged. Then l = 1. Find two 
more l ’s for these permutations: 
P = 
2
64
0 1 0 
0 0 1 
1 0 0
3
75
and P = 
2
64
0 0 1 
0 1 0 
1 0 0
3
75
: 
28. If A has l1 = 4 and l2 = 5, then det(A.l I) = (l .4)(l .5) =l 2.9l +20. Find 
three matrices that have trace a+d = 9, determinant 20, and l = 4;5. 
29. A 3 by 3 matrix B is known to have eigenvalues 0, 1, 2, This information is enough 
to find three of these: 
(a) the rank of B, 
(b) the determinant of BTB, 
(c) the eigenvalues of BTB, and 
(d) the eigenvalues of (B+I).1. 
30. Choose the second row of A = [ 0 1 
¤ ¤ ] so that A has eigenvalues 4 and 7. 
31. Choose a, b, c, so that det(A.l I) = 9l .l 3. Then the eigenvalues are .3, 0, 3: 
A = 
2
64
0 1 0 
0 0 1 
a b c
3
75
:
272 Chapter 5 Eigenvalues and Eigenvectors 
32. Construct any 3 by 3 Markov matrix M: positive entries down each column add to 
1. If e = (1;1;1), verify that MTe = e. By Problem 11, l = 1 is also an eigenvalue 
of M. Challenge: A 3 by 3 singular Markov matrix with trace 12
has eigenvalues 
l = . 
33. Find three 2 by 2 matrices that have l1 =l2 = 0. The trace is zero and the determinant 
is zero. The matrix A might not be 0 but check that A2 = 0. 
34. This matrix is singular with rank 1. Find three l ’s and three eigenvectors: 
A = 
2
64
1
2
1
3
75
h
2 1 2
i 
= 
2
64
2 1 2 
4 2 4 
2 1 2
3
75
: 
35. Suppose A and B have the same eigenvalues l1; : : : ;ln with the same independent 
eigenvectors x1; : : : ;xn. Then A = B. Reason: Any vector x is a combination c1x1+ 
. . .+cnxn. What is Ax? What is Bx? 
36. (Review) Find the eigenvalues of A, B, and C: 
A = 
2
64
1 2 3 
0 4 5 
0 0 6
3
75
; B = 
2
64
0 0 1 
0 2 0 
3 0 0
3
75
; and C = 
2
64
2 2 2 
2 2 2 
2 2 2
3
75
: 
37. When a+b = c+d, show that (1;1) is an eigenvector and find both eigenvalues: 
A = 
"
a b 
c d
#
: 
38. When P exchanges rows 1 and 2 and columns 1 and 2, the eigenvalues don’t change. 
Find eigenvectors of A and PAP for l = 11: 
A = 
2
64
1 2 1 
3 6 3 
4 8 4
3
75
and PAP = 
2
64
6 3 3 
2 1 1 
8 4 4
3
75
: 
39. Challenge problem: Is there a real 2 by 2 matrix (other than I) with A3 = I? Its 
eigenvalues must satisfy l 3 = I. They can be e2pi=3 and e.2pi=3. What trace and 
determinant would this give? Construct A. 
40. There are six 3 by 3 permutation matrices P. What numbers can be the determinants 
of P? What numbers can be pivots? What numbers can be the trace of P? What four 
numbers can be eigenvalues of P?
5.2 Diagonalization of a Matrix 273 
5.2 Diagonalization of a Matrix 
We start right off with the one essential computation. It is perfectly simple and will be 
used in every section of this chapter. The eigenvectors diagonalize a matrix: 
5C Suppose the n by n matrix A has n linearly independent eigenvectors. 
If these eigenvectors are the columns of a matrix S, then S.1AS is a diagonal 
matrix L. The eigenvalues of A are on the diagonal of L: 
Diagonalization S.1AS = L = 
2
6664 
l1 
l2 
. . . 
ln
3
7775
: (1) 
We call S the “eigenvector matrix” and L the “eigenvalue matrix”—using a capital 
lambda because of the small lambdas for the eigenvalues on its diagonal. 
Proof. Put the eigenvectors xi in the columns of S, and compute AS by columns: 
AS = A
2
64
j j j 
x1 x2 . . . xn 
j j j 
3
75
= 
2
64
j j j 
l1x1 l2x2 . . . lnxn 
j j j 
3
75
: 
Then the trick is to split this last matrix into a quite different product SL: 
2
64
l1x1 l2x2 . . . lnxn
3
75
= 
2
6 4x1 x2 . . . xn
3
75 
2
6664 
l1 
l2 
. . . 
ln
3
7775
: 
It is crucial to keep these matrices in the right order. If L came before S (instead of 
after), then l1 would multiply the entries in the first row. We want l1 to appear in the 
first column. As it is, SL is correct. Therefore, 
AS = SL; or S.1AS = L; or A = SLS.1: (2) 
S is invertible, because its columns (the eigenvectors) were assumed to be independent. 
We add four remarks before giving any examples or applications. 
Remark 1. If the matrix A has no repeated eigenvalues—the numbers l1; : : : ;ln are 
distinct—then its n eigenvectors are automatically independent (see 5D below). Therefore 
any matrix with distinct eigenvalues can be diagonalized. 
Remark 2. The diagonalizing matrix S is not unique. An eigenvector x can be multiplied 
by a constant, and remains an eigenvector. We can multiply the columns of S by any 
nonzero constants, and produce a new diagonalizing S. Repeated eigenvalues leave even 
more freedom in S. For the trivial example A = I, any invertible S will do: S.1IS is is 
always diagonal (L is just I). All vectors are eigenvectors of the identity.
274 Chapter 5 Eigenvalues and Eigenvectors 
Remark 3. Other matrices S will not produce a diagonal L. Suppose the first column 
of S is y. Then the first column of SL is l1y. If this is to agree with the first column of 
AS, which by matrix multiplication is Ay, then y must be an eigenvector: Ay =l1y. The 
order of the eigenvectors in S and the eigenvalues in L is automatically the same. 
Remark 4. Not all matrices possess n linearly independent eigenvectors, so not all matrices 
are diagonalizable. The standard example of a “defective matrix” is 
A = 
"
0 1 
0 0
#
: 
Its eigenvalues are l1 =l2 = 0, since it is triangular with zeros on the diagonal: 
det(A.l I) = det
"
.l 1 
0 .l 
# 
=l 2: 
All eigenvectors of this A are multiples of the vector (1;0): 
"
0 1 
0 0
#
x = 
"
0
0
#
; or x = 
"
c
0
#
: 
l = 0 is a double eigenvalue—its algebraic multiplicity is 2. But the geometric multiplicity 
is 1—there is only one independent eigenvector. We can’t construct S. 
Here is a more direct proof that this A is not diagonalizable. Since l1 = l2 = 0, L 
would have to be the zero matrix, But if L = S.1AS = 0, then we premultiply by S and 
postmultiply by S.1, to deduce falsely that A = 0. There is no invertible S. 
That failure of diagonalization was not a result of l = 0. It came from l1 =l2: 
Repeated eigenvalues A = 
"
3 1 
0 3
# 
and A = 
"
2 .1 
1 0 
#
: 
Their eigenvalues are 3, 3 and 1, 1. They are not singular! The problem is the shortage 
of eigenvectors—which are needed for S. That needs to be emphasized: 
Diagonalizability of A depends on enough eigenvectors. 
Invertibility of A depends on nonzero eigenvalues. 
There is no connection between diagonalizability (n independent eigenvector) and invertibility 
(no zero eigenvalues). The only indication given by the eigenvalues is this: 
Diagonalization can fail only if there are repeated eigenvalues. Even then, it does not 
always fail. A = I has repeated eigenvalues 1;1; : : : ;1 but it is already diagonal! There 
is no shortage of eigenvectors in that case. 
The test is to check, for an eigenvalue that is repeated p times, whether there are p 
independent eigenvectors—in other words, whether A.l I has rank n. p. To complete 
that circle of ideas, we have to show that distinct eigenvalues present no problem.
5.2 Diagonalization of a Matrix 275 
5D If eigenvectors x1; : : : ;xk correspond to different eigenvalues l1; : : : ;lk, 
then those eigenvectors are linearly independent. 
Suppose first that k = 2, and that some combination of x1 and x2 produces zero: 
c1x1+c2x2 = 0. Multiplying by A, we find c1l1x1+c2l2x2 = 0. Subtracting l2 times 
the previous equation, the vector x2 disappears: 
c1(l1.l2)x1 = 0: 
Since l1 6= l2 and x1 6= 0, we are forced into c1 = 0. Similarly c2 = 0, and the two 
vectors are independent; only the trivial combination gives zero. 
This same argument extends to any number of eigenvectors: If some combination produces 
zero, multiply by A, subtract lk times the original combination, and xk disappears— 
leaving a combination of x1; : : : ;xk.1, which produces zero. By repeating the same steps 
(this is really mathematical induction) we end up with a multiple of x1 that produces 
zero. This forces c1 = 0, and ultimately every ci = 0. Therefore eigenvectors that come 
from distinct eigenvalues are automatically independent. 
A matrix with n distinct eigenvalues can be diagonalized. This is the typical case. 
Examples of Diagonalization 
The main point of this section is S.1AS = A. The eigenvector matrix S converts A into 
its eigenvalue matrix L (diagonal). We see this for projections and rotations. 
Example 1. The projection A = 
· 
12 
12
12 
12 
. 
has eigenvalue matrix L = 
. 1 0 
0 0 
¤
. The eigenvectors 
go into the columns of S: 
S = 
"
1 1 
1 .1
# 
and AS = SL = 
"
1 0 
1 0
#
: 
That last equation can be verified at a glance. Therefore S.1AS = L. 
Example 2. The eigenvalues themselves are not so clear for a rotation: 
90° rotation K = 
"
0 .1 
1 0 
# 
has det(K.l I) =l 2+1: 
How can a vector be rotated and still have its direction unchanged? Apparently it 
can’t—except for the zero vector, which is useless. But there must be eigenvalues, and 
we must be able to solve du=dt = Ku. The characteristic polynomial l 2+1 should still 
have two roots—but those roots are not real. 
You see the way out. The eigenvalues of K are imaginary numbers, l1 = i and l2 = 
.i. The eigenvectors are also not real. Somehow, in turning through 90°, they are
276 Chapter 5 Eigenvalues and Eigenvectors 
multiplied by i or .i: 
(K.l1I)x1 = 
"
.i .1 
1 .i
#"
y
z
# 
= 
"
0
0
# 
and x1 = 
" 
1 
.i
# 
(K.l2I)x2 = 
"
i .1 
1 i 
#"
y
z
# 
= 
"
0
0
# 
and x2 = 
"
1
i
#
: 
The eigenvalues are distinct, even if imaginary, and the eigenvectors are independent. 
They go into the columns of S: 
S = 
" 
1 1 
.i i
# 
and S.1KS = 
"
i 0 
0 .i
#
: 
We are faced with an inescapable fact, that complex numbers are needed even for 
real matrices. If there are too few real eigenvalues, there are always n complex eigenvalues. 
(Complex includes real, when the imaginary part is zero.) If there are too few 
eigenvectors in the real world R3, or in Rn, we look in C3 or Cn. The space Cn contains 
all column vectors with complex components, and it has new definitions of length and 
inner product and orthogonality. But it is not more difficult than Rn, and in Section 5.5 
we make an easy conversion to the complex case. 
Powers and Products: Ak and AB 
There is one more situation in which the calculations are easy. The eigenvalue of A2 are 
exactly l 2 
1 ; : : : ;l 2 
n , and every eigenvector of A is also an eigenvector of A2. We start 
from Ax =l x, and multiply again by A: 
A2x = Al x =l Ax =l 2x: (3) 
Thus l 2 is an eigenvalue of A2, with the same eigenvector x. If the first multiplication 
by A leaves the direction of x unchanged, then so does the second. 
The same result comes from diagonalization, by squaring S.1AS = L: 
Eigenvalues of A2 (S.1AS)(S.1AS) = L2 or S.1A2S = L2: 
The matrix A2 is diagonalized by the same S, so the eigenvectors are unchanged. The 
eigenvalues are squared. This continues to hold for any power of A: 
5E The eigenvalues of Ak are l k 
1 ; : : : ;l k 
n , and each eigenvector of A is still an 
eigenvector of Ak. When S diagonalizes A, it also diagonalizes Ak: 
Lk = (S.1AS)(S.1AS) . . . (S.1AS) = S.1AkS: (4) 
Each S.1 cancels an S, except for the first S.1 and the last S.
5.2 Diagonalization of a Matrix 277 
If A is invertible this rule also applies to its inverse (the power k = .1). The eigenvalues 
of A.1 are 1=li. That can be seen even without diagonalizing: 
if Ax =l x then x =l A.1x and 
1
l 
x = A.1x: 
Example 3. If K is rotation through 90°, then K2 is rotation through 180° (which means 
.I) and K.1 is rotation through .90°: 
K = 
"
0 .1 
1 0 
#
; K2 = 
"
.1 0 
0 .1
#
; and K.1 = 
" 
0 1 
.1 0
#
: 
The eigenvalues of K are i and .i; their squares are .1 and .1; their reciprocals are 
1=i = .i and 1=(.i) = i. Then K4 is a complete rotation through 360°: 
K4 = 
"
1 0 
0 1
# 
and also L4 = 
"
i4 0 
0 (.i)4
# 
= 
"
1 0 
0 1
#
: 
For a product of two matrices, we can ask about the eigenvalues of AB—but we won’t 
get a good answer. It is very tempting to try the same reasoning, hoping to prove what 
is not in general true. If l is an eigenvalue of A and m is an eigenvalue of B, here is the 
false proof that AB has the eigenvalue ml : 
False proof ABx = Amx = mAx = ml x: 
The mistake lies in assuming that A and B share the same eigenvector x. In general, they 
do not, We could have two matrices with zero eigenvalues, while AB has l = 1: 
AB = 
"
0 1 
0 0
#"
0 0 
1 0
# 
= 
"
1 0 
0 0
#
: 
The eigenvectors of this A and B are completely different, which is typical. For the same 
reason, the eigenvalues of A+B generally have nothing to do with l +m. 
This false proof does suggest what is true. If the eigenvector is the same for A and 
B, then the eigenvalues multiply and AB has the eigenvalue ml . But there is something 
more important. There is an easy way to recognize when A and B share a full set of 
eigenvectors, and that is a key question in quantum mechanics: 
5F Diagonalizable matrices share the same eigenvector matrix S if and only 
if AB = BA. 
Proof. If the same S diagonalizes both A = SL1S.1 and B = SL2S.1, we can multiply 
in either order: 
AB = SL1S.1SL2S.1 = SL1L2S.1 and BA = SL2S.1SL1S.1 = SL2L1S.1: 
Since L1L2 = L2L1 (diagonal matrices always commute) we have AB = BA.
278 Chapter 5 Eigenvalues and Eigenvectors 
In the opposite direction, suppose AB = BA. Starting from Ax =l x, we have 
ABx = BAx = Bl x =l Bx: 
Thus x and Bx are both eigenvectors of A, sharing the same l (or else Bx = 0). If we 
assume for convenience that the eigenvalues of A are distinct—the eigenspaces are all 
one-dimensional—then Bx must be a multiple of x. in other words x is an eigenvector of 
B as well as A. The proof with repeated eigenvalues is a little longer. 
Heisenberg’s uncertainty principle comes from noncommuting matrices, like position 
P and momentum Q. Position is symmetric, momentum is skew-symmetric, and 
together they satisfy QP.PQ = I. The uncertainty principle follows directly from the 
Schwarz inequality (Qx)T(Px) · kQxkkPxk of Section 3.2: 
kxk2 = xTx = xT(QP.PQ)x · 2kQxkkPxk: 
The product of kQxk=kxk and kPxk=kxk—momentum and position errors, when the 
wave function is x—is at least 12
. It is impossible to get both errors small, because when 
you try to measure the position of a particle you change its momentum. 
At the end we come back to A = SLS.1. That factorization is particularly suited to 
take powers of A, and the simplest case A2 makes the point. The LU factorization is 
hopeless when squared, but SLS.1 is perfect. The square is SL2S.1, and the eigenvectors 
are unchanged. By following those eigenvectors we will solve difference equations 
and differential equations. 
Problem Set 5.2 
1. Factor the following matrices into SLS.1: 
A = 
"
1 1 
1 1
# 
and A = 
"
2 1 
0 0
#
: 
2. Find the matrix A whose eigenvalues are 1 and 4, and whose eigenvectors are 
.31
¤ 
and 
.
21
¤
, respectively. (Hint: A = SLS.1.) 
3. Find all the eigenvalues and eigenvectors of 
A = 
2
64
1 1 1 
1 1 1 
1 1 1
3
75 
and write two different diagonalizing matrices S. 
4. If a 3 by 3 upper triangular matrix has diagonal entries 1, 2, 7, how do you know it 
can be diagonalized? What is L?
5.2 Diagonalization of a Matrix 279 
5. Which of these matrices cannot be diagonalized? 
A1 = 
"
2 .2 
2 .2
# 
A2 = 
"
2 0 
2 .2
# 
A3 = 
"
2 0 
2 2
#
: 
6. (a) If A2 = I, what are the possible eigenvalues of A? 
(b) If this A is 2 by 2, and not I or .I, find its trace and determinant. 
(c) If the first row is (3;.1), what is the second row? 
7. If A = 
. 4 3 
1 2 
¤
, find A100 by diagonalizing A. 
8. Suppose A = uvT is a column times a row (a rank-1 matrix). 
(a) By multiplying A times u, show that u is an eigenvector. What is l ? 
(b) What are the other eigenvalues of A (and why)? 
(c) Compute trace(A) from the sum on the diagonal and the sum of l ’s. 
9. Show by direct calculation that AB and BA have the same trace when 
A = 
"
a b 
c d
# 
and B = 
"
q r 
s t
#
: 
Deduce that AB.BA = I is impossible (except in infinite dimensions). 
10. Suppose A has eigenvalues 1, 2, 4. What is the trace of A2? What is the determinant 
of (A.1)T? 
11. If the eigenvalues of A are 1, 1, 2, which of the following are certain to be true? Give 
a reason if true or a counterexample if false: 
(a) A is invertible. 
(b) A is diagonalizable. 
(c) A is not diagonalizable. 
12. Suppose the only eigenvectors of A are multiples of x = (1;0;0). True or false: 
(a) A is not invertible. 
(b) A has a repeated eigenvalue. 
(c) A is not diagonalizable. 
13. Diagonalize the matrix A=
. 5 4 
4 5 
¤ 
and find one of its square roots—a matrix such that 
R2 = A. How many square roots will there be? 
14. Suppose the eigenvector matrix S has ST = S.1. Show that A = SLS.1 is symmetric 
and has orthogonal eigenvectors. 
Problems 15–24 are about the eigenvalue and eigenvector matrices.
280 Chapter 5 Eigenvalues and Eigenvectors 
15. Factor these two matrices into A = SLS.1: 
A = 
"
1 2 
0 3
# 
and A = 
"
1 1 
2 2
#
: 
16. If A = SLS.1 then A3 = ( )( )( ) and A.1 = ( )( )( ). 
17. If A has l1 = 2 with eigenvector x1 = 
.10
¤ 
and l2 = 5 with x2 = 
.
11
¤
, use SLS.1 to 
find A. No other matrix has the same l ’s and x’s. 
18. Suppose A = SLS.1. What is the eigenvalue matrix for A+2I? What is the eigenvector 
matrix? Check that A+2I = ( )( )( ).1. 
19. True or false: If the n columns of S (eigenvectors of A) are independent, then 
(a) A is invertible. 
(b) A is diagonalizable. 
(c) S is invertible. 
(d) S is diagonalizable. 
20. If the eigenvectors of A are the columns of I, then A is a matrix. If the eigenvector 
matrix S is triangular, then S.1 is triangular and A is triangular. 
21. Describe all matrices S that diagonalize this matrix A: 
A = 
"
4 0 
1 2
#
: 
Then describe all matrices that diagonalize A.1. 
22. Write the most general matrix that has eigenvectors 
.
11
¤ 
and 
. 1 
.1 
¤
. 
23. Find the eigenvalues of A and B and A+B: 
A = 
"
1 0 
1 1
#
; B = 
"
1 1 
0 1
#
; A+B = 
"
2 1 
1 2
#
: 
Eigenvalues of A+B (are equal to)(are not equal to) eigenvalues of A plus eigenvalues 
of B. 
24. Find the eigenvalues of A, B, AB, and BA: 
A = 
"
1 0 
1 1
#
; B = 
"
1 1 
0 1
#
; AB = 
"
1 1 
1 2
#
; and BA = 
"
2 1 
1 1
#
: 
Eigenvalues of AB (are equal to)(are not equal to) eigenvalues of A times eigenvalues 
of B. Eigenvalues of AB (are)(are not) equal to eigenvalues of BA.
5.2 Diagonalization of a Matrix 281 
Problems 25–28 are about the diagonalizability of A. 
25. True or false: If the eigenvalues of A are 2, 2, 5, then the matrix is certainly 
(a) invertible. 
(b) diagonalizable. 
(c) not diagonalizable. 
26. If the eigenvalues of A are 1 and 0, write everything you know about the matrices A 
and A2. 
27. Complete these matrices so that detA = 25. Then trace = 10, and l = 5 is repeated! 
Find an eigcnvector with Ax = 5x. These matrices will nothe diagonalizabie because 
there is no second line of eigenvectors. 
A = 
"
8 
2
#
; A = 
"
9 4
1
#
; and A = 
"
10 5 
.5 
#
: 
28. The matrix A = 
. 3 1 
0 3 
¤ 
is not diagonalizable because the rank of A . 3I is . 
Change one entry to make A diagonalizable. Which entries could you change? 
Problems 29–33 are about powers of matrices. 
29. Ak =SLkS.1 approaches the zero matrix as k!. if and only if every l has absolute 
value less than . Does Ak !0 or Bk !0? 
A = 
"
:6 :4 
:4 :6
# 
and B = 
"
:6 :9 
:1 :6
#
: 
30. (Recommended) Find L and S to diagonalize A in Problem 29. What is the limit of 
Lk as k !.? What is the limit of SLkS.1? In the columns of this limiting matrix 
you see the . 
31. Find L and S to diagonalize B in Problem 29. What is B10u0 for these u0? 
u0 = 
"
3
1
#
; u0 = 
" 
3 
.1
#
; and u0 = 
"
6
0
#
: 
32. Diagonalize A and compute SLkS.1 to prove this formula for Ak: 
A = 
"
2 1 
1 2
# 
has Ak = 
1
2 
"
3k+1 3k.1 
3k.1 3k+1
#
: 
33. Diagonalize B and compute SLkS.1 to prove this formula for Bk: 
B = 
"
3 1 
0 2
# 
has Bk = 
"
3k 3k.2k 
0 2k 
#
:
282 Chapter 5 Eigenvalues and Eigenvectors 
Problems 34–44 are new applications of A = SLS.1. 
34. Suppose that A=SLS.1. Take determinants to prove that detA=l1l2 . . .ln = product 
of l ’s. This quick proof only works when A is . 
35. The trace of S times LS.1 equals the trace of LS.1 times S. So the trace of a diagonalizable 
A equals the trace of L, which is . 
36. If A = SLS.1, diagonalize the block matrix B = 
.A 0 
0 2A
¤
. Find its eigenvalue and 
eigenvector matrices. 
37. Consider all 4 by 4 matrices A that are diagonalized by the same fixed eigenvector 
matrix S. Show that the A’s form a subspace (cA and A1 +A2 have this same S). 
What is this subspace when S = I? What is its dimension? 
38. Suppose A2 = A. On the left side A multiplies each column of A. Which of our four 
subspaces contains eigenvectors with l = 1? Which subspace contains eigenvectors 
with l = 0? From the dimensions of those subspaces, A has a full set of independent 
eigenvectors and can be diagonalized. 
39. Suppose Ax = l x. If l = 0, then x is in the nullspace. If l 6= 0, then x is in the 
column space. Those spaces have dimensions (n.r)+r = n. So why doesn’t every 
square matrix have n linearly independent eigenvectors? 
40. Substitute A = SLS.1 into the product (A.l1I)(A.l2I) . . . (A.lnI) and explain 
why this produces the zero matrix. We are substituting the matrix A for the number 
l in the polynomial p(l ) = det(A.l I). The Cayley-Hamilton Theorem says that 
this product is always p(A) = zero matrix, even if A is not diagonalizable. 
41. Test the Cayley-Hamilton Theorem on Fibonacci’s matrix A = 
. 1 1 
1 0 
¤
. The theorem 
predicts that A2.A.I = 0, since det(A.l I) is l 2.l .1. 
42. If A = 
. a b 
c d 
¤
, then det(A.l I) is (l .a)(l .d). Check the Cayley-Hamilton statement 
that (A.aI)(A.dI) = zero matrix. 
43. If A = 
. 1 0 
0 2 
¤ 
and AB = BA, show that B = 
. a b 
c d 
¤ 
is also diagonal. B has the same 
eigen as A, but different eigen . These diagonal matrices B form a twodimensional 
subspace of matrix space. AB.BA = 0 gives four equations for the 
unknowns a, b, c, d—find the rank of the 4 by 4 matrix. 
44. If A is 5 by 5. then AB.BA = zero matrix gives 25 equations for the 25 entries in B. 
Show that the 25 by 25 matrix is singular by noticing a simple nonzero solution B. 
45. Find the eigenvalues and eigenvectors for both of these Markov matrices A and A.. 
Explain why A100 is close to A.: 
A = 
"
:6 :2 
:4 :8
# 
and A. = 
"
1=3 1=3 
2=3 2=3
#
:
5.3 Difference Equations and Powers Ak 283 
5.3 Difference Equations and Powers Ak 
Difference equations uk+1 = Auk move forward in a finite number of finite steps. A 
differential equation takes an infinite number of infinitesimal steps, but the two theories 
stay absolutely in parallel. It is the same analogy between the discrete and the continuous 
that appears over and over in mathematics. A good illustration is compound interest, 
when the time step gets shorter. 
Suppose you invest $1000 at 6% interest. Compounded once a year, the principal P 
is multiplied by 1.06. This is a difference equation Pk+1 = APk = 1:06Pk with a time step 
of one year. After 5 years, the original P0 = 1000 has been multiplied 5 times: 
Yearly P5 = (1:06)5P0 which is (1:06)51000 = $1338: 
Now suppose the time step is reduced to a month. The new difference equation is pk+1 = 
(1+:06=12)pk. After 5 years, or 60 months, you have $11 more: 
Monthly p60 = 
µ
1+ :06 
12 
¶60 
p0 which is (1:005)601000 = $1349: 
The next step is to compound every day, on 5(365) days. This only helps a little: 
Daily compounding 
µ
1+ :06 
365
¶5.365 
1000 = $1349:83: 
Finally, to keep their employees really moving, banks offer continuous compounding. 
The interest is added on at every instant, and the difference equation breaks down. You 
can hope that the treasurer does not know calculus (which is all about limits as Dt !0). 
The bank could compound the interest N times a year, so Dt = 1=N: 
Continuously 
µ
1+ :06 
N 
¶5N 
1000!e:301000 = $1349:87: 
Or the bank can switch to a differential equation—the limit of the difference equation 
pk+1 = (1+:06Dt)pk. Moving pk to the left side and dividing by Dt, 
Discrete to 
continuous 
pk+1. pk 
Dt 
= :06pk approaches 
d p 
dt 
= :06p: (1) 
The solution is p(t) = e:06t p0. After t = 5 years, this again amounts to $1349.87. The 
principal stays finite, even when it is compounded every instant—and the improvement 
over compounding every day is only four cents. 
Fibonacci Numbers 
The main object of this section is to solve uk+1 = Auk. That leads us to Ak and powers 
of matrices. Our second example is the famous Fibonacci sequence: 
Fibonacci numbers 0;1;1;2;3;5;8;13; : : : :
284 Chapter 5 Eigenvalues and Eigenvectors 
You see the pattern: Every Fibonacci number is the sum of the two previous F’s: 
Fibonacci equation Fk+2 = Fk+1+Fk: (2) 
That is the difference equation. It turns up in a most fantastic variety of applications, 
and deserves a book of its own. Leaves grow in a spiral pattern, and on the apple or oak 
you find five growths for every two turns around the stem. The pear tree has eight for 
every three turns, and the willow is 13:5. The champion seems to be a sunflower whose 
seeds chose an almost unbelievable ratio of F12=F13 = 144=233.2 
How could we find the 1000th Fibonacci number, without starting at F0 = 0 and 
F1 =1, and working all the way out to F1000? The goal is to solve the difference equation 
Fk+2 = Fk+1+Fk. This can be reduced to a one-step equation uk+1 = Auk. Every step 
multiplies uk = (Fk+1;Fk) by a matrix A: 
Fk+2 = Fk+1+Fk 
Fk+1 = Fk+1 
becomes uk+1 = 
"
1 1 
1 0
#"
Fk+1 
Fk 
# 
= Auk: (3) 
The one-step system uk+1 = Auk is easy to solve, It starts from u0. After one step it 
produces u1 = Au0. Then u2 is Au1, which is A2u0. Every step brings a multiplication 
by A, and after k steps there are k multiplications: 
The solution to a difference equation uk+1 = Auk is uk = Aku0. 
The real problem is to find some quick way to compute the powers Ak, and thereby find 
the 1000th Fibonacci number. The key lies in the eigenvalues and eigenvectors: 
5G If A can be diagonalized, A = SLS.1, then Ak comes from Lk: 
uk = Aku0 = (SLS.1)(SLS.1) . . . (SLS.1)u0 = SLkS.1u0: (4) 
The columns of S are the eigenvectors of A. Writing S.1u0 = c, the solution 
becomes 
uk = SLkc = 
2
6 4x1 . . . xn
3
75 
2
64
l k 
1 
. . . 
l k 
n
3
75 
2
64
c1
... 
cn
3
75
= c1l k 
1 x1+. . .+cnl k 
n xn: 
(5) 
After k steps, uk is a combination of the n “pure solutions” l kx. 
These formulas give two different approaches to the same solution uk = SLkS.1u0. 
The first formula recognized that Ak is identical with SLkS.1, and we could stop there. 
2For these botanical applications, see D’Arcy Thompson’s book On Growth and Form (Cambridge University 
Press, 1942) or Peter Stevens’s beautiful Patterns in Nature (Little, Brown, 1974). Hundreds of other properties 
of the Fn have been published in the Fibonacci Quarterly. Apparently Fibonacci brought Arabic numerals into 
Europe, about 1200 A.D.
5.3 Difference Equations and Powers Ak 285 
But the second approach brings out the analogy with a differential equation: The pure 
exponential solutions elitxi are now the pure powers l k 
i xi. The eigenvectors xi are 
amplified by the eigenvalues li. By combining these special solutions to match u0—that 
is where c came from—we recover the correct solution uk = SLkS.1u0. 
In any specific example like Fibonacci’s, the first step is to find the eigenvalues: 
A.l I = 
"
1.l 1 
1 .l 
# 
has det(A.l I) =l 2.l .1 
Two eigenvalues l1 = 
1+
p
5 
2 
and l2 = 
1.
p
5 
2 
: 
The second row of A.l I is (1;.l ). To get (A.l I)x=0, the eigenvector is x=(l ;1), 
The first Fibonacci numbers F0 = 0 and F1 = 1 go into u0, and S.1u0 = c: 
S.1u0 = 
"
l1 l2 
1 1 
#.1 "
1
0
# 
gives c = 
" 
1=(l1.l2) 
.1=(l1.l2)
# 
= 
1 
p
5 
" 
1 
.1
#
: 
Those are the constants in uk = c1l k 
1 x1 +c2l k 
2 x2. Both eigenvectors x1 and x2 have 
second component 1. That leaves Fk = c1l k 
1 +c2l k 
2 in the second component of uk: 
Fibonacci 
numbers 
Fk = 
1 
p
5 
2
4
A
1+
p
5 
2 
!k
.
A
1.
p
5 
2 
!k
3
5: 
This is the answer we wanted. The fractions and square roots look surprising because 
Fibonacci’s rule Fk+2 = Fk+1+Fk must produce whole numbers, Somehow that formula 
for Fk must give an integer. In fact, since the second term [(1.
p
5)=2]k=
p
5 is always 
less than 12
, it must just move the first term to the nearest integer: 
F1000 = nearest integer to 
1 
p
5 
A
1+
p
5 
2 
!1000 
: 
This is an enormous number, and F1001 will be even bigger. The fractions are becoming 
insignificant, and the ratio F1001=F1000 must be very close to (1+
p
5)=2 . 1:618. Since 
l k 
2 is insignificant compared to l k 
1 , the ratio Fk+1=Fk approaches l1. 
That is a typical difference equation, leading to the powers of A = 
. 1 1 
1 0 
¤ 
p . it involved 
5 because the eigenvalues did. If we choose a matrix with l1 = 1 and l2 = 6. we can 
focus on the simplicity of the computation—after A has been diagonalized: 
A = 
"
.4 .5 
10 11
# 
has l = 1 and 6; with x1 = 
" 
1 
.1
# 
and x2 = 
"
.1 
2 
# 
Ak = SLkS.1 is 
" 
1 .1 
.1 2 
#"
1k 0 
0 6k
#"
2 1 
1 1
# 
= 
" 
2.6k 1.6k 
.2+2 . 6k .1+2 . 6k
#
:
286 Chapter 5 Eigenvalues and Eigenvectors 
The powers 6k and 1k appear in that last matrix Ak, mixed in by the eigenvectors. 
For the difference equation uk+1 = Auk, we emphasize the main point. Every eigenvector 
x produces a “pure solution” with powers of l : 
One solution is u0 = x; u1 =l x; u2 =l 2x; : : : 
When the initial u0 is an eigenvector x, this is the solution: uk = l kx. In general u0 
is not an eigenvector. But if u0 is a combination of eigenvectors, the solution uk is the 
same combination of these special solutions. 
5H If u0 = c1x1 +. . .+cnxn, then after k steps uk = c1l k 
1 x1 +. . .+cnl k 
n xn. 
Choose the c’s to match the starting vector u0: 
u0 = 
2
6 4x1 . . . xn
3
75 
2
64
c1
... 
cn
3
75
= Sc and c = S.1u0: (6) 
Markov Matrices 
There was an exercise in Chapter 1, about moving in and out of California, that is worth 
another look. These were the rules: 
Each year 1 
10 of the people outside California move in, and 2 
10 of the people 
inside California move out. We start with y0 people outside and z0 inside. 
At the end of the first year the numbers outside and inside are y1 and z1: 
Difference 
equation 
y1 = :9y0+:2z0 
z1 = :1y0+:8z0 
or 
"
y1 
z1
# 
= 
"
:9 :2 
:1 :8
#"
y0 
z0
#
: 
This problem and its matrix have the two essential properties of a Markov process: 
1. The total number of people stays fixed: Each column of the Markov matrix adds 
up to 1. Nobody is gained or lost. 
2. The numbers outside and inside can never become negative: The matrix has no 
negative entries. The powers Ak are all nonnegative.3 
We solve this Markov difference equation using uk = SLkS.1u0. Then we show that 
the population approaches a “steady state.” First A has to be diagonalized: 
A.l I = 
"
:9.l :2 
:1 :8.l 
# 
has det(A.l I) =l 2.1:7l +:7 
3Furthermore, history is completely disregarded; each new uk+1 depends only on the current uk. Perhaps even 
our lives are examples of Markov processes, but I hope not.
5.3 Difference Equations and Powers Ak 287 
l1 and l2 = :7 : A = SLS.1 = 
"
23 
13
13
.13 
#"
1 
:7
#"
1 1 
1 .2
#
: 
To find Ak, and the distribution after k years, change SLS.1 to SLkS.1: 
"
yk 
zk
# 
= Ak 
"
y0 
z0
# 
= 
"
23 
13
13
.13 
#"
1k 
:7k
#"
1 1 
1 .2
#"
y0 
z0
# 
= (y0+z0)
"
2313 
#
+(y0.2z0)(:7)k 
" 
13 
.13 
#
: 
Those two terms are c1l k 
1 x1+c2l k 
2 x2. The factor l k 
1 = 1 is hidden in the first term. In 
the long run, the other factor (:7)k becomes extremely small. The solution approaches 
a limiting state u. = (y.; z.): 
Steady state 
"
y. 
z.
# 
= (y0+z0)
"
2313 
#
: 
The total population is still y0+z0, but in the limit 2
3 of this population is outside California 
and 13
is inside. This is true no matter what the initial distribution may have been! 
If the year starts with 23
outside and 13
inside, then it ends the same way: 
"
:9 :2 
:1 :8
#"
2313 
# 
= 
"
2313 
#
: or Au. = u.: 
The steady state is the eigenvector of A corresponding to l = 1. Multiplication by A, 
from one time step to the next, leaves u. unchanged. 
The theory of Markov processes is illustrated by that California example: 
5I A Markov matrix A has all ai j . 0, with each column adding to 1. 
(a) l1 = 1 is an eigenvalue of A. 
(b) Its eigenvector x1 is nonnegative—and it is a steady state, since Ax1 = x1. 
(c) The other eigenvalues satisfy klik · 1. 
(d) If A or any power of A has all positive entries, these other jlij are below 1. 
The solution Aku0 approaches a multiple of x1—which is the steady state 
u.. 
To find the right multiple of x1, use the fact that the total population stays the same. If 
California started with all 90 million people out, it ended with 60 million out and 30 
million in. It ends the same way if all 90 million were originally inside. 
We note that many authors transpose the matrix so its rows add to 1. 
Remark. Our description of a Markov process was deterministic: populations moved in 
fixed proportions. But if we look at a single individual, the fractions that move become
288 Chapter 5 Eigenvalues and Eigenvectors 
probabilities. With probability 1 
10, an individual outside California moves in. If inside, 
the probability of moving out is 2 
10. The movement becomes a random process, and A is 
called a transition matrix. 
The components of uk = Aku0 specify the probability that the individual is outside 
or inside the state. These probabilities are never negative and add to 1—everybody has 
to be somewhere. That brings us back to the two fundamental properties of a Markov 
matrix: Each column adds to 1, and no entry is negative. 
Why is l = 1 always an eigenvalue? Each column of A.I adds up to 1.1 = 0. 
Therefore the rows of A.I add up to the zero row, they are linearly dependent, and 
det(A.I) = 0. 
Except for very special cases, uk will approach the corresponding eigenvector4. In 
the formula uk = c1l k 
1 x1+. . .+cnl k 
n xn, no eigenvalue can be larger than 1. (Otherwise 
the probabilities uk would blow up.) If all other eigenvalues are strictly smaller than 
l1 = 1, then the first term in the formula will be dominant. The other l k 
i go to zero, and 
uk !c1x1 = u. = steady state. 
This is an example of one of the central themes of this chapter: Given information 
about A, find information about its eigenvalues. Here we found lmax = 1. 
Stability of uk+1 = Auk 
There is an obvious difference between Fibonacci numbers and Markov processes. The 
numbers Fk become larger and larger, while by definition any “probability” is between 0 
and 1. The Fibonacci equation is unstable. So is the compound interest equation Pk+1 = 
1:06Pk; the principal keeps growing forever. If the Markov probabilities decreased to 
zero, that equation would be stable; but they do not, since at every stage they must add 
to 1. Therefore a Markov process is neutrally stable. 
We want to study the behavior of uk+1 = Auk as k ! .. Assuming that A can be 
diagonalized, uk will be a combination of pure solutions: 
Solution at time k uk = SLkS.1u0 = c1l k 
1 x1+. . .+cnl k 
n xn: 
The growth of uk is governed by the l k 
i . Stability depends on the eigenvalues: 
5J The difference equation uk+1 = Auk is 
stable if all eigenvalues satisfy jlij < 1; 
neutrally stable if some jlij = 1 and all the other jlij < 1; and 
unstable if at least one eigenvalue has jlij > 1. 
In the stable case, the powers Ak approach zero and so does uk = Aku0. 
4If everybody outside moves in and everybody inside moves out, then the populations are reversed every year 
and there is no steady state. The transition matrix is A = 
. 0 1 
1 0 
¤ 
and .1 is an eigenvalue as well as +1—which 
cannot happen if all ai j > 0.
5.3 Difference Equations and Powers Ak 289 
Example 1. This matrix A is certainly stable: 
A = 
"
0 4 
0 12 
# 
has eigenvalues 0 and 
1
2
: 
The l ’s are on the main diagonal because A is triangular. Starting from any u0, and 
following the rule uk+1 = Auk, the solution must eventually approach zero: 
u0 = 
"
0
1
#
; u1 = 
"
4
12 
#
; u2 = 
"
2
14 
#
; u3 = 
"
1
18 
#
; u4 = 
" 
121 
16
#
; . . . 
The larger eigenvalue l = 12
governs the decay; after the first step every uk is 12
uk.1. The 
real effect of the first step is to split u0 into the two eigenvectors of A: 
u0 = 
"
8
1
#
+
"
.8 
0 
# 
and then uk = 
µ
1
2
¶k 
"
8
1
#
+(0)k 
"
.8 
0 
#
: 
Positive Matrices and Applications in Economics 
By developing the Markov ideas we can find a small gold mine (entirely optional) of 
matrix applications in economics. 
Example 2 (Leontief’s input-output matrix). 
This is one of the first great successes of mathematical economics. To illustrate it, we 
construct a consumption matrix—in which ai j, gives the amount of product j that is 
needed to create one unit of product i: 
A = 
2
64
:4 0 :1 
0 :1 :8 
:5 :7 :1
3
75
: 
(steel) 
(food) 
(labor) 
The first question is: Can we produce y1 units of steel, y2 units of food, and y3 units of 
labor? We must start with larger amounts p1, p2, p3, because some part is consumed 
by the production itself. The amount consumed is Ap, and it leaves a net production of 
p.Ap. 
Problem To find a vector p such that p.Ap = y; or p = (I.A).1y: 
On the surface, we are only asking if I.A is invertible. But there is a nonnegative twist 
to the problem. Demand and production, y and p, are nonnegative. Since p is (1.A).1y, 
the real question is about the matrix that multiplies y: 
When is (I.A).1 a nonnegative matrix? 
Roughly speaking, A cannot be too large. If production consumes too much, nothing is 
left as output. The key is in the largest eigenvalue l1 of A, which must be below 1:
290 Chapter 5 Eigenvalues and Eigenvectors 
If l1 > 1, (I.A).1 fails to be nonnegative. 
If l1 = 1, (I.A).1 fails to exist. 
If l1 < 1, (I.A).1 is a converging sum of nonnegative matrices: 
Geometric series (I.A).1 = I+A+A2+A3+. . . : (7) 
The 3 by 3 example has l1 = :9, and output exceeds input. Production can go on. 
Those are easy to prove, once we know the main fact about a nonnegative matrix like 
A: Not only is the largest eigenvalue l1 positive, but so is the eigenvector x1. Then 
(I.A).1 has the same eigenvector, with eigenvalue 1=(1.l1). 
If l1 exceeds 1, that last number is negative. The matrix (I .A).1 will take the 
positive vector x1 to a negative vector x1=(1.l1). In that case (I .A).1 is definitely 
not nonnegative. If l1 = 1, then I .A is singular. The productive case is l1 < 1, when 
the powers of A go to zero (stability) and the infinite series I +A+A2+. . . converges. 
Multiplying this series by I.A leaves the identity matrix—all higher powers cancel—so 
(I.A).1 is a sum of nonnegative matrices, We give two examples: 
A = 
"
0 2 
2 0
# 
has l1 = 2 and the economy is lost 
A = 
"
:5 2 
0 :5
# 
has l1 = 
1
2 
and we can produce anything. 
The matrices (I.A).1 in those two cases are .13
. 
1 2 
2 1 
¤ 
and 
. 2 8 
0 2 
¤
. 
Leontief’s inspiration was to find a model that uses genuine data from the real economy. 
The table for 1958 contained 83 industries in the United States, with a “transactions 
table” of consumption and production for each one. The theory also reaches 
beyond (I .A).1, to decide natural prices and questions of optimization. Normally labor 
is in limited supply and ought to be minimized. And, of course, the economy is not 
always linear. 
Example 3 (The prices in a closed input-output model ). 
The model is called “closed” when everything produced is also consumed. Nothing goes 
outside the system. In that case A goes back to a Markov matrix. The columns add up 
to 1. We might be talking about the value of steel and food and labor, instead of the 
number of units, The vector p represents prices instead of production levels. 
Suppose p0 is a vector of prices. Then Ap0 multiplies prices by amounts to give the 
value of each product. That is a new set of prices which the system uses for the next 
set of values A2p0. The question is whether the prices approach equilibrium. Are there 
prices such that p = Ap, and does the system take us there? 
You recognize p as the (nonnegative) eigenvector of the Markov matrix A, with l =1. 
It is the steady state p., and it is approached from any starting point p0. By repeating a 
transaction over and over, the price tends to equilibrium.
5.3 Difference Equations and Powers Ak 291 
The “Perron-Frobenius theorem” gives the key properties of a positive matrix—not 
to be confused with a positive definite matrix, which is symmetric and has all its eigenvalues 
positive. Here all the entries ai j are positive. 
5K If A is a positive matrix, so is its largest eigenvalue: l1 > all other jlij. 
Every component of the corresponding eigenvector x1 is also positive. 
Proof. Suppose A > 0. The key idea is to look at all numbers t such that Ax . tx for 
some nonnegative vector x (other than x = 0). We are allowing inequality in Ax . tx in 
order to have many positive candidates t. For the largest value tmax (which is attained), 
we will show that equality holds: Ax = tmaxx. 
Otherwise, if Ax . tmaxx is not an equality, multiply by A. Because A is positive, that 
produces a strict inequality A2x > tmaxAx. Therefore the positive vector y = Ax satisfies 
Ay > tmaxy, and tmax could have been larger. This contradiction forces the equality Ax = 
tmaxx, and we have an eigenvalue. Its eigenvector x is positive (not just nonnegative) 
because on the left-hand side of that equality Ax is sure to be positive. 
To see that no eigenvalue can be larger than tmax, suppose Az = l z. Since l and z 
may involve negative or complex numbers, we take absolute values: jl jjzj = jAzj · Ajzj 
by the “triangle inequality.” This jzj is a nonnegative vector, so jl j is one of the possible 
candidates t. Therefore jl j cannot exceed l1, which was tmax. 
Example 4 (Von Neumann’s model of an expanding economy ). 
We go back to the 3 by 3 matrix A that gave the consumption of steel, food, and labor. 
If the outputs are s1, f1, `1, then the required inputs are 
u0 = 
2
64
:4 0 :1 
0 :1 :8 
:5 :7 :1
3
75 
2
64
s1 
f1 
`1
3
75
= Au1: 
In economics the difference equation is backward! Instead of u1 = Au0 we have u0 = 
Au1. If A is small (as it is), then production does not consume everything—and the 
economy can grow. The eigenvalues of A.1 will govern this growth. But again there is 
a nonnegative twist, since steel, food, and labor cannot come in negative amounts. Von 
Neumann asked for the maximum rate t at which the economy can expand and still stay 
nonnegative, meaning that u1 . tu0 . 0. 
Thus the problem requires u1 .tAu1. It is like the Perron-Frobenius theorem, with A 
on the other side. As before, equality holds when t reaches tmax—which is the eigenvalue 
associated with the positive eigenvector of A.1. In this example the expansion factor is 
10 
9 : 
x = 
2
641
5
5
3
75
and Ax = 
2
64
:4 0 :1 
0 :1 :8 
:5 :7 :1
3
75 
2
64
1
5
5
3
75
= 
2
64
0:9 
4:5 
4:5
3
75
= 
9 
10
x: 
With steel-food-labor in the ratio 1-5-5, the economy grows as quickly as possible: The 
maximum growth rate is 1=l1.
292 Chapter 5 Eigenvalues and Eigenvectors 
Problem Set 5.3 
1. Prove that every third Fibonacci number in 0;1;1:2;3; : : : is even. 
2. Bernadelli studied a beetle “which lives three years only. and propagates in as third 
year.” They survive the first year with probability 12
, and the second with probability 
13
, and then produce six females on the way out: 
Beetle matrix A = 
2
64
0 0 6 
12
0 0 
0 13
0
3
75
: 
Show that A3 = I, and follow the distribution of 3000 beetles for six years. 
3. For the Fibonacci matrix A = 
. 1 1 
1 0 
¤ 
, compute A2, A3, and A4. Then use the text and 
a calculator to find F20. 
4. Suppose each “Gibonacci” number Gk+2 is the average of the two previous numbers 
Gk+1 and Gk. Then Gk+2 = 12
(Gk+1+Gk): 
Gk+2 = 12
Gk+1+ 12
Gk 
Gk+1 = Gk+1 
is 
"
Gk+2 
Gk+1
# 
= 
h
A
i"
Gk+1 
Gk 
#
: 
(a) Find the eigenvalues and eigenvectors of A. 
(b) Find the limit as n!. of the matrices An = SLnS.1. 
(c) If G0 = 0 and G1 = 1, show that the Gibonacci numbers approach 23
. 
5. Diagonalize the Fibonacci matrix by completing S.1: 
"
1 1 
1 0
# 
= 
"
l1 l2 
1 1 
#"
l1 0 
0 l2
#" #
: 
Do the multiplication SLkS.1 .10
¤ 
to find its second component. This is the kth Fibonacci 
number Fk = (l k 
1 ll k 
2 )=(l1ll2). 
6. The numbers l k 
1 and l k 
2 satisfy the Fibonacci rule Fk+2 = Fk+1+Fk: 
l k+2 
1 =l k+1 
1 +l k 
1 and l k+2 
2 =l k+1 
2 +l k 
2 : 
Prove this by using the original equation for the l ’s (multiply it by l k). Then any 
combination of l k 
1 and l k 
2 satisfies the rule. The combination Fk = (l k 
1 .l k 
2 )=(l1. 
l2) gives the right start of F0 = 0 and F1 = 1.
5.3 Difference Equations and Powers Ak 293 
7. Lucas started with L0 = 2 and L1 = 1. The rule Lk+2 = Lk+1+Lk is the same, so A 
is still Fibonacci’s matrix. Add its eigenvectors x1+x2: 
"
l1 
1 
#
+
"
l2 
1 
# 
= 
"
1
2(1+
p
5) 
1 
#
+
"
12
(1.
p
5) 
1 
# 
= 
"
1
2
# 
= 
"
L1 
L0
#
: 
Multiplying by Ak, the second component is Lk = l k 
1 +l k 
2 . Compute the Lucas 
number L10 slowly by Lk+2 = Lk+1+Lk, and compute approximately by l 10 
1 . 
8. Suppose there is an epidemic in which every month half of those who are well become 
sick, and a quarter of those who are sick become dead. Find the steady state 
for the corresponding Markov process 
2
64
dk+1 
sk+1 
wk+1
3
75
= 
2
64
1 14
0 
0 34 
12 
0 0 12 
3
75 
2
64
dk 
sk 
wk
3
75
: 
9. Write the 3 by 3 transition matrix for a chemistry course that is taught in two sections, 
if every week 14
of those in Section A and 13
of those in Section B drop the course, 
and 16
of each section transfer to the other section. 
10. Find the limiting values of yk and k (k!.) if 
yk+1 = :8yk+:3zk y0 = 0 
zk+1 = :2yk+:7zk z0 = 5: 
Also find formulas for yk and zk from Ak = SLkS.1. 
11. (a) From the fact that column 1 + column 2 = 2(column 3), so the columns are 
linearly dependent find one eigenvalue and one eigenvector of A: 
A = 
2
64
:2 :4 :3 
:4 :2 :3 
:4 :4 :4
3
75
: 
(b) Find the other eigenvalues of A (it is Markov). 
(c) If u0 = (0;10;0), find the limit of Aku0 as k!.. 
12. Suppose there are three major centers for Move-It-Yourself trucks. Every month half 
of those in Boston and in Los Angeles go to Chicago, the other half stay here they 
are, and the trucks in Chicago are split equally between Boston and Los Angeles Set 
up the 3 by 3 transition matrix A, and find the steady state u. corresponding to the 
eigenvalue l = 1. 
13. (a) In what range of a and b is the following equation a Markov process? 
uk+1 = Auk = 
" 
a b 
1.a 1.b
#
uk; u0 = 
"
1
1
#
:
294 Chapter 5 Eigenvalues and Eigenvectors 
(b) Compute uk = SLkS.1u0 for any a and b. 
(c) Under what condition on a and b does uk approach a finite limit as k !., and 
what is the limit? Does A have to be a Markov matrix? 
14. Multinational companies in the Americas, Asia, and Europe have assets of $4 trillion. 
At the start, $2 trillion are in the Americas and $2 trillion in Europe. Each year 12
the 
American money stays home, and 14
goes to each of Asia and Europe. For Asia and 
Europe, 12
stays home and 12
is sent to the Americas. 
(a) Find the matrix that gives 
2
64
Americas 
Asia 
Europe 
3
75 
year k+1 
= A
2
64
Americas 
Asia 
Europe 
3
75 
year k 
. 
(b) Find the eigenvalues and eigenvectors of A. 
(c) Find the limiting distribution of the $4 trillion as the world ends. 
(d) Find the distribution of the $4 trillion at year k. 
15. If A is a Markov matrix, show that the sum of the components of Ax equals the sum 
of the components of x. Deduce that if Ax =l x with l 6= 1, the components of the 
eigenvector add to zero. 
16. The solution to du=dt =Au=
. 0 .1 
1 0 
¤
u (eigenvalues i and .i) goes around in a circle: 
u=(cost; sint). Suppose we approximate du=dt by forward, backward, and centered 
differences F, B, C: 
(F) un+1.un = Aun or un+1 = (I+A)un (this is Euler’s method). 
(B) un+1.un = Aun+1 or un+1 = (I.A).1un (backward Euler). 
(C) un+1.un = 12
A(un+1+un) or un+1 = (I. 12
A).1(I+ 12
A)un. 
Find the eigenvalues of I+A, (IlA).1, and (I.12
A).1(I+12
A). For which difference 
equation does the solution un stay on a circle? 
17. What values of a produce instability in vn+1 =a(vn+wn), wn+1 =a(vn+wn)? 
18. Find the largest a, b, c for which these matrices are stable or neutrally stable: 
"
a .:8 
:8 :2 
#
; 
"
b :8 
0 :2
#
; 
" 
c :8 
:2 c 
#
: 
19. Multiplying term by term, check that (IlA)(I +A+A2 +. . . ) = I. This series represents 
(IlA).1. It is nonnegative when A is nonnegative, provided it has a finite
5.3 Difference Equations and Powers Ak 295 
sum; the condition for that is lmax < 1. Add up the infinite series, and confirm that 
it equals (IlA).1, for the consumption matrix 
A = 
2
64
0 1 1 
0 0 1 
0 0 0
3
75
which has lmax = 0: 
20. For A = 
. 0 :2 
0 :5 
¤
, find the powers Ak (including A0) and show explicitly that their sum 
agrees with (I.A).1. 
21. Explain by mathematics or economics why increasing the “consumption matrix” A 
must increase tmax =l1 (and slow down the expansion). 
22. What are the limits as k!. (the steady states) of the following? 
h
:4 :2:6 :8
ik 
"
1
0
#
; 
h
:4 :2:6 :8
ik 
"
0
1
#
; 
h
:4 :2:6 :8
ik 
: 
Problems 23–29 are about A = SLS.1 and Ak = SLkS.1 
23. Diagonalize A and compute SLkS.1 to prove this formula for Ak: 
A = 
"
3 2 
2 3
# 
has Ak = 
1
2 
"
5k+1 5k.1 
5k.1 5k+1
#
: 
24. Diagonalize B and compute SLkS.1 to prove this formula for Bk: 
B = 
"
3 1 
0 2
# 
has Bk = 
"
3k 3k.2k 
0 2k 
#
: 
25. The eigenvalues of A are 1 and 9, the eigenvalues of B are l1 and 9: 
A = 
"
5 4 
4 5
# 
and B = 
"
4 5 
5 4
#
: 
Find a matrix square root of A from R=S
p
LS.1, Why is there no real matrix square 
root of B? 
26. If A and B have the same l ’s with the same full set of independent eigenvectors, their 
factorizations into are the same. So A = B. 
27. Suppose A and B have the same full set of eigenvectors, so that A = SL1S.1 and 
B = SL2S.1. Prove that AB = BA. 
28. (a) When do the eigenvectors for l = 0 span the nullspace N(A)? 
(b) When do all the eigenvectors for l 6= 0 span the column space C(A)?
296 Chapter 5 Eigenvalues and Eigenvectors 
29. The powers Ak approach zero if all jlij < 1, and they blow up if any jlij > 1. Peter 
Lax gives four striking examples in his book Linear Algebra. 
A = 
"
3 2 
1 4
# 
B = 
" 
3 2 
.5 .3
# 
C = 
" 
5 7 
.3 .4
# 
D = 
" 
5 6:9 
.3 .4
# 
kA1024k > 10700 B1024 = I C1024 = .C kD1024k < 10.78 
Find the eigenvalues l = eiq of B and C to show that B4 = I and C3 = .I. 
5.4 Differential Equations and eAt 
Wherever you find a system of equations, rather than a single equation, matrix theory 
has a part to play. For difference equations, the solution uk =Aku0 depended on the owen 
of A. For differential equations, the solution u(t) = eAtu(0) depends on the exponential 
of A. To define this exponential. and to understand it, we turn right away to an example: 
Differential equation 
du 
dt 
= Au = 
"
.2 1 
1 .2
#
u: (1) 
The first step is always to find the eigenvalues (l1 and .3) and the eigenvectors: 
A
"
1
1
# 
= (.1)
"
1
1
# 
and A
" 
1 
.1
# 
= (.3)
" 
1 
.1
#
: 
Then several approaches lead to u(t). Probably the best is to match the general solution 
to the initial vector u(0) at t = 0. 
The general solution is a combination of pure exponential solutions. These are solutions 
of the special form cel tx, where l is an eigenvalue of A and x is its eigenvector. 
These pure solutions satisfy the differential equation, since d=dt(cel tx) = A(cel tx). 
(They were our introduction to eigenvalues at the start of the chapter.) In this 2 by 2 
example, there are two pure exponentials to be combined: 
Solution u(t) = c1el1tx1+c2el2tx2 or u = 
"
1 1 
1 .1
#"
e.t 
e.3t
#"
c1 
c2
#
: (2) 
At time zero, when the exponentials are e0 = 1, u(0) determines c1 and c2: 
Initial condition u(0) = c1x1+c2x2 = 
"
1 1 
1 .1
#"
c1 
c2
# 
= Sc: 
You recognize S, the matrix of eigenvectors. The constants c = S.1u(0) are the same as 
they were for difference equations. Substituting them back into equation (2), the solution
5.4 Differential Equations and eAt 297 
is 
u(t) = 
"
1 1 
1 .1
#"
e.t 
e.3t
#"
c1 
c2
# 
= S
"
e.t 
e.3t
#
S.1u(0): (3) 
Here is the fundamental formula of this section: SeLtS.1u(0) solves the differential 
equation, just as SLkS.1u0 solved the difference equation: 
u(t) = SeLtS.1u(0) with L = 
"
.1 
.3
# 
and eLt = 
"
e.t 
e.3t
#
: (4) 
There are two more things to be done with this example. One is to complete the 
mathematics, by giving a direct definition of the exponential of a matrix. The other 
is to give a physical interpretation of the equation and its solution. It is the kind of 
differential equation that has useful applications. 
The exponential of a diagonal matrix L is easy; eLt just has the n numbers el t on 
the diagonal. For a general matrix A, the natural idea is to imitate the power series 
ex = 1+x+x2=2!+x3=3!+. . . . If we replace x by At and 1 by I, this sum is an n by n 
matrix: 
Matrix exponential eAt = I+At + 
(At)2 
2! 
+ 
(At)3 
3! 
+. . . : (5) 
The series always converges, and its sum eAt has the right properties: 
(eAs)(eAt) = (eA(s+t)); (eAt)(e.At) = I; and 
d 
dt 
(eAt) = AeAt : (6) 
From the last one, u(t) = eAtu(0) solves the differential equation. This solution must 
be the same as the form SeLtS.1u(0) used for computation. To prove directly that those 
solutions agree, remember that each power (SLS.1)k telescopes into Ak = SLkS.1 (because 
S.1 cancels S). The whole exponential is diagonalized by S: 
eAt = I+SLS.1t + 
SL2S.1t2 
2! 
+ 
SL3S.1t3 
3! 
+. . . 
= S
µ
I+Lt + 
(Lt)2 
2! 
+ 
(Lt)3 
3! 
+. . .
¶
S.1 = SeLtS.1: 
Example 1. In equation (1), the exponential of A = 
..2 1 
1 .2 
¤ 
has L = 
. 1 
.3 
¤
: 
eAt = SeLtS.1 = 
"
1 1 
1 .1
#"
e.t 
e.3t
#"
1 1 
1 .1
#.1 
= 
1
2 
"
e.t +e.3t e.t .e.3t 
e.t .e.3t e.t +e.3t
#
: 
At t =0 we get e0 =I. The infinite series eAt gives the answer for all t, but a series can be 
hard to compute. The form SeLtS.1 gives the same answer when A can be diagonalized; 
it requires n independent eigenvectors in S. This simpler form leads to a combination of 
n exponentials el tx—which is the best solution of all:
298 Chapter 5 Eigenvalues and Eigenvectors 
5L If A can be diagonalized, A = SLS.1, then du=dt = Au has the solution 
u(t) = eAtu(0) = SeLtS.1u(0): (7) 
The columns of S are the eigenvectors x1; : : : ;xn of A. Multiplying gives 
u(t) = 
2
6 4x1 . . . xn
3
75 
2
64
el1t 
. . . 
elnt
3
75
S.1u(0) 
= c1el1tx1+. . .+cnelntxn = combination of el tx: 
(8) 
The constants ci that match the initial conditions u(0) are c = S.1u(0). 
This gives a complete analogy with difference equations and SLS.1u0. In both cases 
we assumed that A could be diagonalized. since otherwise it has fewer than n eigenvectors 
and we have not found enough special solutions. The missing Solutions do exist, 
but they are more complicated than pure exponentials el tx. They involve “generalized 
eigenvectors” and factors like tel t . (To compute this defective case we can use the Jordan 
form in Appendix B, and find eJt .) The formula u(t)=eAtu(0) remains completely 
correct. 
The matrix eAt is never singular. One proof is to look at its eigenvalues; if l is an 
eigenvalue of A, then el t is the corresponding eigenvalue of eAt—and el t can never be 
zero. Another approach is to compute the determinant of the exponential: 
det eAt = el1tel2t . . .elnt = etrace(At): (9) 
Quick proof that eAt is invertible: Just recognize e.At as its inverse. 
This invertibility is fundamental for differential equations. If n solutions are linearly 
independent at t = 0, they remain linearly independent forever. If the initial vectors are 
v1; : : : ;vn, we can put the solutions eAtv into a matrix: 
h
eAtv1 . . . eAtvn
i 
= eAt 
h
v1 . . . vn
i
: 
The determinant of the left-hand side is the Wronskian. It never becomes zero, because 
it is the product of two nonzero determinants. Both matrices on the right-hand side are 
invertible. 
Remark. Not all differential equations come to us as a first-order system du=dt = Au. 
We may start from a single equation of higher order, like y000.3y00+2y0 = 0. To convert 
to a 3 by 3 system, introduce v = y0 and w = v0 as additional unknowns along with y 
itself. Then these two equations combine with the original one to give u0 = Au: 
y0 = v 
v0 = w 
w0 = 3w.2v 
or u0 = 
2
64
0 1 0 
0 0 1 
0 .2 3
3
75 
2
64
y
v
w
3
75
= Au:
5.4 Differential Equations and eAt 299 
0 v w 0 
S0 S1 S2 S3 
concentration 
Figure 5.1: A model of diffusion between four segments. 
We are back to a first-order system. The problem can be solved two ways. In a course 
on differential equations, you would substitute y = el t into y000.3y00+2y0 = 0: 
(l 3.3l 2+2l )el t = 0 or l (l .1)(l .2)el t = 0: (10) 
The three pure exponential solutions are y = e0t , y = et , and y = e2t . No eigenvectors are 
involved. In a linear algebra course, we find the eigenvalues of A: 
det(A.l I) = 
2
64
.l 1 0 
0 .l I 
0 .2 3.l 
3
75
= .l 3+3l 2.2l = 0: (11) 
Equations (10) and (11) are the same! The same three exponents appear: l = 0, l = 1, 
and l = 2. This is a general rule which makes the two methods consistent; the growth 
rates of the solutions stay fixed when the equations change form. It seems to us that 
solving the third-order equation is quicker. 
The physical significance of du=dt = 
..2 1 
1 .2 
¤
u is easy to explain and at the same 
time genuinely important. This differential equation describes a process of diffusion. 
Divide an infinite pipe into four segments (Figure 5.1). At time t = 0, the middle segments 
contain concentrations v(0) and w(0) of a chemical. At each time t, the diffusion 
rate between two adjacent segments is the difference in concentrations. Within each 
segment, the concentration remains uniform (zero in the infinite segments). The process 
is continuous in time but discrete in space; the unknowns are v(t) and w(t) in the two 
inner segments S1 and S2. 
The concentration v(t) in S1 is changing in two ways. There is diffusion into S0, and 
into or out of S2. The net rate of change is dv=dt, and dw=dt is similar: 
Flow rate into S1 
dv 
dt 
= (w.v)+(0.v) 
Flow rate into S2 
dw 
dt 
= (0.w)+(v.w): 
This law of diffusion exactly matches our example du=dt = Au: 
u = 
"
v
w
# 
and 
du 
dt 
= 
"
.2v+w 
v.2w 
# 
= 
"
.2 1 
1 .2
#
u: 
The eigenvalues .1 and .3 will govern the solution. They give the rate at which the 
concentrations decay, and l1 is the more important because only an exceptional set of
300 Chapter 5 Eigenvalues and Eigenvectors 
starting conditions can lead to “superdecay” at the rate e.3t , In fact, those conditions 
must come from the eigenvector (1;.1). If the experiment admits only nonnegative 
concentrations, superdecay is impossible and the limiting rate must be e.t . The solution 
that decays at this slower rate corresponds to the eigenvector (1;1). Therefore the two 
concentrations will become nearly equal (typical for diffusion) as t !.. 
One more comment on this example: It is a discrete approximation, with only two 
unknowns, to the continuous diffusion described by this partial differential equation: 
Heat equation 
¶ u 
¶ t 
= 
¶ 2u 
¶ x2 : 
That heat equation is approached by dividing the pipe into smaller and smaller segments, 
of length 1=N. The discrete system with N unknowns is governed by 
d 
dt 
2
6664 
u1 
.
. 
uN
3
7775
= 
2
6664 
.2 1 
1 .2 . 
. . 1 
1 .2
3
7775 
2
6664 
u1 
.
. 
uN
3
7775
= Au: (12) 
This is the finite difference matrix with the 1, .2, 1 pattern. The right side Au approaches 
the second derivative d2u=dx2, after a scaling factor N2 comes from the flow problem. 
In the limit as N ! ., we reach the heat equation ¶ u=¶ t = ¶ 2u=¶ x2. Its solutions 
are still combinations of pure exponentials, but now there are infinitely many. Instead 
of eigenvectors from Ax =l x, we have eigenfunctions from d2u=dx2 = l u. Those are 
u(x) = sinnpx with l = .n2p2. Then the solution to the heat equation is 
u(t) = 
.a 
n=1 
cne.n2p2t sinnpx: 
The constants cn are determined by the initial condition. The novelty is that the eigenvectors 
are functions u(x), because the problem is continuous and not discrete. 
stability of differential equations 
Just as for difference equations. the eigenvalues decide how u(t) behaves as t ! .. 
As long as A can be diagonalized, there will be n pure exponential solutions to the 
differential equation, and any specific solution u(t) is some combination 
u(t) = SeLtS.1u0 = c1egl1tx1+. . .+cneglntxn: 
Stability is governed by those factors eglit . If they all approach zero, then u(t) approaches 
zero: if they all stay bounded, then u(t) stays bounded; if one of them blows up, then 
except for very special starting conditions the solution will blow up. Furthermore, the 
size of el t depends only on the real part of l . It is only the real parts of the eigenvalues 
that govern stability: If l = a+ib, then 
el t = eateibt = eat(cosbt +i sinbt) and the magnitude is jel t j = eat :
5.4 Differential Equations and eAt 301 
This decays for a < 0, it is constant for a = 0, and it explodes for a > 0. The imaginary 
part is producing oscillations, but the amplitude comes from the real part. 
5M The differential equation du=dt = Au is 
stable and eAt !0 whenever all Reli < 0, 
neutrally stable when all Reli · 0 and Rel1 = 0, and 
unstable and eAt is unbounded if any eigenvalue has Reli > 0. 
In some texts the condition Rel < 0 is called asymptotic stability, because it guarantees 
decay for large times t. Our argument depended on having n pure exponential solutions, 
but even if A is not diagonalizable (and there are terms like tel t ) the result is still true: 
All solutions approach zero if and only if all eigenvalues have Rel < 0. 
Stability is especially easy to decide for a 2 by 2 system (which is very common in 
applications). The equation is 
du 
dt 
= 
"
a b 
c d
#
u: 
and we need to know when both eigenvalues of that matrix have negative real parts. 
(Note again that the eigenvalues can be complex numbers.) The stability tests are 
Rel1 < 0 The trace a+d must be negative. 
Rel2 < 0 The determinant ad.bc must be positive. 
When the eigenvalues are real, those tests guarantee them to be negative. Their product 
is the determinant; it is positive when the eigenvalues have the same sign. Their sum is 
the trace; it is negative when both eigenvalues are negative. 
When the eigenvalues are a complex pair x§iy, the tests still succeed. The trace 
is their sum 2x (which is < 0) and the determinant is (x+iy)(x.iy) = x2 +y2 > 0. 
Figure 5.2 shows the one stable quadrant, trace < 0 and determinant > 0. It also shows 
the parabolic boundary line between real and complex eigenvalues. The reason for the 
parabola is in the quadratic equation for the eigenvalues: 
det
"
a.l b 
c d.l 
# 
=l 2.(trace)l +(det) = 0: (13) 
The quadratic formula for l leads to the parabola (trace)2 = 4(det): 
l1 and l2 = 
1
2 
·
trace§
q
(trace)2.4(det)
.
: (14) 
Above the parabola, the number under the square root is negative—so l is not real. On 
the parabola, the square root is zero and l is repeated. Below the parabola the square 
roots are real. Every symmetric matrix has real eigenvalues, since if b = c, then 
(trace)2.4(det) = (a+d)2.4(ad.b2) = (a.d)2+4b2 . 0:
302 Chapter 5 Eigenvalues and Eigenvectors 
trace T 
1 = 2 and 
both Re > 0 T2 = 4D 
unstable 
both  > 0 
real and unstable 
both Re < 0 
stable 
both  < 0 
real and stable 
complex eigenvalues 
determinant D 
det < 0 gives l1 < 0 and l2 > 0: real and unstable 
Figure 5.2: Stability and instability regions for a 2 by 2 matrix. 
For complex eigenvalues, b and c have opposite signs and are sufficiently large. 
Example 2. One from each quadrant: only #2 is stable: 
"
1 0 
0 2
# "
.1 0 
0 .2
# "
1 0 
0 .2
# "
.1 0 
0 2
# 
On the boundaries of the second quadrant, the equation is neutrally stable. On the horizontal 
axis, one eigenvalue is zero (because the determinant is l1l2 =0). On the vertical 
axis above the origin, both eigenvalues are purely imaginary (because the trace is Zero). 
Crossing those axes are the two ways that stability is lost. 
The n by n case is more difficult. A test for Reli < 0 came from Routh and Hurwitz, 
who found a series of inequalities on the entries ai j. I do not think this approach is 
much good for a large matrix; the computer can probably find the eigenvalues with more 
certainty than it can test these inequalities. Lyapunov’s idea was to find a weighting 
matrix W so that the weighted length kWu(t)k is always decreasing. If there exists 
such a W, then kWuk will decrease steadily to zero, and after a few ups and downs u 
must get there too (stability). The real value of Lyapunov’s method is for a nonlinear 
equation—then stability can be proved without knowing a formula for u(t). 
Example 3. du=dt = 
. 0 .1 
1 0 
¤
u sends u(t) around a circle, starting from u(0) = (1;0). 
Since trace = 0 and det = 1, we have purely imaginary eigenvalues: 
"
.l .1 
1 .l 
# 
=l 2+1 = 0 so l = +i and .i: 
The eigenvectors are (1;.i) and (1; i). and the solution is 
u(t) = 
1
2
eit 
" 
1 
.i
#
+ 
1
2
e.it 
"
1
i
#
:
5.4 Differential Equations and eAt 303 
That is correct but not beautiful. By substituting cost §i sint for eit and e.it , real numbers 
will reappear: The circling solution is u(t) = (cost; sint). 
Starting from a different u(0) = (a;b), the solution u(t) ends up as 
u(t) = 
"
acost .bsint 
bcost +asint
# 
= 
"
cost .sint 
sint cost 
#"
a
b
#
: (15) 
There we have something important! The last matrix is multiplying u(0), so it must be 
the exponential eAt . (Remember that u(t) = eAtu(0).) That matrix of cosines and sines 
is our leading example of an orthogonal matrix. The columns have length 1, their inner 
product is zero, and we have a confirmation of a wonderful fact: 
If A is skew-symmetric (AT = .A) then eAt is an orthogonal matrix. 
AT = .A gives a conservative system. No energy is lost in damping or diffusion: 
AT = .A; (eAt)T = e.At ; and keAtu(0)k = ku(0)k: 
That last equation expresses an essential property of orthogonal matrices. When they 
multiply a vector, the length is not changed. The vector u(0) is just rotated, and that 
describes the solution to du=dt = Au: It goes around in a circle. 
In this very unusual case, eAt can also be recognized directly from the infinite series. 
Note that A = 
. 0 .1 
1 0 
¤ 
has A2 = .I, and use this in the series for eAt : 
I+At + 
(At)2 
2 
+ 
(At)3 
6 
+. . . = 
2
4
.
1. t2 
2 +. . .
. .
.t + t3 
6 .. . .
. 
.
t . t3 
6 +. . .
. .
1. t2 
2 +. . .
. 
3
5 
= 
"
cost .sint 
sint cost 
# 
Example 4. The diffusion equation is stable: A = 
"
.2 1 
1 .2
# 
has l = .1 and l = .3. 
Example 5. If we close off the infinite segments, nothing can escape: 
du 
dt 
= 
"
.1 1 
1 .1
#
u or 
dv=dt = w.v 
dw=dt = v.w: 
This is a continuous Markov process. Instead of moving every year, the particles move 
every instant. Their total number v+w is constant. That comes from adding the two 
equations on the right-hand side: the derivative of v+w is zero. 
A discrete Markov matrix has its column sums equal to lmax = 1. A continuous 
Markov matrix, for differential equations, has its column sums equal to lmax = 0. A is 
a discrete Markov matrix if and only if B = A.I is a continuous Markov matrix. The
304 Chapter 5 Eigenvalues and Eigenvectors 
Figure 5.3: The slow and fast modes of oscillation. 
steady state for both is the eigenvector for lmax. It is multiplied by 1k = 1 in difference 
equations and by e0t = 1 in differential equations, and it doesn’t move. 
In the example, the steady state has v = w. 
Example 6. In nuclear engineering, a reactor is called critical when it is neutrally 
stable; the fission balances the decay. Slower fission makes it stable, or subcritical, and 
eventually it runs down. Unstable fission is a bomb. 
Second-Order Equations 
The laws of diffusion led to a first-order system du=dt = Au. So do a lot of other applications, 
in chemistry, in biology, and elsewhere, but the most important law of physics 
does not. It is Newton’s law F = ma, and the acceleration a is a second derivative. Inertial 
terms produce second-order equations (we have to solve d2u=dt2 = Au instead of 
du=dt = Au), and the goal is to understand how this switch to second derivatives alters 
the solution5. It is optional in linear algebra, but not in physics. 
The comparison will be perfect if we keep the same A: 
d2u 
dt2 = Au = 
"
.2 1 
1 .2
#
u: (16) 
Two initial conditions get the system started—the “displacement” u(0) and the “velocity” 
u0(0). To match these conditions, there will be 2n pure exponential solutions. 
Suppose we use w rather than l , and write these special solutions as u = eiwtx. Substituting 
this exponential into the differential equation, it must satisfy 
d2 
dt2 (eiwtx) = A(eiwtx); or .w2x = Ax: (17) 
The vector x must be an eigenvector of A, exactly as before. The corresponding eigenvalue 
is now .w2, so the frequency w is connected to the decay rate l by the law 
5Fourth derivatives are also possible, in the bending of beams, but nature seems to resist going higher than four.
5.4 Differential Equations and eAt 305 
.w2 = l . Every special solution el tx of the first-order equation leads to two special 
solutions eiwtx of the second-order equation. and the two exponents are w = §
p
.l . 
This breaks down only when l = 0, which has just one square root; if the eigenvector is 
x, the two special solutions are x and tx. 
For a genuine diffusion matrix, the eigenvalues l are all negative and the frequencies 
w are all real: Pure diffusion is converted into pure oscillation. The factors eiwt produce 
neutral stability, the solution neither grows or decays, and the total energy stays precisely 
constant. It just keeps passing around the system. The general solution to d2u=dt2 = Au, 
if A has negative eigenvalues l1; : : : ;ln and if wj =
p
.l j, is 
u(t) = 
.
c1eiw1t +d1e.w1t.
x1+cdots+
.
cneiwnt +dne.wnt.
xn: (18) 
As always, the constants are found from the initial conditions. This is easier to do (at the 
expense of one extra formula) by switching from oscillating exponentials to the more 
familiar sine and cosine: 
u(t) = (a1 cosw1t +b1 sinw1t)x1+. . .+(an coswnt +bn sinwnt)xn: (19) 
The initial displacement u(0) is easy to keep separate: t = 0 means that sinwt = 0 and 
coswt = 1, leaving only 
u(0) = a1x1+. . .+anxn; or u(0) = Sa; or a = S.1u(0): 
Then differentiating u(t) and setting t = 0. the b’s are determined by the initial velocity: 
u0(0) = b1w1x1+. . .+bnwnxn. Substituting the a’s and b’s into the formula for u(t), the 
equation is solved. 
The matrix A = 
..2 1 
1 .2 
¤ 
has l1 = .1 and l2 = .3. The frequencies are w1 = 1 and 
w2 = 
p
3. If the system starts from rest, u0(0) = 0, the terms in bsinwt will disappear: 
Solution from u(0) = 
"
1
0
# 
u(t) = 
1
2 
cost 
"
1
1
#
+ 
1
2 
cos
p
3t 
" 
1 
.1
#
: 
Physically, two masses are connected to each other and to stationary wails by three 
identical springs (Figure 5.3). The first mass is held at v(0) = 1, the second mass is held 
at w(0) = 0, and at t = 0 we let go. Their motion u(t) becomes an average of two pure 
oscillations, corresponding to the two eigenvectors. In the first mode x1 = (1;1), the 
masses move together and the spring in the middle is never stretched (Figure 5.3a). The 
frequency w1 = 1 is the same as for a single spring and a single mass. In the faster mode 
x2 =(1;.1) with frequency 
p
3, the masses move oppositely but with equal speeds. The 
general solution is a combination of these two normal modes. Our particular solution is 
half of each. 
As time goes on, the motion is “almost periodic.” If the ratio w1=w2 had been a 
fraction like 2/3, the masses would eventually return to u(0) = (1;0) and begin again. 
A combination of sin2t and sin3t would have a period of 2p. But 
p
3 is irrational. The
306 Chapter 5 Eigenvalues and Eigenvectors 
best we can say is that the masses will come arbitrarily close to (1;0) and also (0;1). 
Like a billiard ball bouncing forever on a perfectly smooth table, the total energy is fixed. 
Sooner or later the masses come near any state with this energy. 
Again we cannot leave the problem without drawing a parallel to the continuous case. 
As the discrete masses and springs merge into a solid rod, the “second differences” given 
by the 1, .2, 1 matrix A turn into second derivatives. This limit is described by the 
celebrated wave equation ¶ 2u=¶ t2 =¶ 2u=¶ x2. 
Problem Set 5.4 
1. Following the first example in this section, find the eigenvalues and eigenvectors, 
and the exponential eAt , for 
A = 
"
.1 1 
1 .1
#
: 
2. For the previous matrix, write the general solution to du=dt = Au, and the specific 
solution that matches u(0) = (3;1). What is the steady state as t ! .? (This is a 
continuous Markov process; l = 0 in a differential equation corresponds to l = 1 in 
a difference equation, since e0t = 1.) 
3. Suppose the time direction is reversed to give the matrix .A: 
du 
dt 
= 
" 
1 .1 
.1 1 
#
u with u0 = 
"
3
1
#
: 
Find u(t) and show that it blows up instead of decaying as t ! .. (Diffusion is 
irreversible, and the heat equation cannot run backward.) 
4. If P is a projection matrix, show from the infinite series that 
eP . I+1:718P: 
5. A diagonal matrix like L = 
. 1 0 
0 2 
¤ 
satisfies the usual rule eL(t+T) = eLteLT , because 
the rule holds for each diagonal entry. 
(a) Explain why eA(t+T) = eAteAT , using the formula eAt = SeLtS.1. 
(b) Show that eA+B = eAeB is not true for matrices, from the example 
A = 
"
0 0 
1 0
# 
B = 
"
0 .1 
0 0 
# 
(use series for eA and eB).
5.4 Differential Equations and eAt 307 
6. The higher order equation y00+y = 0 can be written as a first-order system by introducing 
the velocity y0 as another unknown: 
d 
dt 
"
y 
y0
# 
= 
"
y0 
y00
# 
= 
" 
y0 
.y
#
: 
If this is du=dt = Au, what is the 2 by 2 matrix A? Find its eigenvalues and eigenvectors, 
and compute the solution that starts from y(0) = 2, y0(0) = 0. 
7. Convert y00 = 0 to a first-order system du=dt = Au: 
d 
dt 
"
y 
y0
# 
= 
"
y0 
0
# 
= 
"
0 1 
0 0
#"
y 
y0
#
: 
This 2 by 2 matrix A has only one eigenvector and cannot be diagonalized. Compute 
eAt from the series I+At +. . . and write the solution eAtu(0) starting from y(0) = 3, 
y0(0) = 4. Check that your (y;y0) satisfies y00 = 0. 
8. Suppose the rabbit population r and the wolf population w are governed by 
dr 
dt 
= 4r.2w 
dw 
dt 
= r+w: 
(a) Is this system stable, neutrally stable, or unstable? 
(b) If initially r = 300 and w = 200, what are the populations at time t? 
(c) After a long time, what is the proportion of rabbits to wolves? 
9. Decide the stability of u0 = Au for the following matrices: 
(a) A = 
"
2 3 
4 5
#
: (b) A = 
"
1 2 
3 .1
#
: 
(c) A = 
"
1 1 
1 .2
#
: (d) A = 
"
.1 .1 
.1 .1
#
: 
10. Decide on the stability or instability of dv=dt = w, dw=dt = v. Is there a solution 
that decays? 
11. From their trace and determinant, at what time t do the following matrices change 
between stable with real eigenvalues, stable with complex eigenvalues, and unstable? 
A1 = 
"
1 .1 
t .1
#
; A2 = 
"
0 4.t 
1 .2 
#
; A3 = 
"
t .1 
1 t 
#
:
308 Chapter 5 Eigenvalues and Eigenvectors 
12. Find the eigenvalues and eigenvectors for 
du 
dt 
= Au = 
2
64
0 3 0 
.3 0 4 
0 .4 0
3
75
u: 
Why do you know, without computing, that eAt will be an orthogonal matrix and 
ku(t)k2 = u21
+u22
+u23
will be constant? 
13. For the skew-symmetric equation 
du 
dt 
= Au = 
2
64
0 c .b 
.c 0 a 
b .a 0 
3
75 
2
64
u1 
u2 
u3
3
75
; 
(a) write out u0
1, u0
2, u0
3 and confirm that u0
1u1+u0
2u2+u0
3u3 = 0. 
(b) deduce that the length u21
+u22
+u23
is a constant. 
(c) find the eigenvalues of A. 
The solution will rotate around the axis w = (a;b;c), because Au is the “cross product” 
u.w—which is perpendicular to u and w. 
14. What are the eigenvalues l and frequencies w, and the general solution, of the following 
equation? 
d2u 
dt2 = 
"
.5 4 
4 .5
#
u: 
15. Solve the second-order equation 
d2u 
dt2 = 
"
.5 .1 
.1 .5
#
u with u(0) = 
"
1
0
# 
and u0(0) = 
"
0
0
#
: 
16. In most applications the second-order equation looks like Mu00+Ku=0, with a mass 
matrix multiplying the second derivatives. Substitute the pure exponential u = eiwtx 
and find the “generalized eigenvalue problem” that must be solved for the frequency 
w and the vector x. 
17. With a friction matrix F in the equation u00+Fu0.Au = 0, substitute a pure exponential 
u = el tx and find a quadratic eigenvalue problem for l . 
18. For equation (16) in the text, with w = 1 and 
p
3, find the motion if the first mass is 
hit at t = 0; u(0) = (0;0) and u0(0) = (1;0). 
19. Every 2 by 2 matrix with trace zero can be written as 
A = 
" 
a b+c 
b.c .a 
#
: 
Show that its eigenvalues are real exactly when a2+b2 . c2.
5.4 Differential Equations and eAt 309 
20. By back-substitution or by computing eigenvectors, solve 
du 
dt 
= 
2
64
1 2 1 
0 3 6 
0 0 4
3
75
u with u(0) = 
2
64
1
0
1
3
75
: 
21. Find l ’s and x’s so that u = el tx solves 
du 
dt 
= 
"
4 3 
0 1
#
u: 
What combination u = c1el1tx1+c2el2tx2 starts from u(0) = (5;.2)? 
22. Solve Problem 21 for u(t) = (y(t); z(t)) by back-substitution: 
First solve 
dz 
dt 
= z; starting from z(0) = .2: 
Then solve 
dy 
dt 
= 4y+3z; starting from y(0) = 5: 
The solution for y will be a combination of e4t and et . 
23. Find A to change y00 = 5y0+4y into a vector equation for u(t) = (y(t);y0(t)): 
du 
dt 
= 
"
y0 
y00
# 
= 
" #"
y 
y0
# 
= Au: 
What are the eigenvalues of A? Find them also by substituting y = el t into the scalar 
equation y00 = 5y0+4y. 
24. A door is opened between rooms that hold v(0) = 30 people and w(0) = 10 people. 
The movement between rooms is proportional to the difference v.w: 
dv 
dt 
= w.v and 
dw 
dt 
= v.w: 
Show that the total v+w is constant (40 people). Find the matrix in du=dt = Au, and 
its eigenvalues and eigenvectors. 
What are v and w at t = 1? 
25. Reverse the diffusion of people in Problem 24 to du=dt = .Au: 
dv 
dt 
= v.w and 
dw 
dt 
= w.v: 
The total v+w still remains constant. How are the l ’s changed now that A is changed 
to .A? But show that v(t) 
grows to infinity from v(0) = 30.
310 Chapter 5 Eigenvalues and Eigenvectors 
26. The solution to y00 = 0 is a straight line y =C+Dt. Convert to a matrix equation: 
d 
dt 
"
y 
y0
# 
= 
"
0 1 
0 0
#"
y 
y0
# 
has the solution 
"
y 
y0
# 
= eAt 
"
y(0) 
y0(0)
#
: 
This matrix A cannot be diagonalized. Find A2 and compute eAt = I +At + 12
A2t2+ 
. . . . Multiply your eAt times (y(0);y0(0)) to check the straight line y(t) = y(0)+ 
y0(0)t. 
27. Substitute y = el t into y00 = 6y0 .9y to show that l = 3 is a repeated root. This is 
trouble; we need a second solution after e3t . The matrix equation is 
d 
dt 
"
y 
y0
# 
= 
" 
0 1 
.9 6
#"
y 
y0
#
: 
Show that this matrix has l = 3;3 and only one line of eigenvectors. Trouble here 
too. Show that the second solution is y = te3t . 
28. Figure out how to write my00+by0+ky = 0 as a vector equation Mu0 = Au. 
29. (a) Find two familiar functions that solve the equation d2y=dt2 = .y. Which one 
starts with y(0) = 1 and y0(0) = 0? 
(b) This second-order equation y00 = .y produces a vector equation u0 = Au: 
u = 
"
y 
y0
# 
du 
dt 
= 
"
y0 
y00
# 
= 
" 
0 1 
.1 0
#"
y 
y0
# 
= Au: 
Put y(t) from part (a) into u(t) = (y;y0). This solves Problem 6 again. 
30. A particular solution to du=dt =Au.b is up =A.1b, if A is invertible. The solutions 
to du=dt = Au give un. Find the complete solution up+un to 
(a) 
du 
dt 
= 2u.8: (b) 
du 
dt 
= 
"
2 0 
0 3
#
u.
"
8
6
#
: 
31. If c is not an eigenvalue of A, substitute u = ectv and find v to solve du=dt = Au. 
ectb. This u = ectv is a particular solution. How does it break down when c is an 
eigenvalue? 
32. Find a matrix A to illustrate each of the unstable regions in Figure 5.2: 
(a) l1 < 0 and l2 > 0. 
(b) l1 > 0 and l2 > 0. 
(c) Complex l ’s with real part a > 0. 
Problems 33–41 are about the matrix exponential eAt .
5.4 Differential Equations and eAt 311 
33. Write five terms of the infinite series for eAt . Take the t derivative of each term. Show 
that you have four terms of AeAt . Conclusion: eAtu(0) solves u0 = Au. 
34. The matrix B = 
. 0 .1 
0 0 
¤ 
has B2 = 0. Find eBt from a (short) infinite series. Check that 
the derivative of eBt is BeBt . 
35. Starting from u(0), the solution at time T is eAT u(0). Go an additional time t to reach 
eAt(eAT u(0)). This solution at time t +T can also be written as . Conclusion: 
eAt times eAT equals . 
36. Write A = 
. 1 1 
0 0 
¤ 
in the form SLS.1. Find eAt from SeLtS.1. 
37. If A2 = A, show that the infinite series produces eAt = I+(et .1)A. For A = 
. 1 1 
0 0 
¤ 
in 
Problem 36, this gives eAt = 
38. Generally eAeB is different from eBeA. They are both different from eA+B. Check this 
using Problems 36–37 and 34: 
A = 
"
1 1 
0 0
# 
B = 
"
0 .1 
0 0 
# 
A+B = 
"
1 0 
0 0
#
: 
39. Write A = 
. 1 1 
0 3 
¤ 
as SLS.1. Multiply SeLtS.1 to find the matrix exponential eAt . 
Check eAt = I when t = 0. 
40. Put A = 
. 1 3 
0 0 
¤ 
into the infinite series to find eAt . First compute A2: 
eAt = 
"
1 0 
0 1
#
+
"
t 3t 
0 0 
#
+ 
1
2 
" #
+. . . = 
"
et 
0 
#
: 
41. Give two reasons why the matrix exponential eAt is never singular: 
(a) Write its inverse. 
(b) Write its eigenvalues. If Ax =l x then eAtx = x. 
42. Find a solution x(t), y(t) of the first system that gets large as t ! .. To avoid this 
instability a scientist thought of exchanging the two equations! 
dx=dt = 0x . 4y 
dy=dt = .2x + 2y 
becomes 
dy=dt = .2x + 2y 
dx=dt = 0x . 4y: 
Now the matrix 
..2 2 
0 .4 
¤ 
is stable. It has l < 0. Comment on this craziness. 
43. From this general solution to du=dt = Au, find the matrix A: 
u(t) = c1e2t 
"
2
1
#
+c2e5t 
"
1
1
#
:
312 Chapter 5 Eigenvalues and Eigenvectors 
5.5 Complex Matrices 
It is no longer possible to work only with real vectors and real matrices In the first half of 
this book, when the basic problem was Ax.b, the solution was real when A and b were 
real. Complex numbers could have been permitted. but would have contributed nothing 
new. Now we cannot avoid them. A real matrix has real coefficients in det(A.l I), but 
the eigenvalues (as in rotations) may be complex. 
We now introduce the space Cn of vectors with n complex components. Addition and 
matrix multiplication follow the same rules as before. Length is computed differently. 
The old way, the vector in C2 with components (1; i) would have zero length: 12+i2 =0, 
not good. The correct length squared is 12+jij2 = 2. 
This change to kxk2 = jx1j2+. . .+jxnj2 forces a whole series of other changes. The 
inner product, the transpose, the definitions of symmetric and orthogonal matrices, all 
need to be modified for complex numbers. The new definitions coincide with the old 
when the vectors and matrices are real. We have listed these changes in a table at the 
end of the section. and we explain them as we go. 
That table virtually amounts to a dictionary for translating real into complex. We 
hope it will be useful to the reader. We particularly want to find out about symmetric 
matrices and Hermitian matrices: Where are their eigenvalues, and what is special 
about their eigenvectors? For practical purposes, those are the most important questions 
in the theory of eigenvalues. We call attention in advance to the answers: 
1. Every symmetric matrix (and Hermitian matrix) has real eigenvalues. 
2. Its eigenvectors can be chosen to be orthonormal. 
Strangely, to prove that the eigenvalues are real we begin with the opposite possibility— 
and that takes us to complex numbers, complex vectors, and complex matrices. 
Complex Numbers and Their Conjugates 
Probably the reader has already met complex numbers; a review is easy to give. The 
important ideas are the complex conjugate . x and the absolute value jxj. Everyone knows 
that whatever i is, it satisfies the equation i2 = .1. It is a pure imaginary number, and 
so are its multiples ib; b is real. The sum a+ib is a complex number, and it is plotted in 
a natural way on the complex plane (Figure 5.4). 
The real numbers a and the imaginary numbers ib are special cases of complex numbers; 
they lie on the axes. Two complex numbers are easy to add: 
Complex addition (a+ib)+(c+id) = (a+c)+i(b+d):
5.5 Complex Matrices 313 
a
a + ib = rei 
a . ib = a + ib = re.i 
complex conjugate 
imaginary axis 
real axis 
b
b 
b 
.b 
r = |a + ib| 
r2 = a2 + b2 
 
. 
r
r 
Figure 5.4: The complex plane, with a+ib = reiq and its conjugate a.ib = re.iq . 
Multiplying a+ib times c+id uses the rule that i2 = .1: 
Multiplication (a+ib)(c+id) = ac+ibc+iad+i2bd 
= (ac.bd)+i(bc+ad): 
The complex conjugate of a+ib is the number a.ib. The sign of the imaginary 
part is reversed. It is the mirror image across the real axis; any real number is its own 
conjugate, since b = 0. The conjugate is denoted by a bar or a star: (a+ib)¤ = a+ib = 
a.ib. It has three important properties: 
1. The conjugate of a product equals the product of the conjugates: 
(a+ib)(c+id) = (ac.bd).i(bc+ad) = (a+ib)(c+id): (1) 
2. The conjugate of a sum equals the sum of the conjugates: 
(a+c)+i(b+d) = (a+c).i(b+d) = (a+ib)+(c+id): 
3. Multiplying any a+ib by its conjugate a.ib produces a real number a2+b2: 
Absolute value (a+ib)(a.ib) = a2+b2 = r2: (2) 
This distance r is the absolute value ja+ibj = 
p
a2+b2: 
Finally, trigonometry connects the sides a and b to the hypotenuse r by a = r cosq 
and b = r sinq . Combining these two equations moves us into polar coordinates: 
Polar form a+ib = r(cosq +i sinq ) = reiq : (3)
314 Chapter 5 Eigenvalues and Eigenvectors 
The most important special case is when r = 1. Then a+ib is eiq = cosq +i sinq . It 
falls on the unit circle in the complex plane. As q varies from 0 to 2p, this number eiq 
circles around zero at the constant radial distance jeiq j =
p
cos2q +sin2q = 1. 
Example 1. x = 3+4i times its conjugate x = 3.4i is the absolute value squared: 
xx = (3+4i)(3.4i) = 25 = jxj2 so r = jxj = 5: 
To divide by 3+4i, multiply numerator and denominator by its conjugate 3.4i: 
2+i 
3+4i 
= 
2+i 
3+4i 
3.4i 
3.4i 
= 
10.5i 
25 
: 
In polar coordinates, multiplication and division are easy: 
reiq times Reia has absolute value rR and angle q +a. 
reiq divided by Reia has absolute value r=R and angle q .a. 
Lengths and Transposes in the Complex Case 
We return to linear algebra, and make the conversion from real to complex. By definition, 
the complex vector space Cn contains all vectors x with n complex components: 
Complex vector x = 
2
6664 
x1 
x2
... 
xn
3
7775
with components x j = aj +ib j: 
Vectors x and y are still added component by component. Scalar multiplication cx is 
now done with complex numbers c. The vectors v1; : : : ;vk are linearly dependent if 
some nontrivial combination gives c1v1 +: : :+ckvk = 0; the c j may now be complex. 
The unit coordinate vectors are still in Cn; they are still independent; and they still form 
a basis. Therefore Cn is a complex vector space of dimension n. 
In the new definition of length, each x2j
is replaced by its modulus jx jj2: 
Length squared kxk2 = jx1j2+. . .+jxnj2: (4) 
Example 2. x = 
"
1
i
# 
and kxk2 = 2; y = 
" 
2+i 
2.4i
# 
and kyk2 = 25: 
For real vectors there was a close connection between the length and the inner product: 
kxk2 = xTx. This connection we want to preserve. The inner product must be modified 
to match the new definition of length, and we conjugate the first vector in the inner 
product. Replacing x by x, the inner product becomes 
Inner product xTy = x1y1+. . .+xnyn: (5)
5.5 Complex Matrices 315 
If we take the inner product of x = (1+3i;3i) with itself, we are back to kxk2: 
Length squared xTx = (1+i)(1+i)+(3i)(3i) = 2+9 and kxk2 = 11: 
Note that yTx is different from xTy; we have to watch the order of the vectors. 
This leaves only one more change in notation, condensing two symbols into one. 
Instead of a bar for the conjugate and a T for the transpose, those are combined into the 
conjugate transpose. For vectors and matrices, a superscript H (or a star) combines both 
operations. This matrix AT = AH = A¤ is called “A Hermitian”: 
“A Hermitian” AH = AT has entries (AH)i j = Aji: (6) 
You have to listen closely to distinguish that name from the phrase “A is Hermitian,” 
which means that A equals AH. If A is an m by n matrix, then AH is n by m: 
Conjugate 
transpose 
2
64
2+i 3i 
4.i 5 
0 0
3
75 
H 
= 
"
2.i 4+i 0 
.3i 5 0
#
: 
This symbol AH gives official recognition to the fact that, with complex entries, it is 
very seldom that we want only the transpose of A. It is the conjugate transpose AH that 
becomes appropriate, and xH is the row vector [x1 . . . xn]. 
5N
1. The inner product of x and y is xHy. Orthogonal vectors have xHy = 0. 
2. The squared length of x is kxk2 = xHx = jx1j2+. . .+jxnj2. 
3. Conjugating (AB)T = BTAT produces (AB)H = BHAH. 
Hermitian Matrices 
We spoke in earlier chapters about symmetric matrices: A = AT. With complex entries, 
this idea of symmetry has to be extended. The right generalization is not to matrices that 
equal their transpose, but to matrices that equal their conjugate transpose. These are 
the Hermitian matrices, and a typical example is A: 
Hermitian matrix A = 
" 
2 3.3i 
3+3i 5 
# 
= AH: (7) 
The diagonal entries must be real; they are unchanged by conjugation. Each off-diagonal 
entry is matched with its mirror image across the main diagonal, and 3.3i is the conjugate 
of 3+3i. In every case, ai j = aji. 
Our main goal is to establish three basic properties of Hermitian matrices. These 
properties apply equally well to symmetric matrices. A real symmetric matrix is certainly 
Hermitian. (For real matrices there is no difference between AT and AH.) The 
eigenvalues of A are real—as we now prove.
316 Chapter 5 Eigenvalues and Eigenvectors 
Property 1 If A =AH, then for all complex vectors x, the number xHAx is real. 
Every entry of A contributes to xHAx. Try the 2 by 2 case with x = (u;v): 
xHAx = 
h
u v
i" 
2 3.3i 
3+3i 5 
#"
u
v
# 
= 2uu+5vv+(3.3i)uv+(3+3i)uv 
= real+real+(sum of complex conjugates): 
For a proof in general. (xHAx)H is the conjugate of the 1 by 1 matrix xHAx, but we 
actually get the same number back again: (xHAx)H = xHAHxHH = xHAx. So that number 
must be real. 
Property 2 If A = AH, every eigenvalue is real. 
Proof. Suppose Ax =l x. The trick is to multiply by xH: xHAx =l xHx. The left-hand 
side is real by Property 1, and the right-hand side xHx=kxk2 is real and positive, because 
x 6= 0. Therefore l = xHAx=xHx must be real. Our example has l = 8 and l = .1: 
jA.l Ij =
.....
2.l 3.3i 
3+3i 5.l
.....
=l 2.7l +10.j3.3ij2 
=l 2.7l .8 = (l .8)(l +1): 
(8) 
Note. This proof of real eigenvalues looks correct for any real matrix: 
False proof Ax =l x gives xTAx =l xTx; so l = 
xTAx 
xTx 
is real: 
There must be a catch: The eigenvector x might be complex. It is when A = AT that 
we can be sure l and x stay real. More than that, the eigenvectors are perpendicular: 
xTy = 0 in the real symmetric case and xHy = 0 in the complex Hermitian case. 
Property 3 Two eigenvectors of a real symmetric matrix or a Hermitian matrix, 
if they come from different eigenvalues, are orthogonal to one another. 
The proof starts with Ax =l1x, Ay =l1y, and A = AH: 
(l1x)Hy = (Ax)Hy = xHAy = xH(l2y): (9) 
The outside numbers are l1xHy=l2xHy, since the l ’s are real. Now wc use the assumption 
l1 6=l2, which forces the conclusion that xHy = 0. In our example, 
(A.8I)x = 
" 
.6 3.i 
3+3i .3 
#"
x1 
x2
# 
= 
"
0
0
#
; x = 
" 
1 
1+i
# 
(A+I)y = 
" 
3 3.3i 
3+3i 6 
#"
y1 
y2
# 
= 
"
0
0
#
; y = 
"
1.i 
.1 
#
:
5.5 Complex Matrices 317 
These two eigenvectors are orthogonal: 
xHy = 
h
1 1.i
i"
1.i 
.1 
# 
= 0: 
Of course any multiples x=a and y=b are equally good as eigenvectors. MATLAB 
picks a = kxk and b = kyk, so that x=a and y=b are unit vectors; the eigenvectors 
are normalized to have length 1. They are now orthonormal. If these eigenvectors are 
chosen to be the columns of S, then we have S.1AS = L as always. The diagonalizing 
matrix can be chosen with orthonormal columns when A = AH. 
In case A is real and symmetric, its eigenvalues are real by Property 2. Its unit 
eigenvectors are orthogonal by Property 3. Those eigenvectors are also real; they solve 
(A.l I)x = 0. These orthonormal eigenvectors go into an orthogonal matrix Q, with 
QTQ = I and QT = Q.1. Then S.1AS = L becomes special—it is Q.1AQ = L or 
A = QLQ.1 = QLQT. We can state one of the great theorems of linear algebra: 
5O A real symmetric matrix can be factored into A = QLQT. Its orthonormal 
eigenvectors are in the orthogonal matrix Q and its eigenvalues are in L. 
In geometry or mechanics, this is the principal axis theorem. It gives the right choice 
of axes for an ellipse. Those axes are perpendicular, and they point along the eigenvectors 
of the corresponding matrix. (Section 6.2 connects symmetric matrices to ndimensional 
ellipses.) In mechanics the eigenvectors give the principal directions, along 
which there is pure compression or pure tension—with no shear. 
In mathematics the formula A = QLQT is known as the spectral theorem. If we 
multiply columns by rows, the matrix A becomes a combination of one-dimensional 
projections—which are the special matrices xxT of rank 1, multiplied by l : 
A = QLQT = 
2
64
j j 
x1 . . . xn 
j j 
3
75 
2
64
l1 
. . . 
ln
3
75 
2
64
— xT
1 — 
... 
— xT
n —
3
75 
=l1x1xT
1 +l2x2xT
2 +. . .+lnxnxT
n : 
(10) 
Our 2 by 2 example has eigenvalues 3 and 1: 
Example 3. A=
" 
2 .1 
.1 2 
#
=3
" 
1
2 .12 
.12 
12 
#
+
"
12 
12
12 
12 
#
=combination of two projections. 
The eigenvectors, with length scaled to 1, are 
x1 = 
1 
p
2 
" 
1 
.1
# 
and x2 = 
1 
p
2 
"
1
1
#
: 
Then the matrices on the right-hand side are x1xT
1 and x2xT
2—columns times rows—and 
they are projections onto the line through x1 and the line through x2. 
All symmetric matrices are combinations of one-dimensional projections—which are 
symmetric matrices of rank 1.
318 Chapter 5 Eigenvalues and Eigenvectors 
Remark. If A is real and its eigenvalues happen to be real, then its eigenvectors are also 
real. They solve (A.l I)x = 0 and can be computed by elimination. But they will not 
be orthogonal unless A is symmetric: A = QLQT leads to AT = A. 
If A is real, all complex eigenvalues come in conjugate pairs: Ax =l x and Ax =l x. 
If a+ib is an eigenvalue of a real matrix, so is a.ib. (If A = AT then b = 0.) 
Strictly speaking, the spectral theorem A = QLQT has been proved only when the 
eigenvalues of A are distinct. Then there are certainly n independent eigenvectors, and 
A can be safely diagonalized. Nevertheless it is true (see Section 5.6) that even with 
repeated eigenvalues, a symmetric matrix still has a complete set of orthonormal eigenvectors. 
The extreme case is the identity matrix, which has l = 1 repeated n times—and 
no shortage of eigenvectors. 
To finish the complex case we need the analogue of a real orthogonal matrix—and you 
can guess what happens to the requirement QTQ = I. The transpose will be replaced by 
the conjugate transpose. The condition will become UHU = I. The new letter U reflects 
the new name: A complex matrix with orthonormal columns is called a unitary matrix. 
Unitary Matrices 
May we propose two analogies? A Hermitian (or symmetric) matrix can be compared 
to a real number. A unitary (or orthogonal) matrix can be compared to a number on 
the unit circle—a complex number of absolute value 1. The l ’s are real if AH = A, and 
they are on the unit circle if UHU = I. The eigenvectors can be scaled to unit length and 
made orthonormal.6 
Those statements are not yet proved for unitary (including orthogonal) matrices. 
Therefore we go directly to the three properties of U that correspond to the earlier Properties 
1–3 of A. Remember that U has orthonormal columns: 
Unitary matrix UHU = I; UUH = I; and UH =U.1: 
This leads directly to Property 10, that multiplication by U has no effect on inner products, 
angles, or lengths. The proof is on one line, just as it was for Q: 
Property 10 (Ux)H(Uy) = xHUHUy = xHy and lengths are preserved by U: 
Length unchanged kUxk2 = xHUHUx = kxk2: (11) 
Property 20 Every eigenvalue of U has absolute value jl j = 1. 
This follows directly from Ux = l x, by comparing the lengths of the two sides: 
kUxk = kxk by Property 10, and always kl xk = jl jkxk. Therefore jl j = 1. 
6Later we compare “skew-Hermitian” matrices with pure imaginary numbers, and “normal” matrices with all 
complex numbers a+ib. A nonnormal matrix without orthogonal eigenvectors belongs to none of these classes, 
and is outside the whole analogy.
5.5 Complex Matrices 319 
Property 30 Eigenvectors corresponding to different eigenvalues are orthonormal. 
Start with Ux =l1x and Uy =l2y, and take inner products by Property 10: 
xHy = (Ux)H(Uy) = (l1x)H(l2y) =l 1l2xHy: 
Comparing the left to the right, l 1l2 = 1 or xHy = 0. But Property 20 is l 1l1 = 1, so we 
cannot also have l 1l2 = 1. Thus xHy = 0 and the eigenvectors are orthogonal. 
Example 4. U = 
"
cost .sint 
sint cost 
# 
has eigenvalues eit and e.it . 
The orthogonal eigenvectors are x=(1;.i) and y=(1; i). (Remember to take conjugates 
in xHy = 1+i2 = 0.) After division by 
p
2 they are orthonormal. 
Here is the most important unitary matrix by far. 
Example 5. U = 
1 
p
n 
2
6664 
1 1 . 1 
1 w . wn.1 
. . . . 
1 wn.1 . w(n.1)2
3
7775
= Fourier matrix p
n 
: 
The complex number w is on the unit circle at the angle q = 2p=n. It equals e2pi=n. Its 
powers are spaced evenly around the circle. That spacing assures that the sum of all n 
powers of w—all the nth roots of 1—is zero. Algebraically, the sum 1+w+. . .+wn.1 
is (wn.1)=(w.1). And wn.1 is zero! 
row 1 of UH times column 2 of U is 
1
n
(1+w+w2+. . .+wn.1) = 
wn.1 
w.1 
= 0: 
row i of UH times column j of U is 
1
n
(1+W +W2+. . .+Wn.1) = 
Wn.1 
W .1 
= 0: 
In the second case, W = wj.i. Every entry of the original F has absolute value 1. The 
factor 
p
n shrinks the columns of U into unit vectors. The fundamental identity of the 
finite Fourier transform is UHU = I. 
Thus U is a unitary matrix. Its inverse looks the same except that w is replaced by 
w.1 = e.iq = w. Since U is unitary, its inverse is found by transposing (which changes 
nothing) and conjugating (which changes w to w). The inverse of this U is U. Ux can be 
computed quickly by the Fast Fourier Transform as found in Section 3.5. 
By Property 10 of unitary matrices, the length of a vector x is the same as the length 
of Ux. The energy in state space equals the energy in transform space. The energy is 
the sum of jx jj2, and it is also the sum of the energies in the separate frequencies. The 
vector x = (1;0; : : : ;0) contains equal amounts of every frequency component, and its 
Discrete Fourier Transform Ux = (1;1; : : : ;1)=
p
n also has length 1.
320 Chapter 5 Eigenvalues and Eigenvectors 
Example 6. 
P = 
2
6664 
0 1 0 0 
0 0 1 0 
0 0 0 1 
1 0 0 0
3
7775
: 
This is an orthogonal matrix, so by Property 30 it must have orthogonal eigenvectors. 
They are the columns of the Fourier matrix! Its eigenvalues must have absolute value 1. 
They are the numbers 1;w; : : : ;wn.1 (or 1; i; i2; i3 in this 4 by 4 ease). It is a real matrix, 
but its eigenvalues and eigenvectors are complex. 
One final note, Skew-Hermitian matrices satisfy KH = .K, just as skew-symmetric 
matrices satisfy KT = .K. Their properties follow immediately from their close link to 
Hermitian matrices: 
If A is Hermitian then K = iA is skew-Hermitian. 
The eigenvalues of K are purely imaginary instead of purely real; we multiply i. The 
eigenvectors are not changed. The Hermitian example on the previous pages would lead 
to 
K = iA = 
" 
2i 3+3i 
.3+3i 5i 
# 
= .KH: 
The diagonal entries are multiples of i (allowing zero). The eigenvalues are 8i and .i. 
The eigenvectors are still orthogonal, and we still have K = ULUH—with a unitary U 
instead of a real orthogonal Q, and with 8i and .i on the diagonal of L. 
This section is summarized by a table of parallels between real and complex. 
Real versus Complex 
Rn (n real components) $ Cn (n complex components) 
length: kxk2 = x2
1+. . .+x2
n $ length: kxk2 = jx1j2+. . .+jxnj2 
transpose: ATi
j = Aji $ Hermitian transpose: AHi
j = Aji 
(AB)T = BTAT $ (AB)H = BHAH 
inner product: xTy = x1y1+. . .+xnyn $ inner product: xHy = x1y1+. . .+xnyn 
(Ax)Ty = xT(ATy) $ (Ax)Hy = xH(AHy) 
orthogonality: xTy = 0 $ orthogonality: xHy = 0 
symmetric matrices: AT = A $ Hermitian matrices: AH = A 
A = QLQ.1 = QLQT (real L) $ A =ULU.1 =ULUH (real L) 
skew-symmetric KT = .K $ skew-Hermitian KH = .K 
orthogonal QTQ = I or QT = Q.1 $ unitary UHU = I or UH =U.1 
(Qx)T(Qy) = xTy and kQxk = kxk $ (Ux)H(Uy) = xHy and kUxk = kxk 
The columns, rows, and eigenvectors of Q and U are orthonormal, and every jl j = 1
5.5 Complex Matrices 321 
Problem Set 5.5 
1. For the complex numbers 3+4i and 1.i, 
(a) find their positions in the complex plane. 
(b) find their sum and product. 
(c) find their conjugates and their absolute values. 
Do the original numbers lie inside or outside the unit circle? 
2. What can you say about 
(a) the sum of a complex number and its conjugate? 
(b) the conjugate of a number on the unit circle? 
(c) the product of two numbers on the unit circle? 
(d) the sum of two numbers on the unit circle? 
3. If x = 2+i and y = 1+3i, find x, xx, 1=x, and x=y. Check that the absolute value jxyj 
equals jxj times jyj, and the absolute value j1=xj equals 1 divided by jxj. 
4. Find a and b for the complex numbers a+ib at the angles q = 30°;60°;90° on the 
unit circle. Verify by direct multiplication that the square of the first is the second, 
and the cube of the first is the third. 
5. (a) If x = reiq what are x2, x.1, and x in polar coordinates? Where are the complex 
numbers that have x.1 = x? 
(b) At t = 0, the complex number e(.1+i)t equals one. Sketch its path in the complex 
plane as t increases from 0 to 2p. 
6. Find the lengths and the inner product of 
x = 
"
2.4i 
4i 
# 
and y = 
"
2+4i 
4i 
#
: 
7. Write out the matrix AH and compute C = AHA if 
A = 
"
1 i 0 
i 0 1
#
: 
What is the relation betweenC andCH? Does it hold wheneverC is constructed from 
some AHA? 
8. (a) With the preceding A, use elimination to solve Ax = 0. 
(b) Show that the nullspace you just computed is orthogonal to C(AH) and not to 
the usual row space C(AT). The four fundamental spaces in the complex case 
are N(A) and C(A) as before, and then N(AH) and C(AH).
322 Chapter 5 Eigenvalues and Eigenvectors 
9. (a) How is the determinant of AH related to the determinant of A? 
(b) Prove that the determinant of any Hermitian matrix is real. 
10. (a) How many degrees of freedom are there in a real symmetric matrix, a real diagonal 
matrix, and a real orthogonal matrix? (The first answer is the sum of the 
other two, because A = QLQT.) 
(b) Show that 3 by 3 Hermitian matrices A and also unitary U have 9 real degrees of 
freedom (columns of U can be multiplied by any eiq ). 
11. Write P, Q and R in the form l1x1xH
1 +l2x2xH
2 of the spectral theorem: 
P = 
"
1
2 
12
12 
12 
#
; Q = 
"
0 1 
1 0
#
; R = 
"
3 4 
4 .3
#
: 
12. Give a reason if true or a counterexample if false: 
(a) If A is Hermitian, then A+iI is invertible. 
(b) If Q is orthogonal. then Q+ 12
I is invertible. 
(c) If A is real, then A+iI is invertible. 
13. Suppose A is a symmetric 3 by 3 matrix with eigenvalues 0, 1, 2. 
(a) What properties can be guaranteed for the corresponding unit eigenvectors u, v, 
w? 
(b) In terms of u, v, w, describe the nullspace, left nullspace, row space and column 
space of A. 
(c) Find a vector x that satisfies Ax = v+w. Is x unique? 
(d) Under what conditions on b does Ax = b have a solution? 
(e) If u, v, w are the columns of S, what are S.1 and S.1AS? 
14. In the list below, which classes of matrices contain A and which contain B? 
A = 
2
6664 
0 1 0 0 
0 0 1 0 
0 0 0 1 
1 0 0 0
3
7775
and B = 
1
4 
2
6664 
1 1 1 1 
1 1 1 1 
1 1 1 1 
1 1 1 1
3
7775
: 
Orthogonal, invertible, projection, permutation, Hermitian, rank-1, diagonalizable, 
Markov. Find the eigenvalues of A and B. 
15. What is the dimension of the space S of all n by n real symmetric matrices? The 
spectral theorem says that every symmetric matrix is a combination of n projection 
matrices. Since the dimension exceeds n, how is this difference explained? 
16. Write one significant fact about the eigenvalues of each of the following.
5.5 Complex Matrices 323 
(a) A real symmetric matrix. 
(b) A stable matrix: all solutions to du=dt = Au approach zero. 
(c) An orthogonal matrix. 
(d) A Markov matrix. 
(e) A defective matrix (nondiagonalizable). 
(f) A singular matrix. 
17. Show that if U and V are unitary, so is UV. Use the criterion UHU = I. 
18. Show that a unitary matrix has j detUj = 1, but possibly detU is different from 
detUH. Describe all 2 by 2 matrices that are unitary. 
19. Find a third column so that U is unitary. How much freedom in column 3? 
U = 
2
64
1=
p
3 i=
p
2 
1=
p
3 0 
i=
p
3 1=
p
2 
3
75
: 
20. Diagonalize the 2 by 2 skew-Hermitian matrix K = 
. i i 
i i 
¤
, whose entries are all 
p
.1. 
Compute eKt = SeLtS.1, and verify that eKt is unitary. What is the derivative of eKt 
at t = 0? 
21. Describe all 3 by 3 matrices that are simultaneously Hermitian, unitary, and diagonal. 
How many are there? 
22. Every matrix Z can be split into a Hermitian and a skew-Hermitian part, Z = A+K, 
just as a complex number z is split into a+ib, The real part of z is half of z+z, and 
the “real part” of Z is half of Z+ZH. Find a similar formula for the “imaginary part” 
K, and split these matrices into A+K: 
Z = 
"
3+i 4+2i 
0 5 
# 
and Z = 
" 
i i 
.i i
#
: 
23. Show that the columns of the 4 by 4 Fourier matrix F in Example 5 are eigenvectors 
of the permutation matrix P in Example 6. 
24. For the permutation of Example 6, write out the circulant matrix C = c0I +c1P+ 
c2P2 +c3P3. (Its eigenvector matrix is again the Fourier matrix.) Write out also 
the four components of the matrix-vector product Cx, which is the convolution of 
c = (c0;c1;c2;c3) and x = (x0;x1;x2;x3). 
25. For a circulant C = FLF.1, why is it faster to multiply by F.1, then L, then F (the 
convolution rule), than to multiply directly by C? 
26. Find the lengths of u = (1+i;1.i;1+2i) and v = (i; i; i). Also find uHv and vHu.
324 Chapter 5 Eigenvalues and Eigenvectors 
27. Prove that AHA is always a Hermitian matrix, Compute AHA and AAH: 
A = 
"
i 1 i 
1 i i
#
: 
28. If Az = 0, then AHAz = 0. If AHAz = 0, multiply by zH to prove that Az = 0. The 
nullspaces of A and AHA are . AHA is an invertible Hermitian matrix when the 
nullspace of A contains only z = . 
29. When you multiply a Hermitian matrix by a real number c, is cA still Hermitian? If 
c=i, show that iA is skew-Hermitian. The 3 by 3 Hermitian matrices are a subspace, 
provided that the “scalars” are real numbers. 
30. Which classes of matrices does P belong to: orthogonal, invertible, Hermitian, unitary, 
factorizable into LU, factorizable into QR? 
P = 
2
64
0 1 0 
0 0 1 
1 0 0
3
75
: 
31. Compute P2, P3, and P100 in Problem 30. What are the eigenvalues of P? 
32. Find the unit eigenvectors of P in Problem 30, and put them into the columns of a 
unitary matrix U. What property of P makes these eigenvectors orthogonal? 
33. Write down the 3 by 3 circulant matrix C = 2I +5P+4P2. It has the same eigenvectors 
as P in Problem 30. Find its eigenvalues. 
34. If U is unitary and Q is a real orthogonal matrix, show that U.1 is unitary and also 
UQ is unitary. Start from UHU = I and QTQ = I. 
35. Diagonalize A (real l ’s) and K (imaginary l ’s) to reach ULUH: 
A = 
" 
0 1.i 
i+1 1 
# 
K = 
" 
0 .1+i 
1+i i 
# 
36. Diagonalize this orthogonal matrix to reach Q =ULUH. Now all l ’s are : 
Q = 
"
cosq .sinq 
sinq cosq 
#
: 
37. Diagonalize this unitary matrix V to reach V =ULUH. Again all jl j = 1: 
V = 
1 
p
3 
" 
1 1.i 
1+i .1 
#
:
5.6 Similarity Transformations 325 
38. If v1; : : : ;vn is an orthonormal basis for Cn, the matrix with those columns is a 
matrix. Show that any vector z equals (vH1
z)v1+. . .+(vHn
z)vn. 
39. The functions e.ix and e.ix are orthogonal on the interval 0 · x · 2p because their 
complex inner product is 
R 2p 
0 = 0. 
40. The vectors v = (1; i;1), w = (i;1;0) and z = are an orthogonal basis for . 
41. If A = R+iS is a Hermitian matrix, are the real matrices R and S symmetric? 
42. The (complex) dimension of Cn is . Find a nonreal basis for Cn. 
43. Describe all 1 by 1 matrices that are Hermitian and also unitary. Do the same for 2 
by 2 matrices. 
44. How are the eigenvalues of AH (square matrix) related to the eigenvalues of A? 
45. If uHu = 1, show that I.2uuH is Hermitian and also unitary. The rank-1 matrix uuH 
is the projection onto what line in Cn? 
46. If A+iB is a unitary matrix (A and B are real), show that Q=
.A .B 
B A 
¤ 
is an orthogonal 
matrix. 
47. If A+iB is a Hermitian matrix (A and B are real), show that 
.A .B 
B A 
¤ 
is symmetric. 
48. Prove that the inverse of a Hermitian matrix is again a Hermitian matrix. 
49. Diagonalize this matrix by constructing its eigenvalue matrix L and its eigenvector 
matrix S: 
A = 
" 
2 1.i 
1+i 3 
# 
= AH: 
50. A matrix with orthonormal eigenvectors has the form A =ULU.1 =ULUH. Prove 
that AAH = AHA. These are exactly the normal matrices. 
5.6 Similarity Transformations 
Virtually every step in this chapter has involved the combination S.1AS. The eigenvectors 
of A went into the columns of S, and that made S.1AS a diagonal matrix (called 
L). When A was symmetric, we wrote Q instead of S, choosing the eigenvectors to be 
orthonormal. In the complex case, when A is Hermitian we writeU—it is still the matrix 
of eigenvectors. Now we look at all combinations M.1AM—formed with any invertible 
M on the right and its inverse on the left. The invertible eigenvector matrix S may fail to 
exist (the defective case), or we may not know it, or we may not want to use it. 
First a new word: The matrices A and M.1AM are “similar”. Going from one to 
the other is a similarity transformation. It is the natural step for differential equations
326 Chapter 5 Eigenvalues and Eigenvectors 
or matrix powers or eigenvalues—just as elimination steps were natural for Ax = b. 
Elimination multiplied A on the left by L.1, but not on the right by L. So U is not 
similar to A, and the pivots are not the eigenvalues. 
A whole family of matrices M.1AM is similar to A, and there are two questions: 
1. What do these similar matrices M.1AM have in common? 
2. With a special choice of M, what special form can be achieved by M.1AM? 
The final answer is given by the Jordan form, with which the chapter ends. 
These combinations M.1AM arise in a differential or difference equation, when a 
“change of variables” u = Mv introduces the new unknown v: 
du 
dt 
= Au becomes M
dv 
dt 
= AMv; or 
dv 
dt 
= M.1AMv 
un+1 = Aun becomes Mvn+1 = AMvn; or vn+1 = M.1AMvn: 
The new matrix in the equation is M.1AM. In the special case M = S, the system is 
uncoupled because L=S.1AS is diagonal. The eigenvectors evolve independently. This 
is the maximum simplification, but other M’s are also useful. We try to make M.1AM 
easier to work with than A. 
The family of matrices M.1AM includes A itself, by choosing M = I. Any of these 
similar matrices can appear in the differential and difference equations, by the change 
u = Mv, so they ought to have something in common, and they do: Similar matrices 
share the same eigenvalues. 
5P Suppose that B = M.1AM. Then A and B have the same eigenvalues. 
Every eigenvector x of A corresponds to an eigenvector M.1x of B. 
Start from Ax =l x and substitute A = MBM.1: 
Same eigenvaluc MBM.1x =l x which is B(M.1x) =l (M.1x): (1) 
The eigenvalue of B is still l . The eigenvector has changed from x to M.1x. 
We can also check that A.l I and B.l I have the same determinant: 
Product of matrices B.l I = M.1AM.l I = M.1(A.l I)M 
Product rule det(B.l I) = detM.1 det(A.l I) detM = det(A.l I): 
The polynomials det(A.l I) and det(B.l I) are equal. Their roots—the eigenvalues 
of A and B—are the same. Here are matrices B similar to A.
5.6 Similarity Transformations 327 
Example 1. A = 
. 1 0 
0 0 
¤ 
has eigenvalues 1 and 0. Each B is M.1AM: 
If M = 
"
1 b 
0 1
#
; then B = 
"
1 b 
0 0
# 
: triangular with l = 0 and 0: 
If M = 
" 
1 1 
.1 1
#
; then B = 
"
12 
12
12 
12 
# 
: projection with l = 0 and 0: 
If M = 
"
a b 
c d
#
; then B = an arbitrary matrix with l = 0 and 0: 
In this case we can produce any B that has the correct eigenvalues. It is an easy case, 
because the eigenvalues 1 and 0 are distinct. The diagonal A was actually L, the outstanding 
member of this family of similar matrices (the capo). The Jordan form will 
worry about repeated eigenvalues and a possible shortage of eigenvectors. All we say 
no is that every M.1AM has the same number of independent eigenvectors as A (each 
eigenvector is multiplied by M.1). 
The first step is to look at the linear transformations that lie behind the matrices. 
Rotations, reflections, and projections act on n-dimensional space. The transformation 
can happen without linear algebra, but linear algebra turns it into matrix multiplication. 
Change of Basis = Similarity Transformation 
The similar matrix B = M.1AM is closely connected to A, if we go back to linear transformations. 
Remember the key idea: Every linear transformation is represented by a 
matrix. The matrix depends on the choice of basis! If we change the basis by M we 
change the matrix A to a similar matrix B. 
Similar matrices represent the same transformation T with respect so different 
bases. The algebra is almost straightforward. Suppose we have a basis v1; : : : ;vn. The 
jth column of A comes from applying T to v j: 
Tv j = combination of the basis vectors = a1 jv1+. . .+an jvn: (2) 
For a new basis V1; : : : ;Vn, the new matrix B is constructed in the same way: TVj = 
combination of the V’s = b1 jV1 +. . .+bn jVn. But also each V must be a combination 
of the old basis vectors: Vj = ami jvi. That matrix M is really representing the identity 
transformation (!) when the only thing happening is the change of basis (T is I). The inverse 
matrix M.1 also represents the identity transformation. when the basis is changed 
from the v’s back to the V’s. Now the product rule gives the result we want: 
5Q The matrices A and B that represent the same linear transformation T 
with respect to two different bases (the v’s and the V’s) are similar: 
[T]V to V 
B 
=
= 
[I]v to V 
M.1 
[T]v to v 
A 
[I]V to v 
M: 
(3)
328 Chapter 5 Eigenvalues and Eigenvectors 
I think an example is the best way to explain B = M.1AM. Suppose T is projection 
onto the line L at angle q . This linear transformation is completely described without the 
help of a basis. But to represent T by a matrix, we do need a basis. Figure 5.5 offers two 
choices, the standard basis v1 = (1;0), v2 = (0;1) and a basis V1, V2 chosen especially 
for T. 
"1
0
# 
projection "..5 
.5 
# 
"0
1
# 
projection " .5 
..5
# A = " .5 ..5 
..5 .5 
# 
135° y = .x 
V2 = "1
1
# 
projects to zero 
V1 = " 1 
.1
# 
projects to V1 
 = "1 0 
0 0
# 
135° y = .x 
Figure 5.5: Change of basis to make the projection matrix diagonal. 
In fact TV1 =V1 (since V1 is already on the line L) and TV2 = 0 (since V2 is perpendicular 
to the line). In that eigenvector basis, the matrix is diagonal: 
Elgenvector basis B = [T]V to V = 
"
1 0 
0 0
#
: 
The other thing is the change of basis matrix M. For that we express V1 as a combination 
v1 cosq?v2 sinq and put those coefficients into column 1. Similarly V2 (or IV2, the 
transformation is the identity) is .v1 sinq +v2 cosq , producing column 2: 
Change of basis M = [I]V to v = 
"
c .s 
s c 
#
: 
The inverse matrix M.1 (which is here the transpose) goes from v to V. Combined with 
B and M, it gives the projection matrix in the standard basis of v’s: 
Standard basis A = MBM.1 = 
"
c2 cs 
cs s2
#
: 
We can summarize the main point. The way to simplify that matrix A—in fact to diagonalize 
it—is to find its eigenvectors. They go into the columns of M (or S) and M.1AM 
is diagonal. The algebraist says the same thing in the language of linear transformations: 
Choose a basis consisting of eigenvectors. The standard basis led to A, which was not 
simple. The right basis led to B, which was diagonal. 
We emphasize again that M.1AM does not arise in solving Ax = b. There the basic 
operation was to multiply A (on the left side only!) by a matrix that subtracts a multiple
5.6 Similarity Transformations 329 
of one row from another. Such a transformation preserved the nullspace and row space 
of A; it normally changes the eigenvalues. 
Eigenvalues are actually calculated by a sequence of simple similarities. The matrix 
goes gradually toward a triangular form, and the eigenvalues gradually appear on the 
main diagonal. (Such a sequence is described in Chapter 7.) This is much better than 
trying to compute det(A.l I), whose roots should be the eigenvalues. For a large matrix, 
it is numerically impossible to concentrate all that information into the polynomial and 
then get it out again. 
Triangular Forms with a Unitary M 
Our first move beyond the eigenvector matrix M = S is a little bit crazy: Instead of a 
more general M, we go the other way and restrict M to be unitary. M.1AM can achieve 
a triangular form T under this restriction. The columns of M = U are orthonormal (in 
the real case, we would write M = Q). Unless the eigenvectors of L are orthogonal, a 
diagonal U.1AU is impossible. But “Schur’s lemma” in 5R is very useful—at least to 
the theory. (The rest of this chapter is devoted more to theory than to applications. The 
Jordan form is independent of this triangular form.) 
5R There is a unitary matrix M =U such that U.1AU = T is triangular. 
The eigenvalues of A appear along the diagonal of this similar matrix T. 
Proof. Every matrix, say 4 by 4, has at least one eigenvalue l1. In the worst case, it 
could be repeated four times. Therefore A has at least one unit eigenvector x1, which we 
place in the first column of U. At this stage the other three columns are impossible to 
determine, so we complete the matrix in any way that leaves it unitary, and call it U1. 
(The Gram-Schmidt process guarantees that this can be done.) Ax1 = l1x1 column 1 
means that the product U.1 
1 AU1 starts in the right form: 
AU1 =U1
2
6664 
l1 ¤ ¤ ¤ 
0 ¤ ¤ ¤ 
0 ¤ ¤ ¤ 
0 ¤ ¤ ¤
3
7775
leads to U.1 
1 AU1 = 
2
6664 
l1 ¤ ¤ ¤ 
0 ¤ ¤ ¤ 
0 ¤ ¤ ¤ 
0 ¤ ¤ ¤
3
7775
: 
Now work with the 3 by 3 submatrix in the lower right-hand corner. It has a unit 
eigenvector x2, which becomes the first column of a unitary matrix M2: 
If U2 = 
2
6664 
1 0 0 0 
0
0 M2 
0 
3
7775
then U.1 
2 (U.1 
1 AU1)U2 = 
2
6664 
l1 ¤ ¤ ¤ 
0 l2 ¤ ¤ 
0 0 ¤ ¤ 
0 0 ¤ ¤
3
7775
:
330 Chapter 5 Eigenvalues and Eigenvectors 
At the last step, an eigenvector of the 2 by 2 matrix in the lower right-hand corner goes 
into a unitary M3, which is put into the corner of U3: 
Triangular U.1 
3 
.
U.1 
2 U.1 
1 AU1U2
.
U3 = 
2
6664 
l1 ¤ ¤ ¤ 
0 l2 ¤ ¤ 
0 0 l3 ¤ 
0 0 0 ¤
3
7775
= T: 
The product U =U1U2U3 is still a unitary matrix, and U.1AU = T. 
This lemma applies to all matrices, with no assumption that A is diagoalizable. We 
could use it to prove that the powers Ak approach zero when all jlij < 1, and the exponentials 
eAt approach zero when all Reli < 0—even without the full set of eigenvectors 
which was assumed in Sections 5.3 and 5.4. 
Example 2. A = 
"
2 .1 
1 0 
# 
has the eigenvalue l = 1 (twice). 
The only line of eigenvectors goes through (1;1). After dividing by 
p
2, this is the first 
column of U, and the triangular U.1AU = T has the eigenvalues on its diagonal: 
U.1AU = 
"
1=
p
2 1=
p
2 
1=
p
2 .1=
p
2
#"
2 .1 
1 0 
#"
1=
p
2 1=
p
2 
1=
p
2 .1=
p
2
# 
= 
"
1 2 
0 1
# 
= T: (4) 
Diagonalizing Symmetric and Hermitian Matrices 
This triangular form will show that any symmetric or Hermitian matrix—whether its 
eigenvalues are distinct or not—has a complete set of orthonormal eigenvectors. We 
need a unitary matrix such that U.1AU is diagonal. Schur’s lemma has just found it. 
This triangular T must be diagonal, because it is also Hermitian when A = AH: 
T = TH (U.1AU)H =UHAH(U.1)H =U.1AU: 
The diagonal matrix U.1AU represents a key theorem in linear algebra. 
5S (Spectral Theorem) Every real symmetric A can be diagonalized by an 
orthogonal matrix Q. Every Hermitian matrix can be diagonalized by a unitary 
U: 
(real) Q.1AQ = L or A = QLQT 
(complex) U.1AU = L or A =ULUH 
The columns of Q (or U) contain orthonormal eigenvectors of A. 
Remark 1. In the real symmetric case, the eigenvalues and eigenvectors are real at every 
step. That produces a real unitary U—an orthogonal matrix.
5.6 Similarity Transformations 331 
Remark 2. A is the limit of symmetric matrices with distinct eigenvalues. As the limit 
approaches, the eigenvectors stay perpendicular. This can fail if A 6= AT: 
A(q ) = 
"
0 cosq 
0 sinq 
# 
has eigenvectors 
"
1
0
# 
and 
"
cosq 
sinq 
#
: 
As q !0, the only eigenvector of the nondiagonalizable matrix 
. 0 1 
0 0 
¤ 
is 
.10
¤
. 
Example 3. The spectral theorem says that this A = AT can be diagonalized: 
A = 
2
64
0 1 0 
1 0 0 
0 0 1
3
75
with repeated eigenvalues l1 =l2 = 1 and l3 = .1: 
l = 1 has a plane of eigenvectors, and we pick an orthonormal pair x1 and x2: 
x1 = 
1 
p
2 
2
64
1
1
0
3
75
and x2 = 
2
64
0
0
1
3
75
and x3 = 
1 
p
2 
2
64
1 
.1 
0 
3
75
for l3 = .1: 
These are the columns of Q. Splitting A = QLQT into 3 columns times 3 rows gives 
A = 
2
64
0 1 0 
1 0 0 
0 0 1
3
75
=l1
2
64 
12 
12
0 
12 
12
0 
0 0 0
3
75
+l2
2
64
0 0 0 
0 0 0 
0 0 1
3
75
+l3
2
64 
12
.12
0 
.12 
120 
0 0 0
3
75
: 
Since l1 =l2, those first two projections x1xT
1 and x2xT
2 (each of rank 1) combine to give 
a projection P1 of rank 2 (onto the plane of eigenvectors). Then A is 
2
64
0 1 0 
1 0 0 
0 0 1
3
75
=l1P1+l3P3 = (+1)
2
64 
12 
12
0 
12 
12
0 
0 0 1
3
75+(.1)
2
64 
12
.12
0 
.12 
12
0 
0 0 0
3
75
: (5) 
Every Hermitian matrix with k different eigenvalues has a spectral decomposition into 
A=l1P1+. . .+lkPk, where Pi is the projection onto the eigenspace for li. Since there is 
a full set of eigenvectors, the projections add up to the identity. And since the eigenspace 
are orthogonal, two projections produce zero: PjPi = 0. 
We are very close to answering an important question, so we keep going: For which 
matrices is T = L? Symmetric, skew-symmetric, and orthogonal T’s are all diagonal! 
Hermitian, skew-Hermitian, and unitary matrices are also in this class. They correspond 
to numbers on the real axis, the imaginary axis, and the unit circle. Now we want the 
whole class, corresponding to all complex numbers. The matrices are called “normal”. 
5T The matrix N is normal if it commutes with NH: NNH = NHN. For 
such matrices, and no others, the triangular T = U.1NU is the diagonal L. 
Normal matrices are exactly those that have a complete set of orthonormal 
eigenvectors.
332 Chapter 5 Eigenvalues and Eigenvectors 
Symmetric and Hermitian matrices are certainly normal: If A = AH, then AAH and 
AHA both equal A2. Orthogonal and unitary matrices are also normal: UUH and UHU 
both equal I. Two steps will work for any normal matrix: 
1. If N is normal, then so is the triangular T =U.1NU: 
TTH =U.1NUUHNHU =U.1NNHU =U.1NHNU =UHNHUU.1NU = THT: 
2. A triangular T that is normal must be diagonal! (See Problems 19–20 at the end of 
this section.) 
Thus, if N is normal, the triangular T =U.1NU must be diagonal. Since T has the same 
eigenvalues as N, it must be L. The eigenvectors of N are the columns of U, and they 
are orthonormal. That is the good case. We turn now from the best possible matrices 
(normal) to the worst possible (defective). 
Normal N = 
" 
2 1 
.1 2
# 
Defective A = 
"
2 1 
0 2
#
: 
The Jordan Form 
This section has done its best while requiring M to be a unitary matrix U. We got 
M.1AM into a triangular form T. Now we lift this restriction on M. Any matrix is 
allowed, and the goal is to make M.1AM as nearly diagonal as possible. 
The result of this supreme effort at diagonalization is the Jordan form J. If A has a full 
set of eigenvectors, we take M = S and arrive at J = S.1AS = L. Then the Jordan form 
coincides with the diagonal L. This is impossible for a defective (nondiagonalizable) 
matrix. For every missing eigenvector, the Jordan form will have a 1 just above its main 
diagonal. The eigenvalues appear on the diagonal because J is triangular. And distinct 
eigenvalues can always be decoupled. 
It is only a repeated l that may (or may not!) require an off-diagonal 1 in J. 
5U If A has s independent eigenvectors, it is similar to a matrix with s blocks: 
Jordan form J = M.1AM = 
2
64
J1 
. . . 
Js
3
75
: (6) 
Each Jordan block Ji is a triangular matrix that has only a single eigenvalue li 
and only one eigenvector: 
Jordan block Ji = 
2
6664 
li 1 
li .
. 1 
li
3
7775
: (7)
5.6 Similarity Transformations 333 
The same li will appear in several blocks, if it has several independent eigenvectors. 
Two matrices are similar if and only if they share the same Jordan 
form J. 
Many authors have made this theorem the climax of their linear algebra course. 
Frankly, I think that is a mistake. It is certainly true that not all matrices are diagonalizable, 
and the Jordan form is the most general case. For that very reason, its construction 
is both technical and extremely unstable. (A slight change in A can put back all the 
missing eigenvectors, and remove the off-diagonal is.) Therefore the right place for the 
details is in the appendix, and the best way to start on the Jordan form is to look at some 
specific and manageable examples. 
Example 4. T = 
"
1 2 
0 1
# 
and A = 
"
2 .1 
1 0 
# 
and B = 
"
1 0 
1 1
# 
all lead to J = 
"
1 1 
0 1
#
. 
These four matrices have eigenvalues 1 and 1 with only one eigenvector—so J consists 
of one block. We now check that. The determinants all equal 1. The traces (the 
sums down the main diagonal) are 2. The eigenvalues satisfy 1.1 = 1 and 1+1 = 2. For 
T, B, and J, which are triangular, the eigenvalues are on the diagonal. We want to show 
that these matrices are similar—they all belong to the same family. 
(T) From T to J, the job is to change 2 to 1. and a diagonal M will do it: 
M.1TM = 
"
1 0 
0 2
#"
1 2 
0 1
#"
1 0 
0 12 
# 
= 
"
1 1 
0 1
# 
= J: 
(B) From B to J, the job is to transpose the matrix. A permutation does that: 
P.1BP = 
"
0 1 
1 0
#"
1 0 
1 1
#"
0 1 
1 0
# 
= 
"
1 1 
0 1
# 
= J: 
(A) From A to J, we go first to T as in equation (4). Then change 2 to 1: 
U.1AU = 
"
1 2 
0 1
# 
= T and then M.1TM = 
"
1 1 
0 1
# 
= J: 
Example 5. A = 
2
64
0 1 2 
0 0 1 
0 0 0
3
75and B = 
2
64
0 0 1 
0 0 0 
0 0 0
3
75
. 
Zero is a triple eigenvalue for A and B, so it will appear in all their Jordan blocks. There 
can be a single 3 by 3 block, or a 2 by 2 and a 1 by I block, or three I by I blocks. Then 
A and B have three possible Jordan forms: 
J1 = 
2
64
0 1 0 
0 0 1 
0 0 0
3
75
; J2 = 
2
64
0 1 0 
0 0 0 
0 0 0
3
75
; J3 = 
2
64
0 0 0 
0 0 0 
0 0 0
3
75
: (8)
334 Chapter 5 Eigenvalues and Eigenvectors 
The only eigenvector of A is (1;0;0). Its Jordan form has only one block, and A must 
be similar to J1. The matrix B has the additional eigenvector (0;1;0), and its Jordan 
form is J2 with two blocks, As for J3 = zero matrix, it is in a family by itself; the only 
matrix similar to J3 is M.10M = 0. A count of the eigenvectors will determine J when 
there is nothing more complicated than a triple eigenvalue. 
Example 6. Application to difference and differential equations (powers and exponentials). 
If A can be diagonalized, the powers of A = SLS.1 are easy: Ak = SLkS.1. In 
every case we have Jordan’s similarity A = MJM.1, so now we need the powers of J: 
Ak = (MJM.1)(MJM.1) . . . (MJM.1) = MJkM.1: 
J is block-diagonal, and the powers of each block can be taken separately: 
(Ji)k = 
2
64
l 1 0 
0 l 1 
0 0 l 
3
75 
k 
= 
2
64
l k kl k.1 12
k(k.1)l k.2 
0 l k kl k.1 
0 0 l k 
3
75
: (9) 
This block Ji will enter when l is a triple eigenvalue with a single eigenvector. Its 
exponential is in the solution to the corresponding differential equation: 
Exponential eJit = 
2
64
el t tel t 1
2t2el t 
0 el t tel t 
0 0 el t 
3
75
: (10) 
Here I+Jit +(Jit)2=2!+. . . produces 1+l t +l 2t2=2!+. . . = el t on the diagonal. 
The third column of this exponential comes directly from solving du=dt = Jiu: 
d 
dt 
2
64
u1 
u2 
u3
3
75
= 
2
64
l 1 0 
0 l 1 
0 0 l 
3
75 
2
64
u1 
u2 
u3
3
75
starting from u0 = 
2
64
0
0
1
3
75
: 
This can be solved by back-substitution (since Ji is triangular). The last equation du3=dt = 
l u3 yields u3 = el t . The equation for u2 is du2=dt =l u2+u3, and its solution is tel t . 
The top equation is du1=dt = l u1 +u2, and its solution is 12
t2el t . When l has multiplicity 
m with only one eigenvector, the extra factor t appears m.1 times. 
These powers and exponentials of J are a part of the solutions uk and u(t). The other 
part is the M that connects the original A to the more convenient matrix J: 
if uk+1 = Auk then uk = Aku0 = MJkM.1u0 
if du=dt = Au then u(t) = eAtu(0) = MeJtM.1u(0): 
When M and J are S and L (the diagonalizable case) those are the formulas of Sections 
5.3 and 5.4. Appendix B returns to the nondiagonalizable case, and shows how the 
Jordan form can be reached. I hope the following table will be a convenient summary.
5.6 Similarity Transformations 335 
Similarity Transformations 
1. A is diagonalizable: The columns of S are eigenvectors and S.1AS = L. 
2. A is arbitrary: The columns of M include “generalized eigenvectors” of A, and the 
Jordan form M.1AM = J is block diagonal. 
3. A is arbitrary: The unitary U can be chosen so that U.1AU = T is triangular. 
4. A is normal, AAH = AHA: then U can be chosen so that U.1AU = L. 
Special cases of normal matrices, all with orthonormal eigenvectors: 
(a) If A = AH is Hermitian, then all li are real. 
(b) If A = AT is real symmetric, then L is real and U = Q is orthogonal. 
(c) If A = .AH is skew-Hermitian, then all li are purely imaginary. 
(d) If A is orthogonal or unitary, then all jlij = 1 are on the unit circle. 
Problem Set 5.6 
1. If B is similar to A andC is similar to B, show thatC is similar to A. (Let B=M.1AM 
and C = N.1BN.) Which matrices are similar to I? 
2. Describe in words all matrices that are similar to 
. 1 0 
0 .1 
¤
, and find two of them. 
3. Explain why A is never similar to A+I. 
4. Find a diagonal M, made up of 1s and .1s, to show that 
A = 
2
6664 
2 1 
1 2 1 
1 2 1 
1 2
3
7775
is similar to B = 
2
6664 
2 .1 
.1 2 .1 
.1 2 .1 
.1 2 
3
7775
: 
5. Show (if B is invertible) that BA is similar to AB. 
6. (a) If CD = .DC (and D is invertible), show that C is similar to .C. 
(b) Deduce that the eigenvalues of C must come in plus-minus pairs. 
(c) Show directly that if Cx =l x, then C(Dx) = .l (Dx). 
7. Consider any A and a “Givens rotation” M in the 1–2 plane: 
A = 
2
64
a b c 
d e f 
g h i
3
75
; M = 
2
64
cosq .sinq 0 
sinq cosq 0 
0 0 1
3
75
: 
Choose the rotation angle q to produce zero in the (3;1) entry of M.1AM.
336 Chapter 5 Eigenvalues and Eigenvectors 
Note. This “zeroing” is not so easy to continue, because the rotations that produce 
zero in place of d and h will spoil the new zero in the corner. We have to leave one 
diagonal below the main one, and finish the eigenvalue calculation in a different way. 
Otherwise, if we could make A diagonal and see its eigenvalues, we would be finding 
the roots of the polynomial det(A.l I) by using only the square roots that determine 
cosq —and that is impossible. 
8. What matrix M changes the basis V1 = (1;1), V2 = (1;4) to the basis v1 = (2;5), 
v2 = (1;4)? The columns of M come from expressing V1 and V2 as combinations 
ami jvi of the v’s. 
9. For the same two bases, express the vector (3;9) as a combination c1V1+c2V2 and 
also as d1v1+d2v2. Check numerically that M connects c to d: Mc = d. 
10. Confirm the last exercise: If V1 = m11v1 + m21v2 and V2 = m12v1 + m22v2, and 
m11c1+m12c2 = d1 and m21c1+m22c2 = d2, the vectors c1V1+c2V2 and d1v1+d2v2 
are the same. This is the “change of basis formula” Mc = d. 
11. If the transformation T is a reflection across the 45° line in the plane, find its matrix 
with respect to the standard basis v1 = (1;0), v2 = (0;1), and also with respect to 
V1 = (1;1), V2 = (1;.1). Show that those matrices are similar. 
12. The identity transformation takes every vector to itself: Tx = x. Find the corresponding 
matrix, if the first basis is v1 = (1;2), v2 = (3;4) and the second basis is 
w1 = (1;0), w2 = (0;1). (It is not the identity matrix!) 
13. The derivative of a+bx+cx2 is b+2cx+0x2. 
(a) Write the 3 by 3 matrix D such that 
D
2
64
a
b
c
3
75= 
2
64b 
2c 
0 
3
75
: 
(b) Compute D3 and interpret the results in terms of derivatives. 
(c) What are the eigenvalues and eigenvectors of D? 
14. Show that every number is an eigenvalue for T f (x) = d f =dx, but the transformation 
T f (x) = 
R x 
0 f (t)dt has no eigenvalues (here .. < x < .). 
15. On the space of 2 by 2 matrices, let T be the transformation that transposes every 
matrix. Find the eigenvalues and “eigenmatrices” for AT =l A. 
16. (a) Find an orthogonal Q so that Q.1AQ = L if 
A = 
2
64
1 1 1 
1 1 1 
1 1 1
3
75
and L = 
2
64
0 0 0 
0 0 0 
0 0 3
3
75
:
5.6 Similarity Transformations 337 
Then find a second pair of orthonormal eigenvectors x1, x2 for l = 0. 
(b) Verify that P = x1xT
1 +x2xT
2 is the same for both pairs. 
17. Prove that every unitary matrix A is diagonalizable, in two steps: 
(i) If A is unitary, and U is too, then so is T =U.1AU. 
(ii) An upper triangular T that is unitary must be diagonal. Thus T = L. 
Any unitary matrix A (distinct eigenvalues or not) has a complete set of orthonormal 
eigenvectors. All eigenvalues satisfy jl j = 1. 
18. Find a normal matrix (NNH = NHN) that is not Hermitian, skew-Hermitian, unitary, 
or diagonal. Show that all permutation matrices are normal. 
19. Suppose T is a 3 by 3 upper triangular matrix, with entries ti j. Compare the entries of 
TTH and THT, and show that if they are equal, then T must be diagonal. All normal 
triangular matrices are diagonal. 
20. If N is normal, show that kNxk = kNHxk for every vector x. Deduce that the ith row 
of N has the same length as the ith column. Note: If N is also upper triangular, this 
leads again to the conclusion that it must be diagonal. 
21. Prove that a matrix with orthonormal eigenvectors must be normal, as claimed in 5T: 
If U.1NU = A, or N =ULUH, then NNH = NHN. 
22. Find a unitary U and triangular T so that U.1AU = T, for 
A = 
"
5 .3 
4 .2
# 
and A = 
2
64
0 1 0 
0 0 0 
1 0 0
3
75
: 
23. If A has eigenvalues 0, 1, 2, what are the eigenvalues of A(A.I)(A.2I)? 
24. (a) Show by direct multiplication that every triangular matrix T, say 3 by 3, satisfies 
its own characteristic equation: (T .l1I)(T .l2I)(T .l3I) = 0. 
(b) SubstitutingU.1AU for T, deduce the famous Cayley-Hamilton theorem: Every 
matrix satisfies its own characteristic equation. For 3 by 3 this is (A.l1I)(A. 
l2I)(A.l3I) = 0. 
25. The characteristic polynomial of A = 
. a b 
c d 
¤ 
is l 2.(a+d)l +(ad .bc). By direct 
substitution, verify Cayley-Hamilton: A2.(a+d)A+(ad.bc)I = 0. 
26. If ai j = 1 above the main diagonal and ai j = 0 elsewhere, find the Jordan form (say 
4 by 4) by finding all the eigenvectors. 
27. Show, by trying for an M and failing, that no two of the three Jordan forms in equation 
(8) are similar: J1 6= M.1J2M, J1 6= M.1J3M, and J2 6= M.1J3M.
338 Chapter 5 Eigenvalues and Eigenvectors 
28. Solve u0 = Ju by back-substitution, solving first for u2(t): 
du 
dt 
= Ju = 
" 
5 1 
05 
#"
u1 
u2
# 
with initial value u(0) = 
"
1
2
#
: 
Notice te5t in the first component u1(t). 
29. Compute A10 and eA if A = MJM.1: 
A = 
" 
14 9 
.16 .10
# 
= 
" 
3 .2 
.4 3 
#"
2 1 
0 2
#"
3 2 
4 3
#
: 
30. Show that A and B are similar by finding M so that B = M.1AM: 
(a) A = 
"
1 0 
1 0
# 
and B = 
"
0 1 
0 1
#
: 
(b) A = 
"
1 1 
1 1
# 
and B = 
" 
1 .1 
.1 1 
#
: 
(c) A = 
"
1 2 
3 4
# 
and B = 
"
4 3 
2 1
#
: 
31. Which of these matrices A1 to A6 are similar? Check their eigenvalues. 
"
1 0 
0 1
# "
0 1 
1 0
# "
1 1 
0 0
# "
0 0 
1 1
# "
1 0 
1 0
# "
0 1 
0 1
#
: 
32. There are sixteen 2 by 2 matrices whose entries are 0s and 1s. Similar matrices go 
into the same family. How many families? How many matrices (total 16) in each 
family? 
33. (a) If x is in the nullspace of A, show that M.1x is in the nullspace of M.1AM. 
(b) The nullspaces of A and M.1AM have the same (vectors)(basis)(dimension). 
34. If A and B have the exactly the same eigenvalues and eigenvectors, does A=B? With 
n independent eigenvectors, we do have A=B. Find A 6=B when l =0;0 (repeated), 
but there is only one line of eigenvectors (x1;0). 
Problems 35–39 are about the Jordan form. 
35. By direct multiplication, find J2 and J3 when 
J = 
"
c 1 
0 c
#
: 
Guess the form of Jk. Set k = 0 to find J0. Set k = .1 to find J.1.
5.6 Similarity Transformations 339 
36. If J is the 5 by 5 Jordan block with l = 0, find J2 and count its eigenvectors, and 
find its Jordan form (two blocks). 
37. The text solved du=dt = Ju for a 3 by 3 Jordan block J. Add a fourth equation 
dw=dt = 5w+x. Follow the pattern of solutions for z, y, x to find w. 
38. These Jordan matrices have eigenvalues 0, 0, 0, 0. They have two eigenvectors (find 
them). But the block sizes don’t match and J is not similar to K: 
J = 
2
6664 
0 1 0 0 
0 0 0 0 
0 0 0 1 
0 0 0 0 
3
7775
and K = 
2
6664 
0 1 0 0 
0 0 1 0 
0 0 0 0 
0 0 0 0 
3
7775
: 
For any matrix M, compare JM with MK. If they are equal, show that M is not 
invertible. Then M.1JM = K is impossible. 
39. Prove in three steps that AT is always similar to A (we know that the l ’s are the 
same, the eigenvectors are the problem): 
(a) For A = one block, find Mi = permutation so that M.1 
i JiMi = JT
i . 
(b) For A = any J, build M0 from blocks so that M.1 
0 JM0 = JT. 
(c) For any A = MJM.1: Show that AT is similar to JT and so to J and to A. 
40. Which pairs are similar? Choose a, b, c, d to prove that the other pairs aren’t: 
"
a b 
c d
# "
b a 
d c
# "
c d 
a b
# "
d c 
b a
#
: 
41. True or false, with a good reason: 
(a) An invertible matrix can’t be similar to a singular matrix. 
(b) A symmetric matrix can’t be similar to a nonsymmetric matrix. 
(c) A can’t be similar to .A unless A = 0. 
(d) A.I can’t be similar to A+I. 
42. Prove that AB has the same eigenvalues as BA. 
43. If A is 6 by 4 and B is 4 by 6, AB and BA have different sizes. Nevertheless, 
"
I .A 
0 I 
#"
AB 0 
B 0
#"
I A 
0 I 
# 
= 
"
0 0 
B BA
# 
= G: 
(a) What sizes are the blocks of G? They are the same in each matrix. 
(b) This equation is M.1FM = G, so F and G have the same 10 eigenvalues. F has 
the eigenvalues of AB plus 4 zeros; G has the eigenvalues of BA plus 6 zeros. AB 
has the same eigenvalues as BA plus zeros.
340 Chapter 5 Eigenvalues and Eigenvectors 
44. Why is each of these statements true? 
(a) If A is similar to B, then A2 is similar to B2. 
(b) A2 and B2 can be similar when A and B are not similar (try l = 0;0). 
(c) 
. 3 0 
0 4 
¤ 
is similar to 
. 3 1 
0 4 
¤
. 
(d) 
. 3 0 
0 3 
¤ 
is not similar to 
. 3 1 
0 3 
¤
. 
(e) If we exchange rows 1 and 2 of A, and then exchange columns 1 and 2, the 
eigenvalues stay the same. 
Properties of Eigenvalues and Eigenvectors 
How are the properties of a matrix reflected in its eigenvalues and eigenvectors? This 
question is fundamental throughout Chapter 5. A table that organizes the key facts may 
be helpful. For each class of matrices, here are the special properties of the eigenvalues 
li and eigenvectors xi. 
Symmetric: AT = A real l ’s orthogonal xT
i x j = 0 
Orthogonal: QT = Q.1 all jl j = 1 orthogonal xTi
x j = 0 
Skew-symmetric: AT = .A imaginary l ’s orthogonal xTi
x j = 0 
Complex Hermitian: AT = A real l ’s orthogonal xTi
x j = 0 
Positive definite: xTAx > 0 all l > 0 orthogonal 
Similar matrix: B = M.1AM l (B) =l (A) x(B) = M.1x(A) 
Projection: P = P2 = PT l = 1;0 column space; nullspace 
Reflection: I.2uuT l = .1;1; : : : ;1 u;u? 
Rank-1 matrix: uvT l = vTu;0; : : : ;0 u; v? 
Inverse: A.1 1=l (A) eigenvectors of A 
Shift: A+cI l (A)+c eigenvectors of A 
Stable powers: An !0 all jl j < 1 
Stable exponential: eAt !0 all Rel < 0 
Markov: mi j > 0, ani
=1mi j = 1 lmax = 1 steady state x > 0 
Cyclic permutation: Pn = I lk = e2pik=n xk = (1;lk; : : : ;l n.1 
k ) 
Diagonalizable: SLS.1 diagonal of L columns of S are independent 
Symmetric: QLQT diagonal of L (real) columns of Q are orthonormal 
Jordan: J = M.1AM diagonal of J each block gives 1 eigenvector 
Every matrix: A =USVT rank(A) = rank(S) eigenvectors of ATA, AAT in V, U
5.6 Similarity Transformations 341 
Review Exercises 
5.1 Find the eigenvalues and eigenvectors, and the diagonalizing matrix S, for 
A = 
"
1 0 
2 3
# 
and B = 
" 
7 2 
.15 .4
#
: 
5.2 Find the determinants of A and A.1 if 
A = S
"
l1 2 
0 l2
#
S.1: 
5.3 If A has eigenvalues 0 and 1, corresponding to the eigenvectors 
"
1
2
# 
and 
" 
2 
.1
#
; 
how can you tell in advance that A is symmetric? What are its trace and determinant? 
What is A? 
5.4 In the previous problem, what will be the eigenvalues and eigenvectors of A2? What 
is the relation of A2 to A? 
5.5 Does there exist a matrix A such that the entire family A+cI is invertible for all 
complex numbers c? Find a real matrix with A+rI invertible for all real r. 
5.6 Solve for both initial values and then find eAt : 
du 
dt 
= 
"
3 1 
1 3
#
u if u(0) = 
"
1
0
# 
and if u(0) = 
"
0
1
#
: 
5.7 Would you prefer to have interest compounded quarterly at 40% per year, or annually 
at 50%? 
5.8 True or false (with counterexample if false): 
(a) If B is formed from A by exchanging two rows, then B is similar to A. 
(b) If a triangular matrix is similar to a diagonal matrix, it is already diagonal. 
(c) Any two of these statements imply the third: A is Hermitian, A is unitary, A2 =I. 
(d) If A and B are diagonalizable, so is AB. 
5.9 What happens to the Fibonacci sequence if we go backward in time, and how is F.k 
related to Fk? The law Fk+2 = Fk+1+Fk is still in force, so F.1 = 1. 
5.10 Find the general solution to du=dt = Au if 
A = 
2
64
0 .1 0 
1 0 .1 
0 1 0 
3
75
:
342 Chapter 5 Eigenvalues and Eigenvectors 
Can you find a time T at which the solution u(T) is guaranteed to return to the 
initial value u(0)? 
5.11 If P is the matrix that projects Rn onto a subspace S, explain why every vector in 
S is an eigenvector, and so is every vector in S?. What are the eigenvai (Note the 
connection to P2 = P, which means that l 2 =l .) 
5.12 Show that every matrix of order > 1 is the sum of two singular matrices. 
5.13 (a) Show that the matrix differential equation dX=dt = AX +XB has the solution 
X(t) = eAtX(0)eBt . 
(b) Prove that the solutions of dX=dt = AX .XA keep the same eigenvalues for all 
time. 
5.14 If the eigenvalues of A are 1 and 3 with eigenvectors (5;2) and (2;1), find the 
solutions to du=dt = Au and uk+1 = Auk, starting from u = (9;4). 
5.15 Find the eigenvalues and eigenvectors of 
A = 
2
64
0 .i 0 
i 1 i 
0 .i 0
3
75
: 
What property do you expect for the eigenvectors, and is it true? 
5.16 By trying to solve "
a b 
c d
#"
a b 
c d
# 
= 
"
0 1 
0 0
# 
= A 
show that A has no square root. Change the diagonal entries of A to 4 and find a 
square root. 
5.17 (a) Find the eigenvalues and eigenvectors of A = 
h 
0 4 
14
0
i
. 
(b) Solve du=dt = Au starting from u(0) = (100;100). 
(c) If v(t) = income to stockbrokers and w(t) = income to client, and they help 
each other by dv=dt = 4w and dw=dt = 14
v, what does the ratio v=w approach 
as t !.? 
5.18 True or false, with reason if true and counterexample if false: 
(a) For every matrix A, there is a solution to du=dt = Au starting from u(0) = 
(1; : : : ;1). 
(b) Every invertible matrix can be diagonalized. 
(c) Every diagonalizable matrix can be inverted. 
(d) Exchanging the rows of a 2 by 2 matrix reverses the signs of its eigenvalues.
5.6 Similarity Transformations 343 
(e) If eigenvectors x and y correspond to distinct eigenvalues, then xHy = 0. 
5.19 If K is a skew-symmetric matrix, show that Q = (I.K)(I+K).1 is an orthogonal 
matrix. Find Q if K = 
. 0 2 
.2 0 
¤
. 
5.20 If KH = .K (skew-Hermitian), the eigenvalues are imaginary and the eigenvectors 
are orthogonal. 
(a) How do you know that K.I is invertible? 
(b) How do you know that K =ULUH for a unitary U? 
(c) Why is eLt unitary? 
(d) Why is eKt unitary? 
5.21 If M is the diagonal matrix with entries d, d2, d3, what is M.1AM? What are its 
eigenvalues in the following case?
A = 
2
64
1 1 1 
1 1 1 
1 1 1
3
75
: 
5.22 If A2 = .I, what are the eigenvalues of A? If A is a real n by n matrix show that n 
must be even, and give an example. 
5.23 If Ax =l1x and ATy =l2y (all real), show that xTy = 0. 
5.24 A variation on the Fourier matrix is the “sine matrix”: 
S = 
1 
p
2 
2
64
sinq sin2q sin3q 
sin2q sin4q sin6q 
sin3q sin6q sin9q
3
75with q = 
p
4 
: 
Verify that ST = S.1. (The columns are the eigenvectors of the tridiagonal .1, 2, 
.1 matrix.) 
5.25 (a) Find a nonzero matrix N such that N3 = 0. 
(b) If Nx =l x, show that l must be zero. 
(c) Prove that N (called a “nilpotent” matrix) cannot be symmetric. 
5.26 (a) Find the matrix P = aaT=aTa that projects any vector onto the line through 
a = (2;1;2). 
(b) What is the only nonzero eigenvalue of P, and what is the corresponding eigenvector? 
(c) Solve uk+1 = Puk, starting from u0 = (9;9;0). 
5.27 Suppose the first row of A is 7, 6 and its eigenvalues are i, .i. Find A.
344 Chapter 5 Eigenvalues and Eigenvectors 
5.28 (a) For which numbers c and d does A have real eigenvalues and orthogonal eigenvectors? 
A = 
2
64
1 2 0 
2 d c 
0 5 3
3
75
: 
(b) For which c and d can we find three orthonormal vectors that are combinations 
of the columns (don’t do it!)? 
5.29 If the vectors x1 and x2 are in the columns of S, what are the eigenvalues and eigenvectors 
of 
A = S
"
2 0 
0 1
#
S.1 and B = S
"
2 3 
0 1
#
S.1? 
5.30 What is the limit as k!. (the Markov steady state) of 
"
:4 :3 
:6 :7
#k "
a
b
#
?
Chapter 6 
Positive Definite Matrices 
6.1 Minima, Maxima, and Saddle Points 
Up to now, we have hardly thought about the signs of the eigenvalues. We couldn’t 
ask whether l was positive before it was known to be real. Chapter 5 established that 
every symmetric matrix has real eigenvalues. Now we will find a test that can be applied 
directly to A, without computing its eigenvalues, which will guarantee that all those 
eigenvalues are positive. The test brings together three of the most basic ideas in the 
book—pivots, determinants, and eigenvalues. 
The signs of the eigenvalues are often crucial. For stability in differential equations, 
we needed negative eigenvalues so that el t would decay. The new and highly important 
problem is to recognize a minimum point. This arises throughout science and engineering 
and every problem of optimization. The mathematical problem is to move the 
second derivative test F00 > 0 into n dimensions. Here are two examples: 
F(x;y) = 7+2(x+y)2.y sin y.x3 f (x;y) = 2x2+4xy+y2: 
Does either F(x;y) or f (x;y) have a minimum at the point x = y = 0? 
Remark 3. The zero-order terms F(0;0) = 7 and f (0;0) = 0 have no effect on the answer. 
They simply raise or lower the graphs of F and f . 
Remark 4. The linear terms give a necessary condition: To have any chance of a minimum, 
the first derivatives must vanish at x = y = 0: 
¶ F 
¶ x 
= 4(x+y).3x2 = 0 and 
¶ F 
¶ y 
= 4(x+y).y cos y.sin y = 0 
¶ f 
¶ x 
= 4x+4y = 0 and 
¶ f 
¶ y 
= 4x+2y = 0: All zero: 
Thus (x;y) = (0;0) is a stationary point for both functions. The surface z = F(x;y) is 
tangent to the horizontal plane z = 7, and the surface z = f (x;y) is tangent to the plane 
z = 0. The question is whether the graphs go above those planes or not, as we move 
away from the tangency point x = y = 0.
346 Chapter 6 Positive Definite Matrices 
Remark 5. The second derivatives at (0;0) are decisive: 
¶ 2F 
¶ x2 = 4.6x = 4 
¶ 2F 
¶ x¶ y 
= 
¶ 2F 
¶ y¶ x 
= 4 
¶ 2F 
¶ y2 = 4+y sin y.2cos y = 2 
¶ 2 f 
¶ x2 = 4 
¶ 2 f 
¶ x¶ y 
= 
¶ 2 f 
¶ y¶ x 
= 4 
¶ 2 f 
¶ y2 = 2: 
These second derivatives 4, 4, 2 contain the answer. Since they are the same for F and 
f , they must contain the same answer. The two functions behave in exactly the same 
way near the origin. F has a minimum if and only if f has a minimum. I am going to 
show that those functions don’t! 
Remark 6. The higher-degree terms in F have no effect on the question of a local minimum, 
but they can prevent it from being a global minimum. In our example the term 
.x3 must sooner or later pull F toward ... For f (x;y), with no higher terms, all the 
action is at (0;0). 
Every quadratic form f =ax2+2bxy+cy2 has a stationary point at the origin, where 
¶ f =¶ x =¶ f =¶ y = 0. A local minimum would also be a global minimum, The surface 
z = f (x;y) will then be shaped like a bowl, resting on the origin (Figure 6.1). If the 
stationary point of F is at x = a, y = b , the only change would be to use the second 
derivatives at a, b : 
Quadratic 
part of F 
f (x;y) = 
x2 
2 
¶ 2F 
¶ x2 (a;b )+xy 
¶ 2F 
¶ x¶ y
(a;b )+ 
y2 
2 
¶ 2F 
¶ y2 (a;b ): (1) 
This f (x;y) behaves near (0;0) in the same way that F(x;y) behaves near (a;b ). 
Figure 6.1: A bowl and a saddle: Definite A = 
. 1 0 
0 1 
¤ 
and indefinite A = 
. 0 1 
1 0 
¤
. 
The third derivatives are drawn into the problem when the second derivatives fail to 
give a definite decision. That happens when the quadratic part is singular. For a true 
minimum, f is allowed to vanish only at x = y = 0. When f (x;y) is strictly positive at 
all other points (the bowl goes up), it is called positive definite.
6.1 Minima, Maxima, and Saddle Points 347 
Definite versus Indefinite: Bowl versus Saddle 
The problem comes down to this: For a function of two variables x and y, what is the 
correct replacement for the condition ¶ 2F=¶ x2 > 0? With only one variable, the sign of 
the second derivative decides between a minimum or a maximum. Now we have three 
second derivatives: Fxx, Fxy = Fyx, and Fyy. These three numbers (like 4, 4, 2) must 
determine whether or not F (as well as f ) has a minimum. 
What conditions on a, b, and c ensure that the quadratic f (x;y) = ax2+2bxy+cy2 
is positive definite? One necessary condition is easy: 
(i) If ax2+2bxy+cy2 is positive definite, then necessarily a > 0. 
We look at x = 1, y = 0, where ax2 +2bxy+cy2 is equal to a. This must be positive. 
Translating back to F, that means that ¶ 2F=¶ x2 > 0. The graph must go up in the x 
direction. Similarly, fix x = 0 and look in the y direction where f (0;y) = cy2: 
(ii) If f (x;y) is positive definite, then necessarily c > 0. 
Do these conditions a > 0 and c > 0 guarantee that f (x;y) is always positive? The 
answer is no. A large cross term 2bxy can pull the graph below zero. 
Example 1. f (x;y) = x2.10xy+y2. Here a = 1 and c = 1 are both positive. But f is 
not positive definite, because f (1;1) = .8. The conditions a > 0 and c > 0 ensure that 
f (x;y) is positive on the x and y axes. But this function is negative on the line x = y, 
because b = .10 overwhelms a and c. 
Example 2. In our original f the coefficient 2b = 4 was positive. Does this ensure a 
minimum? Again the answer is no; the sign of b is of no importance! Even though its 
second derivatives are positive, 2x2+4xy+y2 is not positive definite. Neither F nor f 
has a minimum at (0;0) because f (1;.1) = 2.4+1 = .1. 
It is the size of b, compared to a and c, that must be controlled. We now want a 
necessary and sufficient condition for positive definiteness. The simplest technique is to 
complete the square: 
Express f (x;y) 
using squares 
f = ax2+2bxy+cy2 = a
µ
x+ 
b
a
y
¶2
+
µ
c. 
b2 
a 
¶
y2: (2) 
The first term on the right is never negative, when the square is multiplied by a > 0. 
But this square can be zero, and the second term must then be positive. That term 
has coefficient (ac.b2)=a. The last requirement for positive definiteness is that this 
coefficient must be positive: 
(iii) If ax2+2bxy+cy2 stays positive, then necessarily ac > b2. 
Test for a minimum: The conditions a>0 and ac>b2 are just right. They guarantee 
c > 0. The right side of (2) is positive, and we have found a minimum:
348 Chapter 6 Positive Definite Matrices 
6A ax2+2bxy+cy2 is positive definite if and only if a > 0 and ac > b2. Any 
f (x;y) has a minimum at a point where ¶ F=¶ x =¶ F=¶ y = 0 with 
¶ F2 
¶ x2 > 0 and 
·
¶ F2 
¶ x2 
.·
¶ F2 
¶ y2 
. 
> 
· 
¶ F2 
¶ x¶ y
.2 
: (3) 
Test for a maximum: Since f has a maximum whenever .f has a minimum, we just 
reverse the signs of a, b, and c. This actually leaves ac > b2 unchanged: The quadratic 
form is negative definite if and only if a < 0 and ac > b2. The same change applies for 
a maximum of F(x;y). 
Singular case ac = b2: The second term in equation (2) disappears to leave only 
the first square—which is either positive semidefinite, when a > 0, or negative semidefinite, 
when a < 0. The prefix semi allows the possibility that f can equal zero, as it will 
at the point x = b, y = .a. The surface z = f (x;y) degenerates from a bowl into a valley. 
For f = (x+y)2, the valley runs along the line x+y = 0. 
Saddle Point ac < b2: In one dimension, F(x) has a minimum or a maximum, or 
F00 = 0. In two dimensions, a very important possibility still remains: The combination 
ac.b2 may be negative. This occurred in both examples, when b dominated a and c. It 
also occurs if a and c have opposite signs. Then two directions give opposite results—in 
one direction f increases, in the other it decreases. It is useful to consider two special 
cases: 
Saddle points at (0;0) f1 = 2xy and f2 = x2.y2 and ac.b2 = .1: 
In the first, b = 1 dominates a = c = 0. In the second, a = 1 and c = .1 have opposite 
sign. The saddles 2xy and x2 .y2 are practically the same; if we turn one through 45° 
we get the other. They are also hard to draw. 
These quadratic forms are indefinite, because they can take either sign. So we have 
a stationary point that is neither a maximum or a minimum. It is called a saddle point. 
The surface z = x2.y2 goes down in the direction of the y axis, where the legs fit (if you 
still ride a horse). In case you switched to a car, think of a road going over a mountain 
pass. The top of the pass is a minimum as you look along the range of mountains, but it 
is a maximum as you go along the road. 
Higher Dimensions: Linear Algebra 
Calculus would be enough to find our conditions Fxx >0 and FxxFyy >F2 
xy for a minimum. 
But linear algebra is ready to do more, because the second derivatives fit into a symmetric 
matrix A. The terms ax2 and cy2 appear on the diagonal. The cross derivative 2bxy is
6.1 Minima, Maxima, and Saddle Points 349 
split between the same entry b above and below. A quadratic f (x;y) comes directly from 
a symmetric 2 by 2 matrix! 
xTAx in R2 ax2+2bxy+cy2 = 
h
x y
i"
a b 
b c
#"
x
y
#
: (4) 
This identity (please multiply it out) is the key to the whole chapter. It generalizes 
immediately to n dimensions, and it is a perfect shorthand for studying maxima and 
minima. When the variables are x1; : : : ;xn, they go into a column vector x. For any 
symmetric matrix A, the product xTAx is a pure quadratic form f (x1; : : : ;xn): 
xTAx in Rn 
h
x1 x2 . xn
i
2
6664 
a11 a12 . a1n 
a21 a22 . a2n 
. . . . 
an1 an2 . ann
3
7775 
2
6664 
x1 
x2 
. 
xn
3
7775
= 
na 
i=1 
na 
j=1
ai jxix j: (5) 
The diagonal entries a11 to ann multiply x2
1 to x2
n. The pair ai j = aji combines into 
2ai jxix j. Then f = a11x2
1+2a12x1x2+. . .+annx2
n. 
There are no higher-order terms or lower-order terms—only second-order. The function 
is zero at x = (0; : : : ;0), and its first derivatives are zero. The tangent is flat; this is 
a stationary point. We have to decide if x = 0 is a minimum or a maximum or a saddle 
point of the function f = xTAx. 
Example 3. f = 2x2+4xy+y2 and A = 
"
2 2 
2 1
#
!saddle point. 
Example 4. f = 2xy and A = 
"
0 1 
1 0
#
!saddle point. 
Example 5. A is 3 by 3 for 2x2
1.2x1x2+2x2
2.2x2x3+2x2
3: 
f = 
h
x1 x2 x3
i
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75 2
64
x1 
x2 
x3
3
75
!minimum at (0;0;0): 
Any function F(x1; : : : ;xn) is approached in the same way. At a stationary point 
all first derivatives are zero. A is the “second derivative matrix” with entries ai j = 
¶ 2F=¶ xi¶ x j. This automatically equals aji =¶ 2F=¶ x j¶ xi, so A is symmetric. Then F 
has a minimum when the pure quadratic xTAx is positive definite. These second-order 
terms control F near the stationary point: 
Taylor series F(x) = F(0)+xT(grad F)+ 
1
2
xTAx+higher order terms: (6) 
At a stationary point, grad F = (¶ F=¶ x1; : : : ;¶ F=¶ xn) is a vector of zeros. The second 
derivatives in xTAx take the graph up or down (or saddle). If the stationary point is at x0
350 Chapter 6 Positive Definite Matrices 
instead of 0, F(x) and all derivatives are computed at x0. Then x changes to x.x0 on 
the right-hand side. 
The next section contains the tests to decide whether xTAx is positive (the bowl goes 
up from x = 0). Equivalently, the tests decide whether the matrix A is positive definite—
which is the main goal of the chapter. 
Problem Set 6.1 
1. The quadratic f = x2+4xy+2y2 has a saddle point at the origin, despite the fact that 
its coefficients are positive. Write f as a difference of two squares. 
2. Decide for or against the positive definiteness of these matrices, and write out the 
corresponding f = xTAx: 
(a) 
"
1 3 
3 5
#
: (b) 
" 
1 .1 
.1 1 
#
: (c) 
"
2 3 
3 5
#
: (d) 
"
.1 2 
2 .8
#
: 
The determinant in (b) is zero; along what line is f (x;y) = 0? 
3. If a 2 by 2 symmetric matrix passes the tests a > 0, ac > b2, solve the quadratic 
equation det(A.l I) = 0 and show that both eigenvalues are positive. 
4. Decide between a minimum, maximum, or saddle point for the following functions. 
(a) F = .1+4(ex.x).5x sin y+6y2 at the point x = y = 0. 
(b) F = (x2.2x)cos y, with stationary point at x = 1, y =p. 
5. (a) For which numbers b is the matrix A = 
. 1 b 
b 9 
¤ 
positive definite? 
(b) Factor A = LDLT when b is in the range for positive definiteness. 
(c) Find the minimum value of 12
(x2+2bxy+9y2).y for b in this range. 
(d) What is the minimum if b = 3? 
6. Suppose the positive coefficients a and c dominate b in the sense that a+c > 2b. 
Find an example that has ac < b2, so the matrix is not positive definite. 
7. (a) What 3 by 3 symmetric matrices A1 and A2 correspond to f1 and f2? 
f1 = x2
1+x2
2+x2
3.2x1x2.2x1x3+2x2x3 
f2 = x2
1+2x2
2+11x2
3.2x1x2.2x1x3.4x2x3: 
(b) Show that f1 is a single perfect square and not positive definite. Where is f1 
equal to 0? 
(c) Factor A2 into LLT, Write f2 = xTA2x as a sum of three squares. 
8. If A = 
. a b 
b c 
¤ 
is positive definite, test A.1 = [ p q 
q r ] for positive definiteness.
6.1 Minima, Maxima, and Saddle Points 351 
9. The quadratic f (x1;x2) = 3(x1+2x2)2+4x2
2 is positive. Find its matrix A, factor it 
into LDLT, and connect the entries in D and L to 3, 2, 4 in f . 
10. If R = [ p q 
q r ], write out R2 and check that it is positive definite unless R is singular. 
11. (a) If A = 
. a b 
b c 
¤ 
is Hermitian (complex b), find its pivots and determinant. 
(b) Complete the square for xHAx. Now xH = [x1 x2] can be complex 
ajx1j2+2Rebx1x2+cjx2j2 = ajx1+(b=a)x2j2+ jx2j2: 
(c) Show that a > 0 and ac > jbj2 ensure that A is positive definite. 
(d) Are the matrices 
. 1 1+i 
1.i 2 
¤ 
and 
. 3 4+i 
4.i 6 
¤ 
positive definite? 
12. Decide whether F = x2y2 .2x.2y has a minimum at the point x = y = 1 (after 
showing that the first derivatives are zero at that point). 
13. Under what conditions on a, b, c is ax2+2bxy+cy2 > x2+y2 for all x, y? 
Problems 14–18 are about tests for positive definiteness. 
14. Which of A1, A2, A3, A4 has two positive eigenvalues? Test a > 0 and ac > b2, don’t 
compute the eigenvalues. Find an x so that xTA1x < 0. 
A1 = 
"
5 6 
6 7
# 
A2 = 
"
.1 .2 
.2 .5
# 
A3 = 
" 
1 10 
10 100
# 
A4 = 
" 
1 10 
10 101
#
: 
15. What is the quadratic f = ax2+2bxy+cy2 for each of these matrices? Complete the 
square to write f as a sum of one or two squares d1( )2+d2( )2. 
A = 
"
1 2 
2 9
# 
and A = 
"
1 3 
3 9
#
: 
16. Show that f (x;y) = x2 +4xy+3y2 does not have a minimum at (0;0) even though 
it has positive coefficients. Write f as a difference of squares and find a point (x;y) 
where f is negative. 
17. (Important) If A has independent columns, then ATA is square and symmetric and 
invertible (Section 4.2). Rewrite xTATAx to show why it is positive except when 
x = 0. Then ATA is positive definite. 
18. Test to see if ATA is positive definite in each case: 
A = 
"
1 2 
0 3
#
; A = 
2
64
1 1 
1 2 
2 1
3
75
; and A = 
"
1 1 2 
1 2 1
#
:
352 Chapter 6 Positive Definite Matrices 
19. Find the 3 by 3 matrix A and its pivots, rank, eigenvalues, and determinant: 
h
x1 x2 x3
i
2
64
A 
3
75 
2
64
x1 
x2 
x3
3
75
= 4(x1.x2+2x3)2: 
20. For F1(x;y) = 14
x4 +x2y+y2 and F2(x;y) = x3 +xy.x, find the second derivative 
matrices A1 and A2: 
A = 
" 
¶ 2F=¶ x2 ¶ 2F=¶ x¶ y 
¶ 2F=¶ y¶ x ¶ 2F=¶ y2 
#
: 
A1 is positive definite, so F1 is concave up (= convex). Find the minimum point of 
F1 and the saddle point of F2 (look where first derivatives are zero). 
21. The graph of z = x2 +y2 is a bowl opening upward. The graph of z = x2 .y2 is a 
saddle. The graph of z = .x2.y2 is a bowl opening downward. What is a test on 
F(x;y) to have a saddle at (0;0)? 
22. Which values of c give a bowl and which give a saddle point for the graph of z = 
4x2+12xy+cy2? Describe this graph at the borderline value of c. 
6.2 Tests for Positive Definiteness 
Which symmetric matrices have the property that xTAx > 0 for all nonzero vectors x? 
There are four or five different ways to answer this question, and we hope to find all of 
them. The previous section began with some hints about the signs of eigenvalues. but 
that gave place to the tests on a, b, c: 
b = 
"
a b 
b c
# 
is positive definite when a > 0 and ac.b2 > 0: 
From those conditions, both eigenvalues are positive. Their product l1l2 is determinant 
ac.b2 > 0, so the eigenvalues are either both positive or both negative. They must be 
positive because their sum is the trace a+c > 0. 
Looking at a and ac.b2, it is even possible to spot the appearance of the pivots. They 
turned up when we decomposed xTAx into a sum of squares: 
Sum of squares ax2+2bxy+cy2 = a
µ
x+ 
b
a
y
¶2
+ 
ac.b2 
a 
y2: (1) 
Those coefficients a and (ac.b2)=a are the pivots for a 2 by 2 matrix. For larger 
matrices the pivots still give a simple test for positive definiteness: xTAx stays positive 
when n independent squares are multiplied by positive pivots.
6.2 Tests for Positive Definiteness 353 
One more preliminary remark. The two parts of this hook were linked by the chapter 
on determinants. Therefore we ask what part determinants play. It is not enough to 
require that the determinant of A is positive. If a = c = .1 and b = 0. then detA = 1 
but A = .I = negative definite. The determinant test is applied not only to A itself, 
giving ac.b2 > 0, but also to the 1 by 1 submatrix a in the upper left-hand corner. 
The natural generalization will involve all n of the upper left submatrices of A: 
A1 = 
h
a11
i
; A2 = 
"
a11 a12 
a21 a22
#
; A3 = 
2
64
a11 a12 a13 
a21 a22 a23 
a31 a32 a33
3
75
; . . . ; An = A: 
Here is the main theorem on positive definiteness, and a reasonably detailed proof: 
6B Each of the following tests is a necessary and sufficient condition for the 
real symmetric matrix A to be positive definite: 
(I) xTkx > 0 for all nonzero real vectors x. 
(II) All the eigenvalues of A satisfy li > 0. 
(III) All the upper left submatrices Ak have positive determinants. 
(IV) All the pivots (without row exchanges) satisfy dk > 0. 
Proof. Condition I defines a positive definite matrix. Our first step shows that each 
eigenvalue will be positive: 
If Ax =l x; then xTAx = xTl x =l kxk2: 
A positive definite matrix has positive eigenvalues, since xTAx > 0. 
Now we go in the other direction. If all li > 0, we have to prove xTAx > 0 for 
every vector x (not just the eigenvectors). Since symmetric matrices have a full set of 
orthonormal eigenvectors, any x is a combination c1x1+. . .+cnxn. Then 
Ax = c1Ax1+. . .+cnAxn = c1l1x1+. . .+cnlnxn: 
Because of the orthogonality xT
i xi = 0, and the normalization xT
i xi = 1, 
xTAx = 
.
c1xT
1 +. . .+cnxT
n 
.
(c1l1x1+. . .+cnlnxn) 
= c21
l1+. . .+c2n
ln: 
(2) 
If every li > 0, then equation (2) shows that xTAx > 0. Thus condition II implies condition 
I. 
If condition I holds, so does condition III: The determinant of A is the product of 
the eigenvalues. And if condition I holds, we already know that these eigenvalues are 
positive. But we also have to deal with every upper left submatrix Ak. The trick is to 
look at all nonzero vectors whose last n.k components are zero: 
xTAx = 
h
xT
k 0
i"
Ak ¤ 
¤ ¤
#"
xk 
0 
# 
= xT
k Akxk > 0:
354 Chapter 6 Positive Definite Matrices 
Thus Ak is positive definite. Its eigenvalues (not the same l1!) must be positive. Its 
determinant is their product, so all upper left determinants are positive. 
If condition III holds, so does condition IV: According to Section 4.4, the kth pivot 
dk is the ratio of detAk to detAk.1. If the determinants are all positive, so are the pivots. 
If condition IV holds, so does condition I: We are given positive pivots, and must 
deduce that xTAx > 0. This is what we did in the 2 by 2 case, by completing the square. 
The pivots were the numbers outside the squares. To see how that happens for symmetric 
matrices of any size, we go back to elimination on a symmetric matrix: A = LDLT. 
Example 1. Positive pivots 2, 32
, and 43
: 
A = 
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75
= 
2
64
1 0 0 
.12
1 0 
0 .23
1
3
75 
2
64
2 
32
43 
3
75 
2
64
1 .12
0 
0 1 .23 
0 0 1 
3
75
= LDLT: 
I want to split xTAx into xTLDLTx: 
If x = 
2
64
u
v
w
3
75
; then LTx = 
2
64
1 .12
0 
0 1 .23 
0 0 1 
3
75 
2
64
u
v
w
3
75
= 
2
64
u. 12
v 
v. 23
w 
w 
3
75
: 
So xTAx is a sum of squares with the pivots 2, 32
, and 43
as coefficients: 
xTAx = (LTx)TD(LTx) = 2
µ
u. 
1
2
v
¶2
+ 3
2 
µ
v. 
2
3
w
¶2
+ 4
3
(w)2: 
Those positive pivots in D multiply perfect squares to make xTAx positive. Thus condition 
IV implies condition I, and the proof is complete. 
It is beautiful that elimination and completing the square are actually the same. Elimination 
removes x1 from all later equations. Similarly, the first square accounts for all 
terms in xTAx involving x1. The sum of squares has the pivots outside. The multipliers 
`i j are inside! You can see the numbers .12
and .23
inside the squares in the example. 
Every diagonal entry aii must be positive. As we know from the examples, however, 
it is far from sufficient to look only at the diagonal entries. 
The pivots di are not to be confused with the eigenvalues. For a typical positive 
definite matrix, they are two completely different sets of positive numbers, In our 3 by 3 
example, probably the determinant test is the easiest: 
Determinant test detA1 = 2; detA2 = 3; detA3 = detA = 4: 
The pivots are the ratios d1 = 2, d2 = 32
, d3 = 43
. Ordinarily the eigenvalue test is the 
longest computation. For this A we know the l ’s are all positive: 
Eigenvalue test l1 = 2.
p
2; l2 = 2; l3 = 2+
p
2:
6.2 Tests for Positive Definiteness 355 
Even though it is the hardest to apply to a single matrix, eigenvalues can be the most 
useful test for theoretical purposes. Each test is enough by itself . 
Positive Definite Matrices and Least Squares 
I hope you will allow one more test for positive definiteness. It is already close. We 
connected positive definite matrices to pivots (Chapter 1), determinants (Chapter 4), and 
eigenvalues (Chapter 5). Now we see them in the least-squares problems in Chapter 3, 
coming from the rectangular matrices of Chapter 2. 
The rectangular matrix will be R and the least-squares problem will be Rx = b. It has 
m equations with m . n (square systems are included). The least-square choice bx is the 
solution of RTRbx = RTb. That matrix ARTR is not only symmetric but positive definite, 
as we now show—provided that the n columns of R are linearly independent: 
6C The symmetric matrix A is positive definite if and only if 
(V) There is a matrix R with independent columns such that A = RTR. 
The key is to recognize xTAx as xTRTRx = (Rx)T(Rx). This squared length kRxk2 is 
positive (unless x = 0), because R has independent columns. (If x is nonzero then Rx is 
nonzero.) Thus xTRTRx > 0 and RTR is positive definite. 
It remains to find an R For which A = RTR. We have almost done this twice already: 
Elimination A = LDLT = (L
p
D)(
p
DLT): So take R = 
p
DLT: 
This Cholesky decomposition has the pivots split evenly between L and LT. 
Eigenvalues A = QLQT = (Q
p
L)(
p
LQT): So take R = 
p
LQT: (3) 
A third possibility is R = Q
p
LQT, the symmetric positive definite square root of A. 
There are many other choices, square or rectangular, and we can see why. If you multiply 
any R by a matrix Q with orthonormal columns, then (QR)T(QR) = RTQTQR = RTIR = 
A. Therefore QR is another choice. 
Applications of positive definite matrices are developed in my earlier book Introduction 
to Applied Mathematics and also the new Applied Mathematics and Scientific 
Computing (see www.wellesleycambridge.com). We mention that Ax = lMx 
arises constantly in engineering analysis. If A and M are positive definite, this generalized 
problem is parallel to the familiar Ax =l x, and l > 0. M is a mass matrix for the 
finite element method in Section 6.4. 
Semidefinite Matrices 
The tests for semidefiniteness will relax xTAx > 0, l > 0, d > 0, and det > 0, to allow 
zeros to appear. The main point is to see the analogies with the positive definite case.
356 Chapter 6 Positive Definite Matrices 
6D Each of the following tests is a necessary and sufficient condition for a 
symmetric matrix A to be positive semidefinite: 
(I0) xTAx . 0 for all vectors x (this defines positive semidefinite). 
(II0) All the eigenvalues of A satisfy li . 0. 
(III0) No principal submatrices have negative determinants. 
(IV0) No pivots are negative. 
(V0) There is a matrix R, possibly with dependent columns, such that A = RTR. 
The diagonalization A=QLQT leads to xTAx=xTQLQTx=yTLy. If A has rank r, there 
are r nonzero l ’s and r perfect squares in yTLy =l1y21
+. . .+lry2r
. 
Note. The novelty is that condition III0 applies to all the principal submatrices, not only 
those in the upper left-hand corner. Otherwise, we could not distinguish between two 
matrices whose upper left determinants were all zero: 
"
0 0 
0 1
# 
is positive semidefinite, and 
"
0 0 
0 .1
# 
is negative semidefinite. 
A row exchange comes with the same column exchange to maintain symmetry. 
Example 2. 
A = 
2
64
2 .1 .1 
.1 2 .1 
.1 .1 2 
3
75
is positive semidefinite, by all five tests: 
(I0) xTAx = (x1.x2)2+(x1.x3)2+(x2.x3)2 . 0 (zero if x1 = x2 = x3). 
(II0) The eigenvalues are l1 = 0, l2 =l3 = 3 (a zero eigenvalue). 
(III0) detA = 0 and smaller determinants are positive. 
(IV0) A = 
2
64
2 .1 .1 
.1 2 .1 
.1 .1 2 
3
75
!
2
64
2 0 0 
0 32.32 
0 .32 
32 3
75
!
2
64
2 0 0 
0 32
0 
0 0 0
3
75
(missing pivot). 
(V0) A = RTR with dependent columns in R: 
2
64
2 .1 .1 
.1 2 .1 
.1 .1 2 
3
75= 
2
64
1 .1 0 
0 1 .1 
.1 0 1 
3
75 
2
64
1 0 .1 
.1 1 0 
0 .1 1 
3
75
(1;1;1) in the nullspace. 
Remark. The conditions for semidefiniteness could also be deduced from the origin conditions 
I-V for definiteness by the following trick: Add a small multiple of the identity 
giving a positive definite matrix A+e I. Then let e approach zero. Since the determinants 
and eigenvalues depend continuously on e , they will be positive until the very last 
moment. At e = 0 they must still be nonnegative.
6.2 Tests for Positive Definiteness 357 
My class often asks about unsymmetric positive definite matrices. I never use that 
term. One reasonable definition is that the symmetric part 12
(A+AT) should be positive 
definite. That guarantees that the real parts of the eigenvalues are positive. But it is not 
necessary: A = 
. 1 4 
0 1 
¤ 
has l > 0 but 12
(A+AT) = 
. 
1 2 
2 1 
¤ 
is indefinite. 
If Ax =l x, then xHAx =l xHx and xHAHx =l xHx. 
Adding, 12
xH(A+AH)x = (Rel )xHx > 0, so that Rel > 0. 
Ellipsoids in n Dimensions 
Throughout this book, geometry has helped the matrix algebra. A linear equation produced 
a plane. The system Ax = b gives an intersection of planes. Least squares gives 
a perpendicular projection. The determinant is the volume of a box. Now, for a positive 
definite matrix and its xTAx, we finally get a figure that is curved. It is an ellipse in two 
dimensions, and an ellipsoid in n dimensions. 
The equation to consider is xTAx = 1. If A is the identity matrix, this simplifies to 
x2
1 +x2
2 +. . .+x2
n = 1. This is the equation of the “unit sphere” in Rn. If A = 4I, the 
sphere gets smaller. The equation changes to 4x2
1+. . .+4x2
n = 1. Instead of (1;0; : : : ;0), 
it goes through (12
;0; : : : ;0). The center is at the origin, because if x satisfies xTAx = 1, 
so does the opposite vector .x. The important step is to go from the identity matrix to a 
diagonal matrix: 
Ellipsoid For A = 
2
64
4 
1 
19 
3
75
; the equation is xTAx = 4x2
1+x2
2+ 19
x2
3 = 1: 
Since the entries are unequal (and positive!) the sphere changes to an ellipsoid. 
One solution is x = (12
;0;0) along the first axis. Another is x = (0;1;0). The major 
axis has the farthest point x=(0;0;3). It is like a football or a rugby ball, but not quite— 
those are closer to x2
1+x2
2+ 12
x2
3 = 1. The two equal coefficients make them circular in 
the x1-x2 plane, and much easier to throw! 
Now comes the final step, to allow nonzeros away from the diagonal of A. 
Example 3. A = 
. 5 4 
4 5 
¤ 
and xTAx = 5u2 +8uv+5v2 = 1. That ellipse is centered at 
u = v = 0, but the axes are not so clear. The off-diagonal 4s leave the matrix positive 
definite, but they rotate the ellipse—its axes no longer line up with the coordinate axes 
(Figure 6.2). We will show that the axes of the ellipse point toward the eigenvector of 
A. Because A = AT, those eigenvectors and axes are orthogonal. The major axis of the 
ellipse corresponds to the smallest eigenvalue of A. 
To locate the ellipse we compute l1 = 1 and l2 = 9. The unit eigenvectors are 
(1;.1)=
p
2 and (1;1)=
p
2. Those are at 45° angles with the u-v axes, and they are 
lined up with the axes of the ellipse. The way to see the ellipse properly is to rewrite
358 Chapter 6 Positive Definite Matrices 
u 
v 
b 
b 
Q = 1
3  1 
p
2
, 1 
p
2 
P =  1 
p
2
,. 
1 
p
2 
.1 1 1 
Figure 6.2: The ellipse xTAx = 5u2+8uv+5v2 = 1 and its principal axes. 
xTAx = 1: 
New squares 5u2+8uv+v2 = 
µ 
u 
p
2 
. 
v 
p
2
¶2
+9
µ 
u 
p
2 
+ 
v 
p
2
¶2 
= 1: (4) 
l = 1 and l = 9 are outside the squares. The eigenvectors are inside. This is different 
from completing the square to 5(u+ 4
5v)2+ 95
v2, with the pivots outside. 
The first square equals 1 at (1=
p
2;.1=
p
2) at the end of the major axis. The minor 
axis is one-third as long, since we need (13
)2 to cancel the 9. 
Any ellipsoid xTAx = 1 can be simplified in the same way. The key step is to diagonalize 
A = QLQT. We straightened the picture by rotating the axes. Algebraically, the 
change to y = QTx produces a sum of squares: 
xTAx = (xTQ)L(QTx) = yTLy =l1y21+. . .+lny2n
= 1: (5) 
The major axis has y1 = 1=
p
l1 along the eigenvector with the smallest eigenvalue. 
The other axes are along the other eigenvectors. Their lengths are 1=
p
l2; : : : ;1=
p
ln. 
Notice that the l ’s must be positive—the matrix must be positive definite—or these 
square roots are in trouble. An indefinite equation y21
.9y22
= 1 describes a hyperbola 
and not an ellipse. A hyperbola is a cross-section through a saddle, and an ellipse is a 
cross-section through a bowl. 
The change from x to y = QTx rotates the axes of the space, to match the axes of 
the ellipsoid. In the y variables we can see that it is an ellipsoid, because the equation 
becomes so manageable: 
6E Suppose A = QLQT with li > 0. Rotating y = QTx simplifies xTAx = 1: 
xTQLQTx = 1; yTLy = 1; and l1y21
+. . .+lny2n
= 1: 
This is the equation of an ellipsoid. Its axes have lengths 1=
p
l1; : : : ;1=
p
ln 
from the center. In the original x-space they point along the eigenvectors of A.
6.2 Tests for Positive Definiteness 359 
The Law of Inertia 
For elimination and eigenvalues, matrices become simpler by elementary operations 
The essential thing is to know which properties of the matrix stay unchanged. When 
a multiple of one row is subtracted from another, the row space, nullspace. rant and 
determinant all remain the same. For eigenvalues, the basic operation was a similarity 
transformation A!S.1AS (or A!M.1AM). The eigenvalues are unchanged (and also 
the Jordan form). Now we ask the same question for symmetric matrices: What are the 
elementary operations and their invariants for xTAx? 
The basic operation on a quadratic form is to change variables. A new vector y is 
related to x by some nonsingular matrix, x =Cy. The quadratic form becomes yTCTACy. 
This shows the fundamental operation on A: 
Congruence transformation A!CTAC for some nonsingular C. (6) 
The symmetry of A is preserved, since CTAC remains symmetric. The real question is, 
What other properties are shared by A and CTAC? The answer is given by Sylvester’s 
law of inertia. 
6F CTAC has the same number of positive eigenvalues, negative eigenvalues, 
and zero eigenvalues as A. 
The signs of the eigenvalues (and not the eigenvalues themselves) are preserved by a 
congruence transformation. In the proof, we will suppose that A is nonsingular. Then 
CTAC is also nonsingular, and there are no zero eigenvalues to worry about. (Otherwise 
we can work with the nonsingular A+e I and A.e I, and at the end let e !0.) 
Proof. We want to borrow a trick from topology. Suppose C is linked to an orthogonal 
matrix Q by a continuous chain of nonsingular matrices C(t). At t = 0 and t = 1, C(0) = 
C and C(1) = Q. Then the eigenvalues of C(t)TAC(t) will change gradually, as t goes 
from 0 to 1, from the eigenvalues of CTAC to the eigenvalues of QTAQ. Because C(t) is 
never singular, none of these eigenvalues can touch zero (not to mention cross over it!). 
Therefore the number of eigenvalues to the right of zero, and the number to the left, is 
the same for CTAC as for QTAQ. And A has exactly the same eigenvalues as the similar 
matrix Q.1AQ = QTAQ. 
One good choice for Q is to apply Gram-Schmidt to the columns of C. Then C = QR, 
and the chain of matrices is C(t)=tQ+(1.t)QR. The family C(t) goes slowly through 
Gram-Schmidt, from QR to Q. It is invertible, because Q is invertible and the triangular 
factor tI+(1.t)R has positive diagonal. That ends the proof. 
Example 4. Suppose A = I. Then CTAC = CTC is positive definite. Both I and CTC 
have n positive eigenvalues, confirming the law of inertia. 
Example 5. If A = 
. 1 0 
0 .1 
¤
, then CTAC has a negative determinant: 
detCTAC = (detCT)(detA)(detC) = .(detC)2 < 0:
360 Chapter 6 Positive Definite Matrices 
Then CTAC must have one positive and one negative eigenvalue, like A. 
Example 6. This application is the important one: 
6G For any symmetric matrix A, the signs of the pivots agree with the signs 
of the eigenvalues. The eigenvalue matrix L and the pivot matrix D have the 
same number of positive entries, negative entries, and zero entries. 
We will assume that A allows the symmetric factorization A = LDLT (without row exchanges). 
By the law of inertia, A has the same number of positive eigenvalues as D. 
But the eigenvalues of D are just its diagonal entries (the pivots). Thus the number of 
positive pivots matches the number of positive eigenvalues of A. 
That is both beautiful and practical. It is beautiful because it brings together (for 
symmetric matrices) two parts of this book that were previously separate: pivots and 
eigenvalues. It is also practical, because the pivots can locate the eigenvalues: 
A has positive pivots 
A.2I has a negative pivot 
A = 
2
64
3 3 0 
3 10 7 
0 7 8
3
75
A.2I = 
2
64
1 3 0 
3 8 7 
0 7 6
3
75: 
A has positive eigenvalues, by our test. But we know that lmin is smaller than 2, because 
subtracting 2 dropped it below zero. The next step looks at A.I, to see if lmin < 1. (It 
is, because A.I has a negative pivot.) That interval containing l is cut in half at every 
step by checking the signs of the pivots. 
This was almost the first practical method of computing eigenvalues. It was dominant 
about 1960, after one important improvement—to make A tridiagonal first. Then the 
pivots are computed in 2n steps instead of 16
n3. Elimination becomes fast, and the search 
for eigenvalues (by halving the intervals) becomes simple. The current favorite is the 
QR method in Chapter 7. 
The Generalized Eigenvalue Problem 
Physics, engineering, and statistics are usually kind enough to produce symmetric matrices 
in their eigenvalue problems. But sometimes Ax =l x is replaced by Ax =lMx. 
There are two matrices rather than one. 
An example is the motion of two unequal masses in a line of springs: 
m1 
d2v 
dt2 +2v.w = 0 
m2 
d2w 
dt2 .v+2w = 0 
or 
"
m1 0 
0 m2
# 
d2u 
dt2 +
" 
2 .1 
.1 2 
#
u = 0: (7) 
When the masses were equal, m1 = m2 = 1, this was the old system u00+Au = 0. Now 
it is Mu00+Au = 0, with a mass matrix M. The eigenvalue problem arises when we look
6.2 Tests for Positive Definiteness 361 
for exponential solutions eiwtx: 
Mu00+Au = 0 becomes M(iw)2eiwtx+Aeiwtx = 0: (8) 
Canceling eiwt , and writing l for w2, this is an eigenvalue problem: 
Generalized problem Ax =lMx 
" 
2 .1 
.1 2 
#
x =l 
"
m1 0 
0 m2
#
x: (9) 
There is a solution when A.lM is singular. The special choice M = I brings back the 
usual det(A.l I) = 0. We work out det(A.lM) with m1 = 1 and m2 = 2: 
det
"
2.l .1 
.1 2.2l 
# 
= 2l 2.6l +3 = 0 gives l = 
3§
p
3 
2 
: 
For the eigenvector x1(
p
3.1;1), the two masses oscillate together—but the first mass 
only moves as far as 
p
3p .1 . :73. In the fastest mode, the components of x2 = (1+ 
3;.1) have opposite signs and the masses move in opposite directions. This time the 
smaller mass goes much further. 
The underlying theory is easier to explain if M is split into RTR. (M is assumed to be 
positive definite.) Then the substitution y = Rx changes 
Ax =lMx =l RTRx into AR.1y =l RTy: 
Writing C for R.1, and multiplying through by (RT).1 = CT, this becomes a standard 
eigenvalue problem for the single symmetric matrix CTAC: 
Equivalent problem CTACy =l y: (10) 
The eigenvalues l j are the same as for the original Ax =lMx. and the eigenvectors are 
related by y j =Rxj. The properties of CTAC lead directly to thc properties of Ax=lMx, 
when A = AT and M is positive definite: 
1. The eigenvalues for Ax =lMx are real, because CTAC is symmetric. 
2. The l ’s have the same signs as the eigenvalues of A, by the law of inertia. 
3. CTAC has orthogonal eigenvectors y j. So the eigenvectors of Ax =lMx have 
“M-orthogonality” xT
i Mx j = xT
i RTRxj = yTi
y j = 0: (11) 
A and M are being simultaneously diagonalized. If S has the x j in its columns, then 
STAS = L and STMS = I. This is a congruence transformation, with ST on the left, 
and not a similarity transformation with S.1. The main point is easy to summarize: As 
long as M is positive definite, the generalized eigenvalue problem Ax = .lMx behaves 
exactly like Ax =l x.
362 Chapter 6 Positive Definite Matrices 
Problem Set 6.2 
1. For what range of numbers a and b are the matrices A and B positive definite? 
A = 
2
64
a 2 2 
2 a 2 
2 2 a
3
75
B = 
2
64
1 2 4 
2 b 8 
4 8 7
3
75
: 
2. Decide for or against the positive definiteness of 
A = 
2
64
2 .1 .1 
.1 2 .1 
.1 .1 2 
3
75
; B = 
2
64
2 .1 .1 
.1 2 1 
.1 1 2 
3
75
; C = 
2
64
0 1 2 
1 0 1 
2 1 0
3
75 
2 
: 
3. Construct an indefinite matrix with its largest entries on the main diagonal: 
A = 
2
64
1 b .b 
b 1 b 
.b b 1 
3
75
with jbj < 1 can have detA < 0: 
4. Show from the eigenvalues that if A is positive definite, so is A2 and so is A.1. 
5. If A and B are positive definite, then A+B is positive definite. Pivots and eigenvalues 
are not convenient for A+B. Much better to prove xT(A+B)x > 0. 
6. From the pivots, eigenvalues, and eigenvectors of A = 
. 5 4 
4 5 
¤
, write A as RTR in three 
ways: (L
p
D)(
p
DLT), (Q
p
L)(
p
LQT), and (Q
p
LQT)(Q
p
LQT). 
7. If A = QLQT is symmetric positive definite, then R = Q
p
LQT is its symmetric positive 
definite square root. Why does R have positive eigenvalues? Compute R and 
verify R2 = A for 
A = 
"
10 6 
6 10
# 
and A = 
"
10 .6 
.6 10
#
: 
8. If A is symmetric positive definite and C is nonsingular, prove that B =CTAC is also 
symmetric positive definite. 
9. If A = RTR prove the generalized Schwarz inequality jxTAyj2 · (xTAx)(yTAy). 
10. The ellipse u2+4v2 = 1 corresponds to A = 
. 1 0 
0 4 
¤
. Write the eigenvalues and eigenvectors, 
and sketch the ellipse. 
11. Reduce the equation 3u2 .2
p
2uv+2v2 = 1 to a sum of squares by finding the 
eigenvalues of the corresponding A, and sketch the ellipse.
6.2 Tests for Positive Definiteness 363 
12. In three dimensions, l1y21
+l2y22
+l3y23
= 1 represents an ellipsoid when all li > 0. 
Describe all the different kinds of surfaces that appear in the positive semidefinite 
case when one or more of the eigenvalues is zero. 
13. Write down the five conditions for a 3 by 3 matrix to be negative definite (.A is 
positive definite) with special attention to condition III: How is det(.A) related to 
detA? 
14. Decide whether the following matrices are positive definite, negative definite, semidefinite, 
or indefinite: 
A = 
2
64
1 2 3 
2 5 4 
3 4 9
3
75
; B = 
2
6664 
1 2 0 0 
2 6 .2 0 
0 .2 5 .2 
0 0 .2 3 
3
7775
; C = .B; D = A.1: 
Is there a real solution to .x2.5y2.9z2.4xy.6xz.8yz = 1? 
15. Suppose A is symmetric positive definite and Q is an orthogonal matrix. True or 
false: 
(a) QTAQ is a diagonal matrix. 
(b) QTAQ is symmetric positive definite. 
(c) QTAQ has the same eigenvalues as A. 
(d) e.A is symmetric positive definite. 
16. If A is positive definite and a11 is increased, prove from cofactors that the determinant 
is increased. Show by example that this can fail if A is indefinite. 
17. From A = RTR. show for positive definite matrices that detA · a11a22 . . .ann. (The 
length squared of column j of R is aj j. Use determinant = volume.) 
18. (Lyapunov test for stability of M) Suppose AM +MHA = .I with positive definite 
A. If Mx =l x show that ReA < 0. (Hint: Multiply the first equation by xH and x.) 
19. Which 3 by 3 symmetric matrices A produce these functions f = xTAx? Why is the 
first matrix positive definite but not the second one? 
(a) f = 2(x2
1+x2
2+x2
3.x1x2.x2x3). 
(b) f = 2(x2
1+x2
2+x2
3.x1x2.x1x3.x2x3). 
20. Compute the three upper left determinants to establish positive definiteness. Verify 
that their ratios give the second and third pivots. 
A = 
2
64
2 2 0 
2 5 3 
0 3 8
3
75
:
364 Chapter 6 Positive Definite Matrices 
21. A positive definite matrix cannot have a zero (or even worse, a negative number) on 
its diagonal. Show that this matrix fails to have xTAx > 0: 
h
x1 x2 x3
i
2
64
4 1 1 
1 0 2 
1 2 5
3
75 
2
64
x1 
x2 
x3
3
75
is not positive when (x1;x2;x3) = ( ; ; ): 
22. A diagonal entry aj j of a symmetric matrix cannot be smaller than all l ’s. If it 
were, then A.aj jI would have eigenvalues and would be positive definite. But 
A.aj jI has a on the main diagonal. 
23. Give a quick reason why each of these statements is true: 
(a) Every positive definite matrix is invertible. 
(b) The only positive definite projection matrix is P = I. 
(c) A diagonal matrix with positive diagonal entries is positive definite. 
(d) A symmetric matrix with a positive determinant might not be positive definite! 
24. For which s and t do A and B have all l > 0 (and are therefore positive definite)? 
A = 
2
64
s .4 .4 
.4 s .4 
.4 .4 s 
3
75
and B = 
2
64
t 3 0 
3 t 4 
0 4 t
3
75
: 
25. You may have seen the equation for an ellipse as (xa
)2 +(yb
)2 = 1. What are a and 
b when the equation is written as l1x2 +l2y2 = 1? The ellipse 9x2 +16y2 = 1 has 
half-axes with lengths a = , and b = . 
26. Draw the tilted ellipse x2+xy+y2 = 1 and find the half-lengths of its axes from the 
eigenvalues of the corresponding A. 
27. With positive pivots in D, the factorization A = LDLT becomes L
p
D
p
DLT. (Square 
roots of the pivots give D = 
p
D
p
D.) Then C = L
p
D yields the Cholesky factorization 
A =CCT, which is “symmetrized LU”: 
From C = 
"
3 0 
1 2
# 
find A: From A = 
"
4 8 
8 25
# 
find C: 
28. In the Cholesky factorization A =CCT, with C = L
p
D, the square roots of the pivots 
are on the diagonal of C. Find C (lower triangular) for 
A = 
2
64
9 0 0 
0 1 2 
0 2 8
3
75
and A = 
2
64
1 1 1 
1 2 2 
1 2 7
3
75
:
6.2 Tests for Positive Definiteness 365 
29. The symmetric factorization A = LDLT means that xTAx = xTLDLTx: 
h
x y
i"
a b 
b c
#"
x
y
# 
= 
h
x y
i" 
1 0 
b=a 1
#"
a 0 
0 (ac.b2)=a
#"
1 b=a 
0 1 
#"
x
y
#
: 
The left-hand side is ax2+2bxy+cy2. The right-hand side is a(x+ ba
y)2+ y2. 
The second pivot completes the square! Test with a = 2, b = 4, c = 10. 
30. Without multiplying A = 
. cosq .sinq 
sinq cosq 
¤ . 2 0 
0 5 
¤ . cosq sinq 
.sinq cosq 
¤
, find 
(a) the determinant of A. (b) the eigenvalues of A. 
(c) the eigenvectors of A. (d) a reason why A is symmetric positive definite. 
31. For the semidefinite matrices 
A = 
2
64
2 .1 .1 
.1 2 .1 
.1 .1 2 
3
75
(rank 2) and B = 
2
64
1 1 1 
1 1 1 
1 1 1
3
75
(rank 1); 
write xTAx as a sum of two squares and xTBx as one square. 
32. Apply any three tests to each of the matrices 
A = 
2
64
1 1 1 
1 1 1 
1 1 0
3
75
and B = 
2
64
2 1 2 
1 1 1 
2 1 2
3
75
; 
to decide whether they are positive definite, positive semidefinite, or indefinite. 
33. For C = 
. 2 0 
0 .1 
¤ 
and A = 
. 
1 1 
1 1 
¤
, confirm that CTAC has eigenvalues of the same signs 
as A. Construct a chain of nonsingular matrices C(t) linking C to an orthogonal 
Q. Why is it impossible to construct a nonsingular chain linking C to the identity 
matrix? 
34. If the pivots of a matrix are all greater than 1, are the eigenvalues all greater than 1? 
Test on the tridiagonal .1, 2, .1 matrices. 
35. Use the pivots of A. 12
I to decide whether A has an eigenvalue smaller than 12
: 
A. 
1
2
I = 
2
64
2:5 3 0 
3 9:5 7 
0 7 7:5
3
75
: 
36. An algebraic proof of the law of inertia starts with the orthonormal eigenvectors 
x1; : : : ;xp of A corresponding to eigenvalues li >0. and the orthonormal eigenvectors 
y1; : : : ;yq of CTAC corresponding to eigenvalues mi < 0.
366 Chapter 6 Positive Definite Matrices 
(a) To prove that the p+q vectors x1; : : : ;xp, Cy1; : : : ;Cyq are independent, assume 
that some combination gives zero: 
a1x1+. . .+apxp = b1Cy1+. . .+bqCyq (= z; say): 
Show that zTAz =l1a21
+. . .+lpa2
p . 0 and zTAz = m1b21
+. . .+mqb2q
· 0. 
(b) Deduce that the a’s and b’s are zero (proving linear independence). From that 
deduce p+q · n. 
(c) The same argument for the n. p negative l ’s and the n.q positive m’s gives 
n. p+n.q · n. (We again assume no zero eigenvalues—which are handled 
separately). Show that p+q = n, so the number p of positive l ’s equals the 
number n.q of positive m’s—which is the law of inertia. 
37. If C is nonsingular, show that A and CTAC have the same rank. Thus they have the 
same number of zero eigenvalues. 
38. Find by experiment the number of positive, negative, and zero eigenvalues of 
A = 
" 
I B 
BT 0
# 
when the block B (of order 12
n) is nonsingular. 
39. Do A and CTAC always satisfy the law of inertia when C is not square? 
40. In equation (9) with m1 = 1 and m2 = 2, verify that the normal modes are Morthogonal: 
xT
1Mx2 = 0. 
41. Find the eigenvalues and eigenvectors of Ax =lMx: 
" 
6 .3 
.3 6 
#
x = 
l
18 
"
4 1 
1 4
#
x: 
42. If the symmetric matrices A and M are indefinite, Ax = lMx might not have real 
eigenvalues. Construct a 2 by 2 example. 
43. A group of nonsingular matrices includes AB and A.1 if it includes A and B. “Products 
and inverses stay in the group.” Which of these sets are groups? Positive definite 
symmetric matrices A, orthogonal matrices Q, all exponentials etA of a fixed matrix 
A, matrices P with positive eigenvalues, matrices D with determinant 1. Invent a 
group containing only positive definite matrices.
6.3 Singular Value Decomposition 367 
6.3 Singular Value Decomposition 
A great matrix factorization has been saved for the end of the basic course. USVT joins 
with LU from elimination and QR from orthogonalization (Gauss and Gram-Schmidt). 
Nobody’s name is attached; A = USVT is known as the “SVD” or the singular value 
decomposition. We want to describe it, to prove it, and to discuss its applications— 
which are many and growing. 
The SVD is closely associated with the eigenvalue-eigenvector factorization QLQT of 
a positive definite matrix. The eigenvalues are in the diagonal matrix L. The eigenvector 
matrix Q is orthogonal (QTQ = I) because eigenvectors of a symmetric matrix can be 
chosen to be orthonormal. For most matrices that is not true, and for rectangular matrices 
it is ridiculous (eigenvalues undefined). But now we allow the Q on the left and the QT 
on the right to be any two orthogonal matrices U and VT—not necessarily transposes of 
each other. Then every matrix will split into A =USVT. 
The diagonal (but rectangular) matrix S has eigenvalues from ATA, not from A! Those 
positive entries (also called sigma) will be s1; : : : ;sr. They are the singular values of A. 
They fill the first r places on the main diagonal of S—when A has rank r. The rest of S 
is zero. 
With rectangular matrices, the key is almost always to consider ATA and AAT. 
Singular Value Decomposition: Any m by n matrix A can be factored 
into 
A =USVT = (orthogonal)(diagonal)(orthogonal): 
The columns of U (m by m) are eigenvectors of AAT, and the columns of V (n 
by n) are eigenvectors of ATA. The r singular values on the diagonal of S (m 
by n) are the square roots of the nonzero eigenvalues of both AAT and ATA. 
Remark 1. For positive definite matrices, S is L and USVT is identical to QLQT. For 
other symmetric matrices, any negative eigenvalues in L become positive in S. For 
complex matrices, S remains real but U and V become unitary (the complex version of 
orthogonal). We take complex conjugates in UHU = I and VHV = I and A =USVH. 
Remark 2. U and V give orthonormal bases for all four fundamental subspaces: 
first r columns of U: column space of A 
last m.r columns of U: left nullspace of A 
first r columns of V: row space of A 
last n.r columns of V: nullspace of A 
Remark 3. The SVD chooses those bases in an extremely special way. They are more 
than just orthonormal. When A multiplies a column v j of V, it produces s j times a 
column of U. That comes directly from AV =US, looked at a column at a time.
368 Chapter 6 Positive Definite Matrices 
Remark 4. Eigenvectors of AAT and ATA must go into the columns of U and V: 
AAT = (USVT)(VSTUT) =USSTUT and, similarly, ATA =VSTSVT: (1) 
U must be the eigenvector matrix for AAT. The eigenvalue matrix in the middle is SST— 
which is m by m with s 2 
1 ; : : : ;s 2 
r on the diagonal. 
From the ATA =VSTSVT, the V matrix must be the eigenvector matrix for ATA. The 
diagonal matrix STS has the same s 2 
1 ; : : : ;s 2 
r , but it is n by n. 
Remark 5. Here is the reason that Avj =s juj. Start with ATAvj =s2j
v j: 
Multiply by A AATAv j =s2j
Avj (2) 
This says that Avj is an eigenvector of AAT! We just moved parentheses to (AAT)(Avj). 
The length of this eigenvector Avj is s j, because 
vTATAv j =s2j
vTj
v j gives kAvjk2 =s2j
: 
So the unit eigenvector is Avj=s j = uj. In other words, AV =US. 
Example 1. This A has only one column: rank r = 1. Then S has only s1 = 3: 
SVD A = 
2
64
.1 
2
2 
3
75
= 
2
64
.13 
23 
23
23
.13 
23
23 
23
.13 
3
75 
2
64
3
0
0
3
75
h
1
i 
=U3.3S3.1VT 
1.1: 
ATA is 1 by 1, whereas AAT is 3 by 3. They both have eigenvalue 9 (whose square root 
is the 3 in S). The two zero eigenvalues of AAT leave some freedom for the eigenvectors 
in columns 2 and 3 of U. We kept that matrix orthogonal. 
Example 2. Now A has rank 2, and AAT = 
" 
2 .1 
.1 2 
# 
with l = 3 and 1: 
"
.1 1 0 
0 .1 1
# 
=USVT = 
1 
p
2 
"
.1 1 
1 1
#"p
3 0 0 
0 1 0
#2
64
1 .2 1 
.1 0 1 
1 1 1
3
75
=
p
6 
=
p
2 
=
p
3 
: 
Notice 
p
3 and 
p
1. The columns of U are left singular vectors (unit eigenvectors of 
AAT). The columns of V are right singular vectors (unit eigenvectors of ATA). 
Application of the SVD 
We will pick a few important applications, after emphasizing one key point. The SVD is 
terrific for numerically stable computations. because U and V are orthogonal matrices. 
They never change the length of a vector. Since kUxk2 =xTUTUx=kxk2, multiplication 
by U cannot destroy the scaling.
6.3 Singular Value Decomposition 369 
Of course S could multiply by a large s or (more commonly) divide by a small s , 
and overflow the computer. But still S is as good as possible. It reveals exactly what is 
large and what is small. The ratio smax=smin is the condition number of an invertible n 
by n matrix. The availability of that information is another reason for the popularity of 
the SVD. We come back to this in the second application. 
1. Image processing Suppose a satellite takes a picture, and wants to send it to Earth. 
The picture may contain 1000 by 1000 “pixels”—a million little squares, each with a 
definite color. We can code the colors, and send back 1,000,000 numbers. It is better to 
find the essential information inside the 1000 by 1000 matrix, and send only that. 
Suppose we know the SVD. The key is in the singular values (in S). Typically, some 
s ’s are significant and others are extremely small. If we keep 20 and throw away 980, 
then we send only the corresponding 20 columns of U and V. The other 980 columns 
are multiplied in USVT by the small s ’s that are being ignored. We can do the matrix 
multiplication as columns times rows: 
A =USVT = u1s1vT1
+u2s2vT2
+. . .+ursrvTr
: (3) 
Any matrix is the sum of r matrices of rank 1. If only 20 terms are kept, we send 20 
times 2000 numbers instead of a million (25 to 1 compression). 
The pictures are really striking, as more and more singular values are included. At 
first you see nothing, and suddenly you recognize everything. The cost is in computing 
the SVD—this has become much more efficient, but it is expensive for a big matrix. 
2. The effective rank The rank of a matrix is the number of independent rows, and 
the number of independent columns. That can be hard to decide in computations! In 
exact arithmetic, counting the pivots is correct. Real arithmetic can be misleading—but 
discarding small pivots is not the answer. Consider the following: 
e is small 
"
e 2e 
1 2 
# 
and 
"
e 1 
0 0
# 
and 
"
e 1 
e 1+e
#
: 
The first has rank 1, although roundoff error will probably produce a second pivot. Both 
pivots will be small; how many do we ignore? The second has one small pivot, but we 
cannot pretend that its row is insignificant. The third has two pivots and its rank is 2, but 
its “effective rank” ought to be 1. 
We go to a more stable measure of rank. The first step is to use ATA or AAT, which 
are symmetric but share the same rank as A. Their eigenvalues—the singular values 
squared—are not misleading. Based on the accuracy of the data, we decide on a tolerance 
like 10.6 and count the singular values above it—that is the effective rank. The 
examples above have effective rank 1 (when e is very small). 
3. Polar decomposition Every nonzero complex number z is a positive number r times
370 Chapter 6 Positive Definite Matrices 
a number eiq on the unit circle: z = reiq . That expresses z in “polar coordinates.” If 
we think of z as a 1 by 1 matrix, r corresponds to a positive definite matrix and eiq 
corresponds to an orthogonal matrix. More exactly, since eiq is complex and satisfies 
e.iq eiq = 1, it forms a 1 by 1 unitary matrix: UHU = I. We take the complex conjugate 
as well as the transpose, for UH. 
The SVD extends this “polar factorization” to matrices of any size: 
Every real square matrix can be factored into A = QS, where Q is orthogonal 
and S is symmetric positive semidefinite. If A is invertible then S is positive 
definite. 
For proof we just insert VTV = I into the middle of the SVD: 
A =USVT = (UVT)(VSVT): (4) 
The factor S =VSVT is symmetric and semidefinite (because S is). The factor Q =UVT 
is an orthogonal matrix (because QTQ=VUTUVT =I). In the complex case, S becomes 
Hermitian instead of symmetric and Q becomes unitary instead of orthogonal. In the 
invertible case S is definite and so is S. 
Example 3. Polar decomposition: 
A = QS 
"
1 .2 
3 .1
# 
= 
"
0 .1 
1 0 
#" 
3 .1 
.1 2 
#
: 
Example 4. Reverse polar decomposition: 
A = S0Q 
"
1 .2 
3 .1
# 
= 
"
2 1 
1 3
#"
0 .1 
1 0 
#
: 
The exercises show how, in the reverse order. S changes but Q remains the same. Both 
S and S0 are symmetric positive definite because this A is invertible. 
Application of A = QS: A major use of the polar decomposition is in continuum 
mechanics (and recently in robotics). In any deformation, it is important to separate 
stretching from rotation, and that is exactly what QS achieves. The orthogonal matrix 
Q is a rotation, and possibly a reflection. The material feels no strain. The symmetric 
matrix S has eigenvalues s1; : : : ;sr, which are the stretching factors (or compression 
factors). The diagonalization that displays those eigenvalues is the natural choice of 
axes—called principal axes: as in the ellipses of Section 6.2. It is S that requires work 
on the material, and stores up elastic energy. 
We note that S2 is ATA, which is symmetric positive definite when A is invertible. S 
is the symmetric positive definite square root of ATA, and Q is AS.1. In fact, A could be 
rectangular, as long as ATA is positive definite. (That is the condition we keep meeting,
6.3 Singular Value Decomposition 371 
that A must have independent columns.) In the reverse order A = S0Q, the matrix S0 is 
the symmetric positive definite square root of AAT. 
4. Least Squares For a rectangular system Ax = b. the least-squares solution comes 
from the normal equations ATAbx = ATb. If A has dependent columns then ATA is not 
invertible and bx is not determined. Any vector in the nullspace could be added to bx. We 
can now complete Chapter 3, by choosing a “best” (shortest) bx for every Ax = b. 
Ax = b has two possible difficulties: Dependent rows or dependent columns. With 
dependent rows, Ax = b may have no solution. That happens when b is outside the 
column space of A. Instead of Ax = b. we solve ATAbx = ATb. But if A has dependent 
columns, this bx will not be unique. We have to choose a particular solution of ATAbx = 
ATb, and we choose the shortest. 
The optimal solution of Ax = b is the minimum length solution of ATAbx = ATb. 
That minimum length solution will be called x+. It is our preferred choice as the best 
solution to Ax = b (which had no solution), and also to ATAbx = ATb (which had too 
many). We start with a diagonal example. 
Example 5. A is diagonal, with dependent rows and dependent columns: 
Abx = p is 
2
64
s1 0 0 0 
0 s2 0 0 
0 0 0 0
3
75 
2
6664 
bx1 
bx2 
bx3 
bx4
3
7775
= 
2
64
b1 
b2 
0 
3
75
: 
The columns all end with zero. In the column space, the closest vector to b = (b1;b2;b3) 
is p = (b1;b2;0). The best we can do with Ax = b is to solve the first two equations, 
since the third equation is 0 = b3. That error cannot be reduced, but the errors in the first 
two equations will be zero. Then 
bx1 = b1=s1 and bx2 = b2=s2: 
Now we face the second difficulty. To make bx as short as possible, we choose the 
totally arbitrary bx3 and bx4 to be zero. The minimum length solution is x+: 
A+ is pseudoinverse 
x+ = A+b is shortest 
x+ = 
2
6664 
b1=s1 
b2=s2 
0
0 
3
7775
= 
2
6664 
1=s1 0 0 
0 1=s2 0 
0 0 0 
0 0 0
3
7775 
2
64
b1 
b2 
b3
3
75
: (5) 
This equation finds x+, and it also displays the matrix that produces x+ from b. That 
matrix is the pseudoinverse A+ of our diagonal A. Based on this example, we know S+
372 Chapter 6 Positive Definite Matrices 
and x+ for any diagonal matrix S: 
S = 
2
6664 
s1 
. . . 
sr 
3
7775
S+ = 
2
6664 
1=s1 
. . . 
1=sr 
3
7775
S+b = 
2
6664 
b1=s1 
... 
br=sr
3
7775
: 
The matrix S is m by n, with r nonzero entries si. Its pseudoinverse S+ is n by m, with 
r nonzero entries 1=si. All the blank spaces are zeros. Notice that (S+)+ is S again. 
That is like (A.1).1 = A, but here A is not invertible. 
Now we find x+ in the general case. We claim that the shortest solution x+ is always 
in the row space of A. Remember that any vector bx can be split into a row space component 
xr and a nullspace component: bx = xr +xn. There are three important points about 
that splitting: 
1. The row space component also solves ATAbxr = ATb, because Axn = 0. 
2. The components are orthogonal, and they obey Pythagoras’s law: 
kbxk2 = kxrk2+kxnk2; so bx is shortest when xn = 0. 
3. All solutions of ATAbx = ATb have the same xr. That vector is x+. 
The fundamental theorem of linear algebra was in Figure 3.4. Every p in the column 
space comes from one and only one vector xr in the row space. All we are doing is to 
choose that vector, x+ = xr, as the best solution to Ax = b. 
The pseudoinverse in Figure 6.3 starts with b and comes back to x+. It inverts A where 
A is invertible—between row space and column space. The pseudoinverse knocks out 
the left nullspace by sending it to zero, and it knocks out the nullspace by choosing xr as 
x+.
We have not yet shown that there is a matrix A+ that always gives x+—but there is. 
It will be n by m, because it takes b and p in Rm back to x+ in Rn. We look at one more 
example before finding A+ in general. 
Example 6. Ax = b is .x1+2x2+2x3 = 18, with a whole plane of solutions. 
According to our theory, the shortest solution should be in the row space of A = 
[.1 2 2]. The multiple of that row that satisfies the equation is x+ = (.2;4;4). There 
are longer solutions like (.2;5;3), (.2;7;1), or (.6;3;3), but they all have nonzero 
components from the nullspace. The matrix that produces x+ from b = [18] is the pseudoinverse 
A+. Whereas A was 1 by 3, this A+ is 3 by 1: 
A+ = 
h
.1 2 2
i+ 
= 
2
64
.19
2929 
3
75
and A+[18] = 
2
64
.2 
4
4 
3
75
: (6)
6.3 Singular Value Decomposition 373 
Figure 6.3: The pseudoinverse A+ inverts A where it can on the column space. 
The row space of A is the column space of A+. Here is a formula for A+: 
If A =USVT (the SVD), then its pseudoinverse is A+ =VS+UT: (7) 
Example 6 had s = 3—the square root of the eigenvalue of AAT = [9]. Here it is again 
with S and S+: 
A = 
h
.1 2 2
i 
=USVT = 
h
1
ih
3 0 0
i
2
64
.13 
23 
23
23
.13 
23
23 23
.13 
3
75 
VS+UT = 
2
64
.13 
23 
23
23
.13 
23
23 
23
.13 
3
75 
2
64 
130 0
3
75
h
1
i 
= 
2
64
.19
2929 
3
75
= A+: 
The minimum length least-squares solution is x+ = A+b =VS+UTb. 
Proof. Multiplication by the orthogonal matrix UT leaves lengths unchanged: 
kAx.bk = kUSVTx.bk = kSVTx.UTbk: 
Introduce the new unknown y = VTx = V.1x, which has the same length as x. Then, 
minimizing kAx.bk is the same as minimizing kSy.UTbk. Now S is diagonal and we 
know the best y+. It is y+ = S+UTb so the best x+ is Vy+: 
Shortest solution x+ =Vy+ =VS+UTb = A+b: 
Vy+ is in the row space, and ATAx+ = ATb from the SVD.
374 Chapter 6 Positive Definite Matrices 
Problem Set 6.3 
Problems 1–2 compute the SVD of a square singular matrix A. 
1. Compute ATA and its eigenvalues s 2 
1 , 0 and unit eigenvectors v1, v2: 
A = 
"
1 4 
2 8
#
: 
2. (a) Compute AAT and its eigenvalues s 2 
1 , 0 and unit eigenvectors u1, u2. 
(b) Choose signs so that Av1 =s1u1 and verify the SVD: 
"
1 4 
2 8
# 
= 
h
u1 u2
i"
s1 
0
#h
v1 v2
iT 
: 
(c) Which four vectors give orthonormal bases for C(A), N(A), C(AT), N(AT)? 
Problems 3–5 ask for the SVD of matrices of rank 2. 
3. Find the SVD from the eigenvectors v1, v2 of ATA and Avi =siui: 
Fibonacci matrix A = 
"
1 1 
1 0
#
: 
4. Use the SVD part of the MATLAB demo eigshow (or Java on the course page 
web.mit.edu/18.06) to find the same vectors v1 and v2 graphically. 
5. Compute ATA and AAT, and their eigenvalues and unit eigenvectors, for 
A = 
"
1 1 0 
0 1 1
#
: 
Multiply the three matrices USVT to recover A. 
Problems 6–13 bring out the underlying ideas of the SVD. 
6. Suppose u1; : : : ;un and v1; : : : ;vn are orthonormal bases for Rn. Construct the matrix 
A that transforms each vj into uj to give Av1 = u1; : : : ;Avn = un. 
7. Construct the matrix with rank 1 that has Av = 12u for v = 12
(1;1;1;1) and u = 
13
(2;2;1). Its only singular value is s1 = . 
8. Find USVT if A has orthogonal columns w1; : : : ;wn of lengths s1; : : : ;sn. 
9. Explain how USVT expresses A as a sum of r rank-1 matrices in equation (3): 
A =s1u1vT1
+. . .+srurvTr
:
6.3 Singular Value Decomposition 375 
10. Suppose A is a 2 by 2 symmetric matrix with unit eigenvectors u1 and u2. If its 
eigenvalues are l1 = 3 and l2 = .2, what are U, S, and VT? 
11. Suppose A is invertible (withs1 >s2 >0). Change A by as small a matrix as possible 
to produce a singular matrix A0. Hint: U and V do not change: 
Find A0 from A = 
h
u1 u2
i"
s1 
s2
#h
v1 v2
iT 
: 
12. (a) If A changes to 4A, what is the change in the SVD? 
(b) What is the SVD for AT and for A.1? 
13. Why doesn’t the SVD for A+I just use S+I? 
14. Find the SVD and the pseudoinverse 0+ of the m by n zero matrix. 
15. Find the SVD and the pseudoinverse VS+UT of 
A = 
h
1 1 1 1
i
; B = 
"
0 1 0 
1 0 0
#
; and C = 
"
1 1 
0 0
#
: 
16. If an m by n matrix Q has orthonormal columns, what is Q+? 
17. Diagonalize ATA to find its positive definite square root S = VS1=2VT and its polar 
decomposition A = QS: 
A = 
1 
p
10 
"
10 6 
0 8
#
: 
18. What is the minimum-length least-squares solution x+ = A+b to the following? 
Ax = 
2
64
1 0 0 
1 0 0 
1 1 1
3
75 
2
64C
D
E
3
75
= 
2
64
0
2
2
3
75
: 
You can compute A+, or find the general solution to ATAbx = ATb and choose the 
solution that is in the row space of A. This problem fits the best plane C+Dt+Ez to 
b = 0 and also b = 2 at t = z = 0 (and b = 2 at t = z = 1). 
(a) If A has independent columns, its left-inverse (ATA).1AT is A+. 
(b) If A has independent rows, its right-inverse AT(AAT).1 is A+. 
In both cases, verify that x+ = A+b is in the row space. and ATAx+ = ATb. 
19. Split A =USVT into its reverse polar decomposition QS0. 
20. Is (AB)+ = B+A+ always true for pseudoinverses? I believe not.
376 Chapter 6 Positive Definite Matrices 
21. Removing zero rows ofU leaves A = LU, where the r columns or L span the column 
space of A and the r rows of U span the row space. Then A+ has the explicit formula 
UT(U UT).1(LTL).1LT. 
Why is A+b in the row space with UT at the front? Why does ATAA+b = ATb, so 
that x+ = A+b satisfies the normal equation as it should? 
22. Explain why AA+ and A+A are projection matrices (and therefore symmetric). What 
fundamental subspaces do they project onto? 
6.4 Minimum Principles 
In this section we escape for the first time from linear equations. The unknown x will not 
be given as the solution to Ax = b or Ax =l x. Instead, the vector x will be determined 
by a minimum principle. 
It is astonishing how many natural laws can be expressed as minimum principles. Just 
the fact that heavy liquids sink to the bottom is a consequence of minimizing their potential 
energy. And when you sit on a chair or lie on a bed, the springs adjust themselves 
so that the energy is minimized. A straw in a glass of water looks bent because light 
reaches your eye as quickly as possible. Certainly there are more highbrow examples: 
The fundamental principle of structural engineering is the minimization of total energy.1 
We have to say immediately that these “energies” are nothing but positive definite 
quadratic functions. And the derivative of a quadratic is linear. We get back to the 
familiar linear equations, when we set the first derivatives to zero. Our first goal in 
this section is to find the minimum principle that is equivalent to Ax = b, and the 
minimization equivalent to Ax = l x. We will be doing in finite dimensions exactly 
what the theory of optimization does in a continuous problem, where “first derivatives 
= 0” gives a differential equation. In every problem, we are free to solve the linear 
equation or minimize the quadratic. 
The first step is straightforward: We want to find the “parabola” P(x) whose minimum 
occurs when Ax = b. If A is just a scalar, that is easy to do: 
The graph of P(x) = 
1
2
Ax2.bx has zero slope when 
dP 
dx 
= Ax.b = 0: 
This point x = A.1b will be a minimum if A is positive. Then the parabola P(x) opens 
upward (Figure 6.4). In more dimensions this parabola turns into a parabolic bowl (a 
paraboloid). To assure a minimum of P(x), not a maximum or a saddle point, A must be 
positive definite! 
1I am convinced that plants and people also develop in accordance with minimum principles. Perhaps civilization 
is based on a law of least action. There must be new laws (and minimum principles) to be found in the social 
sciences and life sciences.
6.4 Minimum Principles 377 
6H If A is symmetric positive definite, then P(x) = 12
xTAx.xTb reaches its 
minimum at the point where Ax = b. At that point Pmin = .12
bTA.1b. 
Figure 6.4: The graph of a positive quadratic P(x) is a parabolic bowl. 
Proof. Suppose Ax = b. For any vector y, we show that P(y) . P(x): 
P(y).P(x) = 
1
2
yTAy.yTb. 
1
2
xTAx+xTb 
= 
1
2
yTAy.yTAx+ 
1
2
xTAx (set b = Ax) 
= 
1
2
(y.x)TA(y.x): 
(1) 
This can’t be negative since A is positive definite—and it is zero only if y.x = 0. At all 
other points P(y) is larger than P(x), so the minimum occurs at x. 
Example 1. Minimize P(x) = x2
1 .x1x2 +x2
2 .b1x1 .b2x2. The usual approach, by 
calculus, is to set the partial derivatives to zero. This gives Ax = b: 
¶ P=¶ x1 = 2x1.x2.b1 = 0 
¶ P=¶ x2 = .x1+2x2.b2 = 0 
means 
" 
2 .1 
.1 2 
#"
x1 
x2
# 
= 
"
b1 
b2
#
: (2) 
Linear algebra recognizes this P(x) as 1
2xTAx.xTb, and knows immediately that Ax = b 
gives the minimum. Substitute x = A.1b into P(x): 
Minimum value Pmin = 
1
2
(A.1b)TA(A.1b).(A.1b)Tb = .
1
2
bTA.1b: (3) 
In applications, 12
xTAx is the internal energy and .xTb is the external work. The system 
automatically goes to x = A.1b, where the total energy P(x) is a minimum. 
Minimizing with Constraints 
Many applications add extra equations Cx = d on top of the minimization problem. 
These equations are constraints. We minimize P(x) subject to the extra requirement 
Cx = d. Usually x can’t satisfy n equations Ax = b and also ` extra constraints Cx = d. 
We have too many equations and we need ` more unknowns.
378 Chapter 6 Positive Definite Matrices 
Those new unknowns y1; : : : ;y` are called Lagrange multipliers. They build the 
constraint into a function L(x;y). This was the brilliant insight of Lagrange: 
L(x;y) = P(x)+yT(Cx.d) = 
1
2
xTAx.xTb+xTCTy.yTd: 
That term in L is chosen exactly so that ¶ L=¶ y = 0 brings back Cx = d. When we set 
the derivatives of L to zero, we have n+` equations for n+` unknowns x and y: 
Constrained 
minimization 
¶ L=¶ x = 0 : 
¶ L=¶ y = 0 : 
Ax+CTy = b 
Cx = d 
(4) 
The first equations involve the mysterious unknowns y. You might well ask what they 
represent. Those “dual unknowns” y tell how much the constrained minimum PC=min 
(which only allows x when Cx = d) exceeds the unconstrained Pmin (allowing all x): 
Sensitivity of minimum PC=min = Pmin+ 
1
2
yT(CA.1b.d) . Pmin: (5) 
Example 2. Suppose P(x1;x2) = 12
x2
1 + 12
x2
2. Its smallest value is certainly Pmin = 0. 
This unconstrained problem has n = 2, A = I, and b = 0. So the minimizing equation 
Ax = b just gives x1 = 0 and x2 = 0. 
Now add one constraint c1x1 +c2x2 = d. This puts x on a line in the x1-x2 plane. 
The old minimizer x1 = x2 = 0 is not on the line. The Lagrangian function L(x;y) = 
12
x2
1+ 12
x2
2+y(c1x1+c2x2.d) has n+` = 2+1 partial derivatives: 
¶ L=¶ x1 = 0 
¶ L=¶ x2 = 0 
¶ L=¶ y = 0 
x1+c1y = 0 
x2+c2y = 0 
c1x1+c2x2 = d: 
(6) 
Substituting x1 = .c1y and x2 = .c2y into the third equation gives .c21
y.c22
y = d. 
Solution y = 
.d 
c21
+c22x1 = 
c1d 
c21
+c22
x2 = 
c2d 
c21
+c22
: (7) 
The constrained minimum of P = 12
xTx is reached at that solution point: 
PC=min = 
1
2
x2
1+ 
1
2
x2
2 = 
1
2 
c21
d2+c22
d2 
(c21
+c22
)2 = 
1
2 
d2 
c21
+c22
: (8) 
This equals .12yd as predicted in equation (5), since b = 0 and Pmin = 0. 
Figure 6.5 shows what problem the linear algebra has solved, if the constraint keeps 
x on a line 2x1.x2 = 5. We are looking for the closest point to (0;0) on this line. The 
solution is x = (2;.1). We expect this shortest vector x to be perpendicular to the line, 
and we are right.
6.4 Minimum Principles 379 
Figure 6.5: Minimizing 12
kxk2 for all x on the constraint line 2x1.x2 = 5. 
Least Squares Again 
In minimization, our big application is least squares. The best bx is the vector that minimizes 
the squared error E2 = kAx.bk2. This is a quadratic and it fits our framework! I 
will highlight the parts that look new: 
Squared error E2 = (Ax.b)T(Ax.b) = xTATAx.2xTATb+bTb: (9) 
Compare with 12
xTAx.xTb at the start of the section, which led to Ax = b: 
.
A changes to ATA
¤ .
b changes to ATb
¤ .
bTb is added
¤ 
: 
The constant bTb raises the whole graph—this has no effect on the best bx. The other 
two changes, A to ATA and b to ATb, give a new way to reach the least-squares equation 
(normal equation). The minimizing equation Ax = b changes into the 
Least-squares equation ATAbx = ATb: (10) 
Optimization needs a whole book. We stop while it is pure linear algebra. 
The Rayleigh quotient 
Our second goal is to find a minimization problem equivalent to Ax =l x. That is not so 
easy. The function to minimize cannot be a quadratic, or its derivative would be linear— 
and the eigenvalue problem is nonlinear (l times x). The trick that succeeds is to divide 
one quadratic by another one: 
Rayleigh quotient Minimize R(x) = 
xTAx 
xTx 
: 
6I Rayleigh’s Principle: The minimum value of the Rayleigh quotient is 
the smallest eigenvalue l1. R(x) reaches that minimum at the first eigenvector 
x1 of A: 
Minimum where Ax1 =l x1 R(x1) = 
xT
1Ax1 
xT
1 x1 
= 
xT
1l1x1 
xT
1 x1 
=l1:
380 Chapter 6 Positive Definite Matrices 
If we keep xTAx = 1, then R(x) is a minimum when xTx = kxk2 is as large as possible. 
We are looking for the point on the ellipsoid xTAx = 1 farthest from the origin—the 
vector x of greatest length. From our earlier description of the ellipsoid, its longest axis 
points along the first eigenvector. So R(x) is a minimum at x1. 
Algebraically, we can diagonalize the symmetric A by an orthogonal matrix: QTAQ= 
L. Then set x = Qy and the quotient becomes simple: 
R(x) = 
(Qy)TA(Qy) 
(Qy)T(Qy) 
= 
yTLy 
yTy 
= 
l1y21
+. . .+lny2n 
y21
+. . .+y2n
: (11) 
The minimum of R is l1, at the point where y1 = 1 and y2 = . . . = yn = 0: 
At all points l1(y21
+y22
+. . .+y2n
) · (l1y21
+l2y22
+. . .+lny2n
): 
The Rayleigh quotient in equation (11) is never belowl1 and never above ln (the largest 
eigenvalue). Its minimum is at the eigenvector x1 and its maximum is at xn: 
Maximum where Axn =lnxn R(xn) = 
xT
nAxn 
xT
n xn 
= 
xT
nlnxn 
xT
n xn 
=ln: 
One small yet important point: The Rayleigh quotient equals a11, when the trial vector 
is x = (1;0; : : : ;0). So a11 (on the main diagonal) is between l1 and ln. You can see this 
in Figure 6.6, where the horizontal distance to the ellipse (where a11x2 = 1) is between 
the shortest distance and the longest distance: 
1 
p
ln 
· 
1 
p
a11 
· 
1 
p
l1 
which is l1 · a11 ·ln: 
The diagonal entries of any symmetric matrix are between l1 and ln. We drew Figure 
6.6 for a 2 by 2 positive definite matrix to see it clearly. 
Intertwining of the Eigenvalues 
The intermediate eigenvectors x2; : : : ;xn.1 are saddle points of the Rayleigh quotient 
(zero derivatives, but not minima or maxima). The difficulty with saddle points is that 
we have no idea whether R(x) is above or below them. That makes the intermediate 
eigenvalues l2; : : : ;ln.1 harder to estimate. 
For this optional topic, the key is to find a constrained minimum or maximum. The 
constraints come from the basic property of symmetric matrices: xj is perpendicular to 
the other eigenvectors. 
6J The minimum of R(x) subject to xTx1 = 0 is l2. The minimum of R(x) 
subject to any other constraint xTv = 0 is not above l2: 
l2 = min 
xTx1=0
R(x) and l2 . min 
xTv=0
R(x): (12)
6.4 Minimum Principles 381 
b 
b 
b 
1/
p
1 
1/
p
a11 
1/
p
n 
ellipse x
T
Ax = 1 
Figure 6.6: The farthest x = x1=
p
l1 and the closet x = xn=
p
ln both give xTAx = xTl x = 1: These are the major 
axes of the ellipse. 
This “maximin principle” makes l2 the maximum over all v of the minimum of R(x) with 
xTv = 0. That offers a way to estimate l2 without knowing l1. 
Example 3. Throw away the last row and column of any symmetric matrix: 
l1(A) = 2.
p
2 
l2(A) = 2 
l3(A) = 2+
p
2 
A = 
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75
becomes B = 
" 
2 .1 
.1 2 
#
l1(B) = 1 
l2(B) = 3: 
The second eigenvalue l2(A) = 2 is above the lowest eigenvalue l1(B) = 1. The lowest 
eigenvalue l1(A) = 2.
p
2 is below l1(B). So l1(B) is caught between. 
This example chose v = (0;0;1) so the constraint xTv = 0 knocked out the third component 
of x (thereby reducing A to B). 
The complete picture is an intertwining of eigenvalues: 
l1(A) ·l1(B) ·l2(A) ·l2(B) · . . . ·ln.1(B) ·ln(A): (13) 
This has a natural interpretation for an ellipsoid, when it is cut by a plane through the 
origin. The cross section is an ellipsoid of one lower dimension. The major axis Of this 
cross section cannot be longer than the major axis of the whole ellipsoid: l1(B).l1(A). 
But the major axis of the cross section is at least as long as the second axis of the original 
ellipsoid: l1(B) · l2(A). Similarly the minor axis of the cross section is smaller than 
the original second axis, and larger than the original minor axis: l2(A)·l2(B)·l3(A). 
You can see the same thing in mechanics. When springs and masses are oscillating, 
suppose one mass is held at equilibrium. Then the lowest frequency is increased but not 
above l2. The highest frequency is decreased, but not below ln.1. 
We close with three remarks, I hope your intuition says that they are correct.
382 Chapter 6 Positive Definite Matrices 
Remark 1. The maximin principle extends to j-dimensional subspaces Sj: 
Maximum of minimum l j+1 = max 
all Sj 
·
min 
x?Sj 
R(x)
.
: (14) 
Remark 2. There is also a minimax principle for ln.j: 
Minimum of maximum ln.j = min 
all Sj 
·
max 
x?Sj 
R(x)
.
: (15) 
If j =1, we are maximizing R(x) over one constraint xTv=0. That maximum is between 
the unconstrained ln.1 and ln. The toughest constraint makes x perpendicular to the top 
eigenvector v = xn. Then the best x is the next eigenvector xn.1. The “minimum of the 
maximum” is ln.1. 
Remark 3. For the generalized problem Ax = lMx, the same principles hold if M is 
positive definite. In the Rayleigh quotient, xTx becomes xTMx: 
Rayleigh quotient Minimizing R(x) = 
xTAx 
xTMx 
gives l1(M.1A): (16) 
Even for unequal masses in an oscillating system (M 6= I), holding one mass at equilibrium 
will raise the lowest frequency and lower the highest frequency. 
Problem Set 6.4 
1. Consider the system Ax = b given by 
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75 
2
64
x1 
x2 
x3
3
75
= 
2
64
4
0
4
3
75
: 
Construct the corresponding quadratic P(x1;x2;x3), compute its partial derivatives 
¶ P=¶ xi, and verify that they vanish exactly at the desired solution. 
2. Complete the square in P = 12xTAx.xTb = 12
(x.A.1b)TA(x.A.1b)+constant. 
This constant equals Pmin because the term before it is never negative. (Why?) 
3. Find the minimum, if there is one of P1 = 12
x2+xy+y2.3y and P2 = 12
x2.3y. What 
matrix A is associated with P2? 
4. (Review) Another quadratic that certainly has its minimum at Ax = b is 
Q(x) = 
1
2
kAx.bk2 = 
1
2
xTATAx.xTATb+ 
1
2
bTb: 
Comparing Q with P, and ignoring the constant 12
bTb, what system of equations do 
we get at the minimum of Q? What are these equations called in the theory of least 
squares?
6.4 Minimum Principles 383 
5. For any symmetric matrix A, compute the ratio R(x) for the special choice x = 
(1; : : : ;1). How is the sum of all entries ai j related to l1 and ln? 
6. With A = 
. 2 .1 
.1 2 
¤
, find a choice of x that gives a smaller R(x) than the bound l1 · 2 
that comes from the diagonal entries. What is the minimum value of R(x)? 
7. If B is positive definite, show from the Rayleigh quotient that the smallest eigenvalue 
of A+B is larger than the smallest eigenvalue of A. 
8. If l1 and m1 are the smallest eigenvalues of A and B, show that the smallest eigenvalue 
q1 of A+B is at least as large as l1+m1. (Try the corresponding eigenvector 
x in the Rayleigh quotients.) 
Note. Problems 7 and 8 are perhaps the most typical and most important results 
that come easily from Rayleigh’s principle, but only with great difficulty from the 
eigenvalue equations themselves. 
9. If B is positive definite, show from the minimax principle (12) that the second smallest 
eigenvalue is increased by adding B : l2(A+B) >l2(A). 
10. If you throw away two rows and columns of A, what inequalities do you expect 
between the smallest eigenvalue m of the new matrix and the original l ’s? 
11. Find the minimum values of 
R(x) = 
x2
1.x1x2+x2
2 
x2
1+x2
2 
and R(x) = 
x2
1.x1x2+x2
2 
2x2
1+x2
2 
: 
12. Prove from equation (11) that R(x) is never larger than the largest eigenvalue ln. 
13. The minimax principle for l j involves j-dimensional subspaces Sj: 
Equivalent to equation (15) l j = min 
Sj 
·
max 
x in Sj 
R(x)
.
: 
(a) If l j is positive, infer that every Sj contains a vector x with R(x) > 0. 
(b) Deduce that Sj contains a vector y =C.1x with yTcTACy=yTy > 0. 
(c) Conclude that the jth eigenvalue of CTAC, from its minimax principle, is also 
positive—proving again the law of inertia in Section 6.2. 
14. Show that the smallest eigenvalue l1 of Ax=lMx is not larger than the ratio a11=m11 
of the corner entries. 
15. Which particular subspace S2 in Problem 13 gives the minimum value l2? In other 
words, over which S2 is the maximum of R(x) equal to l2?
384 Chapter 6 Positive Definite Matrices 
16. (Recommended) From the zero submatrix decide the signs of the n eigenvalues: 
A = 
2
6664 
0 . 0 1 
. . 0 2 
0 0 0 . 
1 2 . n
3
7775
: 
17. (Constrained minimum) Suppose the unconstrained minimum x = A.1b happens to 
satisfy the constraint Cx = d. Verify that equation (5) correctly gives PC=min = Pmin; 
the correction term is zero. 
6.5 The Finite Element Method 
There were two main ideas in the preceding section on minimum principles: 
(i) Solving Ax = b is equivalent to minimizing P(x) = 12
xTAx.xTb. 
(ii) Solving Ax =l1x is equivalent to minimizing R(x) = xTAx=xTx. 
Now we try to explain how these ideas can be applied. 
The story is a long one, because these principles have been known for more than a 
century. In engineering problems like plate bending, or physics problems like the ground 
state (eigenfunction) of an atom, minimization was used to get a rough approximation 
to the true solution. The approximations had to be rough; the computers were human. 
The principles (i) and (ii) were there, but they could not be implemented. 
Obviously the computer was going to bring about a revolution. It was the method 
of finite differences that jumped ahead, because it is easy to “discretize” a differential 
equation. Already in Section 1.7, derivatives were replaced by differences. The physical 
region is covered by a mesh, and u00 = f (x) became uj+1 .2uj +uj.1 = h2 f j. The 
1950s brought new ways to solve systems Au = f that are very large and very sparse— 
algorithms and hardware are both much faster now. 
What we did not fully recognize was that even finite differences become incredibly 
complicated for real engineering problems, like the stresses on an airplane. The real 
difficulty is not to solve the equations, but to set them up. For an irregular region we 
piece the mesh together from triangles or quadrilaterals or tetrahedra. Then we need a 
systematic way to approximate the underlying physical laws. The computer has to help 
not only in the solution of Au = f and Ax =l x, but in its formulation. 
You can guess what happened. The old methods came back, with a new idea and a 
new name. The new name is the finite element method. The new ides uses more of 
the power of the computer—in constructing a discrete approximation, solving it, and 
displaying the results—than any other technique in scientific computation2. If the basic 
2Please forgive this enthusiasm: I know the method may not be immortal.
6.5 The Finite Element Method 385 
idea is simple, the applications can be complicated. For problems on this scale, the one 
undebatable point is their cost—I am afraid a billion dollars would be a conservative 
estimate of the expense so far. I hope some readers will be vigorous enough to master 
the finite element method and put it to good use. 
Trial Functions 
Starting from the classical Rayleigh-Ritz principle, I will introduce the new idea of finite 
elements. The equation can be .u00 = f (x) with boundary conditions u(0) = u(1) = 
0. This problem is infinite-dimensional (the vector b is replaced by a function f , and 
the matrix A becomes .d2=dx2). We can write down the energy whose minimum is 
required, replacing inner products vT f by integrals of v(x) f (x): 
Total energy P(v) = 
1
2
vTAv.vT f = 
1
2 
Z 1 
0 
v(x)(.v00(x))dx.
Z 1 
0 
v(x) f (x)dx: (1) 
P(v) is to be minimized over all functions v(x) that satisfy v(0)=v(1)=0. The function 
that gives the minimum will be the solution u(x). The differential equation has been 
converted to a minimum principle, and it only remains to integrate by parts: 
Z 1 
0 
v(.v00)dx = 
Z 1 
0 
(v0)2dx.[vv0]x=1 
x=0 so P(v) = 
Z 1 
0 
·
1
2
(v0(x))2+v(x) f (x)
.
dx: 
The term vv0 is zero at both limits, because v is. Now 
R 
(v0(x))2dx is positive like xTAx. 
We are guaranteed a minimum. 
To compute the minimum exactly is equivalent to solving the differential equation exactly. 
The Rayleigh-Ritz principle produces an n-dimensional problem by choosing only 
n trial functions V1(x); : : : ;Vn(x). From all combinations V = y1V1(x)+. . .+ynVn(x), 
we look for the particular combination (call it U) that minimizes P(V). This is the key 
idea, to minimize over a subspace of V’s instead of over all possible v(x). The function 
that gives the minimum is U(x). We hope and expect that U(x) is near the correct u(x). 
Substituting V for v, the quadratic turns into 
P(V) = 
1
2 
Z 1 
0 
.
y1V0 
1(x)+. . .+ynV0 
n(x)
.2dx.
Z 1 
0 
.
y1V1(x)+. . .+ynVn(x)
. 
f (x)dx: (2) 
The trial functions V are chosen in advance. That is the key step! The unknowns 
y1; : : : ;yn go into a vector y. Then P(V) = 12
yTAy.yTb is recognized as one of the 
quadratics we are accustomed to. The matrix entries Ai j are 
R 
V0 
i V0 
jdx = coefficient of 
yiy j. The components bj are 
R 
Vj f dx. We can certainly find the minimum of 12
yTAy.yTb 
by solving Ay = b. Therefore the Rayleigh-Ritz method has three steps: 
1. Choose the trial functions V1; : : : ;Vn. 
2. Compute the coefficients Ai j and bj.
386 Chapter 6 Positive Definite Matrices 
3. Solve Ay = b to find U(x) = y1V1(x)+. . .+ynVn(x). 
Everything depends on step 1. Unless the functions Vj(x) are extremely simple, the 
other steps will be virtually impossible. And unless some combination of the Vj is close 
to the true solution u(x), those steps will be useless. To combine both computability 
and accuracy, the key idea that makes finite elements successful is the use of piecewise 
polynomials as the trial functions V(x). 
Linear Finite Elements 
The simplest and most widely used finite element is piecewise linear. Place nodes at 
the interior points x1 = h;x2 = 2h; : : : ;xn = nh, just as for finite differences. Then Vj is 
the “hat function” that equals 1 at the node x j, and zero at all the other nodes (Figure 
6.7a). It is concentrated in a small interval around its node, and it is zero everywhere 
else (including x = 0 and x = 1). Any combination y1V1+. . .+ynVn must have the value 
y j at node j (the other V’s are zero there), so its graph is easy to draw (Figure 6.7b). 
1 
0 x4 = 4h 1 
V4(x) 
0 1 
V (x) = y1V1 + · · · + y5V5 
y1 
y4 
Figure 6.7: Hat functions and their linear combinations. 
Step 2 computes the coefficients Ai j =
R 
V0 
i V0 
jdx in the “stiffness matrix” A. The slope 
V0 
j equals 1=h in the small interval to the left of x j, and .1=h in the interval to the right. 
If these “double intervals” do not overlap, the product V0 
i V0 
j is zero and Ai j = 0. Each 
hat function overlaps itself and only two neighbors: 
Diagonal i = j Aii = 
Z 
V0 
i V0 
i dx = 
Z µ
1
h
¶2 
dx+
Z µ
.
1
h
¶2 
dx = 
2
h
: 
Off-diagonal i = j§1 Ai j = 
Z 
V0 
i V0 
jdx = 
Z µ
1
h
¶µ
.1 
h 
¶
dx = 
.1 
h 
: 
Then the stiffness matrix is actually tridiagonal: 
Stiffness matrix A = 
1
h 
2
666664 
2 .1 
.1 2 .1 
.1 2 .1 
.1 2 .1 
.1 2 
3
777775
:
6.5 The Finite Element Method 387 
This looks just like finite differences! It has led to a thousand discussions about the 
relation between these two methods. More complicated finite elements—polynomials of 
higher degree. defined on triangles or quadrilaterals for partial differential equations— 
also produce sparse matrices A. You could think of finite elements as a systematic way 
to construct accurate difference equations on irregular meshes. The essential thing is the 
simplicity of these piecewise polynomials. Inside every element, their slopes arc easy to 
find and to integrate. 
The components bj on the right side are new. Instead of just the value of f at x j, 
as for finite differences, they are now an average of f around that point: bj = 
R 
Vj f dx. 
Then, in step 3, we solve the tridiagonal system Ay = b, which gives the coefficients in 
the minimizing trial function U = y1V1+. . .+ynVn. Connecting all these heights y j by 
a broken line, we have the approximate solution U(x). 
Example 1. u00 = 2 with u(0) = u(1) = 0, and solution u(x) = x.x2. 
The approximation will use three intervals and two hat functions, with h = 13
. The 
matrix A is 2 by 2. The right side requires integration of the hat function times f (x) = 2. 
That produces twice the area 13
under the hat: 
A = 3
" 
2 .1 
.1 2 
# 
and b = 
"
2323 
#
: 
The solution to Ay = b is y = (29
; 2
9). The best U(x) is 29
V1+ 29
V2, which equals 29
at the 
mesh points. This agrees with the exact solution u(x) = x.x2 = 13
. 19
. 
In a more complicated example, the approximation will not be exact at the nodes. 
But it is remarkably close. The underlying theory is explained in the author’s book An 
Analysis of the Finite Element Method (see www.wellesleycambridge.com) written 
jointly with George Fix. Other books give more detailed applications, and the subject 
of finite elements has become an important part of engineering education. It is treated 
in Introduction to Applied Mathematics, and also in my new book Applied Mathematics 
and Scientific Computing. There we discuss partial differential equations, where the 
method really comes into its own. 
Eigenvalue Problems 
The Rayleigh-Ritz idea—to minimize over a finite-dimensional family of V’s in place 
of all admissible v’s—is also useful for eigenvalue problems. The true minimum of the 
Rayleigh quotient is the fundamental frequency l1. Its approximate minimum L1 will 
be larger—because the class of trial functions is restricted to the V’s. This step was 
completely natural and inevitable: to apply the new finite element ideas to this longestablished 
variational form of the eigenvalue problem. 
The best example of an eigenvalue problem has u(x) = sinpx and l1 =p2: 
Eigenfunction u(x) .u00 =l u; with u(0) = u(1) = 0:
388 Chapter 6 Positive Definite Matrices 
That function sinpx minimizes the Rayleigh quotient vTAv=vTv: 
Rayleigh quotient R(v) = 
R 1 
0 v(x)(.v00(x))dx 
R 1 
0 (v(x))2dx 
= 
R 1 
0 (v0(x))2dx 
R 1 
0 (v(x))2dx 
: 
This is a ratio of potential to kinetic energy, and they are in balance at the eigenvector. 
Normally this eigenvector would be unknown, and to approximate it we admit only the 
trial candidates V = y1V1+. . .+ynVn: 
R(V) = 
R 1 
0 (y1V0 
1+. . .+ynV0 
n)2dx 
R 1 
0 (y1V1+. . .+ynVn)2dx 
= 
yTAy 
yTMy
: 
Now we face a matrix problem: Minimize yTAy=yTMy. With M = I, this leads to the 
standard eigenvalue problem Ay = l y. But our matrix M will be tridiagonal, because 
neighboring hat functions overlap. It is exactly this situation that brings in the generalized 
eigenvalue problem. The minimum value L1 will be the smallest eigenvalue of 
Ay = lMy. That L1 will be close to (and above) p2. The eigenvector y will give the 
approximation U = y1V1+. . .+ynVn to the eigenfunction. 
As in the static problem. The method can be summarized in three steps: (1) choose 
the Vj, (2) compute A and M, and (3) solve Ay = lMy. I don’t know why that costs a 
billion dollars. 
Problem Set 6.5 
1. Use three hat functions, with h = 14
, to solve .u00 = 2 with u(0) = u(1) = 0. Verify 
that the approximation U matches u = x.x2 at the nodes. 
2. Solve .u00 = x with u(0) = u(1) = 0. Then solve approximately with two hat functions 
and h = 13
. Where is the largest error? 
3. Suppose .u00 = 2, with the boundary condition u(1) = 0 changed to u0(1) = 0. This 
“natural” condition on u0 need not be imposed on the trial functions V. With h = 13
, 
there is an extra half-hat V3, which goes from 0 to 1 between x = 23
and x = 1. 
Compute A33 = 
R 
(V0 
3)2dx and f3 = 
R 
2V3dx. Solve Ay = f for the finite element 
solution y1V1+y2V2+y3V3. 
4. Solve .u00 =2 with a single hat function, but place its node at x = 14
instead of x = 12
. 
(Sketch this function V1.) With boundary conditions u(0) = u(1) = 0, compare the 
finite element approximation with the true u = x.x2. 
5. Galerkin’s method starts with the differential equation (say .u00 = f (x)) instead of 
the energy P. The trial solution is still u = y1V1+y2V2+. . .+ynVn, and the y’s are 
chosen to make the difference between .u00 and f orthogonal to every Vj: 
Galerkin 
Z 
(.y1V00 
1 .y2V00 
2 .. . ..ynV00 
n )Vjdx = 
Z 
f (x)Vj(x)dx:
6.5 The Finite Element Method 389 
integrate the left side by parts to reach Ay = f , proving that Galerkin gives the same 
A and f as Rayleigh-Ritz for symmetric problems. 
6. A basic identity for quadratics shows y = A.1b as minimizing: 
P(y) = 
1
2
yTAy.yTb = 
1
2
(y.A.1b)TA(y.A.1b). 
1
2
bTA.1b: 
The minimum over a subspace of trial functions is at the y nearest to A.1b. (That 
makes the first term on the right as small as possible; it is the key to convergence of 
U to u.) If A = I and b = (1;0;0), which multiple of V = (1;1;1) gives the smallest 
value of P(y) = 12
yTy.y1? 
7. For a single hat function V(x) centered at x = 12
, compute A = 
R 
(V0)2dx and M = R 
V2dx. In the 1 by 1 eigenvalue problem, is l = A=M larger or smaller than the true 
eigenvalue l =p2? 
8. For the hat functions V1 and V2 centered at x = h = 13
and x = 2h = 23
, compute the 2 
by 2 mass matrix Mi j = 
R 
ViVjdx, and solve the eigenvalue problem Ax =lMx. 
9. What is the mass matrix Mi j = 
R 
ViVjdx for n hat functions with h = 1 
n+1?
Chapter 7 
Computations with Matrices 
7.1 Introduction 
One aim of this book is to explain the useful parts of matrix theory. In comparison 
with older texts in abstract linear algebra, the underlying theory has not been radically 
changed. One of the best things about the subject is that the theory is really essential 
for the applications. What is different is the change in emphasis which comes with a 
new point of view. Elimination becomes more than just a way to find a basis for the 
row space, and the Gram-Schmidt process is not just a proof that every subspace has an 
orthonormal basis. Instead, we really need these algorithms. And we need a convenient 
description, A = LU or A = QR, of what they do. 
This chapter will take a few more steps in the same direction. I suppose these steps are 
governed by computational necessity, rather than by elegance, and I don’t know whether 
to apologize for that; it makes them sound very superficial, and that is wrong. They deal 
with the oldest and most fundamental problems of the subject, Ax = b and Ax =l x, but 
they are continually changing and improving. In numerical analysis there is a survival 
of the fittest, and we want to describe some ideas that have survived so far. They fall 
into three groups: 
1. Techniques for Solving Ax = b. Elimination is a perfect algorithm, except 
when the particular problem has special properties—as almost every problem has. Section 
7.4 will concentrate on the property of sparseness, when most of the entries in A 
are zero. We develop iterative rather than direct methods for solving Ax = b. An iterative 
method is “self-correcting,” and never reaches the exact answer. The object is to 
get close more quickly than elimination. In some problems, that can be done; in many 
others, elimination is safer and faster if it takes advantage of the zeros. The competition 
is far from over, and we will identify the spectral radius that controls the speed of convergence 
to x = A.1b. 
2. Techniques for Solving Ax = l x. The eigenvalue problem is one of the out-
7.2 Matrix Norm and Condition Number 391 
standing successes of numerical analysis. It is clearly defined, its importance is obvious, 
but until recently no one knew how to solve it. Dozens of algorithms have been suggested, 
and everything depends on the size and the properties of A (and on the number 
of eigenvalues that are wanted). You can ask LAPACK for an eigenvalue subroutine, 
without knowing its contents, but it is better to know. We have chosen two or three ideas 
that have superseded almost all of their predecessors: the QR algorithm, the family of 
“power methods,” and the preprocessing of a symmetric matrix to make it tridiagonal. 
The first two methods are iterative, and the last is direct. It does its job in a finite 
number of steps, but it does not end up with the eigenvalues themselves. This produces 
a much simpler matrix to use in the iterative steps. 
3. The Condition Number of a Matrix. Section 7.2 attempts to measure the 
“sensitivity” of a problem: If A and b are slightly changed, how great is the effect on 
x = A.1b? Before starting on that question, we need a way to measure A and the change 
DA. The length of a vector is already defined, and now we need the norm of a matrix. 
Then the condition number, and the sensitivity of A will follow from multiplying the 
norms of A and A.1. The matrices in this chapter are square. 
7.2 Matrix Norm and Condition Number 
An error and a blunder are very different things. An error is a small mistake, probably 
unavoidable even by a perfect mathematician or a perfect computer. A blunder is much 
more serious, and larger by at least an order of magnitude. When the computer rounds 
oft a number after 16 bits, that is an error, But when a problem is so excruciatingly 
sensitive that this roundoff error completely changes the solution, then almost certainly 
someone has committed a blunder. Our goal in this section is to analyze the effect of 
errors, so that blunders can be avoided. 
We are actually continuing a discussion that began in Chapter 1 with 
A = 
"
1 1 
1 1:0001
# 
and B = 
"
0:0001 1 
1 1
#
: 
We claimed that B is well-conditioned, and not particularly sensitive to roundoff—except 
that if Gaussian elimination is applied in a stupid way, the matrix becomes completely 
vulnerable. It is a blunder to accept :0001 as the first pivot, and we must insist on a larger 
and safer choice by exchanging the rows of B. When “partial pivoting” is built into the 
elimination algorithm, the computer automatically looks for the largest pivot. Then the 
natural resistance to roundoff error is no longer compromised. 
How do we measure this natural resistance, and decide whether a matrix is wellconditioned 
or ill-conditioned? If there is a small change in b or in A, how large a 
change does that produce in the solution x?
392 Chapter 7 Computations with Matrices 
We begin with a change in the right-hand side, from b to b+d b. This error might 
come from experimental data or from roundoff. We may suppose that d b is small, but 
its direction is outside our control. The solution is changed from x to x+d x: 
Error equation A(x+d x) = b+d b; so, by subtraction A(d x) =d b: (1) 
An error d b leads to d x = A.1d b. There will be a large change in the solution x when 
A.1 is large—A is nearly singular. The change in x is especially large when d b points in 
the direction that is amplified most by A.1. 
Suppose A is symmetric and its eigenvalues are positive: 0 < l1 · . . . · ln. Any 
vector d b is a combination of the corresponding unit eigenvectors x1; : : : ;xn. The worst 
error d x, coming from A.1, is in the direction of the first eigenvector x1: 
Worst error If d b =e x1; then d x = 
d b 
l1 
: (2) 
The error kd bk is amplified by 1=l1, which is the largest eigenvalue of A.1. This 
amplification is greatest when l1 is near zero, and A is nearly singular. 
Measuring sensitivity entirely by l1 has a serious drawback. Suppose we multiply all 
the entries of A by 1000; then l1 will be multiplied by 1000 and the matrix will look 
much less singular. This offends our sense of fair play; such a simple rescaling cannot 
make an ill-conditioned matrix well. It is true that d x will be 1000 times smaller, but so 
will the solution x = A.1b. The relative error kd xk=kxk will be the same. Dividing by 
kxk normalizes the problem against a trivial change of scale. At the same time there is 
a normalization for d b; our problem is to compare the relative change kd bk=kbk with 
the relative error kd xk=kxk. 
The worst case is when kd xk is large—with d b in the direction of the eigenvector 
x1—and when kxk is small. The true solution x should be as small as possible compared 
to the true b. This means that the original problem Ax=b should be at the other extreme, 
in the direction of the last eigenvector xn: if b = xn, then x = A.1b = b=ln. 
It is this combination, b = xn and d b =e x1, that makes the relative error as large as 
possible. These are the extreme cases in the following inequalities: 
7A For a positive definite matrix, the solution x = A.1b and the error d x = 
A.1d b always satisfy 
kxk . 
kbk 
lmax 
and kd xk · 
kd bk 
lmin 
and 
kd xk 
kxk 
· 
lmax 
lmin 
kd bk 
kbk 
: (3) 
The ratio c =lmax=lmin is the condition number of a positive definite matrix 
A. 
Example 1. The eigenvalues of A are approximately l1 = 10.4=2 and l2 = 2: 
A = 
"
1 1 
1 1:0001
# 
has condition number about c = 4 . 104:
7.2 Matrix Norm and Condition Number 393 
We must expect a violent change in the solution from ordinary changes in the data. 
Chapter 1 compared the equations Ax = b and Ax0 = b0: 
u + v = 2 
u + 1:0001v = 2 
u + v = 2 
u + 1:0001v = 2:0001: 
The right-hand sides are changed only by kd bk = :0001 = 10.4. At the same time, the 
solution goes from u = 2, v = 0 to u = v = 1. This is a relative error of 
kd xk 
kxk 
= 
k(.1;1)k 
k(2;0)k 
= 
p
2 
2 
; which equals 2 . 104 kd bk 
kbk 
: 
Without having made any special choice of the perturbation, there was a relatively large 
change in the solution. Our x and d b make 45° angles with the worst cases, which 
accounts for the missing 2 between 2 . 104 and the extreme possibility c = 4 . 104. 
If A = I or even if A = I=10, its condition number is c =lmax=lmin = 1. By comparison, 
the determinant is a terrible measure of ill-conditioning. It depends not only on the 
scaling but also on the order n; if A = I=10, then the determinant of A is 10.n. In fact, 
this “nearly singular” matrix is as well-conditioned as possible. 
Example 2. The n by n finite difference matrix A has lmax . 4 and lmin .p2=n2: 
A = 
2
666664 
2 .1 
.1 2 .1 
.1 2 . 
. . .1 
.1 2 
3
777775
: 
The condition number is approximately c(A)= 12
n2, and this time the dependence on the 
order n is genuine. The better we approximate .u00 = f , by increasing the number of 
unknowns, the harder it is to compute the approximation. At a certain crossover point, 
an increase in n will actually produce a poorer answer. 
Fortunately for the engineer, this crossover occurs where the accuracy is already 
pretty good. Working in single precision, a typical computer might make roundoff errors 
of order 10.9. With n = 100 unknowns and c = 5000, the error is amplified at most to 
be of order 10.5—which is still more accurate than any ordinary measurements. But 
there will be trouble with 10,000 unknowns, or with a 1, .4, 6, .4, 1 approximation to 
d4u=dx4 = f (x)—for which the condition number grows as n4.1 
Unsymmetric Matrices 
Our analysis so far has applied to symmetric matrices with positive eigenvalues. We 
could easily drop the positivity assumption, and use absolute values jl j. But to go 
1The usual rule of thumb, experimentally verified, is that the computer can lose log c decimal places to the 
roundoff errors in Gaussian elimination.
394 Chapter 7 Computations with Matrices 
beyond symmetry, as we certainly want to do, there will have to be a major change. This 
is easy to see for the very unsymmetric matrices 
A = 
"
1 100 
0 1 
# 
and A.1 = 
"
1 .100 
0 1 
#
: (4) 
The eigenvalues all equal one, but the proper condition number is not lmax=lmin = 1. 
The relative change in x is not bounded by the relative change in b. Compare 
x = 
"
0
1
# 
when b = 
"
100 
1 
#
; x0 = 
"
100 
0 
# 
when b0 = 
"
100 
0 
#
: 
A 1% change in b has produced a hundredfold change in x; the amplification factor is 
1002. Since c represents an upper bound, the condition number must be at least 10,000. 
The difficulty here is that a large off-diagonal entry in A means an equally large entry in 
A.1. Expecting A.1 to get smaller as A gets bigger is often wrong. 
For a proper definition of the condition number, we look back at equation (3). We 
were trying to make x small and b=Ax large. When A is not symmetric, the maximum of 
kAxk=kxk may be found at a vector x that is not one of the eigenvectors. This maximum 
is an excellent measure of the size of A. It is the norm of A. 
7B The norm of A is the number kAk defined by 
kAk = max 
x6=0 
kAxk 
kxk 
: (5) 
In other words, kAk bounds the “amplifying power” of the matrix: 
kAxk · kAkkxk for all vectors x. (6) 
The matrices A and A.1 in equation (4) have norms somewhere between 100 and 101. 
They can be calculated exactly, but first we want to complete the connection between 
norms and condition numbers. Because b = Ax and d x = A.1d b, equation (6) gives 
kbk · kAkkxk and kd xk · kA.1kkd bk: (7) 
This is the replacement for equation (3), when A is not symmetric. In the symmetric case, 
kAk is the same as lmax, and kA.1k is the same as 1=lmin. The correct replacement for 
lmax=lmin is the product kAkkA.1k—which is the condition number. 
7C The condition number of A is c = kAkkA.1k. The relative error satisfies 
d x from d b 
kd xk 
kxk 
· c
kd bk 
kbk 
directly from equation (7). (8) 
If we perturb the matrix A instead of the right-hand side b, then 
d x from d A 
kd xk 
kx+d xk 
· c
kd Ak 
kAk 
from equation (10) below. (9)
7.2 Matrix Norm and Condition Number 395 
What is remarkable is that the same condition number appears in equation (9), when the 
matrix itself is perturbed: If Ax = b and (A+d A)(x+d x) = b, then by subtraction 
Ad x+d A(x+d x) = 0; or d x = .A.1(d A)(x+d x): 
Multiplying by d A amplifies a vector by no more than kd Ak, and multiplying by A.1 
amplifies by no more than kA.1k. Then kd xk < kA.1kkd Akkx+d xk, which is 
kd xk 
kx+d xk 
· kA.1kkd Ak = c
kd Ak 
kAk 
: (10) 
These inequalities mean that roundoff error comes from two sources. One is the 
natural sensitivity of the problem, measured by c. The other is the actual error d b 
or d A. This was the basis of Wilkinson’s error analysis. Since elimination actually 
produces approximate factors L0 and U0, it solves the equation with the wrong matrix 
A+d A = L0U0 instead of the right matrix A = LU. He proved that partial pivoting 
controls d A—so the burden of the roundoff error is carried by the condition number c. 
A Formula for the Norm 
The norm of A measures the largest amount by which any vector (eigenvector or not) 
is amplified by matrix multiplication: kAk = max(kAxk=kxk). The norm of the identity 
matrix is 1. To compute the norm, square both sides to reach the symmetric ATA: 
kAk2 = max 
kAxk2 
kxk2 = max 
xTATAx 
xTx 
: (11) 
7D kAk is the square root of the largest eigenvalue of ATA: kAk2 =lmax(ATA). 
The vector that A amplifies the most is the corresponding eigenvector of ATA: 
xTATAx 
xTx 
= 
xT(lmaxx) 
xTx 
=lmax(ATA) = kAk2: (12) 
Figure 7.1 shows an unsymmetric matrix with eigenvalues l1 = l2 = 1 and norm 
kAk = 1:618. In this case A.1 has the same norm. The farthest and closest points Ax on 
the ellipse come from eigenvectors x of ATA, not of A. 
Note 1. The norm and condition number are not actually computed in practice, only 
estimated, There is not time to solve an eigenvalue problem for lmax(ATA). 
Note 2. In the least-squares equation ATAx = ATb, the condition number c(ATA) is the 
square of c(A). Forming ATA can turn a healthy problem into a sick one. It may be 
necessary to orthogonalize A by Gram-Schmidt, instead of computing with ATA. 
Note 3. The singular values of A in the SVD are the square roots of the eigenvalues of 
ATA. By equation (12), another formula for the norm is kAk = smax. The orthogonal 
U and V leave lengths unchanged in kAxk = kUSVTxk. So the largest kAxk=kxk comes 
from the largest s in the diagonal matrix S.
396 Chapter 7 Computations with Matrices 
norm 
1 
kA.1
k 
A = "1 1 
0 1
# 
ATA = "1 1 
1 2
# 
ellipse of all Ax 
circle kxk = 1 
kAk = 
1 + 
p
5 
2 
kAk
2 = max(ATA)  2.618 
1 
kA.1
k
2 = min(ATA)  0.382 
c(A) = kAkkA.1
k  (1.618)2 
Figure 7.1: The norms of A and A.1 come from the longest and shortest Ax. 
Note 4. Roundoff error also enters Ax =l x. What is the condition number of the eigenvalue 
problem? The condition number of the diagonalizing S measures the sensitivity 
of the eigenvalues. If m is an eigenvalue of A+E, then its distance from one of the 
eigenvalues of A is 
jm .l j · kSkkS.1kkEk = c(S)kEk: (13) 
With orthonormal eigenvectors and S = Q, the eigenvalue problem is perfectly conditioned: 
c(Q) = 1. The change dl in the eigenvalues is no greater than the change d A. 
Therefore the best case is when A is symmetric, or more generally when AAT = ATA. 
Then A is a normal matrix; its diagonalizing S is an orthogonal Q (Section 5.6). 
If xk is the kth column of S and yk is the kth row of S.1, then lk changes by 
dlk = ykExk+terms of order kEk2: (14) 
In practice, ykExk is a realistic estimate of dl . The idea in every good algorithm is to 
keep the error matrix E as small as possible—usually by insisting, as in the next section, 
on orthogonal matrices at every step of the computation of l . 
Problem Set 7.2 
1. For an orthogonal matrix Q, show that kQk = 1 and also c(Q) = 1. Orthogonal 
matrices (and their multiples aQ) are the only perfectly conditioned matrices. 
2. Which “famous” inequality gives k(A+B)xk·kAxk+kBxk, and why does it follow 
from equation (5) that kA+Bk · kAk+kBk? 
3. Explain why kABxk·kAkkBkkxk, and deduce from equation (5) that kABk·kAkkBk. 
Show that this also implies c(AB) · c(A)c(B).
7.2 Matrix Norm and Condition Number 397 
4. For the positive definite A=
. 2 .1 
.1 2 
¤
, compute kA.1k=1=l1, kAk=l2, and c(A)= 
l2=l1. Find a right-hand side b and a perturbation d b so that the error is the worst 
possible, kd xk=kxk = ckd bk=kbk. 
5. Show that if l is any eigenvalue of A, Ax =l x, then jl j · kAk. 
6. The matrices in equation (4) have norms between 100 and 101. Why? 
7. Comparing the eigenvalues of ATA and AAT, prove that kAk = kATk. 
8. For a positive definite A, the Cholesky decomposition is A = LDLT = RTR, where 
R = 
p
DLT. Show directly from equation (12) that the condition number of c(R) is 
the square root of c(A). Elimination without row exchanges cannot hurt a positive 
definite matrix, since c(A) = c(RT)c(R). 
9. Show that maxjl j is not a true norm, by finding 2 by 2 counterexamples to lmax(A+ 
B) ·lmax(A)+lmax(B) and lmax(AB) ·lmax(A)lmax(B). 
10. Show that the eigenvalues of B = 
. 0 A 
AT 0 
¤ 
are §si, the singular values of A. Hint: Try 
B2. 
11. (a) Do A and A.1 have the same condition number c? 
(b) In parallel with the upper bound (8) on the error, prove a lower bound: 
kd xk 
kxk 
. 
1
c 
kd bk 
kbk 
: (Consider A.1b = x instead of Ax = b.) 
12. Find the norms lmax and condition numbers lmax=lmin of these positive definite 
matrices: "
100 0 
0 2
# "
2 1 
1 2
# "
3 1 
1 1
#
: 
13. Find the norms and condition numbers from the square roots of lmax(ATA) and 
lmin(ATA): "
.2 0 
0 2
# "
1 1 
0 0
# " 
1 1 
.1 1
#
: 
14. Prove that the condition number kAkkA.1k is at least 1. 
15. Why is I the only symmetric positive definite matrix that has lmax =lmin = 1? Then 
the only matrices with kAk = 1 and kA.1k = 1 must have ATA = I. They are 
matrices. 
16. Orthogonal matrices have norm kQk = 1. If A = QR, show that kAk · kRk and also 
kRk · kAk. Then kAk = kQkkRk. Find an example of A = LU with kAk < kLkkUk.
398 Chapter 7 Computations with Matrices 
17. (Suggested by Moler and Van Loan) Compute b.Ay and b.Az when 
b = 
"
:217 
:254
# 
A = 
"
:780 :563 
:913 :659
# 
y = 
" 
:341 
.:087
# 
z = 
"
:999 
.1:0
#
: 
Is y closer than z to solving Ax = b? Answer in two ways: Compare the residual 
b.Ay to b.Az. Then compare y and z to the true x = (1;.1), Sometimes we want 
a small residual, sometimes a small d x. 
Problems 18–20 are about vector norms other than the usual kxk = 
p
x . x. 
18. The “`1 norm” is kxk1 =jxj1+. . .+jxjn. The “`. norm” is kxk. =maxjxij. Compute 
kxk, kxk1 and kxk. for the vectors 
x = (1;1;1;1;1) and x = (:1; :7; :3; :4; :5): 
19. Prove that kxk. · kxk · kxk1. Show from the Schwarz inequality that the ratios 
kxk=kxk. and kxk1=kxk are never larger than 
p
n. Which vector (x1; : : : ;xn) gives 
ratios equal to 
p
n? 
20. All vector norms must satisfy the triangle inequality. Prove that 
kx+yk. · kxk.+kyk. and kx+yk1 · kxk1+kyk1: 
21. Compute the exact inverse of the Hilbert matrix A by elimination. Then compute 
A.1 again by rounding all numbers to three figures: 
In MATLAB : A = hilb(3) = 
2
64
1 12 
13
12 
13 
14
13 
14 
15 
3
75
: 
22. For the same A, compute b=Ax for x=(1;1;1) and x=(0;6;.3:6). A small change 
Db produces a large change Dx. 
23. Compute lmax and lmin for the 8 by 8 Hilbert matrix ai j = 1=(i+ j.1). If Ax = b 
with kbk = 1, how large can kxk be? If b has roundoff error less than 10.16, how 
large an error can this cause in x? 
24. If you know L, U, Q, and R, is it faster to solve LUx = b or QRx = b? 
25. Choosing the largest available pivot in each column (partial pivoting), factor each A 
into PA = LU: 
A = 
"
1 0 
2 2
# 
and A = 
2
64
1 0 1 
2 2 0 
0 2 0
3
75
:
7.3 Computation of Eigenvalues 399 
26. Find the LU factorization of A = 
.e 1 
1 1 
¤
. On your computer, solve by elimination 
when e = 10.3;10.6;10.9;10.12;10.15: 
"
e 1 
1 1
#"
x1 
x2
# 
= 
"
1+e 
2 
#
: 
The true x is (1;1). Make a table to show the error for each e . Exchange the two 
equations and solve again—the errors should almost disappear. 
7.3 Computation of Eigenvalues 
There is no one best way to find the eigenvalues of a matrix. But there are certainly 
some terrible ways which should never be tried, and also some ideas that do deserve a 
permanent place. We begin by describing one very rough and ready approach, the power 
method, whose convergence properties are easy to understand. We added a graphic 
animation (with sound) to the course page web.mit.edu/18.06, to show the power method 
in action. 
We move steadily toward a more sophisticated algorithm, which starts by making a 
symmetric matrix tridiagonal and ends by making it virtually diagonal. That second step 
is done by repeating Gram-Schmidt, so it is known as the QR method. 
The ordinary power method operates on the principle of a difference equation. It 
starts with an initial guess u0 and then successively forms u1 = Au0, u2 = Au1, and 
in general uk+1 = Auk. Each step is a matrix-vector multiplication. After k steps it 
produces uk = Aku0, although the matrix Ak will never appear. The essential thing is 
that multiplication by A should be easy—if the matrix is large, it had better be sparse— 
because convergence to the eigenvector is often very slow. Assuming A has a full set of 
eigenvectors x1; : : : ;xn, the vector uk will be given by the usual formula: 
Eigenvectors weighted by l k uk = c1l k 
1 x1+. . .+cnl k 
n xn: 
Suppose the largest eigenvalue ln is all by itself; there is no other eigenvalue of the same 
magnitude, and jl1j · . . . · jln.1j < jlnj. Then as long as the initial guess u0 contained 
some component of the eigenvector xn, so that cn 6= 0, this component will gradually 
dominate in uk: 
uk 
l k 
n 
= c1
µ
l1 
ln
¶k 
x1+. . .+cn.1
µ
ln.1 
ln 
¶k 
xn.1+cnxn: (1) 
The vectors uk point more and more accurately toward the direction of xn. Their convergence 
factor is the ratio r = jln.1j=jlnj. It is just like convergence to a steady state, for 
a Markov matrix, except now ln may not equal 1. The scaling factor l k 
n in equation (1) 
prevents uk from growing very large or very small, in case jlnj > 1 or jlnj < 1.
400 Chapter 7 Computations with Matrices 
Often we can just divide each uk by its first component ak before taking the next step. 
With this simple scaling, the power method uk+1 = Auk=ak converges to a multiple of 
xn. The scaling factors ak will approach ln. 
Example 1. The uk approach the eigenvector 
h
2=3 
1=3
i 
= 
. 
:667 
:333 
¤ 
when A = 
. 
:9 :2 
:1 :8 
¤ 
is the 
matrix of population shifts in Section 1.3: 
u0 = 
"
1
0
#
; u1 = 
"
:9 
:1
#
; u2 = 
"
:83 
:17
#
; u3 = 
"
:781 
:219
#
; u4 = 
"
:747 
:253
#
: 
If r = jln.1j=jlnj is close to 1, then convergence is very slow. In many applications 
r > :9, which means that more than 20 iterations are needed to achieve one more digit. 
(The example had r =:7, and it was still slow.) If r =1, which means jln.1j=jlnj, then 
convergence will probably not occur at all. That happens (in the applet with sound) for a 
complex conjugate pair ln.1 =l n. There are several ways to get around this limitation, 
and we shall describe three of them: 
1. The block power method works with several vectors at once, in place of uk. If we 
multiply p orthonormal vectors by A, and then apply Gram-Schmidt to orthogonalize 
them again—that is a single step of the method—the convergence ratio becomes 
r0 =jln.pj=jlnj. We will obtain approximations to p different eigenvalues and their 
elgenvectors. 
2. The inverse power method operates with A.1 instead of A. A single step is vk+1 = 
A.1vk, which means that we solve the linear system Avk+1 =vk (and save the factors 
L and U!). Now we converge to the smallest eigenvalue l1 and its eigenvector x1, 
provided jl1j < jl2j. Often it is l1 that is wanted in the applications, and then 
inverse iteration is an automatic choice. 
3. The shifted inverse power method is best of all. Replace A by A.aI. Each eigenvalue 
is shifted by a, and the convergence factor for the inverse method will change 
to r00 = jl1.aj=jl2.aj. If a is a good approximation to l1, r00 will be very small 
and the convergence is enormously accelerated. Each step of the method solves 
(A.aI)wk+1 = wk: 
wk = 
c1x1 
(l1.a)k + 
c2x2 
(l2.a)k +. . .+ 
cnxn 
(ln.a)k : 
When a is close to l1, the first term dominates after only one or two steps. If 
l1 has already been computed by another algorithm (such as QR), then a is this 
computed value. One standard procedure is to factor A.aI into LU and to solve 
Ux1 = (1;1; : : : ;1) by back-substitution. 
If l1 is not already approximated, the shifted inverse power method has to generate its 
own choice ofa. We can varya =ak at every step if we want to, so (A.akI)wk+1 =wk.
7.3 Computation of Eigenvalues 401 
When A is symmetric, a very accurate choice is the Rayleigh quotient: 
shift by ak = R(wk) = 
wTk
Awk 
wTk
wk 
: 
This quotient R(x) has a minimum at the true eigenvector x1. Its graph is like the bottom 
of a parabola, so the error l1.ak is roughly the square of the error in the eigenvector. 
The convergence factors jl1 .akj=jl2 .akj are themselves converging to zero. Then 
these Rayleigh quotient shifts give cubic convergence of ak to l1.2 
Tridiagonal and Hessenberg Forms 
The power method is reasonable only for a matrix that is large and sparse. When too 
many entries are nonzero, this method is a mistake. Therefore we ask whether there is 
any simple way to create zeros. That is the goal of the following paragraphs. 
It should be said that after computing a similar matrix Q.1AQ with more zeros than 
A, we do not intend to go back to the power method. There are much more powerful 
variants, and the best of them seems to be the QR algorithm. (The shifted inverse power 
method has its place at the very end, in finding the eigenvector.) The first step is to produce 
quickly as many zeros as possible, using an orthogonal matrix Q. If A is symmetric, 
then so is Q.1AQ. No entry can become dangerously large because Q preserves lengths. 
To go from A to Q.1AQ, there are two main possibilities: We can produce one zero at 
every step (as in elimination), or we can work with a whole column at once. For a single 
zero, it is easy to use a plane rotation as illustrated in equation (7), found near the end 
of this section, that has cosq and sinq in a 2 by 2 block. Then we could cycle through 
all the entries below the diagonal, choosing at each step a rotation q that will produce a 
zero; this is Jacobi’s method. It fails to diagonalize A after a finite number of rotations, 
since the zeros from early steps will be destroyed when later zeros are created. 
To preserve the zeros and stop, we have to settle for less than a triangular form. 
The Hessenberg form accepts one nonzero diagonal below the main diagonal. If a 
Hessenberg matrix is symmetric, it only has three nonzero diagonals. 
A series of rotations in the right planes will produce the required zeros. Householder 
found a new way to accomplish exactly the same thing. A Householder transformation 
is a reflection matrix determined by one vector v: 
Householder matrix H = I.2 
vvT 
kvk2 : 
Often v is normalized to become a unit vector u = v=kvk, and then H becomes I.2uuT. 
In either case H is both symmetric and orthogonal: 
HTH = (I.2uuT)(I.2uuT) = I.4uuT+4uuTuuT = I: 
2Linear convergence means that every step multiplies the error by a fixed factor r < 1. Quadratic convergence 
means that the error is squared at every step, as in Newton’s method xk+1.xk = .f (xk)= f 0(xk) for solving f (x) = 
0. Cubic convergence takes 10.1 to 10.3 to 10.9.
402 Chapter 7 Computations with Matrices 
Thus H = HT = H.1. Householder’s plan was to produce zeros with these matrices, and 
its success depends on the following identity Hx = .s z: 
7E Suppose z is the column vector (1;0; : : : ;0), s = kxk, and v = x+s z. 
Then Hx = .s z = (.s ;0; : : : ;0). The vector Hx ends in zeros as desired. 
The proof is to compute Hx and reach .s z: 
Hx = x. 
2vvTx 
kvk2 = x.(x+s z) 
2(x+s z)Tx 
(x+s z)T(x+s z) 
= x.(x+s z) (because xTx =s 2) 
= .s z: 
(2) 
This identity can be used right away, on the first column of A. The final Q.1AQ is 
allowed one nonzero diagonal below the main diagonal (Hessenberg form). Therefore 
only the entries strictly below the diagonal will be involved: 
x = 
2
6664 
a21 
a31 
... 
an1
3
7775
; z = 
2
6664 
1
0... 
0
3
7775
; Hx = 
2
6664 
.s
0... 
0 
3
7775
: (3) 
At this point Householder’s matrix H is only of order n.1, so it is embedded into the 
lower right-hand corner of a full-size matrix U1: 
U1 = 
2
666664 
1 0 0 0 0 
0
0 H 
0
0 
3
777775
=U.1 
1 ; and U.1 
1 AU1 = 
2
666664 
a11 ¤ ¤ ¤ ¤ 
.s ¤ ¤ ¤ ¤ 
0 ¤ ¤ ¤ ¤ 
0 ¤ ¤ ¤ ¤ 
0 ¤ ¤ ¤ ¤
3
777775
: 
The first stage is complete, and U.1 
1 AU1 has the required first column. At the second 
stage, x consists of the last n.2 entries in the second column (three bold stars). Then 
H2 is of order n.2. When it is embedded in U2, it produces 
U2 = 
2
666664 
1 0 0 0 0 
0 1 0 0 0 
0 0 
0 0 H2 
0 0 
3
777775
=U.1 
2 ; U.1 
2 (U.1 
1 AU1)U2 = 
2
666664 
¤ ¤ ¤ ¤ ¤ 
¤ ¤ ¤ ¤ ¤ 
0 ¤ ¤ ¤ ¤ 
0 0 ¤ ¤ ¤ 
0 0 ¤ ¤ ¤
3
777775
: 
U3 will take care of the third column. For a 5 by 5 matrix, the Hessenberg form is 
achieved (it has six zeros). In general Q is the product of all the matrices U1U2 . . .Un.2, 
and the number of operations required to compute it is of order n3.
7.3 Computation of Eigenvalues 403 
Example 2. (to change a13 = a31 to zero) 
A = 
2
64
1 0 1 
0 1 1 
1 1 0
3
75
; x = 
"
0
1
#
; v = 
"
1
1
#
; H = 
" 
0 .1 
.1 0 
#
: 
Embedding H into Q, the result Q.1AQ is tridiagonal: 
Q = 
2
64
1 0 0 
0 0 .1 
0 .1 0 
3
75
; Q.1AQ = 
2
64
1 .1 0 
.1 0 1 
0 1 1
3
75
: 
Q.1AQ is a matrix that is ready to reveal its eigenvalues—the QR algorithm is ready to 
begin—but we digress for a moment to mention two other applications of these same 
Householder matrices H. 
1. The Gram-Schmidt factorization A = QR. Remember that R is to be upper triangular. 
We no longer have to accept an extra nonzero diagonal below the main one, 
since no matrices are multiplying on the right to spoil the zeros. The first step in 
constructing Q is to work with the whole first column of A: 
x = 
2
6664 
a11 
a21 
... 
an1
3
7775
; z = 
2
6664 
1
0... 
0
3
7775
; v = x+kxkz; H1 = I.2 
vvT 
kvk2 : 
The first column of H1A equals .kxkz. It is zero below the main diagonal, and it 
is the first column of R. The second step works with the second column of H1A, 
from the pivot on down, and produces an H2H1A which is zero below that pivot. 
(The whole algorithm is like elimination, but slightly slower.) The result of n.1 
steps is an upper triangular R, but the matrix that records the steps is not a lower 
triangular L. Instead it is the product Q=H1H2 . . .Hn.1, which can be stored in this 
factored form (keep only the v’s) and never computed explicitly. That completes 
Gram-Schmidt. 
2. The singular value decomposition UTAV = S. The diagonal matrix S has the same 
shape as A, and its entries (the singular values) are the square roots of the eigenvalues 
of ATA. Since Householder transformations can only prepare for the eigenvalue 
problem, we cannot expect them to produce S. Instead, they stably produce a bidiagonal 
matrix, with zeros everywhere except along the main diagonal and the one 
above. 
The first step toward the SVD is exactly as in QR above: x is the first column of A, 
and H1x is zero below the pivot. The next step is to multiply on the right by an H(1)
404 Chapter 7 Computations with Matrices 
which will produce zeros as indicated along the first row: 
A!H1A = 
2
64
¤ ¤ ¤ ¤ 
0 ¤ ¤ ¤ 
0 ¤ ¤ ¤
3
75
!H1AH(1) = 
2
64
¤ ¤ 0 0 
0 ¤ ¤ ¤ 
0 ¤ ¤ ¤
3
75
: (4) 
Then two final Householder transformations quickly achieve the bidiagonal form: 
H2H1AH(1) = 
2
64
¤ ¤ 0 0 
0 ¤ ¤ ¤ 
0 0 ¤ ¤
3
75
and H2H1AH(1)H(2) = 
2
64
¤ ¤ 0 0 
0 ¤ ¤ 0 
0 0 ¤ ¤
3
75
: 
The QR Algorithm for Computing Eigenvalues 
The algorithm is almost magically simple. It starts with A0, factors it by Gram-Schmidt 
into Q0R0, and then reverses the factors: A1 = R0Q0. This new matrix A1 is similar to 
the original one because Q.1 
0 A0Q0 =Q.1 
0 (Q0R0)Q0 =A1. So the process continues with 
no change in the eigenvalues: 
All Ak are similar Ak = QkRk and then Ak+1 = RkQk: (5) 
This equation describes the unshifted QR algorithm, and almost always Ak approaches a 
triangular form, Its diagonal entries approach its eigenvalues, which are also the eigenvalues 
of A0. If there was already some processing to obtain a tridiagonal form, then A0 
is connected to the absolutely original A by Q.1AQ = A0. 
As it stands, the QR algorithm is good but not very good. To make it special, it needs 
two refinements: We must allow shifts to Ak .akI, and we must ensure that the QR 
factorization at each step is very quick. 
1. The Shifted Algorithm. If the number ak is close to an eigenvalue, the step in 
equation (5) should be shifted immediately by ak (which changes Qk and Rk): 
Ak =akI = QkRk and then Ak+1 = RkQk+akI: (6) 
This matrix Ak+1 is similar to Ak (always the same eigenvalues): 
Q.1 
k AkQk = Q.1 
k (QkRk+akI)Qk = Ak+1: 
What happens in practice is that the (n;n) entry of Ak—the one in the lower right-hand 
corner—is the first to approach an eigenvalue. That entry is the simplest and most popular 
choice for the shift ak. Normally this produces quadratic convergence, and in the 
symmetric case even cubic convergence, to the smallest eigenvalue. After three or four
7.3 Computation of Eigenvalues 405 
steps of the shifted algorithm, the matrix Ak looks like this: 
Ak = 
2
6664 
¤ ¤ ¤ ¤ 
¤ ¤ ¤ ¤ 
0 ¤ ¤ ¤ 
0 0 e l01 
3
7775
; with e .1: 
We accept the computed l01
as a very close approximation to the true l1. To find the 
next eigenvalue, the QR algorithm continues with the smaller matrix (3 by 3, in the 
illustration) in the upper left-hand corner. Its subdiagonal elements will be somewhat 
reduced by the first QR steps, and another two steps are sufficient to find l2. This gives 
a systematic procedure for finding all the eigenvalues. In fact, the QR method is now 
completely described. It only remains to catch up on the eigenvectors—that is a single 
inverse power step—and to use the zeros that Householder created. 
2. When A0 is tridiagonal or Hessenberg, each QR step is very fast. The Gram-Schmidt 
process (factoring into QR) takes O(n3) operations for a full matrix A. For a Hessenberg 
matrix this becomes O(n2), and for a tridiagonal matrix it is O(n). Fortunately, each new 
Ak is again in Hessenberg or tridiagonal form: 
Q0 is Hessenberg Q0 = A0R.1 
0 = 
2
6664 
¤ ¤ ¤ ¤ 
¤ ¤ ¤ ¤ 
0 ¤ ¤ ¤ 
0 0 ¤ ¤
3
7775 
2
6664 
¤ ¤ ¤ ¤ 
0 ¤ ¤ ¤ 
0 0 ¤ ¤ 
0 0 0 ¤
3
7775
: 
You can easily check that this multiplication leaves Q0 with the same three zeros as A0. 
Hessenberg times triangular is Hessenberg. So is triangular times Hessenberg: 
A1 is Hessenberg A1 = R0Q0 = 
2
6664 
¤ ¤ ¤ ¤ 
0 ¤ ¤ ¤ 
0 0 ¤ ¤ 
0 0 0 ¤
3
7775 
2
6664 
¤ ¤ ¤ ¤ 
¤ ¤ ¤ ¤ 
0 ¤ ¤ ¤ 
0 0 ¤ ¤
3
7775
: 
The symmetric case is even better, since A1 =Q.1 
0 A0Q0 =QT0
A0Q0 stays symmetric. By 
the reasoning just completed, A1 is also Hessenberg. So A1 must be tridiagonal. The 
same applies to A2;A3; : : :, and every QR step begins with a tridiagonal matrix. 
The last point is the factorization itself, producing the Qk and Rk from each Ak (or 
really from Ak .akI). We may use Householder again, but it is simpler to annihilate 
each subdiagonal element in turn by a “plane rotation” Pi j. The first is P21: 
Rotation to kill a21 P21Ak = 
2
6664 
cosq .sinq 
sinq cosq 
1 
1
3
7775 
2
6664 
a11 ¤ ¤ ¤ 
a21 ¤ ¤ ¤ 
0 ¤ ¤ ¤ 
0 0 ¤ ¤
3
7775
(7)
406 Chapter 7 Computations with Matrices 
The (2;1) entry in this product is a11 sinq +a21 cosq , and we choose the angle q that 
makes this combination zero. The next rotation P32 is chosen in a similar way, to remove 
the (3;2) entry of P32P21Ak. After n.1 rotations, we have R0: 
Triangular factor Rk = Pn n.1 . . .P32P21Ak: (8) 
Books on numerical linear algebra give more information about this remarkable algorithm 
in scientific computing. We mention one more method—Arnoldi in ARPACK— 
for large sparse matrices. It orthogonalizes the Krylov sequence x;Ax;A2x; : : : by Gram- 
Schmidt. If you need the eigenvalues of a large matrix, don’t use det(A.l I)! 
Problem Set 7.3 
1. For the matrix A = 
. 2 .1 
.1 2 
¤ 
with eigenvalues l1 = 1 and l2 = 3, apply the power 
method uk+1 = Auk three times to the initial guess u0 = 
.10
¤
. What is the limiting 
vector u.? 
2. For the same A and the initial guess u0 = 
.34
¤
, compare three inverse power steps to 
one shifted step with a = uT0
Au0=uT0
u0: 
uk+1 = A.1uk = 
1
3 
"
2 1 
1 2
#
uk or u = (A.aI).1u0: 
The limiting vector u. is now a multiple of the other eigenvector (1;1). 
3. Explain why jln=ln.1j controls the convergence of the usual power method. Construct 
a matrix A for which this method does not converge. 
4. The Markov matrix A = 
. 
:9 :3 
:1 :7 
¤ 
has l = 1 and :6, and the power method uk = Aku0 
converges to 
. 
:75 
:25 
¤
. Find the eigenvectors of A.1. What does the inverse power 
method u.k = A.ku0 converge to (after you multiply by :6k)? 
5. Show that for any two different vectors of the same length, kxk = kyk, the Householder 
transformation with v = x.y gives Hx = y and Hy = x. 
6. Compute s = kxk, v = x+s z, and H = I.2vvT=vTv, Verify Hx = .s z: 
x = 
"
3
4
# 
and z = 
"
1
0
#
: 
7. Using Problem 6, find the tridiagonal HAH.1 that is similar to 
A = 
2
64
1 3 4 
3 1 0 
4 0 0
3
75
7.4 Iterative Methods for Ax = b 407 
8. Show that starting from A0 = 
. 2 .1 
.1 2 
¤
, the unshifted QR algorithm produces only the 
modest improvement A1 = 15
. 14 .3 
.3 6 
¤
. 
9. Apply to the following matrix A a single QR step with the shift a = a22—which in 
this case means without shift, since a22 = 0. Show that the off-diagonal entries go 
from sinq to .sin3q , which is cubic convergence. 
A = 
"
cosq sinq 
sinq 0 
#
: 
10. Check that the tridiagonal A = 
. 0 1 
1 0 
¤ 
is left unchanged by the QR algorithm. It is one 
of the (rare) counterexamples to convergence (so we shift). 
11. Show by induction that, without shifts, (Q0Q1 . . .Qk)(Rk . . .R1R0) is exactly the QR 
factorization of Ak+1. This identity connects QR to the power method and leads to 
an explanation of its convergence. If jl1j > jl2j > . . . > jlnj, these eigenvalues will 
gradually appear on the main diagonal. 
12. Choose sinq and cosq in the rotation P to triangularize A, and find R: 
P21A = 
"
cosq .sinq 
sinq cosq 
#"
1 .1 
3 5 
# 
= 
"
¤ ¤ 
0 ¤
# 
= R: 
13. Choose sinq and cosq to make P21AP.1 
21 triangular (same A). What are the eigenvalues? 
14. When A is multiplied by Pi j (plane rotation), which entries are changed? When Pi jA 
is multiplied on the right by P.1 
i j , which entries are changed now? 
15. How many multiplications and how many additions are used to compute PA? (A 
careful organization of all the rotations gives 23n3 multiplications and additions, the 
same as for QR by reflectors and twice as many as for LU.) 
16. (Turning a robot hand) A robot produces any 3 by 3 rotation A from plane rotations 
around the x, y, and z axes. If P32P31P21A = I, the three robot turns are in A = 
P.1 
21 P.1 
31 P.1 
32 . The three angles are Euler angles. Choose the first q so that 
P21A = 
2
64
cosq .sinq 0 
sinq cosq 0 
0 0 1
3
75
1
2 
2
64
.1 2 2 
2 .1 2 
2 2 .1
3
75
is zero in the (2;1) position. 
7.4 Iterative Methods for Ax = b 
In contrast to eigenvalues, for which there was no choice, we do not absolutely need 
an iterative method to solve Ax = b. Gaussian elimination will reach the solution x in
408 Chapter 7 Computations with Matrices 
a finite number of steps (n3=3 for a full matrix, less than that for the large matrices we 
actually meet), Often that number is reasonable. When it is enormous, we may have to 
settle for an approximate x that can be obtained more quickly—and it is no use to go 
part way through elimination and then stop. 
Our goal is to describe methods that start from any initial guess x0, and produce an 
improved approximation xk+1 from the previous xk. We can stop when we want to. 
An iterative method is easy to invent, by splitting the matrix A. If A = S.T, then 
the equation Ax = b is the same as Sx = Tx+b. Therefore we can try 
Iteration from xk to xk+1 Sxk+1 = Txk+b: (1) 
There is no guarantee that this method is any good. A successful splitting S.T satisfies 
two different requirements: 
1. The new vector xk+1 should be easy to compute. Therefore S should be a simple 
(and invertible!) matrix; it may be diagonal or triangular. 
2. The sequence xk should converge to the true solution x. If we subtract the iteration 
in equation (1) from the true equation Sx = Tx+b, the result is a formula involving 
only the errors ek = x.xk: 
Error equation Sek+1 = Tek: (2) 
This is just a difference equation. It starts with the initial error e0, and after k steps 
it produces the new error ek = (S.1T)ke0. The question of convergence is exactly 
the same as the question of stability: xk !x exactly when ek !0. 
7F The iterative method in equation (1) is convergent if and only if every 
eigenvalue of S.1T satisfies jl j < 1. Its rate of convergence depends on the 
maximum size of jl j: 
Spectral radius “rho” r(S.1T) = max 
i 
jlij: (3) 
Remember that a typical solution to ek+1 = S.1Tek is a combination of eigenvectors: 
Error after k steps ek = c1l k 
1 x1+. . .+cnl k 
n xn: (4) 
The largest jlij will eventually be dominant, so the spectral radius r =jlmaxj will govern 
the rate at which ek converges to zero. We certainly need r < 1. 
Requirements 1 and 2 above are conflicting. We could achieve immediate convergence 
with S = A and T = 0; the first and only step of the iteration would be Ax1 = b. In 
that case the error matrix S.1T is zero, its eigenvalues and spectral radius are zero, and 
the rate of convergence (usually defined as .logr) is infinite. But Ax1 = b may be hard 
to solve; that was the reason for a splitting. A simple choice of S can often succeed, and 
we start with three possibilities:
7.4 Iterative Methods for Ax = b 409 
1. S = diagonal part of A (Jacobi’s method). 
2. S = triangular pail of A (Gauss-Seidel method). 
3. S = combination of 1 and 2 (successive overrelaxation or SOR). 
S is also called a preconditioner, and its choice is crucial in numerical analysis. 
Example 1 (Jacobi). Here S is the diagonal part of A: 
A = 
" 
2 .1 
.1 2 
#
; S = 
"
2 
2
#
;T = 
"
0 1 
1 0
#
;S.1T = 
"
0 12
12
0
#
: 
If the components of x are v and w, the Jacobi step Sxk+1 = Txk+b is 
2vk+1 = wk+b1 
2wk+1 = vk+b2; 
or 
"
v
w
#
k+1 
= 
"
0 12
12
0
#"
v
w
#
k
+
"
b1=2 
b2=2
#
: 
The decisive matrix S.1T has eigenvalues §12
, which means that the error is cut in half 
(one more binary digit becomes correct) at every step. In this example, which is much 
too small to be typical, the convergence is fast. 
For a larger matrix A, there is a very practical difficulty. The Jacobi iteration requires 
us to keep all components of xk until the calculation of xk+1 is complete. A 
much more natural idea, which requires only half as much storage, is to start using each 
component of the new xk+1 as soon as it is computed; xk+1 takes the place of xk a component 
at a time. Then xk can be destroyed as fast as xk+1 is created, The first component 
remains as before: 
New x1 a11(x1)k+1 = (.a12x2.a13x3.. . ..a1nxn)k+b1: 
The next step operates immediately with this new value of x1, to find (x2)k+1: 
New x2 a22(x2)k+1 = .a21(x1)k+1+(.a23x3.. . ..a2nxn)k+b2: 
And the last equation in the iteration step will use new values exclusively: 
New xn ann(xn)k+1 = (.an1x1.an2x2.. . ..ann.1xn.1)k+1+bn: 
This is called the Gauss-Seidel method, even though it was apparently unknown to 
Gauss and not recommended by Seidel. That is a surprising bit of history, because it is 
not a bad method. When the terms in xk+1 are moved to the left-hand side, S is seen as 
the lower triangular part of A. On the right-hand side, T is strictly upper triangular. 
Example 2 (Gauss-Seidel). Here S.1T has smaller eigenvalues: 
A = 
" 
2 .1 
.1 2 
#
; S = 
" 
2 0 
.1 2
#
; T = 
"
0 1 
0 0
#
; S.1T = 
"
0 12 
0 14 
#
:
410 Chapter 7 Computations with Matrices 
A single Gauss-Seidel step takes the components vk and wk into 
2vk+1 = wk+b1 
2wk+1 = vk+b2; 
or 
" 
2 0 
.1 2
#
xk+1 = 
"
0 1 
0 0
#
xk+b: 
The eigenvalues of S.1T are 1
4 and 0. The error is divided by 4 every time, so a single 
Gauss-Seidel step is worth two Jacobi steps. Since both methods require the same 
number of operations—we just use the new value instead of the old, and actually save 
on storage—the Gauss-Seidel method is better. 
This rule holds in many applications, even though there are examples in which Jacobi 
converges and Gauss-Seidel fails (or conversely). The symmetric case is straightforward: 
When all aii > 0, Gauss-Seidel converges if and only if A is positive definite. 
It was discovered during the years of hand computation (probably by accident) that 
convergence is faster if we go beyond the Gauss-Seidel correction xk+1 .xk. Roughly 
speaking, those approximations stay on the same side of the solution x. An overrelaxation 
factor w moves us closer to the solution. With w = 1, we recover Gauss-Seidel; 
with w > 1, the method is known as successive overrelaxation (SOR). The optimal 
choice of w never exceeds 2. It is often in the neighborhood of 1.9. 
To describe overrelaxation, let D, L, and U be the parts of A on, below, and above 
the diagonal, respectively. (This splitting has nothing to do with the A = LDU of elimination. 
In fact we now have A = L+D+U.) The Jacobi method has S = D on the 
left-hand side and T = .L.U on the right-hand side. Gauss-Seidel chose S = D+L 
and T = .U. To accelerate the convergence, we move to 
Overrelaxation [D+wL]xk+1 = [(1.w)D.wU]xk+wb: (5) 
Regardless of w, the matrix on the left is lower triangular and the one on the right is 
upper triangular. Therefore xk+1 can still replace xk, component by component, as soon 
as it is computed. A typical step is 
aii(xi)k+1 = aii(xi)k+w[(.ai1x1.. . ..aii.1xi.1)k+1+(.aiixi.. . ..ainxn)k+bi]: 
If the old guess xk happened to coincide with the true solution x, then the new guess xk+1 
would stay the same, and the quantity in brackets would vanish. 
Example 3 (SOR). For the same A = 
. 2 .1 
.1 2 
¤
, each overrelaxation step is 
" 
2 0 
.w 2
#
xk+1 = 
"
2(1.w) w 
0 2(1.w)
#
xk+wb: 
If we divide byw, these two matrices are the S and T in the splitting AS.T; the iteration 
is back to Sxk+1 = Txk+b. The crucial matrix L = S.1T is 
L = 
" 
2 0 
.w 2
#.1 "
2(1.w) w 
0 2(1.w)
# 
= 
" 
1.w 12
w 
12
w(1.w) 1.w + 1
4w2
#
:
7.4 Iterative Methods for Ax = b 411 
The optimalw makes the largest eigenvalue of L (its spectral radius) as small as possible. 
The whole point of overrelaxation is to discover this optimal w. The product of the 
eigenvalues equals detL = detT=detS: 
l1l2 = detL = (1.w)2: 
Always detS = detD because L lies below the diagonal, and detT = det(1.w)D because 
U lies above the diagonal. Their product is detL = (1.w)n. (This explains why 
we never go as far as w = 2. The product of the eigenvalues would be too large, and 
the iteration could not converge.) We also get a clue to the behavior of the eigenvalues: 
At the optimal w the two eigenvalues are equal. They must both equal w .1 so their 
product will match detL. This value of w is easy to compute, because the sum of the 
eigenvalues always agrees with the sum of the diagonal entries (the trace of L): 
Optimal w l1+l2 = (wopt.1)+(wopt.1) = 2.2wopt+ 
1
4
w2
opt: (6) 
This quadratic equation gives wopt = 4(2.
p
3) . 1:07. The two equal eigenvalues are 
approximately w .1 = 1:07, which is a major reduction from the Gauss-Seidel value 
l = 14
at w = 1. In this example, the right choice of w has again doubled the rate of 
convergence, because (14
)2 . :07. If w is further increased, the eigenvalues become a 
complex conjugate pair—both have jl j =w .1, which is now increasing with w. 
The discovery that such an improvement could be produced so easily, almost as if by 
magic, was the starting point for 20 years of enormous activity in numerical analysis. 
The first problem was solved in Young’s 1950 thesis—a simple formula for the optimal 
w. The key step was to connect the eigenvalues l of L to the eigenvalues m of the 
original Jacobi matrix D.1(.L.U). That connection is expressed by 
Formula for w (l +w .1)2 =lw2m2: (7) 
This is valid for a wide class of finite difference matrices, and if we take w = 1 (Gauss- 
Seidel) it yields l 2 =l m2. Therefore l =0 and l =m2 as in Example 2, where m =§12 
and l = 0, l = 14
. All the matrices in Young’s class have eigenvalues m that occur in 
plus-minus pairs, and the corresponding l are 0 and m2. So Gauss-Seidel doubles the 
Jacobi rate of convergence. 
The important problem is to choose w so that lmax will be minimized. Fortunately, 
Young’s equation (7) is exactly our 2 by 2 example! The best w makes the two roots l 
both equal to w .1: 
(w .1)+(w .1) = 2.2w +m2w2; or w = 
2(1.
p
1.m2) 
m2 : 
For a large matrix, this pattern will be repeated for a number of different pairs §mi—and 
we can only make a single choice of w. The largest m gives the largest value of w and
412 Chapter 7 Computations with Matrices 
of l = w .1. Since our goal is to make lmax as small as possible, that extremal pair 
specifies the best choice wopt: 
Optimal w wopt = 
2(1.
p
1.m2
max) 
m2
max 
and lmax =wopt.1: (8) 
7G The splittings of the .1, 2, .1 matrix of order n yield these eigenvalues 
of B: 
Jacobi (S = 0, 2, 0 matrix): S.1T has jl jmax = cos 
p 
n+1 
Gauss-Seidel (S = .1, 2, 0 matrix): S.1T has jl jmax = 
µ
cos 
p 
n+1
¶2 
SOR (with the best w): jl jmax = 
µ
cos 
p 
n+1
¶2
,µ
1+sin 
p 
n+1
¶2 
: 
This can only be appreciated by an example. Suppose A is of order 21, which is very 
moderate. Then h = 1 
22, cosph = :99, and the Jacobi method is slow; cos2ph = :98 
mpeans that even Gauss-Seidel will require a great many iterations. But since sinph = 
:02 = :14, the optimal overrelaxation method will have the convergence factor 
lmax = :86 
1:14 
= :75; with wopt = 1+lmax = 1:75: 
The error is reduced by 25% at every step, and a single SOR step is the equivalent of 
30 Jacobi steps: (:99)30 = :75. 
That is a striking result from such a simple idea. Its real applications are not in onedimensional 
problems like .uxx = f . A tridiagonal system Ax = b is already easy. It is 
for partial differential equations that overrelaxation (and other ideas) will be important. 
Changing to .uxx.uyy = f leads to the “five-point scheme.” The entries .1, 2, .1 in 
the x direction combine with .1, 2, .1 in the y direction to give a main diagonal of 
+4 and four off-diagonal entries of .1. The matrix A does not have a small bandwidth! 
There is no way to number the N2 mesh points in a square so that each point stays 
close to all four of its neighbors. That is the true curse of dimensionality, and parallel 
computers will partly relieve it. 
If the ordering goes a row at a time, every point must wait a whole row for the neighbor 
above it to turn up. The “five-point matrix” has bandwidth N: This matrix has had 
more attention, and been attacked in more different ways, than any other linear equation 
Ax = b. The trend now is back to direct methods, based on an idea of Golub and 
Hockney; certain special matrices will fall apart when they are dropped the right way. 
(It is comparable to the Fast Fourier Transform.) Before that came the iterative methods 
of alternating direction, in which the splitting separated the tridiagonal matrix in the x 
direction from the one in the y direction, A recent choice is S = L0U0, in which small
7.4 Iterative Methods for Ax = b 413 
N 
A = 
.1, 2, .1 in x and y 
gives .1, .1, 4, .1, .1 
entries of the true L and U are set to zero while factoring A. It is called incomplete LU 
and it can be terrific. 
We cannot close without mentioning the conjugate gradient method, which looked 
dead hut is suddenly very much alive (Problem 33 gives the steps). It is direct rather 
than iterative, but unlike elimination, it can be stopped part way. And needless to say, 
a completely new idea may still appear and win. But it seems fair to say that it was the 
change from :99 to :75 that revolutionized the solution of Ax = b. 
Problem Set 7.4 
1. This matrix has eigenvalues 2.
p
2, 2, and 2+
p
2: 
A = 
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75
: 
Find the Jacobi matrix D.1(.L.U) and the Gauss-Seidel matrix (D+L).1(.U) 
and their eigenvalues, and the numbers wopt and lmax for SOR. 
2. For this n by n matrix, describe the Jacobi matrix J = D.1(.L.U): 
A = 
2
6664 
2 .1 
.1 . . 
. . .1 
.1 2 
3
7775
: 
Show that the vector x1 = (sinph; sin2ph; : : : ; sinnph) is an eigenvector of J with 
eigenvalue l1 = cosph = cosp=(n+1). 
3. In Problem 2, show that xk = (sin kph; sin2kph; : : : ; sinnkph) is an eigenvector of A. 
Multiply xk by A to find the corresponding eigenvalue ak. Verify that in the 3 by 3 
case these eigenvalues are 2.
p
2, 2, 2+
p
2. 
Note. The eigenvalues of the Jacobi matrix J = 12
(.L.U) = I . 12
A are lk = 1. 
12ak = cos kph. They occur in plus-minus pairs and lmax is cosph.
414 Chapter 7 Computations with Matrices 
Problems 4–5 require Gershgorin’s “circle theorem”: Every eigenvalue of A lies in at 
least one of the circles C1; : : : ;Cn, where Ci has its center at the diagonal entry aii. Its 
radius ri = ai6=j jai jj is equal to the absolute sum along the rest of the row. 
Proof. Suppose xi is the largest component of x. Then Ax =l x leads to 
(l .aii)xi =aj6=i
ai jx j; or jl .aiij ·aj6=i 
jai jj 
jx jj 
jxij 
·aj6=i 
jai jj = ri: 
4. The matrix 
A = 
2
64
3 1 1 
0 4 1 
2 2 5
3
75 
is called diagonally dominant because every jaiij > ri. Show that zero cannot lie in 
any of the circles, and conclude that A is nonsingular. 
5. Write the Jacobi matrix J for the diagonally dominant A of Problem 4, and find the 
three Gershgorin circles for J. Show that all the radii satisfy ri < 1, and that the 
Jacobi iteration converges. 
6. The true solution to Ax = b is slightly different from the elimination solution to 
LUx0 = b; A.LU misses zero because of roundoff. One strategy is to do everything 
in double precision, but a better and faster way is iterative refinement: Compute only 
one vector r =b.Ax0 in double precision, solve LUy=r, and add the correction y to 
x0. Problem: Multiply x1 =x0+y by LU, write the result as a splitting Sx1 =Tx0+b, 
and explain why T is extremely small. This single step brings us almost exactly to x. 
7. For a general 2 by 2 matrix 
A = 
"
a b 
c d
#
; 
find the Jacobi iteration matrix S.1T = .D.1(L+U) and its eigenvalues mi. Find 
also the Gauss-Seidel matrix.(D+L).1U and its eigenvalues li, and decide whether 
lmax = m2
max. 
8. Change Ax = b to x = (I.A)x+b. What are S and T for this splitting? What matrix 
S.1T controls the convergence of xk+1 = (1.A)xk+b? 
9. If l is an eigenvalue of A, then is an eigenvalue of B = I .A. The real eigenvalues 
of B have absolute value less than 1 if the real eigenvalues of A lie between 
and . 
10. Show why the iteration xk+1 = (I.A)xk+b does not converge for A = 
. 2 .1 
.1 2 
¤
.
7.4 Iterative Methods for Ax = b 415 
11. Why is the norm of Bk never larger than kBkk? Then kBk < 1 guarantees that the 
powers Bk approach zero (convergence). This is no surprise, since jl jmax is below 
kBk. 
12. If A is singular, then all splittings A = S.T must fail. From Ax = 0, show that 
S.1Tx = x. So this matrix B = S.1T has l = 1 and fails. 
13. Change the 2s to 3s and find the eigenvalues of S.1T for both methods: 
(J) 
"
3 0 
0 3
#
xk+1 = 
"
0 1 
1 0
#
xk+b (GS) 
" 
3 0 
.1 3
#
xk+1 = 
"
0 1 
0 0
#
xk+b. 
Does jl jmax for Gauss-Seidel equal jl j2
max for Jacobi? 
14. Write a computer code (MATLAB or other) for Gauss-Seidel. You can define S and 
T from A, or set up the iteration loop directly from the entries ai j. Test it on the .1, 
2, .1 matrices A of order 10, 20, 50, with b = (1;0; : : : ;0). 
15. The SOR splitting matrix S is the same as for Gauss-Seidel except that the diagonal 
is divided by w. Write a program for SOR on an n by n matrix. Apply it with w = 1, 
1.4, 1.8, 2.2 when A is the .1, 2, .1 matrix of order 10. 
16. When A = AT, the Arnoldi-Lanczos method finds orthonormal q’s so that Aqj = 
bj.1qj.1+ajqj+bjqj+1 (with q0 = 0). Multiply by qTjto find a formula for aj. The 
equation says that AQ = QT where T is a matrix. 
17. What bound on jl jmax does Gershgorin give For these matrices (see Problem 4)? 
What are the three Gershgorin circles that contain all the eigenvalues? 
A = 
2
64
:3 :3 :2 
:3 :2 :4 
:2 :4 :1
3
75
A = 
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75
: 
The key point for large matrices is that matrix-vector multiplication is much 
faster than matrix-matrix multiplication. A crucial construction starts with a vector 
b and computes Ab;A2b; : : : (but never A2!). The first N vectors span the Nth 
Krylov subspace. They are the columns of the Krylov matrix KN: 
KN = 
h
b Ab A2b . . . AN.1b
i
: 
The Arnoldi-Lanczos iteration orthogonalizes the columns of KN, and the conjugate 
gradient iteration solves Ax = b when A is symmetric positive definite.
416 Chapter 7 Computations with Matrices 
Arnoldi Iteration Conjugate Gradient Iteration 
q1 = b=kbk x0 = 0; r0 = b; p0 = r0 
for n = 1 to N .1 for n = 1 to N 
v = Aqn an = (rT
n.1rn.1)=(pTn
.1Apn.1) step length xn.1 to xn 
for j = 1 to n xn = xn.1+anpn.1 approximate solution 
hjn = qTj
v rn = rn.1.anApn.1 new residual b.Axn 
v = v.hjnqj bn = (rT
n rn)=(rT
n.1rn.1) improvement this step 
hn+1;n = kvk pn = rn+bnpn.1 next search direction 
qn+1 = v=hn+1;n Note: Only 1 matrix vector multiplication Aq and Ap 
18. In Arnoldi, show that q2 is orthogonal to q1. The Arnoldi method is Gram-Schmidt 
orthogonalization applied to the Krylov matrix: KN = QNRN. The eigenvalues of 
QT
NAQN are often very close to those of A, even for N .n. The Lanczos iteration is 
Arnoldi for symmetric matrices (all coded in ARPACK). 
19. In conjugate gradients, show that r1 is orthogonal to r0 (orthogonal residuals), and 
pTAp0 = 0 (search directions are A-orthogonal). The iteration solves Ax = b by 
minimizing the error eTAe in the Krylov subspace. It is a fantastic algorithm.
Chapter 8 
Linear Programming and Game Theory 
8.1 Linear Inequalities 
Algebra is about equations, and analysis is often about inequalities. The line between 
them has always seemed clear. But I have realized that this chapter is a counterexample: 
linear programming is about inequalities, but it is unquestionably a part of linear 
algebra. It is also extremely useful—business decisions are more likely to involve linear 
programming than determinants or eigenvalues. 
There are three ways to approach the underlying mathematics: intuitively through 
the geometry, computationally through the simplex method, or algebraically through 
duality. These approaches are developed in Sections 8.1, 8.2, and 8.3. Then Section 
8.4 is about problems (like marriage) in which the solution is an integer. Section 8.5 
discusses poker and other matrix games. The MIT students in Bringing Down the House 
counted high cards to win at blackjack (Las Vegas follows fixed rules, and a true matrix 
game involves random strategies). 
Section 8.3 has something new in this fourth edition. The simplex method is now 
in a lively competition with a completely different way to do the computations, called 
an interior point method. The excitement began when Karmarkar claimed that his 
version was 50 times faster than the simplex method. (His algorithm, outlined in 8.2, 
was one of the first to be patented—something we then believed impossible, and not 
really desirable.) That claim brought a burst of research into methods that approach 
the solution from the “interior” where all inequalities are strict: x . 0 becomes x > 0. 
The result is now a great way to get help from the dual problem in solving the primal 
problem. 
One key to this chapter is to see the geometric meaning of linear inequalities. An 
inequality divides n-dimensional space into a halfspace in which the inequality is satisfied, 
and a halfspace in which it is not. A typical example is x+2y . 4. The boundary 
between the two halfspaces is the line x+2y = 4, where the inequality is “tight.” Figure 
8.1 would look almost the same in three dimensions. The boundary becomes a plane 
like x+2y+z = 4, and above it is the halfspace x+2y+z . 4. In n dimensions, the
418 Chapter 8 Linear Programming and Game Theory 
“plane” has dimension n.1. 
b 
b 
x 
y 
x + 2y  4 
x + 2y = 4 
x + 2y = 0 
(1, 2) 
Figure 8.1: Equations give lines and planes. Inequalities give halfspaces. 
Another constraint is fundamental to linear programming: x and y are required to be 
nonnegative. This pair of inequalities x . 0 and y . 0 produces two more halfspaces. 
Figure 8.2 is bounded by the coordinate axes: x . 0 admits all points to the right of 
x = 0, and y . 0 is the halfspace above y = 0. 
The Feasible Set and the Cost Function 
The important step is to impose all three inequalities at once. They combine to give the 
shaded region in Figure 8.2. This feasible set is the intersection of the three halfspaces 
x+2y . 4, x . 0, and y . 0. A feasible set is composed of the solutions to a family of 
linear inequalities like Ax . b (the intersection of m halfspaces). When we also require 
that every component of x is nonnegative (the vector inequality x . 0), this adds n more 
halfspaces. The more constraints we impose, the smaller the feasible set. 
It can easily happen that a feasible set is bounded or even empty. If we switch our 
example to the halfspace x+2y · 4, keeping x . 0 and y . 0, we get the small triangle 
OAB. By combining both inequalities x+2y . 4 and x+2y · 4, the set shrinks to a line 
where x+2y = 4. If we add a contradictory constraint like x+2y · .2, the feasible set 
is empty. 
The algebra of linear inequalities (or feasible sets) is one part of our subject. But 
linear programming has another essential ingredient: It looks for the feasible point that 
maximizes or minimizes a certain cost function like 2x+3y. The problem in linear 
programming is to find the point that lies in the feasible set and minimizes the cost. 
The problem is illustrated by the geometry of Figure 8,2. The family of costs 2x+3y
8.1 Linear Inequalities 419 
gives a family of parallel lines. The minimum cost comes when the first line intersects 
the feasible set. That intersection occurs at B, where x¤ = 0 and y¤ = 2; the minimum 
cost is 2x¤+3y¤ = 6. The vector (0;2) is feasible because it lies in the feasible set, it is 
optimal because it minimizes the cost function, and the minimum cost 6 is the value of 
the program. We denote optimal vectors by an asterisk. 
x 
y 
feasible set 
x + 2y  4 
x  0 
y  0 
B 
A 
cost 2x + 3y = 6 
2x + 3y = 0 
O 
Figure 8.2: The feasible set with flat sides, and the costs 2x+3y, touching at B. 
The optimal vector occurs at a corner of the feasible set. This is guaranteed by the 
geometry, because the lines that give the cost function (or the planes, when we get to 
more unknowns) move steadily up until they intersect the feasible set. The first contact 
must occur along its boundary! The “simplex method” will go from one corner of the 
feasible set to the next until it finds the corner with lowest cost. In contrast, “interior 
point methods” approach that optimal solution from inside the feasible set. 
Note. With a different cost function, the intersection might not be just a single point. If 
the cost happened to be x+2y, the whole edge between B and A would be optimal. The 
minimum cost is x¤+2y¤, which equals 4 for all these optimal vectors. On our feasible 
set, the maximum problem would have no solution! The cost can go arbitrarily high and 
the maximum cost is infinite. 
Every linear programming problem falls into one of three possible categories: 
1. The feasible set is empty. 
2. The cost function is unbounded on the feasible set. 
3. The cost reaches its minimum (or maximum) on the feasible set: the good case. 
The empty and unbounded cases should be very uncommon for a genuine problem in 
economics or engineering. We expect a solution.
420 Chapter 8 Linear Programming and Game Theory 
Slack Variables 
There is a simple way to change the inequality x+2y . 4 to an equation. Just introduce 
the difference as a slack variable w = x+2y.4. This is our equation! The old constraint 
x+2y . 4 is converted into w . 0, which matches perfectly the other inequality 
constraints x . 0, y . 0. Then we have only equations and simple nonnegativity constraints 
on x, y, w. The variables w that “take up the slack” are now included in the vector 
unknown x:
Primal problem Minimize cx subject to Ax = b and x . 0. 
The row vector c contains the costs; in our example, c = [2 3 0]. The condition x . 0 
puts the problem into the nonnegative part of Rn. Those inequalities cut back on the 
solutions to Ax = b. Elimination is in danger, and a completely new idea is needed. 
The Diet Problem and Its Dual 
Our example with cost 2x+3y can be put into words. It illustrates the “diet problem” 
in linear programming, with two sources of protein—say steak and peanut butter. Each 
pound of peanut butter gives a unit of protein, and each steak gives two units. At least 
four units are required in the diet. Therefore a diet containing x pounds of peanut butter 
and y steaks is constrained by x+2y . 4, as well as by x . 0 and y . 0. (We cannot have 
negative steak or peanut butter.) This is the feasible set, and me p1001cm is to minimize 
the cost. If a pound of peanut butter costs $2 and a steak is $3. then the cost of the whole 
diet is 2x+3y. Fortunately, the optimal diet is two steaks: x¤ = 0 and y¤ = 2. 
Every linear program, including this one, has a dual. If the original prohe1v a minimization, 
its dual is a maximization. The minimum in the given “primal problem” 
equals the maximum in its dual. This is the key to linear programming, and it will be 
explained in Section 8.3. Here we stay with the diet problem and try to interpret its dual. 
In place of the shopper, who buys enough protein at minimal cost, the dual problem 
is faced by a druggist. Protein pills compete with steak and peanut butter. Immediately 
we meet the two ingredients of a typical linear program: The druggist maximizes the 
pill price p, but that price is subject to linear constraints. Synthetic protein must not 
cost more than the protein in peanut butter ($2 a unit) or the protein in steak ($3 for two 
units). The price must be nonnegative or the druggist will not sell. Since four units of 
protein are required, the income to the druggist will be 4p: 
Dual problem Maximize 4p, subject to p · 2, 2p · 3, and p . 0. 
In this example the dual is easier to solve than the primal; it has only one unknown 
p. The constraint 2p · 3 is the tight one that is really active, and the maximum price 
of synthetic protein is p = $1:50. The maximum revenue is 4p = $6, and the shopper 
ends up paying the same for natural and synthetic protein. That is the duality theorem: 
maximum equals minimum.
8.1 Linear Inequalities 421 
Typical Applications 
The next section will concentrate on solving linear programs. This is the time to describe 
two practical situations in which we minimize or maximize a linear cost function subject 
to linear constraints. 
1. Production Planning. Suppose General Motors makes a profit of $200 on each 
Chevrolet, $300 on each Buick, and $500 on each Cadillac. These get 20, 17, and 14 
miles per gallon, respectively, and Congress insists that the average car must get 18. The 
plant can assemble a Chevrolet in 1 minute, a Buick in 2 minutes, and a Cadillac in 3 
minutes. What is the maximum profit in 8 hours (480 minutes)? 
Problem Maximize the profit 200x+300y+500z subject to 
20x+17y+14z . 18(x+y+z); x+2y+3z · 480; x;y; z . 0: 
2. Portfolio Selection. Federal bonds pay 5%, municipals pay 6%, and junk bonds pay 
9%. We can buy amounts x, y, z not exceeding a total of $100,000. The problem is to 
maximize the interest, with two constraints: 
(i) no more than $20,000 can be invested in junk bonds, and 
(ii) the portfolio’s average quality must be no lower than municipals, so x . z. 
Problem Maximize 5x+6y+9z subject to 
x+y+z · 100;000; z · 20;000; z · x; x;y; z . 0: 
The three inequalities give three slack variables, with new equations like w = x.z and 
inequalities w . 0. 
Problem Set 8.1 
1. Sketch the feasible set with constraints x+2y . 6, 2x+y . 6, x . 0, y . 0. What 
points lie at the three “corners” of this set? 
2. (Recommended) On the preceding feasible set, what is the minimum value of the 
cost function x+y? Draw the line x+y = constant that first touches the feasible set. 
What points minimize the cost functions 3x+y and x.y? 
3. Show that the feasible set constrained by 2x+5y · 3, .3x+8y · .5, x . 0, y . 0, 
is empty.
422 Chapter 8 Linear Programming and Game Theory 
4. Show that the following problem is feasible but unbounded, so it has no optimal 
solution: Maximize x+y, subject to x . 0, y . 0, .3x+2y · .1, x.y · 2. 
5. Add a single inequality constraint to x . 0, y . 0 such that the feasible set contains 
only one point. 
6. What shape is the feasible set x . 0, y . 0, z . 0, x+y+z = 1, and what is the 
maximum of x+2y+3z? 
7. Solve the portfolio problem at the end of the preceding section. 
8. In the feasible set for the General Motors problem, the nonnegativity x;y; z.0 leaves 
an eighth of three-dimensional space (the positive octant). How is this cut by the two 
planes from the constraints, and what shape is the feasible set? How do its corners 
show that, with only these two constraints, there will be only two kinds of cars in the 
optimal solution? 
9. (Transportation problem) Suppose Texas, California, and Alaska each produce a million 
barrels of oil; 800,000 barrels are needed in Chicago at a distance of 1000, 2000, 
and 3000 miles from the three producers, respectively; and 2,200,000 barrels are 
needed in New England 1500, 3000, and 3700 miles away. If shipments cost one 
unit for each barrel-mile, what linear program with five equality constraints must be 
solved to minimize the shipping cost? 
8.2 The Simplex Method 
This section is about linear programming with n unknowns x . 0 and m constraints 
Ax . b. In the previous section we had two variables, and one constraint x+2y . 4. The 
full problem is not hard to explain, and not easy to solve. 
The best approach is to put the problem into matrix form. We are given A, b, and c: 
1. an m by n matrix A. 
2. a column vector b with m components, and 
3. a row vector c (cost vector) with n components. 
To be “feasible,” the vector x must satisfy x . 0 and Ax . b. The optimal vector x¤ is the 
feasible vector of least cost—and the cost is cx = c1x1+. . .+cnxn. 
Minimum problem Minimize the cost cx, subject to x . 0 and Ax . b. 
The condition x . 0 restricts x to the positive quadrant in n-dimensional space. In 
R2 it is a quarter of the plane; it is an eighth of R3. A random vector has one chance 
in 2n of being nonnegative. Ax . b produces m additional halfspaces, and the feasible
8.2 The Simplex Method 423 
vectors meet all of the m+n conditions. In other words, x lies in the intersection of 
m+n halfspaces. This feasible set has flat sides; it may be unbounded. and it may be 
empty. 
The cost function cx brings to the problem a family of parallel planes. One plane 
cx = 0 goes through the origin. The planes cx = constant give all possible costs. As 
the cost varies, these planes sweep out the whole n-dimensional space. The optimal x¤ 
(lowest cost) occurs at the point where the planes first touch the feasible set. 
Our aim is to compute x¤. We could do it (in principle) by finding all the corners 
of the feasible set, and computing their costs. In practice this is impossible. There 
could be billions of corners, and we cannot compute them all. Instead we turn to the 
simplex method, one of the most celebrated ideas in computational mathematics. It was 
developed by Dantzig as a systematic way to solve linear programs, and either by luck 
or genius it is an astonishing success. The steps of the simplex method are summarized 
later, and first we try to explain them. 
The Geometry: Movement Along Edges 
I think it is the geometric explanation that gives the method away. Phase I simply locates 
one corner of the feasible set. The heart of the method goes from corner to corner 
along the edges of the feasible set. At a typical corner there are n edges to choose from. 
Some edges lead away from the optimal but unknown x¤, and others lead gradually 
toward it. Dantzig chose an edge that leads to a new corner with a lower cost. There 
is no possibility of returning to anything more expensive. Eventually a special corner is 
reached, from which all edges go the wrong way: The cost has been minimized. That 
corner is the optimal vector x¤, and the method stops. 
The next problem is to turn the ideas of corner and edge into linear algebra. A corner 
is the meeting point of n different planes. Each plane is given by one equation—just 
as three planes (front wall, side wall, and floor) produce a corner in three dimensions. 
Each corner of the feasible set comes from turning n of the n+m inequalities Ax . b 
and x . 0 into equations, and finding the intersection of these n planes. 
One possibility is to choose the n equations x1 = 0; : : : ;xn = 0, and end up at the 
origin. Like all the other possible choices, this intersection point will only be a genuine 
corner if it also satisfies the m remaining inequality constraints. Otherwise it is not even 
in the feasible set, and is a complete fake. Our example with n = 2 variables and m = 2 
constraints has six intersections, illustrated in Figure 8.3. Three of them are actually 
corners P, Q, R of the feasible set. They are the vectors (0;6), (2;2), and (6;0), One 
of them must be the optimal vector (unless the minimum cost is ..). The other three, 
including the origin, are fakes. 
In general there are (n+m)!=n!m! possible intersections. That counts the number of 
ways to choose n plane equations out of n+m. The size of that binomial coefficient 
makes computing all corners totally impractical for large m and n. It is the task of Phase
424 Chapter 8 Linear Programming and Game Theory 
x 
y 
feasible set 
2x + y = 6 
x + 2y = 6 
y = 0 
x = 0 
b 
b 
b
b b b 
P 
Q 
R 
Figure 8.3: The corners P, Q, R, and the edges of the feasible set. 
I either to find one genuine corner or to establish that the feasible set is empty. We 
continue on the assumption that a corner has been found. 
Suppose one of the n intersecting planes is removed. The points that satisfy the 
remaining n.1 equations form an edge that comes out of the corner. This edge 
is the intersection of the n.1 planes. To stay in the feasible set, only one direction is 
allowed along each edge. But we do have a choice of n different edges, and Phase II 
must make that choice. 
To describe this phase, rewrite Ax . b in a form completely parallel to the n simple 
constraints x j . 0. This is the role of the slack variables w = Ax.b. The constraints 
Ax . b are translated into w1 . 0; : : : ;wm . 0, with one slack variable for every row of 
A. The equation w = Ax.b, or Ax.w = b, goes into matrix form: 
Slack variables give m equations 
h
A .I
i"
x
w
# 
= b: 
The feasible set is governed by these m equations and the n+m simple inequalities x.0, 
w . 0. We now have equality constraints and nonnegativity. 
The simplex method notices no difference between x and w, so we simplify: 
h
A .I
i 
is renamed A 
"
x
w
# 
is renamed x 
h
c 0
i 
is renamed c: 
The equality constraints are now Ax = b. The n+m inequalities become just x . 0. 
The only trace left of the slack variable w is in the fact that the new matrix A is m by 
n+m, and the new x has n+m components. We keep this much of the original notation 
leaving m and n unchanged as a reminder of what happened. The problem has become: 
Minimize cx, subject to x . 0 and Ax = b.
8.2 The Simplex Method 425 
Example 1. The problem in Figure 8.3 has constraints x+2y . 6, 2x+y . 6, and cost 
x+y. The new system has four unknowns (x, y, and two slack variables): 
A = 
"
1 2 .1 0 
2 1 0 .1
# 
b = 
"
6
6
# 
c = 
h
1 1 0 0
i
: 
The Simplex Algorithm 
With equality constraints, the simplex method can begin. A corner is now a point where 
n components of the new vector x (the old x and w) are zero. These n components of x 
are the free variables in Ax = b. The remaining m components are the basic variables or 
pivot variables. Setting the n free variables to zero, the m equations Ax = b determine 
the m basic variables. This “basic solution” x will be a genuine corner if its m nonzero 
components are positive. Then x belongs to the feasible set. 
8A The corners of the feasible set are the basic feasible solutions of Ax = b. 
A solution is basic when n of its m+n components are zero, and it is feasible 
when it satisfies x . 0. Phase I of the simplex method finds one basic feasible 
solution. Phase II moves step by step to the optimal x¤. 
The corner point P in Figure 8.3 is the intersection of x = 0 with 2x+y.6 = 0. 
Corner 
Basic 
Feasible 
(0,6,6,0) 
(two zeros) 
(positive nonzeros) 
Ax = 
"
1 2 .1 0 
2 1 0 .1
#
2
6664 0
6
6
0
3
7775
= 
"
6
6
# 
= b: 
Which corner do we go to next? We want to move along an edge to an adjacent 
corner. Since the two corners are neighbors, m.1 basic variables will remain basic. 
Only one of the 6s will become free (zero). At the same time, one variable will move up 
from zero to become basic. The other m.1 basic components (in this case, the other 6) 
will change but stay positive. The choice of edge (see Example 2 below) decides which 
variable leaves the basis and which one enters. The basic variables are computed by 
solving Ax = b. The free components of x are set to zero. 
Example 2. An entering variable and a leaving variable move us to a new corner. 
Minimize 7x3.x4.3x5 subject to 
x1 +x3+6x4+2x5 = 8 
x2+x3 +3x5 = 9: 
Start from the corner at which x1 = 8 and x2 = 9 are the basic variables. At that corner 
x3 = x4 = x5 = 0. This is feasible, but the zero cost may not be minimal. It would 
be foolish to make x3 positive, because its cost coefficient is +7 and we are trying to 
lower the cost. We choose x5 because it has the most negative cost coefficient .3. The 
entering variable will be x5.
426 Chapter 8 Linear Programming and Game Theory 
With x5 entering the basis, x1 or x2 must leave. In the first equation, increase x5 and 
decrease x1 while keeping x1+2x5 = 8. Then x1 will be down to zero when x5 reaches 
4. The second equation keeps x2 +3x5 = 9. Here x5 can only increase as far as 3. To 
go further would make x2 negative, so the leaving variable is x2. The new corner has 
x = (2;0;0;0;3). The cost is down to .9. 
Quick Way In Ax = b, the right sides divided by the coefficients of the entering 
variable are 82
and 93
. The smallest ratio 93
tells which variable hits zero first, and must 
leave. We consider only positive ratios, because if the coefficient of x5 were .3, then 
increasing x5 would actually increase x2. (At x5 = 10 the second equation would give 
x2 = 39.) The ratio 93
says that the second variable leaves. It also gives x5 = 3. 
If all coefficients of x5 had been negative, this would be an unbounded case: we can 
make x5 arbitrarily large, and bring the cost down toward ... 
The current step ends at the new corner x = (2;0;0;0;3). The next step will only be 
easy if the basic variables x1 and x5 stand by themselves (as x1 and x2 originally did). 
Therefore, we “pivot” by substituting x5 = 13
(9.x2.x3) into the cost function and the 
first equation. The new problem, starting from the new corner, is: 
Minimize the cost 7x3.x4.(9.x2.x3) = x2+8x3.x4.9 
with constraints 
x1. 23
x2+ 13
x3+6x4 = 2 
13
x2+ 13
x3 +x5 = 3: 
The next step is now easy. The only negative coefficient .1 in the cost makes x4 the 
entering variable. The ratios of 26
and 30
, the right sides divided by the x4 column, make 
x1 the leaving variable. The new corner is x¤ = (0;0;0;13
;3). The new cost .913
is the 
minimum. 
In a large problem, a departing variable might reenter the basis later on. But the cost 
keeps going down—except in a degenerate case—so the m basic variables can’t be the 
same as before. No corner is ever revisited! The simplex method must end at the optimal 
corner (or at .. if the cost turns out to be unbounded). What is remarkable is the speed 
at which x¤ is found. 
Summary The cost coefficients 7, .1, .3 at the first corner and 1, 8, .1 at the 
second corner decided the entering variables. (These numbers go into r, the crucial vector 
defined below. When they are all positive we stop.) The ratios decided the leaving 
variables. 
Remark on Degeneracy A corner is degenerate if more than the usual n components 
of x are zero. More than n planes pass through the corner, so a basic variable 
happens to vanish. The ratios that determine the leaving variable will include zeros, and 
the basis might change without actually moving from the corner. In theory, we could 
stay at a corner and cycle forever in the choice of basis.
8.2 The Simplex Method 427 
Fortunately, cycling does not occur. It is so rare that commercial codes ignore it. 
Unfortunately, degeneracy is extremely common in applications—if you print the cost 
after each simplex step you see it repeat several times before the simplex method finds a 
good edge. Then the cost decreases again. 
The Tableau 
Each simplex step involves decisions followed by row operations—the entering and 
leaving variables have to be chosen, and they have to be made to come and go. One 
way to organize the step is to fit A, b, c into a large matrix, or tableau: 
Tableau is m+1 by m+n+1 T = 
"
A b 
c 0
#
: 
At the start, the basic variables may be mixed with the free variables. Renumbering if 
necessary, suppose that x1; : : : ;xm are the basic (nonzero) variables at the current corner. 
The first m columns of A form a square matrix B (the basis matrix for that corner). The 
last n columns give an m by n matrix N. The cost vector c splits into [cB cN], and the 
unknown x into (xB;xN). 
At the corner, the free variables are xN = 0. There, Ax = b turns into BxB = b: 
Tableau at corner T = 
" 
B N b 
cB cN 0 
# 
xN = 0 xB = B.1b cost = cBB.1b: 
The basic variables will stand alone when elimination multiplies by B.1: 
Reduced tableau T0 = 
" 
I B.1N B.1b 
cB cN 0 
#
: 
To reach the fully reduced row echelon form R = rref(T), subtract cB times the top 
block row from the bottom row: 
Fully reduced R = 
" 
I B.1N B.1b 
0 cN .cBB.1N .cBB.1b
#
: 
Let me review the meaning of each entry in this tableau, and also call attention to Example 
3 (following, with numbers). Here is the algebra: 
Constraints xB+B.1NxN = B.1b Corner xB = B.1b; xN = 0: (1) 
The cost cBxB+cNxN has been turned into 
Cost cx = (cN .cBB.1N)xN +cBB.1b Cost at this corner = cBB.1b: (2) 
Every important quantity appears in the fully reduced tableau R. We can decide whether 
the corner is optimal by looking at r = cN .cBB.1N in the middle of the bottom row. If
428 Chapter 8 Linear Programming and Game Theory 
any entry in r is negative, the cost can still be reduced. We can make rxN negative, 
at the start of equation (2), by increasing a component of xN. That will be our next step. 
But if r . 0, the best corner has been found. This is the stopping test, or optimality 
condition: 
8B The corner is optimal when r = cN .cBB.1N . 0. Its cost is cBB.1b. 
Negative components of r correspond to edges on which the cost goes down. 
The entering variable xi corresponds to the most negative component of r. 
The components of r are the reduced costs—the cost in cN to use a free variable 
minus what it saves. Computing r is called pricing out the variables. If the direct cost 
(in cN) is less than the saving (from reducing basic variables), then ri < 0, and it will pay 
to increase that free variable. 
Suppose the most negative reduced cost is ri. Then the ith component of xN is the 
entering variable, which increases from zero to a positive value a at the next corner 
(the end of the edge). 
As xi is increased, other components of x may decrease (to maintain Ax = b). The xk 
that reaches zero first becomes the leaving variable—it changes from basic to free. We 
reach the next corner when a component of xB drops to zero. 
That new corner is feasible because we still have x . 0. It is basic because we again 
have n zero components. The ith component of xN went from zero to a. The kth component 
of xB dropped to zero (the other components of xB remain positive). The leaving 
xk that drops to zero is the one that gives the minimum ratio in equation (3): 
8C Suppose xi is the entering variable and u is column i of N: 
At new corner xi =a = smallest ratio
(B.1b) j 
(B.1u) j 
= 
(B.1b)k 
(B.1u)k 
: (3) 
This minimum is taken only over positive components of B.1u. The kth column 
of the old B leaves the basis (xk becomes 0) and the new column u enters. 
B.1u is the column of B.1N in the reduced tableau R, above the most negative entry in 
the bottom row r, If B.1u · 0, the next corner is infinitely far away and the minimal 
cost is .. (this doesn’t happen here). Our example will go from the corner P to Q, and 
begin again at Q. 
Example 3. The original cost function x+y and constraints Ax = b = (6;6) give 
"
A b 
c 0
# 
= 
2
64
1 2 .1 0 6 
2 1 0 .1 6 
1 1 0 0 0 
3
75
: 
At the corner P in Figure 8.3, x = 0 intersects 2x+y = 6. To be organized, we exchange
8.2 The Simplex Method 429 
columns 1 and 3 to put basic variables before free variables: 
Tableau at P T = 
2
64
.1 2 1 0 6 
0 1 2 .1 6 
0 1 1 0 0 
3
75
: 
Then, elimination multiplies the first row by .1, to give a unit pivot, and uses the second 
row to produce zeros in the second column: 
Fully reduced at P R = 
2
64
1 0 3 .2 6 
0 1 2 .1 6 
0 0 .1 1 .6
3
75
: 
Look first at r = [.1 1] in the bottom row. It has a negative entry in column 3, so the 
third variable will enter the basis. The current corner P and its cost +6 are not optimal. 
The column above that negative entry is B.1u = (3;2); its ratios with the last column 
are 63
and 62
. Since the first ratio is smaller, the first unknown w (and the first column of 
the tableau) is pushed out of the basis. We move along the feasible set from corner P to 
corner Q in Figure 8.3. 
The new tableau exchanges columns 1 and 3, and pivoting by elimination gives 
2
64
3 0 1 .2 6 
2 1 0 .1 6 
.1 0 0 1 .6
3
75
!
2
6664 
1 0 13
.23
2 
0 1 .23 
13
2 
0 0 13 
13.4
3
7775
: 
In that new tableau at Q, r = [13 
13
] is positive. The stopping test is passed. The corner 
x = y = 2 and its cost +4 are optimal. 
The Organization of a Simplex Step 
The geometry of the simplex method is now expressed in algebra—“corners” are “basic 
feasible solutions.” The vector r and the ratio a are decisive. Their calculation is the 
heart of the simplex method, and it can be organized in three different ways: 
1. In a tableau, as above. 
2. By updating B.1 when column u taken from N replaces column k of B. 
3. By computing B = LU, and updating these LU factors instead of B.1. 
This list is really a brief history of the simplex method, In some ways, the most 
fascinating stage was the first—the tableau—which dominated the subject for so many 
years. For most of us it brought an aura of mystery to linear programming, chiefly 
because it managed to avoid matrix notation almost completely (by the skillful device of
430 Chapter 8 Linear Programming and Game Theory 
writing out all matrices in full !). For computational purposes (except for small problems 
in textbooks), the day of the tableau is over. 
To see why, remember that after the most negative coefficient in r indicates which 
column u will enter the basis, none of the other columns above r will be used. It was 
a waste of time to compute them. In a larger problem, hundreds of columns would be 
computed time and time again, just waiting for their turn to enter the basis. It makes 
the theory clear to do the eliminations so completely and reach R. But in practice this 
cannot be justified. 
It is quicker, and in the end simpler, to see what calculations are really necessary. 
Each simplex step exchanges a column of N for a column of B. Those columns are 
decided by r and a. This step begins with the current basis matrix B and the current 
solution xB = B.1b. 
A Step of the Simplex Method 
1. Compute the row vector l = cBB.1 and the reduced costs r = cN .l N. 
2. If r . 0, stop: the current solution is optimal. Otherwise, if ri is the most 
negative component, choose u = column i of N to enter the basis. 
3. Compute the ratios of B.1b to B.1u, admitting only positive components 
of B.1u. (If B.1u < 0, the minimal cost is ...) When the smallest ratio 
occurs at component k, the kth column of the current B will leave. 
4. Update B, B.1, or LU, and the solution xB = B.1b. Return to step 1. 
This is sometimes called the revised simplex method to distinguish it from the operations 
on a tableau. It is really the simplex method itself, boiled down. 
This discussion is finished once we decide how to compute steps 1, 3, and 4: 
l = cBB.1; v = B.1u; and xB = B.1b: (4) 
The most popular way is to work directly with B.1, calculating it explicitly at the first 
corner. At succeeding corners, the pivoting step is simple. When column k of the identity 
matrix is replaced by u, column k of B.1 is replaced by v=B.1u. To recover the identity 
matrix, elimination will multiply the old B.1 by 
E.1 = 
2
666664 
1 v1 
. . 
vk 
. . 
vn 1
3
777775 
.1 
= 
2
666664 
1 .v1=vk 
. . 
1=vk 
. . 
.vn=vk 1
3
777775
(5) 
Many simplex codes use the product form of the inverse, which saves these simple 
matrices E.1 instead of directly updating B.1. When needed, they are applied to b and 
cB. At regular intervals (maybe every 40 simplex steps), B.1 is recomputed and the E.1 
are erased. Equation (5) is checked in Problem 9 at the end of this section.
8.2 The Simplex Method 431 
A newer approach uses the ordinary methods of numerical linear algebra, regarding 
equation (4) as three equations sharing the same matrix B: 
l B = cB; Bv = u; BxB = b: (6) 
The usual factorization B = LU (or PB = LU, with row exchanges for stability) leads to 
the three solutions. L and U can be updated instead of recomputed. 
One question remains: How many simplex steps do we have to take? This is impossible 
to answer in advance. Experience shows that the method touches only about 3m=2 
different corners, which means an operation count of about m2n. That is comparable to 
ordinary elimination for Ax = b, and is the reason for the simplex method’s success. But 
mathematics shows that the path length cannot always be bounded by any fixed multiple 
or power of m. The worst feasible sets (Klee and Minty invented a lopsided cube) can 
force the simplex method to try every corner—at exponential cost. 
It was Khachian’s method that showed that linear programming could be solved in 
polynomial time.1 His algorithm stayed inside the feasible set, and captured x¤ in a series 
of shrinking ellipsoids. Linear programming is in the nice class P, not in the dreaded 
class NP (like the traveling salesman problem). For NP problems it is believed (but not 
proved) that all deterministic algorithms must take exponentially long to finish, in the 
worst case. 
All this time, the simplex method was doing the job—in an average time that is now 
proved (for variants of the usual method) to be polynomial. For some reason, hidden in 
the geometry of many-dimensional polyhedra, bad feasible sets are rare and the simplex 
method is lucky. 
Karmarkar’s Method 
We come now to the most sensational event in the recent history of linear programming. 
Karmarkar proposed a method based on two simple ideas, and in his experiments it 
defeated the simplex method. The choice of problem and the details of the code are both 
crucial, and the debate is still going on. But Karmarkar’s ideas were so natural, and fit 
so perfectly into the framework of applied linear algebra, that they can be explained in a 
few paragraphs. 
The first idea is to start from a point inside the feasible set—we will suppose it is 
x0 = (1;1; : : : ;1). Since the cost is cx, the best cost-reducing direction is toward .c. 
Normally that takes us off the feasible set; moving in that direction does not maintain 
Ax = b. If Ax0 = b and Ax1 = b, then Dx = x1.x0 has to satisfy ADx = 0. The step Dx 
must lie in the nullspace of A. Therefore we project .c onto the nullspace, to find the 
feasible direction closest to the best direction. This is the natural but expensive step in 
Karmarkar’s method. 
1The number of operations is bounded by powers of m and n, as in elimination. For integer programming and 
factoring into primes, all known algorithms can take exponentially long. The celebrated conjecture “P 6= NP” says 
that such problems cannot have polynomial algorithms.
432 Chapter 8 Linear Programming and Game Theory 
The step Dx is a multiple of the projection .Pc. The longer the step, the more the 
cost is reduced—but we cannot go out of the feasible set. The multiple of .Pc is chosen 
so that x1 is close to, but a little inside, the boundary at which a component of x reaches 
zero. 
That completes the first idea—the projection that gives the steepest feasible descent. 
The second step needs a new idea. since to continue in the same direction is useless. 
Karmarkar’s suggestion is to transform x1 back to (1;1; : : : ;1) at the center. His 
change of variables was nonlinear, but the simplest transformation is just a rescaling by 
a diagonal matrix D. Then we have room to move. The rescaling from x to X = D.1x 
changes the constraint and the cost: 
Ax = b becomes ADX = b cTx becomes cTDX: 
Therefore the matrix AD takes the place of A, and the vector cTD takes the place of cT. 
The second step projects the new c onto the nullspace of the new A. All the work is in 
this projection, to solve the weighted normal equations: 
(AD2AT)y = AD2c: (7) 
The normal way to compute y is by elimination. Gram-Schmidt will orthogonalize the 
columns of DAT, which can be expensive (although it makes the rest of the calculation 
easy). The favorite for large sparse problems is the conjugate gradient method, which 
gives the exact answer y more slowly than elimination, but you can go part way and then 
stop. In the middle of elimination you cannot stop. 
Like other new ideas in scientific computing, Karmarkar’s method succeeded on some 
problems and not on others. The underlying idea was analyzed and improved. Newer 
interior point methods (staying inside the feasible set) are a major success—mentioned 
in the next section. And the simplex method remains tremendously valuable. like the 
whole subject of linear programming—which was discovered centuries after Ax = b, but 
shares the fundamental ideas of linear algebra. The most far-reaching of those ideas is 
duality, which comes next. 
Problem Set 8.2 
1. Minimize x1+x2.x3, subject to 
2x1.4x2+x3+x4 = 4 
3x1+5x2+x3 +x5 = 2: 
Which of x1, x2, x3 should enter the basis, and which of x4, x5 should leave? Compute 
the new pair of basic variables, and find the cost at the new corner. 
2. After the preceding simplex step, prepare for and decide on the next step.
8.2 The Simplex Method 433 
3. In Example 3, suppose the cost is 3x+y. With rearrangement, the cost vector is 
c = (0;1;3;0). Show that r . 0 and, therefore, that corner P is optimal. 
4. Suppose the cost function in Example 3 is x.y, so that after rearrangement c = 
(0;.1;1;0) at the corner P. Compute r and decide which column u should enter the 
basis. Then compute B.1u and show from its sign that you will never meet another 
corner. We are climbing the y-axis in Figure 8.3, and x.y goes to ... 
5. Again in Example 3, change the cost to x+3y. Verify that the simplex method takes 
you from P to Q to R, and that the corner R is optimal. 
6. Phase I finds a basic feasible solution to Ax = b (a corner). After changing signs 
to make b . 0, consider the auxiliary problem of minimizing w1 +w2 +. . .+wm, 
subject to x . 0, w . 0, Ax+w = b. Whenever Ax = b has a nonnegative solution, 
the minimum cost in this problem will be zero—with w¤ = 0. 
(a) Show that, for this new problem, the corner x = 0, w = b is both basic and feasible. 
Therefore its Phase I is already set, and the simplex method can proceed 
to find the optimal pair x¤, w¤. If w¤ = 0, then x¤ is the required corner in the 
original problem. 
(b) With A = [1 1] and b = [3], write out the auxiliary problem, its Phase I vector 
x=0, w=b, and its optimal vector. Find the corner of the feasible set x1.x2 =3, 
x1 . x2 . 0, and draw a picture of this set. 
7. If we wanted to maximize instead of minimize the cost (with Ax = b and x . 0), 
what would be the stopping test on r, and what rules would choose the column of N 
to make basic and the column of B to make free? 
8. Minimize 2x1+x2, subject to x1+x2 . 4, x1+3x2 . 12, x1.x2 . 0, x . 0. 
9. Verify the inverse in equation (5), and show that BE has Bv = u in its kth column. 
Then BE is the correct basis matrix for the next stop, E.1B.1 is its inverse, and E.1 
updates the basis matrix correctly. 
10. Suppose we want to minimize cx = x1.x2, subject to 
2x1.4x2+x3 = 6 
3x1+6x2 +x4 = 12 
(all x1;x2;x3;x4 . 0): 
Starting from x = (0;0;6;12), should x1 or x2 be increased from its current value of 
zero? How far can it be increased until the equations force x3 or x4 down to zero? At 
that point, what is the new x? 
11. For the matrix P = I .AT(AAT).1A, show that if x is in the nullspace of A, then 
Px = x. The nullspace stays unchanged under this projection. 
12. (a) Minimize the cost cTx = 5x1+4x2+8x3 on the plane x1+x2+x3 = 3, by testing 
the vertices P, Q, R, where the triangle is cut off by the requirement x . 0.
434 Chapter 8 Linear Programming and Game Theory 
(b) Project c = (5;4;8) onto the nullspace of A = [1 1 1], and find the maximum 
step s that keeps e.sPc nonnegative. 
8.3 The Dual Problem 
Elimination can solve Ax=b, but the four fundamental subspaces showed that a different 
and deeper understanding is possible. It is exactly the same for linear programming. The 
mechanics of the simplex method will solve a linear program, but duality is really at the 
center of the underlying theory. Introducing the dual problem is an elegant idea, and 
at the same time fundamental for the applications. We shall explain as much as we 
understand. 
The theory begins with the given primal problem: 
Primal (P) Minimize cx, subject to x . 0 and Ax . b. 
The dual problem starts from the same A, b, and c, and reverses everything. In the 
primal, c is in the cost function and b is in the constraint, In the dual, b and c are 
switched, The dual unknown y is a row vector with m components, and the feasible set 
has yA · c instead of Ax . b. 
In short, the dual of a minimum problem is a maximum problem. Now y . 0: 
Dual (D) Maximize yb, subject to y . 0 and yA · c. 
The dual of this problem is the original minimum problem. There is complete symmetry 
between the primal and dual problems. The simplex method applies equally well to a 
maximization—anyway, both problems get solved at once. 
I have to give you some interpretation of all these reversals. They conceal a competition 
between the minimizer and the maximizer. In the diet problem, the minimizer has n 
foods (peanut butter and steak, in Section 8.1). They enter the diet in the (nonnegative) 
amounts x1; : : : ;xn. The constraints represent m required vitamins, in place of the one 
earlier constraint of sufficient protein. The entry ai j measures the ith vitamin in the jth 
food, and the ith row of Ax . b forces the diet to include at least bi of that vitamin. If ci 
is the cost of the jth food, then c1x1+. . .+cnxn = cx is the cost of the diet. That cost is 
to be minimized. 
In the dual, the druggist is selling vitamin pills at prices yi . 0. Since food j 
contains vitamins in the amounts ai j, the druggist’s price for the vitamin equivalent 
cannot exceed the grocer’s price c j. That is the jth constraint in yA · c. Working within 
this constraint on vitamin prices, the druggist can sell the required amount bi of each 
vitamin for a total income of y1b1+. . .+ymbm = yb—to be maximized. 
The feasible sets for the primal and dual problems look completely different. The 
first is a subset of Rn, marked out by x . 0 and Ax . b. The second is a subset of Rm,
8.3 The Dual Problem 435 
determined by y . 0 and AT and c. The whole theory of linear programming hinges on 
the relation between primal and dual. Here is the fundamental result: 
8D Duality Theorem When both problems have feasible vectors, they have 
optimal x¤ and y¤. The minimum cost cx¤ equals the maximum income y¤b. 
If optimal vectors do not exist, there are two possibilities: Either both feasible sets are 
empty, or one is empty and the other problem is unbounded (the maximum is +. or the 
minimum is ..). 
The duality theorem settles the competition between the grocer and the druggist. The 
result is always a tie. We will find a similar “minimax theorem” in game theory. The 
customer has no economic reason to prefer vitamins over food, even though the druggist 
guarantees to match the grocer on every food—and even undercuts on expensive foods 
(like peanut butter). We will show that expensive foods are kept out of the optimal diet, 
so the outcome can be (and is) a tie. 
This may seem like a total stalemate, but I hope you will not be fooled. The optimal 
vectors contain the crucial information. In the primal problem, x¤ tells the purchaser 
what to buy. In the dual, y¤ fixes the natural prices (shadow prices) at which the economy 
should run. Insofar as our linear model reflects the true economy. x¤ and y¤ represent 
the essential decisions to be made. 
We want to prove that c¤x = y¤b. It may seem obvious that the druggist can raise 
the vitamin prices y¤ to meet the grocer, hut only one thing is truly clear: Since each 
food can be replaced by its vitamin equivalent, with no increase in cost, all adequate 
food diets must cost at least as much as vitamins. This is only a one-sided inequality, 
druggist’s price · grocer’s price. It is called weak duality, and it is easy to prove for 
any linear program and its dual: 
8E If x and y are feasible in the primal and dual problems, then yb · cx. 
Proof. Since the vectors are feasible, they satisfy Ax . b and yA · c. Because feasibility 
also includes x . 0 and y . 0, we can take inner products without spoiling those 
inequalities (multiplying by negative numbers would reverse them): 
yAx . yb and yAx · cx: (1) 
Since the left-hand sides are identical, we have weak duality yb · cx. 
This one-sided inequality prohibits the possibility that both problems are unbounded. 
If yb is arbitrarily large, a feasible x would contradict yb · cx. Similarly, if cx can go 
down to .., the dual cannot admit a feasible y. 
Equally important, any vectors that achieve yb = cx must be optimal. At that point 
the grocer’s price equals the druggist’s price. We recognize an optimal food diet and 
optimal vitamin prices by the fact that the consumer has nothing to choose: 
8F If the vectors x and y are feasible and cx = yb, then x and y are optimal.
436 Chapter 8 Linear Programming and Game Theory 
Since no feasible y can make yb larger than cx, our y that achieves this value is optimal. 
Similarly, any x that achieves the cost cx = yb must be an optimal x¤. 
We give an example with two foods and two vitamins. Note how AT appears when 
we write out the dual, since yA · c for row vectors means ATyT · cT for columns. 
Primal Minimize x1+4x2 Dual Maximize 6y1+7y2 
subject to x1 . 0; x2 . 0 subject to y1 . 0; y2 . 0 
2x1+x2 . 6 2y1+5y2 · 1 
5x1+3x2 . 7. y1+3x2 · 4. 
Solution x1 = 3 and x2 = 0 are feasible, with cost x1+4x2 = 3. In the dual, y1 = 12
and 
y2 = 0 give the same value 6y1+7y2 = 3. These vectors must be optimal. 
Please look closely to see what actually happens at the moment when yb = cx. Some 
of the inequality constraints are tight, meaning that equality holds. Other constraints are 
loose, and the key rule makes economic sense: 
(i) The diet has x¤j
= 0 when food j is priced above its vitamin equivalent. 
(ii) The price is y¤i
= 0 when vitamin i is oversupplied in the diet x¤. 
In the example, x2 = 0 because the second food is too expensive. Its price exceeds the 
druggist’s price, since y1 +3y2 · 4 is a strict inequality 12
+0 < 4. Similarly, the diet 
required seven units of the second vitamin, but actually supplied 5x1+3x2 = 15. So we 
found y2 = 0, and that vitamin is a free good. You can see how the duality has become 
complete. 
These optimality conditions are easy to understand in matrix terms. From equation 
(1) we want y¤Ax¤ = y¤b at the optimum. Feasibility requires Ax¤ . b, and we look for 
any components in which equality fails. This corresponds to a vitamin that is oversupplied, 
so its price is y¤i
= 0. 
At the same time, we have y¤A · c. All strict inequalities (expensive foods) correspond 
to x¤j
= 0 (omission from the diet). That is the key to y¤Ax¤ = cx¤, which we 
need. These are the complementary slackness conditions of linear programming, and 
the Kuhn-Tucker conditions of nonlinear programming: 
8G The optimal vectors x¤ and y¤ satisfy complementary slackness: 
If (Ax¤)i > bi then y¤i
= 0 If (y¤A) j > c j then x¤j
= 0: (2) 
Let me repeat the proof. Any feasible vectors x and y satisfy weak duality: 
yb · y(Ax) = (yA)x · cx: (3) 
We need equality, and there is only one way in which y¤b can equal y¤(Ax¤). Any time 
bi < (Ax¤)i, the factor y¤i
that multiplies these components must be zero.
8.3 The Dual Problem 437 
Similarly, feasibility gives yAx · cx. We get equality only when the second slackness 
condition is fulfilled. If there is an overpricing (y¤A) j < c j, it must be canceled through 
multiplication by x¤j
= 0. This leaves us with y¤b = cx¤ in equation (3). This equality 
guarantees the optimality of x¤ and y¤. 
The Proof of Duality 
The one-sided inequality yb · cx was easy to prove; it gave a quick test for optimal 
vectors (they turn it into an equality); and now it has given the slackness conditions in 
equation (2). The only thing it has not done is to show that y¤b = cx¤ is really possible. 
Until those optimal vectors are actually produced, the duality theorem is not complete. 
To produce y¤ we return to the simplex method—which has already computed x¤. Our 
problem is to show that the method stopped in the right place for the dual problem (even 
though it was constructed to solve the primal). Recall that the m inequalities Ax . b 
were changed to equations by introducing the slack variables w = Ax.b: 
Primal feasibility 
h
A .I
i"
x
w
# 
= b and 
"
x
w
# 
. 0: (4) 
Every simplex step picked m columns of the long matrix [A .I] to be basic, and shifted 
them (theoretically) to the front. This produced [B N]. The same shift reordered the 
long cost vector [c 0] into [cB cN]. The stopping condition, which brought the simplex 
method to an end, was r = cN .cBB.1N . 0. 
This condition r . 0 was finally met, since the number of corners is finite. At that 
moment the cost was as low as possible: 
Minimum cost cx¤ = 
h
cB cN
i"
B.1b 
0 
# 
= cBB.1b: (5) 
If we can choose y¤ = cBB.1 in the dual, we certainly have y¤b = cx¤. The minimum 
and maximum will be equal. We have to show that this y¤ satisfies the dual constraints 
yA · c and y . 0: 
Dual feasibility y
h
A .I
i 
· 
h
c 0
i
: (6) 
When the simplex method reshuffles the long matrix and vector to put the basic variables 
first, this rearranges the constraints in equation (6) into 
y
h
B N
i 
· 
h
cB cN
i
: (7) 
For y¤ = cBB.1, the first half is an equality and the second half is cBB.1N · cN. This is 
the stopping condition r . 0 that we know to be satisfied! Therefore our y¤ is feasible, 
and the duality theorem is proved. By locating the critical m by m matrix B, which is 
nonsingular as long as degeneracy is forbidden, the simplex method has produced the 
optimal y¤ as well as x¤.
438 Chapter 8 Linear Programming and Game Theory 
Shadow Prices 
In calculus, everybody knows the condition for a maximum or a minimum: The first 
derivatives are zero. But this is completely changed by constraints. The simplest example 
is the line y = x. Its derivative is never zero, calculus looks useless, and the largest 
y is certain to occur at the end of the interval. That is exactly the situation in linear programming! 
There are more variables, and an interval is replaced by a feasible set, but 
still the maximum is always found at a corner of the feasible set (with only m nonzero 
components). 
The problem in linear programming is to locate that cornet For this, calculus is not 
completely helpless. Far from it, because “Lagrange multipliers” will bring back zero 
derivatives at the maximum and minimum. The dual variables y are exactly the Lagrange 
multipliers. And they answer the key question: How does the minimum cost 
cx¤ = y¤b change, if we change b or c? 
This is a question in sensitivity analysis. It allows us to squeeze extra information out 
of the dual problem. For an economist or an executive, these questions about marginal 
cost are the most important. 
If we allow large changes in b or c, the solution behaves in a very jumpy way. As 
the price of eggs increases, there will be a point at which they disappear from the diet. 
The variable xegg will jump from basic to free. To follow it properly, we would have 
to introduce “parametric” programming. But if the changes are small, the corner that 
was optimal remains optimal. The choice of basic variables does not change; B and N 
stay the same. Geometrically, we shifted the feasible set a little (by changing b), and we 
tilted the planes that come up to meet it (by changing c). When these changes are small, 
contact occurs at the same (slightly moved) corner. 
At the end of the simplex method, when the right basic variables are known, the 
corresponding m columns of A make up the basis matrix B. At that corner, a shift of size 
Db changes the minimum cost by y¤Db. The dual solution y¤ gives the rate of change 
of minimum cost (its derivative) with respect to changes in b. The components of y¤ 
are the shadow prices. If the requirement for a vitamin goes up by D, and the druggist’s 
price is y¤1
, then the diet cost (from druggist or grocer) will go up by y¤1
D. In the case 
that y¤1
is zero, that vitamin is a free good and the small change has no effect. The diet 
already contained more than b1. 
We now ask a different question. Suppose we insist that the diet contain some small 
edible amount of egg. The condition xegg . 0 is changed to xegg . d . How does this 
change the cost? 
If eggs were in the diet x¤, there is no change. But if x¤
egg = 0, it will cost extra to add 
in the amount d . The increase will not be the full price ceggd , since we can cut down on 
other foods. The reduced cost of eggs is their own price, minus the price we are paying 
for the equivalent in cheaper foods. To compute it we return to equation (2) of Section
8.3 The Dual Problem 439 
8.2: 
cost = (cN .cBB.1N)xN +cBB.1b = rxN +cBB.1b: 
If egg is the first free variable, then increasing the first component of xN to d will increase 
the cost by r1d . The real cost of egg is r1. This is the change in diet cost as the zero lower 
bound (nonnegativity constraint) moves upwards. We know that r . 0, and economics 
tells us the same thing: The reduced cost of eggs cannot be negative or they would have 
entered the diet. 
Interior Point Methods 
The simplex method moves along edges of the feasible set, eventually reaching the optimal 
corner x¤. Interior point methods start inside the feasible set (where the constraints 
are all inequalities). These methods hope to move more directly to x¤ (and also find y¤). 
When they are very close to the answer, they stop. 
One way to stay inside is to put a barrier at the boundary. Add an extra cost in the 
form of a logarithm that blows up when any variable x or any slack variable w = Ax.b 
touches zero. The number q is a small parameter to be chosen: 
Barrier problem P(q ) Minimize cx.q 
A 
na1
ln xi+ 
ma1
lnwi
!
: (8) 
This cost is nonlinear (but linear programming is already nonlinear, from inequalities). 
The notation is simpler if the long vector (x;w) is renamed x and [A .I] is renamed A. 
The primal constraints are now x . 0 and Ax = b. The sum of ln xi in the barrier now 
goes to m+n. 
The dual constraints are yA · c. (We don’t need y . 0 when we have Ax = b in 
the primal.) The slack variable is s = c.yA, with s . 0. What are the Kuhn-Tucker 
conditions for x and y to be the optimal x¤ and y¤? Along with the constraints we require 
duality: cx¤ = y¤b. 
Including the barrier gives an approximate problem P(q ). For its Kuhn-Tucker optimality 
conditions, the derivative of ln xi gives 1=xi. If we create a diagonal matrix X 
from those positive numbers xi, and use e = [1 . . . 1] for the row vector of n+m ones, 
then optimality in P(q ) is as follows: 
Primal (column vectors) Ax = b with x . 0 (9a) 
Dual (row vectors) yA+q eX.1 = c (9b) 
As q ! 0, we expect those optimal x and y to approach x¤ and y¤ for the original nobarrier 
problem, and q eX.1 will stay nonnegative. The plan is to solve equations (9a– 
9b) with smaller and smaller barriers, given by the size of q . 
In reality, those nonlinear equations are approximately solved by Newton’s method 
(which means they are linearized). The nonlinear term is s = q eX.1. To avoid 1=xi,
440 Chapter 8 Linear Programming and Game Theory 
rewrite that as sX =q e. Creating the diagonal matrix S from s, this is eSX =q e. If we 
change e, y, c, and s to column vectors, and transpose, optimality now has three parts: 
Primal Ax = b; x . 0: (10a) 
Dual ATy+s = c: (10b) 
Nonlinear XSe.q e = 0: (10c) 
Newton’s method takes a step Dx, Dy, Ds from the current x, y, s. (Those solve equations 
(10a) and (10b), but not (10c).) By ignoring the second-order term DXDSe, the 
corrections come from linear equations! 
ADx = 0: (11a) 
Newton step ATDy+Ds = 0: (11b) 
SDx+XDs =q e.XSe: (11c) 
Robert Freund’s notes for his MIT class pin down the (quadratic) convergence rate and 
the computational complexity of this algorithm. Regardless of the dimensions m and n, 
the duality gap sx is generally below 10.8 after 20–80 Newton steps. This algorithm 
is used almost “as is” in commercial interior-point software, and for a large class of 
nonlinear optimization problems as well. 
The Theory of Inequalities 
There is more than one way to study duality. We quickly proved yb · cx, and then 
used the simplex method to get equality. This was a constructive proof ; x¤ and y¤ were 
actually computed. Now we look briefly at a different approach, which omits the simplex 
algorithm and looks more directly at the geometry. I think the key ideas will be just as 
clear (in fact, probably clearer) if we omit some of the details. 
The best illustration of this approach came in the Fundamental Theorem of Linear 
Algebra. The problem in Chapter 2 was to find b in the column space of A. After elimination 
and the four subspaces, this solvability question was answered in a completely 
different way by Problem 11 in Section 3.1: 
8H Ax = b has a solution or there is a y such that yA = 0 and yb 6= 0. 
This is the theorem of the alternative, because to find both x and y is impossible: If Ax= 
b then yAx = yb 6= 0, and this contradicts yAx = 0x = 0. In the language of subspaces, 
either b is in the column space, or it has a component sticking into the left nullspace. 
That component is the required y. 
For inequalities, we want to find a theorem of exactly the same kind. Start with the 
same system Ax = b, but add the constraint x . 0. When does there exist a nonnegative 
solution to Ax = b? 
In Chapter 2, b was anywhere in the column space. Now we allow only nonnegative 
combinations, and the b’s no longer fill out a subspace. Instead, they fill a cone-shaped
8.3 The Dual Problem 441 
column 1 
column 4 
column 2 
column 3 
b 
b is in 
the cone 
b is 
outside 
the cone 
b 
separating 
plane
P 
y 
Figure 8.4: The cone of nonnegative combinations of the columns: b = Ax with x . 0. When b is outside the cone, 
it is separated by a hyperplane (perpendicular to y). 
region. For n columns in Rm, the cone becomes an open-ended pyramid. Figure 8.4 has 
four vectors in R2, and A is 2 by 4. If b lies in this cone, there is a nonnegative solution 
to Ax = b; otherwise not. 
What is the alternative if b lies outside the cone? Figure 8.4 also shows a “separating 
hyperplane,” which has the vector b on one side and the whole cone on the other side. 
The plane consists of all vectors perpendicular to a fixed vector y. The angle between 
y and b is greater than 90°, so yb < 0. The angle between y and every column of A is 
less than 90°, so yA . 0. This is the alternative we are looking for. This theorem of the 
separating hyperplane is fundamental to mathematical economics. 
8I Ax = b has a nonnegative solution or there is a y with yA . 0 and 
yb < 0. 
Example 1. The nonnegative combinations of the columns of A = I fill the positive 
quadrant b . 0. For every other b, the alternative must hold for some y: 
Not in cone If b = 
" 
2 
.3
#
; then y = 
h
0 1
i 
gives yI . 0 but yb = .3: 
The x-axis, perpendicular to y = [0 1], separates b from the cone = quadrant. 
Here is a curious pair of alternatives. It is impossible for a subspace S and its orthogonal 
complement S? both to contain positive vectors. Their inner product would 
be positive, not zero. But S might be the x-axis and S? the y-axis, in which case they 
contain the “semipositive” vectors [1 0] and [0 1]. This slightly weaker alternative does 
work: Either S contains a positive vector x > 0, or S? contains a nonzero y . 0. When S 
and S? are perpendicular lines in the plane, one or the other must enter the first quadrant. 
I can’t see this clearly in three or four dimensions.
442 Chapter 8 Linear Programming and Game Theory 
For linear programming, the important alternatives come when the constraints are 
inequalities. When is the feasible set empty (no x)? 
8J Ax.b has a solution x.0 or there is a y·0 with yA.0 and yb<0. 
Proof. The slack variables w = Ax.b change Ax . b into an equation. Use 8I: 
First alternative 
h
A .I
i"
x
w
# 
= b for some 
"
x
w
# 
. 0: 
Second alternative y
h
A .I
i 
. 
h
0 0
i 
for some y with yb < 0: 
It is this result that leads to a “nonconstructive proof” of the duality theorem. 
Problem Set 8.3 
1. What is the dual of the following problem: Minimize x1 +x2, subject to x1 . 0, 
x2 . 0, 2x1 . 4, x1+3x2 . 11? Find the solution to both this problem and its dual, 
and verify that minimum equals maximum. 
2. What is the dual of the following problem: Maximize y2 subject to y1 . 0, y2 . 0, 
y1+y2 · 3? Solve both this problem and its dual. 
3. Suppose A is the identity matrix (so that m=n), and the vectors b and c are nonnegative. 
Explain why x¤ =b is optimal in the minimum problem, find y¤ in the maximum 
problem, and verify that the two values are the same. If the first component of b is 
negative, what are x¤ and y¤? 
4. Construct a 1 by 1 example in which Ax.b, x.0 is unfeasible, and the dual problem 
is unbounded. 
5. Starting with the 2 by 2 matrix A=
. 1 0 
0 .1 
¤
, choose b and c so that both of the feasible 
sets Ax . b, x . 0 and yA · c, y . 0 are empty. 
6. If all entries of A, b, and c are positive, show that both the primal and the dual are 
feasible. 
7. Show that x = (1;1;1;0) and y = (1;1;0;1) are feasible in the primal and dual, with 
A = 
2
6664 
0 0 1 0 
0 1 0 0 
1 1 1 1 
1 0 0 1
3
7775
; b = 
2
6664 
1
1
1
1
3
7775
; c = 
2
6664 
1
1
1
3
3
7775
: 
Then, after computing cx and yb, explain how you know they are optimal.
8.3 The Dual Problem 443 
8. Verify that the vectors in the previous exercise satisfy the complementary slackness 
conditions in equation (2), and find the one slack inequality in both the primal and 
the dual. 
9. Suppose that A = 
. 1 0 
0 1 
¤
, b = 
. 1 
.1 
¤
, and c = 
.
11
¤
. Find the optimal x and y, and verify 
the complementary slackness conditions (as well as yb = cx). 
10. If the primal problem is constrained by equations instead of inequalities—Minimize 
cx subject to Ax = b and x . 0—then the requirement y . 0 is left out of the dual: 
Maximize yb subject to yA · c. Show that the one-sided inequality yb · cx still 
holds. Why was y . 0 needed in equation (1) but not here? This weak duality can be 
completed to full duality. 
11. (a) Without the simplex method, minimize the cost 5x1+3x2+4x3, subject to x1+ 
x2+x3 . 1, x1 . 0, x2 . 0, x3 . 0. 
(b) What is the shape of the feasible set? 
(c) What is the dual problem, and what is its solution y? 
12. If the primal has a unique optimal solution x¤, and then c is changed a little, explain 
why x¤ still remains the optimal solution. 
13. Write the dual of the following problem: Maximize x1+x2+x3 subject to 2x1+x2 · 
4, x3 · 6. What are the optimal x¤ and y¤ (if they exist!)? 
14. If A = 
. 1 1 
0 1 
¤
, describe the cone of nonnegative combinations of the columns. If b lies 
inside that cone, say b = (3;2), what is the feasible vector x? If b lies outside, say 
b = (0;1), what vector y will satisfy the alternative? 
15. In three dimensions, can you find a set of six vectors whose cone of nonnegative 
combinations fills the whole space? What about four vectors? 
16. Use 8H to show that the following equation has no solution, because the alternative 
holds: "
2 2 
4 4
#
x = 
"
1
1
#
: 
17. Use 8I to show that there is no solution x . 0 (the alternative holds): 
"
1 3 .5 
1 .4 .7
#
x = 
"
2
3
#
: 
18. Show that the alternatives in 8J (Ax . b, x . 0, yA . 0, yb < 0, y · 0) cannot both 
hold. Hint: yAx.
444 Chapter 8 Linear Programming and Game Theory 
8.4 Network Models 
Some linear problems have a structure that makes their solution very quick. Band matrices 
have all nonzeros close to the main diagonal, and Ax = b is easy to solve. In linear 
programming, we are interested in the special class for which A is an incidence matrix. 
Its entries are .1 or +1 or (mostly) zero, and pivot steps involve only additions and 
subtractions. Much larger problems than usual can be solved. 
Networks enter all kinds of applications. Traffic through an intersection satisfies 
Kirchhoff’s current law: flow in equals flow out. For gas and oil, network programming 
has designed pipeline systems that are millions of dollars cheaper than the intuitive (not 
optimized) designs. Scheduling pilots and crews and airplanes has become a significant 
problem in applied mathematics! We even solve the marriage problem—to maximize 
the number of marriages when brides have a veto. That may not be the real problem, but 
it is the one that network programming solves. 
The problem in Figure 8.5 is to maximize the flow from the source to the sink. The 
flows cannot exceed the capacities marked on the edges, and the directions given by 
the arrows cannot be reversed. The flow on the two edges into the sink cannot exceed 
6+1 = 7. Is this total of 7 achievable? What is the maximal flow from left to right? 
The unknowns are the flows xi j from node i to node j. The capacity constraints are 
xi j · ci j. The flows are nonnegative: xi j . 0 going with the arrows. By maximizing the 
return flow x61 (dotted line), we maximize the total flow into the sink. 
Figure 8.5: A 6-node network with edge capacities: the maximal flow problem. 
Another constraint is still to be heard from. It is the “conservation law,” that the flow 
into each node equals the flow out. That is Kirchhoff’s current law: 
Current law ai
xi j .ak
x jk = 0 for j = 1;2; : : : ;6: (12) 
The flows xi j enter node j from earlier nodes i. The flows x jk leave node j to later 
nodes k. The balance in equation (1) can be written as Ax = 0, where A is a node-edge 
incidence matrix (the transpose of Section 2.5). A has a row for every node and a +1,
8.4 Network Models 445 
.1 column for every edge: 
Incidence 
Matrix 
A = 
2
666666664 
1 1 .1 
.1 1 1 
.1 1 1 
.1 .1 1 
.1 .1 1 
.1 .1 1
3
777777775 
node 1
2
3
4
5
6 
edge 12 13 24 25 34 35 46 56 61 
Maximal Flow Maximize x61 subject to Ax = 0 and 0 · xi j · ci j: 
A flow of 2 can go on the path 1-2-4-6-1. A flow of 3 can go along 1-3-4-6-1. An 
additional flow of 1 can take the lowest path 1-3-5-6-1. The total is 6, and no more is 
possible. How do you prove that the maximal flow is 6 and not 7? 
Trial and error is convincing, but mathematics is conclusive: The key is to find a cut in 
the network, across which all capacities are filled. That cut separates nodes 5 and 6 from 
the others. The edges that go forward across the cut have total capacity 2+3+1 = 6— 
and no more can get across! Weak duality says that every cut gives a bound to the total 
flow, and full duality says that the cut of smallest capacity (the minimal cut) is filled by 
the maximal flow. 
8K Max flow-min cut theorem. The maximal flow in a network equals the 
total capacity across the minimal cut. 
A “cut” splits the nodes into two groups S and T (source in S and sink in T). Its capacity 
is the sum of the capacities of all edges crossing the cut (from S to T). Several cuts 
might have the same capacity. Certainly the total flow can never be greater than the total 
capacity across the minimal cut. The problem, here and in all of duality, is to show that 
equality is achieved by the right flow and the right cut. 
Proof that max flow = min cut. Suppose a flow is maximal. Some nodes might still be 
reached from the source by additional flow, without exceeding any capacities. Those 
nodes go with the source into the set S. The sink must lie in the remaining set T, or it 
could have received more flow! Every edge across the cut must he filled, or extra flow 
could have gone further forward to a node in T. Thus the maximal flow does fill this cut 
to capacity. and equality has been achieved. 
This suggests a way to construct the maximal flow: Check whether any path has 
unused capacity. If so, add flow along that “augmenting path.” Then compute the remaining 
capacities and decide whether the sink is cut off from the source, or additional 
flow is possible. If you label each node in S by the previous node that flow could come 
from, you can backtrack to find the path for extra flow.
446 Chapter 8 Linear Programming and Game Theory 
The Marriage Problem 
Suppose we have four women and four men. Some of those sixteen couples are compatible, 
others regrettably are not. When is it possible to find a complete matching, with 
everyone married? If linear algebra can work in 20-dimensional space, it can certainly 
handle the trivial problem of marriage. 
There are two ways to present the problem—in a matrix or on a graph. The matrix 
contains ai j = 0 if the ith woman and jth man are not compatible, and ai j = 1 if they are 
willing to try. Thus row i gives the choices of the ith woman, and column j corresponds 
to the jth man: 
Compatibility 
matrix 
A = 
2
6664 
1 0 0 0 
1 1 1 0 
0 0 0 1 
0 0 0 1
3
7775
has 6 compatible pairs. 
The left graph in Figure 8.6 shows two possible marriages. Ignoring the source s and 
sink t, it has four women on the left and four men on the right. The edges correspond 
to the 1s in the matrix, and the capacities are 1 marriage. There is no edge between the 
first woman and fourth man, because the matrix has a14 = 0. 
Figure 8.6: Two marriages on the left, three (maximum) on the right. The third is created by adding two new 
marriages and one divorce (backward flow). 
It might seem that node M2 can’t be reached by more flow—but that is not so! The 
extra flow on the right goes backward to cancel an existing marriage. This extra flow 
makes 3 marriages, which is maximal. The minimal cut is crossed by 3 edges. 
A complete matching (if it is possible) is a set of four is in the matrix. They would 
come from four different rows and four different columns, since bigamy is not allowed. 
It is like finding a permutation matrix within the nonzero entries of A. On the graph, this 
means four edges with no nodes in common. The maximal flow is less than 4 exactly 
when a complete matching is impossible. 
In our example the maximal flow is 3, not 4. The marriages 1–1, 2–2, 4–4 are allowed
8.4 Network Models 447 
(and several other sets of three marriages), but there is no way to reach four. The minimal 
cut on the right separates the two women at the bottom from the three men at the top. 
The two women have only one man left to choose—not enough. The capacity across the 
cut is only 3. 
Whenever there is a subset of k women who among them like fewer than k men, a 
complete matching is impossible. 
That test is decisive. The same impossibility can be expressed in different ways: 
1. (For Chess) It is impossible to put four rooks on squares with 1s in A, so that no 
rook can take any other rook. 
2. (For Marriage Matrices) The 1s in the matrix can be covered by three horizontal 
or vertical lines. That equals the maximum number of marriages. 
3. (For Linear Algebra) Every matrix with the same zeros as A is singular. 
Remember that the determinant is a sum of 4! = 24 terms. Each term uses all four rows 
and columns. The zeros in A make all 24 terms zero. 
A block of zeros is preventing a complete matching! The 2 by 3 submatrix in rows 3, 
4 and columns 1, 2, 3 of A is entirely zero. The general rule for an n by n matrix is that 
a p by q block of zeros prevents a matching if p+q > n. Here women 3, 4 could marry 
only the man 4. If p women can marry only n.q men and p > n.q (which is the same 
as a zero block with p+q > n), then a complete matching is impossible. 
The mathematical problem is to prove the following: If every set of p women does 
like at least p men, a complete matching is possible. That is Hall’s condition. No block 
of zeros is too large. Each woman must like at least one man, each two women must 
between them like at least two men, and so on, to p = n. 
8L A complete matching is possible if (and only if) Hall’s condition holds. 
The proof is simplest if the capacities are n, instead of 1, on all edges across the 
middle. The capacities out of the source and into the sink are still 1. If the maximal flow 
is n, all those edges from the source and into the sink are filled—and the flow produces 
n marriages. When a complete matching is impossible, and the maximal flow is below 
n, some cut must be responsible. 
That cut will have capacity below n, so no middle edges cross it. Suppose p nodes on 
the left and r nodes on the right are in the set S with the source. The capacity across that 
cut is n. p from the source to the remaining women, and r from these men to the sink. 
Since the cut capacity is below n, the p women like only the r men and no others. But 
the capacity n. p+r is below n exactly when p > r, and Hall’s condition fails.
448 Chapter 8 Linear Programming and Game Theory 
Spanning Trees and the Greedy Algorithm 
A fundamental network model is the shortest path problem—in which the edges have 
lengths instead of capacities. We want the shortest path from source to sink. If the edges 
are telephone lines and the lengths are delay times, we are finding the quickest route 
for a call, If the nodes are computers, we are looking for the perfect message-passing 
protocol. 
A closely related problem finds the shortest spanning tree—a set of n.1 edges 
connecting all the nodes of the network. Instead of getting quickly between a source 
and a sink, we are now minimizing the cost of connecting all the nodes. There are no 
loops, because the cost to close a loop is unnecessary. A spanning tree connects the 
nodes without loops, and we want the shortest one. Here is one possible algorithm: 
1. Start from any node s and repeat the following step: 
Add the shortest edge that connects the current tree to a new node. 
In Figure 8.7, the edge lengths would come in the order 1, 2, 7, 4, 3, 6. The last step 
skips the edge of length 5, which closes a loop. The total length is 23—but is it minimal? 
We accepted the edge of length 7 very early, and the second algorithm holds out longer. 
Figure 8.7: A network and a shortest spanning tree of length 23. 
2. Accept edges in increasing order of length, rejecting edges that complete a loop. 
Now the edges come in the order 1, 2, 3, 4, 6 (again rejecting 5), and 7. They are the 
same edges—although that will not always happen. Their total length is the same—and 
that does always happen. The spanning tree problem is exceptional, because it can be 
solved in one pass. 
In the language of linear programming, we are finding the optimal corner first. The 
spanning tree problem is being solved like back-substitution, with no false steps. This 
general approach is called the greedy algorithm. Here is another greedy idea: 
3. Build trees from all n nodes, by repeating the following step: 
Select any tree and add the minimum-length edge going out from that tree. 
The steps depend on the selection order of the trees. To stay with the same tree is 
algorithm 1. To take the lengths in order is algorithm 2. To sweep through all the trees
8.4 Network Models 449 
in turn is a new algorithm. It sounds so easy, but for a large problem the data structure 
becomes critical, With a thousand nodes, there might be nearly a million edges, and you 
don’t want to go through that list a thousand times. 
Further Network Models 
There are important problems related to matching that are almost as easy: 
1. The optimal assignment problem: ai j measures the value of applicant i in job j. 
Assign jobs to maximize the total value—the sum of the ai j on assigned jobs. (If 
all ai j are 0 or 1, this is the marriage problem.) 
2. The transportation problem: Given supplies at n points and demands at n markets 
choose shipments xi j from suppliers to markets that minimize the total cost aCi jxi j. 
(If all supplies and demands are 1, this is the optimal assignment problem—sending 
one person to each job.) 
3. Minimum costflow: Now the routes have capacities ci j as well as costs Ci j, mixing 
the maximal flow problem with the transportation problem. What is the cheapest 
flow, subject to capacity constraints? 
A fascinating part of this subject is the development of algorithms. Instead of a 
theoretical proof of duality, we use breadth-first search or depth-first search to find 
the optimal assignment or the cheapest flow. It is like the simplex method, in starting 
from a feasible flow (a corner) and adding a new flow (to move to the next corner), The 
algorithms are special because network problems involve incidence matrices. 
The technique of dynamic programming rests on a simple idea: If a path from source 
to sink is optimal, then each part of the path must be optimal. The solution is built 
backwards from the sink, with a multistage decision process. At each stage, the distance 
to the sink is the minimum of a new distance plus an old distance: 
Bellman equation x-t distance = minimum over y of (x-y + y-t distances). 
I wish there were space for more about networks. They are simple but beautiful. 
Problem Set 8.4 
1. In Figure 8.5, add 3 to every capacity. Find by inspection the maximal flow and 
minimal cut. 
2. Find a maximal flow and minimal cut for the following network:
450 Chapter 8 Linear Programming and Game Theory 
3. If you could increase the capacity of any one pipe in the network above, which 
change would produce the largest increase in the maximal flow? 
4. Draw a 5-node network with capacity ji. jj between node i and node j. Find the 
largest possible flow from node 1 to node 4. 
5. In a graph, the maximum number of paths from s to t with no common edges equals 
the minimum number of edges whose removal disconnects s from t. Relate this to 
the max flow-min cut theorem. 
6. Find a maximal set of marriages (a complete matching, if possible) for 
A = 
2
666664 
0 0 1 0 0 
1 1 0 1 1 
0 1 1 0 1 
0 0 1 1 0 
0 0 0 1 0
3
777775
and B = 
2
666664 
1 1 0 0 0 
0 1 0 1 0 
0 0 1 0 1 
1 1 1 0 0 
1 0 0 0 0
3
777775
: 
Sketch the network for B, with heavier lines on the edges in your matching. 
7. For the matrix A in Problem 6, which rows violate Hall’s condition—by having all 
their 1s in too few columns? Which p by q submatrix of zeros has p+q > n? 
8. How many lines (horizontal and vertical) are needed to cover all the 1s in A in Problem 
6? For any matrix, explain why weak duality is true: If k marriages are possible, 
then it takes at least k lines to cover all the 1s. 
9. (a) Suppose every row and every column contains exactly two 1s. Prove that a complete 
matching is possible. (Show that the 1s cannot be covered by less than n 
lines) 
(b) Find an example with two or more is in each row and column, for which a complete 
matching is impossible. 
10. If a 7 by 7 matrix has 15 1s, prove that it allows at least 3 marriages. 
11. For infinite sets, a complete matching may be impossible even if Hail’s condition is 
passed. If the first row is all 1s and then every ai i.1 = 1, show that any p rows have 
1s in at least p columns—and yet there is no complete matching.
8.5 Game Theory 451 
12. If Figure 8.5 shows lengths instead of capacities, find the shortest path from s to t, 
and a minimal spanning tree. 
13. Apply algorithms 1 and 2 to find a shortest spanning tree for the network of Problem 
2. 
14. (a) Why does the greedy algorithm work for the spanning tree problem? 
(b) Show by example that the greedy algorithm could fail to find the shortest path 
from s to t, by starting with the shortest edge. 
15. If A is the 5 by 5 matrix with is just above and just below the main diagonal, find 
(a) a set of rows with 1s in too few columns. 
(b) a set of columns with is in too few rows. 
(c) a p by q submatrix of zeros with p+q > 5. 
(d) four lines that cover all the 1s. 
16. The maximal flow problem has slack variables wi j = ci j .xi j for the difference between 
capacities and flows. State the problem of Figure 8.5 as a linear program. 
8.5 Game Theory 
The best way to explain a two-person zero-sum game is to give an example. It has two 
players X and Y, and the rules are the same for every turn: 
X holds up one hand or two, and so does Y. If they make the same decision, Y 
wins $10. If they make opposite decisions, X wins $10 for one hand and $20 
for two: 
Payoff matrix 
(payments to X) 
A = 
" 
.10 20 
10 .10 
# 
one hand by Y 
two hands by Y 
one hand 
by X 
two hands 
by X 
If X does the same thing every time, Y will copy him and win. Similarly Y cannot stick 
to a single strategy, or X will do the opposite. Both players must use a mixed strategy, 
and the choice at every turn must be independent of the previous turns. If there is some 
historical pattern, the opponent can take advantage of it. Even the strategy “stay with 
the same choice until you lose” is obviously fatal. After enough plays, your opponent 
would know exactly what to expect. 
In a mixed strategy, X can put up one hand with frequency x1 and both hands with 
frequency x2 = 1.x1. At every turn this decision is random. Similarly Y can pick
452 Chapter 8 Linear Programming and Game Theory 
probabilities y1 and y2 = 1.y1. None of these probabilities should be 0 or 1; otherwise 
the opponent adjusts and wins. If they equal 12
, Y would be losing $20 too often. (He 
would lose $20 a quarter of the time, $10 another quarter of the time, and win $10 half 
the time—an average loss of $2.50. This is more than necessary.) But the more Y moves 
toward a pure two-hand strategy, the more X will move toward one hand. 
The fundamental problem is to find the best mixed strategies. Can X choose probabilities 
x1 and x2 that present Y with no reason to move his own strategy (and vice versa)? 
Then the average payoff will have reached a saddle point: It is a maximum as far as X 
is concerned, and a minimum as far as Y is concerned. To find such a saddle point is to 
solve the game. 
X is combining the two columns with weights x1 and 1.x1 to produce a new “mixed” 
column. Weights 3
5 and 25
would produce this column: 
Mixed column 
3
5 
"
.10 
10 
#
+ 
2
5 
" 
20 
.10
# 
= 
"
2
2
#
: 
Against this mixed strategy, Y will always lose $2. This does not mean that all 
strategies are optimal for Y! If Y is lazy and stays with one hand, X will change and 
start winning $20. Then Y will change, and then X again. Finally, since we assume they 
are both intelligent, they settle down to optimal mixtures. Y will combine the rows with 
weights y1 and 1.y1, trying to produce a new row which is as small as possible: 
Mixed row y1 
h
.10 20
i
+(1.y1)
h
10 .10
i 
= 
h
10.20y1 .10+30y1
i
: 
The right mixture makes the two components equal, at y1 = 25
. Then both components 
equal 2; the mixed row becomes [2 2]. With this strategy Y cannot lose more than $2. 
Y has minimized the maximum loss, and that minimax agrees with the maximin found 
by X. The value of the game is minimax = maximin = $2. 
The optimal mixture of rows might not always have equal entries! Suppose X is 
allowed a third strategy of holding up three hands to win $60 when Y puts up one hand 
and $80 when Y puts up two. The payoff matrix becomes 
A = 
"
.10 20 60 
10 .10 80
#
: 
X will choose the three-hand strategy (column 3) every time, and win at least $60. At 
the same time, Y always chooses the first row; the maximum loss is $60. We still have 
maximin = minimax = $60, but the saddle point is over in the corner. 
In Y’s optimal mixture of rows, which was purely row 1, $60 appears only in the 
column actually used by X. In X’s optimal mixture of columns, which was column 3, 
$60 appears in the row that enters Y’s best strategy. This rule corresponds exactly to the 
complementary slackness condition of linear programming.
8.5 Game Theory 453 
Matrix Games 
The most general “m by n matrix game” is exactly like our example. X has n possible 
moves (columns of A). Y chooses from the m rows. The entry ai j is the payment when 
X chooses column j and Y chooses row i. A negative entry means a payment to Y. This 
is a zero-sum game. Whatever one player loses, the other wins. 
X is free to choose any mixed strategy x = (x1; : : : ;xn). These x1 give the frequencies 
for the n columns and they add to 1. At every turn X uses a random device to produce 
strategy i with frequency xi. Y chooses a vector y = (y1; : : : ;ym), also with yi . 0 and 
ayi = 1, which gives the frequencies for selecting rows. 
A single play of the game is random. On the average, the combination of column j 
for X and row i for Y will turn up with probability xiyi. When it does come up, the payoff 
is ai j. The expected payoff to X from this combination is ai jx jyi, and the total expected 
payoff from each play of the same game is aaai jx jyi = yAx: 
yAx = 
h
y1 . . . ym
i
2
64
a11 a12 . . . a1n 
... 
... 
... 
am1 am2 . . . amn
3
75 
2
6664 
x1 
x2
... 
xn
3
7775
= a11x1y1+. . .+amnxnym 
= average payoff: 
It is this payoff yAx that X wants to maximize and Y wants to minimize. 
Example 1. Suppose A is the n by n identity matrix, A = I. The expected payoff becomes 
yIx=x1y1+. . .+xnyn. X is hoping to hit on the same choice as Y, to win aii =$1. 
Y is trying to evade X, to pay ai j =$0. If X chooses any column more often than another, 
Y can escape more often. The optimal mixture is x¤ = (1=n;1=n; : : : ;1=n). Similarly Y 
cannot overemphasize any row—the optimal mixture is y¤ = (1=n;1=n; : : : ;1=n). The 
probability that both will choose strategy i is (1=n)2, and the sum over i is the expected 
payoff to X. The total value of the game is n times (1=n)2, or 1=n: 
y¤Ax¤ = 
h
1=n . . . 1=n
i
2
64
1 
. . . 
1
3
75 
2
64
1=n 
... 
1=n
3
75
= 
µ
1
n
¶2
+. . .+
µ
1
n
¶2 
= 
1
n
: 
As n increases, Y has a better chance to escape. The value 1=n goes down. 
The symmetric matrix A = I did not make the game fair. A skew-symmetric matrix, 
AT = .A, means a completely fair game. Then a choice of strategy j by X and i by Y 
wins ai j for X, and a choice of j by Y and i by X wins the same amount for Y (because 
aji = .ai j). The optimal strategies x¤ and y¤ must be the same, and the expected payoff 
must be y¤Ax¤ = 0. The value of the game, when AT = .A, is zero. But the strategy is 
still to be found.
454 Chapter 8 Linear Programming and Game Theory 
Example 2. 
Fair game A = 
2
64
0 .1 .1 
1 0 .1 
1 1 0 
3
75
: 
In words, X and Y both choose a number between 1 and 3. The smaller choice wins $1. 
(If X chooses 2 and Y chooses 3, the payoff is a32 = $1; if they choose the same number, 
we are on the diagonal and nobody wins.) Neither player can choose a strategy involving 
2 or 3. The pure strategies x¤ = y¤ = (1;0;0) are optimal—both players choose 1 every 
time. The value is y¤Ax¤ = a11 = 0. 
The matrix that leaves all decisions unchanged has mn equal entries, say a. This 
simply means that X wins an additional amount a at every turn. The value of the game 
is increased by a, but there is no reason to change x¤ and y¤. 
The Minimax Theorem 
Put yourself in the place of X, who chooses the mixed strategy x = (x1; : : : ;xn). Y will 
eventually recognize that strategy and choose y to minimize the payment yAx. An intelligent 
player X will select x¤ to maximize this minimum: 
X wins at least min 
y 
yAx¤ = max 
x 
min 
y 
yAx: (1) 
Player Y does the opposite. For any chosen strategy y, X will maximize yAx. Therefore 
Y will choose the mixture y¤ that minimizes this maximum: 
Y loses no more than max 
x 
y¤Ax = min 
y 
max 
x 
yAx: (2) 
I hope you see what the key result will be, if it is true. We want the amount in 
equation (1) that X is guaranteed to win to equal the amount in equation (2) that Y must 
be satisfied to lose. Then the game will be solved: X can only lose by moving from x¤ 
and Y can only lose by moving from y¤, The existence of this saddle point was proved 
by von Neumann: 
8M For any matrix A, the minimax over all strategies equals the maximin: 
Minimax theorem max 
x 
min 
y 
yAx = min 
y 
max 
x 
yAx = value of the game. 
(3) 
If the maximum on the left is attained at x¤, and the minimum on the right is 
attained at y¤, this is a saddle point from which nobody wants to move: 
y¤Ax · y¤Ax¤ · yAx¤ for all x and y. (4) 
At this saddle point, x¤ is at least as good as any other x (since y¤Ax · y¤Ax¤). And the 
second player Y could only pay more by leaving y¤.
8.5 Game Theory 455 
As in duality theory, maximin · minimax is easy. We combine the definition in equation 
(1) of x¤ and the definition in equation (2) of y¤: 
max 
x 
min 
y 
yAx = min 
y 
yAx¤ · y¤Ax¤ · max 
x 
y¤Ax = min 
y 
max 
x 
yAx: (5) 
This only says that if X can guarantee to win at least a, and Y can guarantee to lose no 
more than b , then a ·b . The achievement of von Neumann was to prove that a =b . 
The minimax theorem means that equality must hold throughout equation (5). 
For us, the striking thing about the proof is that it uses exactly the same mathematics 
as the theory of linear programming. X and Y are playing “dual” roles. They are both 
choosing strategies from the “feasible set” of probability vectors: xi .0, axi =1, yi .0, 
ayi = 1. What is amazing is that even von Neumann did not immediately recognize the 
two theories as the same. (He proved the minimax theorem in 1928, linear programming 
began before 1947, and Gale, Kuhn, and Tucker published the first proof of duality 
in 1951—based on von Neumann’s notes!) We are reversing history by deducing the 
minimax theorem from duality. 
Briefly, the minimax theorem can be proved as follows. Let b be the column vector 
of m 1s, and c be the row vector of n 1s. These linear programs are dual: 
(P) minimize cx (D) maximize yb 
subject to Ax . b, x . 0 subject to yA · c, y . 0. 
To make sure that both problems are feasible, add a large number a to all entries of 
A. This cannot affect the optimal strategies, since every payoff goes up by a. For the 
resulting matrix, which we still denote by A, y = 0 is feasible in the dual and any large x 
is feasible in the primal. 
The duality theorem of linear programming guarantees optimal x¤ and y¤ with cx¤ = 
y¤b. Because of the 1s in b and c, this means that ax¤
i =ay¤i
=S. Division by S changes 
the sums to 1—and the resulting mixed strategies x¤=S and y¤=S are optimal. For any 
other strategies x and y, 
Ax¤ . b implies yAx¤ . yb = 1 and y¤A · c implies y¤Ax · cx = 1: 
The main point is that y¤Ax · 1 · yAx¤. Dividing by S, this says that player X cannot 
win more than 1=S against the strategy y¤=S, and player Y cannot lose less than 1=S 
against x¤=S. Those strategies give maximin = minimax = 1=S. 
Real Games 
This completes the theory, but it leaves a natural question: Which ordinary games are 
actually equivalent to “matrix games”? Do chess and bridge and poker fit into von 
Neumann’s theory? 
I think chess does not fit very well, for two reasons. A strategy for black must include 
a decision on how to respond to white’s first play, and second play, and so on to the end
456 Chapter 8 Linear Programming and Game Theory 
of the game. X and Y have billions of pure strategies. I do not see much of a role for 
chance. If white can find a winning strategy or if black can find a drawing strategy— 
neither has ever been found—that would effectively end the game of chess. You could 
play it like tic-tac-toe, but the excitement would go away. 
Bridge does contain some deception—as in a finesse. It counts as a matrix game, but 
m and n are again fantastically big. Perhaps separate parts of bridge could be analyzed 
for an optimal strategy. The same is true in baseball, where the pitcher and batter try 
to outguess each other on the choice of pitch. (Or the catcher tries to guess when the 
runner will steal. A pitchout every time will walk the batter, so there must be an optimal 
frequency—depending on the base runner and on the situation.) Again a small part of 
the game could be isolated and analyzed. 
On the other hand, blackjack is not a matrix game (in a casino) because the house 
follows fixed rules. My friend Ed Thorp found a winning strategy by counting high 
cards—forcing more shuffling and more decks at Las Vegas. There was no element of 
chance, and no mixed strategy x¤. The best-seller Bringing Down the House tells how 
MIT students made a lot of money (while not doing their homework). 
There is also the Prisoner’s Dilemma, in which two accomplices are separately offered 
the same deal: Confess and you are free, provided your accomplice does not confess 
(the accomplice then gets 10 years). If both confess, each gets 6 years. If neither 
confesses, only a minor crime (2 years each) can be proved. What to do? The temptation 
to confess is very great, although if they could depend on each other they would hold 
out. This is not a zero-sum game; both can lose. 
One example of a matrix game is poker. Bluffing is essential, and to be effective it has 
to be unpredictable. (If your opponent finds a pattern, you lose.) The probabilities for 
and against bluffing will depend on the cards that are seen, and on the bets. In fact, the 
number of alternatives again makes it impractical to find an absolutely optimal strategy 
x¤. A good poker player must come pretty close to x¤, and we can compute it exactly if 
we accept the following enormous simplification of the game: 
X is dealt a jack or a king, with equal probability, and Y always gets a queen. X can 
fold and lose the $1 ante, or bet an additional $2. If X bets, Y can fold and lose $1, or 
match the extra $2 and see if X is bluffing. Then the higher card wins the $3 from the 
opponent. So Y has two possibilities, reacting to X (who has four strategies): 
Strategies (Row 1) If X bets, Y folds. 
for Y (Row 2) If X bets, Y matches the extra $2. 
(1) Bet the extra $2 on a king and fold on a jack. 
Strategies (2) Bet the extra $2 in either case (bluffing). 
for X (3) Fold in either case, and lose $1 (foolish). 
(4) Fold on a king and bet on a jack (foolish).
8.5 Game Theory 457 
The payoff matrix A requires a little patience to compute: 
a11 = 0: X loses $1 half the time on a jack and wins on a king (Y folds). 
a21 = 1: Both bets X loses $1 half the time and wins $3 half the time. 
a12 = 1: X bets and Y folds (the bluff succeeds). 
a11 = 0: X wins $3 with the king and loses $3 with the jack (the bluff fails). 
Poker payoff matrix A = 
"
0 1 .1 0 
1 0 .1 .2
#
: 
The optimal strategy for X is to bluff half the time, x¤ = (12
;12
;0;0). The underdog Y 
must choose y¤ = (12
;12
). The value of the game is fifty cents to X. 
That is a strange way to end this book, by teaching you how to play watered-down 
poker (blackjack pays a lot better). But I guess even poker has its place within linear 
algebra and its applications. I hope you have enjoyed the book. 
Problem Set 8.5 
1. How will the optimal strategies in the game that opens this section be affected if the 
$20 is increased to $70? What is the value (the average win for X) of this new game? 
2. With payoff matrix A = 
. 1 2 
3 4 
¤
, explain the calculation by X of the maximin and by Y 
of the minimax. What strategies x¤ and y¤ are optimal? 
3. If ai j is the largest entry in its row and the smallest in its column, why will X always 
choose column j and Y always choose row i (regardless of the rest of the matrix)? 
Show that the preceding problem had such an entry, and then construct an A without 
one. 
4. Compute Y’s best strategy by weighting the rows of A = 
. 3 4 1 
2 0 3 
¤ 
with y and 1.y. X 
will concentrate on the largest of the components 3y+2(1.y), 4y, and y+3(1.y). 
Find the largest of those three (depending on y) and then find the y¤ between 0 and 1 
that makes this largest component as small as possible. 
5. With the same A as in Problem 4, find the best strategy for X. Show that X uses only 
the two columns (the first and third) that meet at the minimax point in the graph. 
6. Find both optimal strategies, and the value, if 
A = 
" 
1 0 .1 
.2 .1 2 
#
: 
7. Suppose A = 
. a b 
c d 
¤
. What weights x1 and 1.x1 will give a column of the form 
[u u]T, and what weights y1 and 1.y1 on the two rows will give a new row [v v]? 
Show that u = v.
458 Chapter 8 Linear Programming and Game Theory 
8. Find x¤, y¤ and the value v for 
A = 
2
64
1 0 0 
0 2 0 
0 0 3
3
75
: 
9. Compute 
min 
yi.0 
y1+y2=1 
max 
x1.0 
x1+x2=1
(x1y1+x2y2): 
10. Explain each of the inequalities in equation (5). Then, once the minimax theorem 
has turned them into equalities, derive (again in words) the saddle point equations 
(4). 
11. Show that x¤ = (12
;12
;0;0) and y¤ = (12
;12
) are optimal strategies in our simplified 
version of poker, by computing yAx¤ and y¤Ax and verifying the conditions (4) for a 
saddle point. 
12. Has it been proved that no chess strategy always wins for black? This is certainly 
true when the players are given two moves at a time; if black had a winning strategy, 
white could move a knight out and back and then follow that strategy, leading to the 
impossible conclusion that both would win. 
13. If X chooses a prime number and simultaneously Y guesses whether it is odd or even 
(with gain or loss of $1), who has the advantage? 
14. If X is a quarterback, with the choice of run or pass, and Y can defend against a run 
or a pass, suppose the payoff (in yards) is 
A = 
"
2 8 
6 .6
# 
defense against run 
defense against pass. 
run pass 
What are the optimal strategies and the average gain on each play?
AppendixA 
Intersection, Sum, and Product of Spaces 
A.1 The Intersection of Two Vector Spaces 
New questions arise from considering two subspaces V and W, not just one. We look 
first at the vectors that belong to both subspaces. This “intersection” V\Wis a subspace 
of those subspaces: 
If V and W are subspaces of one vector space, so is their intersection V\W. 
The vectors belonging to both V andW form a subspace. 
Suppose x and y are vectors in V and also in W. Because V and W are vector spaces 
in their own right, x+y and cx are in V and in W. The results of addition and scalar 
multiplication stay within the intersection. 
Two planes through the origin (or two “hyperplanes” in Rn) meet in a subspace. The 
intersection of several subspaces, or infinitely many, is again a subspace. 
Example 1. The intersection of two orthogonal subspaces V and W is the one-point 
subspace V\W= f0g. Only the zero vector is orthogonal to itself. 
Example 2. Suppose V and W are the spaces of n by n upper and lower triangular 
matrices. The intersection V\W is the set of diagonal matrices—belonging to both 
triangular subspaces. Adding diagonal matrices, or multiplying by c, leaves a diagonal 
matrix. 
Example 3. Suppose V is the nullspace of A, andWis the null space of B. Then V\W 
is the smaller nullspace of the larger matrix C: 
Intersection of nullspaces N(A)\N(B) is the nullspace of C = 
"
A
B
#
. 
Cx = 0 requires both Ax = 0 and Bx = 0. So x has to be in both nullspaces.
460 Appendix A Intersection, Sum, and Product of Spaces 
A.2 The Sum of Two Vector Spaces 
Usually, after discussing the intersection of two sets, it is natural to look at their Union. 
With vector spaces, this is not natural. The union V[W of two subspaces will not in 
general be a subspace. If V and W are the x-axis and the y-axis in the plane, the two 
axes together are not a subspace. The sum of (1;0) and (0;1) is not on either axis. 
We do want to combine V and W. In place of their union we turn to their sum. 
Definition. If V and W are both subspaces of a given space, so is their sum. V+W 
contains all combinations v+w, where v is in V and w is in W. 
V+W is the smallest vector space that contains both V and W. The sum of the 
x-axis and the y-axis is the whole x-y plane. So is the sum of any two different lines, 
perpendicular or not. If V is the x-axis and W is the 45° line x = y, then any vector like 
(5;3) can be split into v+w = (2;0)+(3;3). Thus V+W is all of R2. 
Example 4. Suppose V and W are orthogonal complements in Rn. Then their sum is 
V+W= Rn. Every x is the sum of its projections in V andW. 
Example 5. If V is the space of upper triangular matrices, andWis the space of lower 
triangular matrices, then V+Wis the space of all matrices. Every n by n matrix can be 
written as the sum of an upper and a lower triangular matrix—in many ways, because 
the diagonals are not uniquely determined. 
These triangular subspaces have dimension n(n+1)=2. The space V+Wof all matrices 
has dimension n2. The space V\Wof diagonal matrices has dimension n. Formula 
(3) below becomes n2+n = n(n+1)=2+n(n+1)=2. 
Example 6. If V is the column space of A, andWis the column space of B, then V+W 
is the column space of the larger matrix [A B]. The dimension of V+W may be less 
than the combined dimensions of V and W (because these two spaces might overlap): 
Sum of column spaces dim(V+W) = rank of [A B]: (1) 
The computation of V\W is more subtle. For the intersection of column spaces, a 
good method is to put bases for V and W in the columns of A and B. The nullspace 
of [A B] leads to V\W (see Problem 9). Those spaces have the same dimension (the 
nullity of [A B]). Combining with dim(V+W) gives 
dim(V+W)+dim(V\W) = rank of [A B]+nullity of [A B]: (2) 
We know that the rank plus the nullity (counting pivot columns plus free columns) always 
equals the total number of columns. When [A B] has k+` columns, with k =dimV 
and ` = dimW, we reach a neat conclusion: 
Dimension formula dim(V+W)+dim(V\W) = dim(V)+dim(W): (3) 
Not a bad formula. The overlap of V and W is in V\W.
Appendix A Intersection, Sum, and Product of Spaces 461 
A.3 The Cartesian Product of Two Vector Spaces 
If V has dimension n, and W has dimension q, their Cartesian product V.W has dimension 
n+q. 
Definition. V.W contains all pairs of vectors x = (v;w). 
Adding (v;w) to (v¤;w¤) in this product space gives (v+v¤;w+w¤). Multiplying by c 
gives (cv;cw). All operations in V.W are a component at a time. 
Example 7. The Cartesian product of R2 and R3 is very much like R5. A typical vector 
x in R2.R3 is ((1;2); (4;6;5)): one vector from R2 and one from R3. That looks like 
(1;2;4;6;5) in R5. 
Cartesian products go naturally with block matrices. From R5 to R5, we have ordinary 
5 by 5 matrices. On the product space R2.R3, the natural form of a matrix is a 5 by 5 
block matrix M: 
M = 
"
R2 to R2 R3 to R2 
R2 to R3 R3 to R3
# 
= 
"
2 by 2 2 by 3 
3 by 2 3 by 3
# 
= 
"
A B 
C D
#
: 
Matrix-vector multiplication produces (Av+Bw;Cv+Dw). Not too fascinating. 
A.4 The Tensor Product of Two Vector Spaces 
Somehow we want a product space that has dimension n times q. The vectors in this 
“tensor product” (denoted ­) will look like n by q matrices. For the tensor product 
R2­R3, the vectors will look like 2 by 3 matrices. The dimension of R2.R3 is 5, but 
the dimension of R2­R3 is going to be 6. 
Start with v = (1;2) and w = (4;6;5) in R2 and R3. The Cartesian product just puts 
them next to each other as (v;w). The tensor product combines v and w into the rank 1 
matrix vwT: 
Column times row v­w = vwT 
"
1
2
#h
4 6 5
i 
= 
"
4 6 5 
8 12 10
#
: 
All the special matrices vwT belong to the tensor product R2 ­R3. The product space 
is spanned by those vectors v­w. Combinations of rank-1 matrices give all 2 by 3 
matrices, so the dimension of R2 ­R3 is 6. Abstractly: The tensor product V­W is 
identified with the space of linear transformations from V to W. 
If V is only a line in R2, and W is only a line in R3, then V­W is only a “line in 
matrix space.” The dimensions are now 1.1 = 1. All the rank-1 matrices vwT will be 
multiples of one matrix.
462 Appendix A Intersection, Sum, and Product of Spaces 
Basis for the Tensor Product. When V is R2 and W is R3, we have a standard 
basis for all 2 by 3 matrices (a six-dimensional space): 
Basis 
"
1 0 0 
0 0 0
# "
0 1 0 
0 0 0
# "
0 0 1 
0 0 0
# "
0 0 0 
1 0 0
# "
0 0 0 
0 1 0
# "
0 0 0 
0 0 1
#
: 
That basis for R2 ­R3 was constructed in a natural way. I started with the standard 
basis v1 = (1;0) and v2 = (0;1) for R2. Those were combined with the basis vectors 
w1 = (1;0;0), w2 = (0;1;0), and w3 = (0;0;1) in R3. Each pair vi­wj corresponds to 
one of the six basis vectors (2 by 3 matrices above) in the tensor product V­W. This 
construction succeeds for subspaces too: 
Basis: Suppose V and W are subspaces of Rm and Rp with bases v1; : : : ;vn 
and w1; : : : ;wq. Then the nq rank-1 matrices viwTj
are a basis for V­W. 
V­W is an nq-dimensional subspace of m by p matrices, An algebraist would match 
this matrix construction to the abstract definition of V­W. Then tensor products can 
go beyond the specific case of column vectors. 
A.5 The Kronecker Product A­B of Two Matrices 
An m by n matrix A transforms any vector v in Rn to a vector Av in Rm, Similarly, a p 
by q matrix B transforms w to Bw. The two matrices together transform vwT to AvwTBT. 
This is a linear transformation (of tensor products) and it must come from a matrix. 
What is the size of that matrix A­B? It takes the nq-dimensional space Rn­Rq to 
the mp-dimensional space Rm­Rp. Therefore the matrix has shape mp by nq. We will 
write this Kronecker product (also called tensor product) as a block matrix: 
Kronecker product 
mp rows, nq columns 
A­B = 
2
6664 
a11B a12B . . . a1nB 
a21B a22B . . . a2nB 
. . . . . . 
am1B am2B . . . amnB
3
7775
: (4) 
Notice the special structure of this matrix! A lot of important block matrices have that 
Kronecker form. They often come from two-dimensional applications, where A is a 
“matrix in the x-direction” and B is acting in the y-direction (examples below). If A and 
B are square, so m = n and p = q, then the big matrix A­B is also square. 
Example 8. (Finite differences in the x and y directions) Laplace’s partial differential 
equation .¶ 2u=¶ x2 .¶ 2u=¶ y2 = 0 is replaced by finite differences, to find values 
for u on a two-dimensional grid. Differences in the x-direction add to differences in the 
y-direction, connecting five neighboring values of u:
Appendix A Intersection, Sum, and Product of Spaces 463 
b b 
b b 
b b 
b 
b
b
b + .1 2 .1 
x-differences 
b b
b b 
b b 
b 
b
b
b 
.! 
.1
2 
.1 
y-differences 
b b
b b 
b b 
b 
b
b
b 
.1
4 
.1 
.
u
i+1, j + 2u
i, j .
u
i
.
1, j 
.
u
i, j+1 + 2u
i, j .
u
i, j
.
1 
= 0 
sum 
.1 .1 
A 5-point equation is centered at each of the nine meshpoints. The 9 by 9 matrix (call 
it A2D) is constructed from the 3 by 3 “1D” matrix for differences along a line: 
Difference matrix 
in one direction 
A=
2
64
2 .1 0 
.1 2 .1 
0 .1 2 
3
75
Identity matrix 
in other direction 
I =
2
64
1 0 0 
0 1 0 
0 0 1
3
75
: 
Kronecker products produce three 1D differences along three lines, up or across: 
One direction A­I = 
2
64
2I .I 0 
.I 2I .I 
0 .I 2I 
3
75
: 
Other direction I­A = 
2
64
A 0 0 
0 A 0 
0 0 A
3
75
: 
Both directions A2D = (A­I)+(I­A) = 
2
64A+2I .I 0 
.I A+2I .I 
0 .I A+2I
3
75
: 
The sum (A­I)+(I­A) is the 9 by 9 matrix for Laplace’s five-point difference equation 
(Section 1.7 was for 1D and Section 7.4 mentioned 2D). The middle row of this 9 by 9 
matrix shows all five nonzeros from the five-point molecule: 
Away from boundary Row 5 of A2D = 
h
0 .1 0 .1 4 .1 0 .1 0
i
: 
Example 9. (The Fourier matrix in 2D) The one-dimensional Fourier matrix F is 
the most important complex matrix in the world. The Fast Fourier Transform in Section 
3.5 is a quick way to multiply by that matrix F. So the FFT transforms “time domain to 
frequency domain” for a 1D audio signal. For images we need the 2D transform: 
Fourier matrix in 2D F2D = F ­F = Transform along each row, 
then down each column 
The image is a two-dimensional array of pixel values. It is transformed by F2D into a twodimensional 
array of Fourier coefficients. That array can be compressed and transmitted
464 Appendix A Intersection, Sum, and Product of Spaces 
and stored. Then the inverse transform brings us back from Fourier coefficients to pixel 
values. We need to know the inverse rule for Kronecker products: 
The inverse of the matrix A­B is the matrix A.1­B.1. 
The FFT also speeds up the 2D inverse transform! We just invert in one direction followed 
by the other direction. We are adding aack`eikxei`y over k and then `. 
The Laplace difference matrix A2D =(A­I)+(I­A) has no simple inverse formula. 
That is why the equation A2Du = b has been studied so carefully. One of the fastest 
methods is to diagonalize A2D by using its eigenvector matrix (which is the Fourier sine 
matrix S­S, very similar to F2D). The eigenvalues of A2D come immediately from the 
eigenvalues of A1D: 
The n2 eigenvalues of (A­I)+(I­B) are all the sums li(A)+l j(B). 
The n2 eigenvalues of A­B are all the products li(A)l j(B). 
If A and B are n by n, the determinant of A ­ B (the product of its eigenvalues) is 
(detA)n(detB)n. The trace of A­B is (trace A)(trace B). This appendix illustrates both 
“pure linear algebra” and its crucial applications! 
Problem Set A 
1. Suppose S and T are subspaces of R13, with dimS = 7 and dimT = 8. 
(a) What is the largest possible dimension of S\T? 
(b) What is the smallest possible dimension of S\T? 
(c) What is the smallest possible dimension of S+T? 
(d) What is the largest possible dimension of S+T? 
2. What are the intersections of the following pairs of subspaces? 
(a) The x-y plane and the y-z plane in R3, 
(b) The line through (1;1;1) and the plane through (1;0;0) and (0;1;1). 
(c) The zero vector and the whole space R3. 
(d) The plane S perpendicular to (1;1;0) and perpendicular to (0;1;1) in R3. 
What are the sums of those pairs of subspaces? 
3. Within the space of all 4 by 4 matrices, let V be the subspace of tridiagonal matrices 
and W the subspace of upper triangular matrices. Describe the subspace V+W, 
whose members are the upper Hessenberg matrices. What is V\W? Verify formula 
(3).
Appendix A Intersection, Sum, and Product of Spaces 465 
4. If V\W contains only the zero vector, then equation (3) becomes dim(V+W) = 
dimV+dimW. Check this when V is the row space of A, W is the nullspace of A, 
and the matrix A is m by n of rank r. What are the dimensions? 
5. Give an example in R3 for which V\W contains only the zero vector, but V is not 
orthogonal to W. 
6. If V\W= f0g, then V+W is called the direct sum of V and W, with the special 
notation V©W. If V is spanned by (1;1;1) and (1;0;1), choose a subspace W so 
that V©W= R3, Explain why any vector x in the direct sum V©W can be written 
in one and only one way as x = v+w (with v in V and w in W). 
7. Find a basis for the sum V+W of the space V spanned by v1 = (1;1;0;0), v2 = 
(1;0;1;0) and the space W spanned by w1 = (0;1;0;1), w2 = (0;0;1;1). Find also 
the dimension of V\W and a basis for it. 
8. Prove from equation (3) that rank(A+B) = rank(A)+rank(B). 
9. The intersection C(A)\C(B) matches the nullspace of [A B]. Each y=Ax1 =Bx2 
in the column spaces of both A and B matches x=(x1;.x2) in the nullspace, because 
[A B]x =Ax1.Bx2 =0. Check that y=(6;3;6) matches x =(1;1;.2;.3), and find 
the intersection C(A)\C(B), for 
A = 
2
64
1 5 
3 0 
2 4
3
75
B = 
2
64
3 0 
0 1 
0 2
3
75
: 
10. Multiply A­B times A.1­B.1 to get AA.1­BB.1 = I­I = I2D. 
11. What is the 4 by 4 Fourier matrix F2D = F ­F for F = 
. 1 1 
1 .1 
¤
? 
12. Suppose Ax =l (A)x and By =l (B)y. Form a long column vector z with n2 components, 
x1y, then x2y, and eventually xny. Show that z is an eigenvector for (A­I)z = 
l (A)z and (A­B)z =l (A)l (B)z. 
13. What would be the seven-point Laplace matrix for .uxx.uyy.uzz =0? This “threedimensional” 
matrix is built from Kronecker products using I and A1D.
AppendixB 
The Jordan Form 
Given a square matrix A, we want to choose M so that M.1AM is as nearly diagonal as 
possible. In the simplest case, A has a complete set of eigenvectors and they become 
the columns of M—otherwise known as S. The Jordan form is J = M.1AM = L; it is 
constructed entirely from 1 by 1 blocks Ji = li, and the goal of a diagonal matrix is 
completely achieved. In the more general and more difficult case, some eigenvectors are 
missing and a diagonal form is impossible. That case is now our main concern. 
We repeat the theorem that is to be proved: 
If a matrix A has s linearly independent eigenvectors, then it is similar to a 
matrix J that is in Jordan form, with s square blocks on the diagonal: 
J = M.1AM = 
2
64
J1 
. . . 
Js
3
75: 
Each block has one eigenvector, one eigenvalue, and is just above the diagonal: 
Ji = 
2
6664 
li 1
. .
. 1 
li
3
7775
: 
An example of such a Jordan matrix is 
J = 
2
666664 
8 1 0 0 0 
0 8 0 0 0 
0 0 0 1 0 
0 0 0 0 0 
0 0 0 0 0
3
777775
= 
2
66666664 
"
8 1 
0 8
# 
"
0 1 
0 0
# 
h
0
i
3
77777775 
= 
2
666664 
J1 
J2 
J3
3
777775
: 
The double eigenvalue l = 8 has only a single eigenvector, in the first coordinate direction 
e1 = (1;0;0;0;0); as a result, l = 8 appears only in a single block J1. The triple
Appendix B The Jordan Form 467 
eigenvalue l = 0 has two eigenvectors, e3 and e5, which correspond to the two Jordan 
blocks J2 and J3. If A had 5 eigenvectors, all blocks would be 1 by 1 and J would be 
diagonal. 
The key question is this: If A is some other 5 by 5 matrix, under what conditions will 
its Jordan form be this same J? When will there exist an M such that M.1AM = J? As a 
first requirement, any similar matrix A must share the same eigenvalues 8, 8, 0, 0, 0. But 
the diagonal matrix with these eigenvalues is not similar to J—and our question really 
concerns the eigenvectors. 
To answer it, we rewrite M.1AM = J in the simpler form AM = MJ: 
A
2
666664
x1 x2 x3 x4 x5
3
777775
= 
2
666664
x1 x2 x3 x4 x5
3
777775 
2
666664 
8 1 
0 8 
0 1 
0 0 
0
3
777775
: 
Carrying out the multiplications a column at a time, 
Ax1 = 8x1 and Ax2 = 8x2+x1 (1) 
Ax3 = 0x3 and Ax4 = 0x4+x3 and Ax5 = 0x5: (2) 
Now we can recognize the conditions on A. It must have three genuine eigenvectors, 
just as J has. The one with l = 8 will go into the first column of M, exactly as it would 
have gone into the first column of S: Ax1 = 8x1, The other two, which will be named 
x3 and x5, go into the third and fifth columns of M: Ax3 = Ax5 = 0. Finally there must 
be two other special vectors, the generalized eigenvectors x2 and x4. We think of x2 as 
belonging to a string of vectors, headed by x1 and described by equation (1). In fact, 
x2 is the only other vector in the string, and the corresponding block J1 is of order 2. 
Equation (2) describes two different strings, one in which x4 follows x3, and another in 
which x5 is alone; the blocks J2 and J3 are 2 by 2 and 1 by 1. 
The search for the Jordan form of A becomes a search for these strings of vectors, 
each one headed by an eigenvector: For every i, 
either Axi =lixi or Axi =lixi+xi.1: (3) 
The vectors xi go into the columns of M, and each string produces a single block in J. 
Essentially, we have to show how these strings can be constructed for every matrix A. 
Then if the strings match the particular equations (1) and (2), our J will be the Jordan 
form of A. 
I think that Filippov’s idea makes the construction as clear and simple as possible1. 
It proceeds by mathematical induction, starting from the fact that every 1 by 1 matrix 
1A. F, Filippov, A short proof of the reduction to Jordan form, Moscow Univ. Math. Bull., volume 26 (1971) 
pp. 70–71.
468 Appendix B The Jordan Form 
is already in its Jordan form. We may assume that the construction is achieved for all 
matrices of order less than n—this is the “induction hypothesis”—and then explain the 
steps for a matrix of order n. There are three steps, and after a general description we 
apply them to a specific example. 
Step 1. If we assume A is singular, then its column space has dimension r < n. Looking 
only within this smaller space, the induction hypothesis guarantees that a Jordan 
form is possible—there must be r independent vectors wi in the column space 
such that 
either Awi =liwi or Awi =liwi+wi.1: (4) 
Step 2. Suppose the nullspace and the column space of A have an intersection of dimension 
p. Of course, every vector in the nullspace is an eigenvector corresponding 
to l = 0. Therefore, there must have been p strings in step 1 that started from 
this eigenvalue, and we are interested in the vectors wi that come at the end of 
these strings. Each of these p vectors is in the column space, so each one is a 
combination of the columns of A: wi = Ayi for some yi. 
Step 3. The nullspace always has dimension n.r. Therefore, independent from its 
p-dimensional intersection with the column space, it must contain n.r . p 
additional basis vectors zi lying outside that intersection. 
Now we put these steps together to give Jordan’s theorem: 
The r vectors wi, the p vectors yi, and the n.r . p vectors zi form Jordan 
strings for the matrix A, and these vectors are linearly independent. They go 
into the columns of M, and J = M.1AM is in Jordan form. 
If we want to renumber these vectors as x1; : : : ;xn, and match them to equation (3), 
then each yi should be inserted immediately after the wi it came from; it completes a 
string in which li = 0. The z’s come at the very end, each one alone in its own string; 
again the eigenvalue is zero, since the z’s lie in the nullspace. The blocks with nonzero 
eigenvalues are already finished at step 1, the blocks with zero eigenvalues grow by one 
row and column at step 2, and step 3 contributes any 1 by 1 blocks Ji = [0]. 
Now we try an example, and to stay close to the previous pages we take the eigenvalues 
to be 8, 8, 0, 0, 0: 
A = 
2
666664 
8 0 0 8 8 
0 0 0 8 8 
0 0 0 0 0 
0 0 0 0 0 
0 0 0 0 8
3
777775
: 
Step 1. The column space has dimension r =3, and is spanned by the coordinate vectors 
e1;e2;e5. To look within this space we ignore the third and fourth rows and
Appendix B The Jordan Form 469 
columns of A; what is left has eigenvalues 8, 8, 0, and its Jordan form comes 
from the vectors 
w1 = 
2
666664 
8
0
0
0
0
3
777775
; w2 = 
2
666664 
0
1
0
0
1
3
777775
; w3 = 
2
666664 
0
8
0
0
0
3
777775
: 
The wi are in the column space, they complete the string for l = 8, and they 
start the string for l = 0: 
Aw1 = 8w1; Aw2 = 8w2+w1; Aw3 = 0w3: (5) 
Step 2. The nullspace of A contains e2 and e3, so its intersection with the column space 
is spanned by e2. Therefore p = 1 and, as expected, there is one string in equation 
(3) corresponding to l = 0. The vector w3 comes at the end (as well as the 
beginning) of that string, and w3 = A(e4.e1). Therefore y = e4.e1. 
Step 3. The example has n.r. p = 5.3.1 = 1, and z = e3 is in the nullspace but 
outside the column space. It will be this z that produces a 1 by 1 block in J. 
If we assemble all five vectors, the full strings are 
Aw1 = 8w1; Aw2 = 8w2+w1; Aw3 = 0w3; Ay = 0y+w3; Az = 0z: 
Comparing with equations (1) and (2), we have a perfect match—the Jordan form of our 
example will be exactly the J we wrote earlier. Putting the five vectors into the columns 
of M must give AM = MJ, or M.1AM = J: 
M = 
2
666664 
8 0 0 .1 0 
0 1 8 0 0 
0 0 0 0 1 
0 0 0 1 0 
0 1 0 0 0
3
777775
: 
We are sufficiently trustful of mathematics (or sufficiently lazy) not to multiply out 
M.1AM. 
In Filippov’s construction, the only technical point is to verify the independence of 
the whole collection wi, yi, and zi. Therefore, we assume that some combination is zero: 
aciwi+adiyi+agizi = 0: (6) 
Multiplying by A, and using equations (4) for the wi as well as Azi = 0, 
aci
2
64
liwi 
or 
liwi+wi.1
3
75
+adiAyi = 0: (7)
470 Appendix B The Jordan Form 
The Ayi are the special wi at the ends of strings corresponding to li = 0, so they cannot 
appear in the first sum. (They are multiplied by zero in liwi.) Since equation (7) is 
some combination of the wi, which were independent by the induction hypothesis—they 
supplied the Jordan form within the column space—we conclude that each di must be 
zero. Returning to equation (6), this leaves aciwi = .agizi, and the left-hand side is in 
the column space. Since the z’s were independent of that space, each gi must be zero. 
Finally, aciwi = 0, and the independence of the wi produces ci = 0. 
If the original A had not been singular, the three steps would have been applied instead 
to A0 =A.cI. (The constant c is chosen to make A0 singular, and it can be any one of the 
eigenvalues of A.) The algorithm puts A0 into its Jordan formM.1A0M =J0 by producing 
the strings xi from the wi, yi and zi. Then the Jordan form for A uses the same strings 
and the same M: 
M.1AM = M.1A0M+M.1cM = J0+cI = J: 
This completes the proof that every A is similar to some Jordan matrix J. Except for a 
reordering of the blocks, it is similar to only one such J; there is a unique Jordan form 
for A. Thus, the set of all matrices is split into a number of families, with the following 
property: All the matrices in the same family have the same Jordan form, and they are 
all similar to each other (and to J), but no matrices in different families are similar. In 
every family, J is the most beautiful—if you like matrices to be nearly diagonal. With 
this classification into families, we stop. 
Example 1. 
A = 
2
64
0 1 2 
0 0 1 
0 0 0
3
75
with l = 0;0;0: 
This matrix has rank r = 2 and only one eigenvector. Within the column space, there is 
a single string w1, w2, which happens to coincide with the last two columns: 
A
2
64
1
0
0
3
75
= 0 and A
2
64
2
1
0
3
75
= 
2
64
1
0
0
3
75
; 
or 
Aw1 = 0 and Aw2 = 0w2+w1: 
The nullspace lies entirely within the column space, and it is spanned by w1. Therefore 
p = 1 in step 2, and the vector y comes from the equation 
Ay = w2 = 
2
64
2
1
0
3
75
; where solution is y = 
2
64
0
0
1
3
75
:
Appendix B The Jordan Form 471 
Finally, the string w1, w2, y goes into the matrix M: 
M = 
2
64
1 2 0 
0 1 0 
0 0 1
3
75
; and M.1AM = 
2
64
0 1 0 
0 0 1 
0 0 0
3
75
= J: 
Application to du=dt = Au 
As always, we simplify the problem by uncoupling the unknowns. This uncoupling is 
complete only when there is a full set of eigenvectors, and u = Sv; the best change of 
variables in the present case is u=Mv. This produces the new equation Mdv=dt =AMv, 
or dv=dt = Jv, which is as simple as the circumstances allow. It is coupled only by the 
off-diagonal 1s within each Jordan block. In the preceding example, which has a single 
block, du=dt = Au becomes 
dv 
dt 
= 
2
64
0 1 0 
0 0 1 
0 0 0
3
75
v or 
da=dt = b 
db=dt = c 
dc=dt = 0 
or 
a = a0+b0t +c0t2=2 
b = b0+c0t 
c = c0: 
The system is solved by working upward from the last equation, and a new power of t 
enters at every step. (An ` by ` block has powers as high as t`.1.) The exponentials of 
J, in this case and in the earlier 5 by 5 example, are 
eJt = 
2
64
1 t t2=2 
0 1 t 
0 0 1 
3
75
and 
2
666664 
e8t te8t 0 0 0 
0 e8t 0 0 0 
0 0 1 t 0 
0 0 0 1 0 
0 0 0 0 1
3
777775
: 
You can see how the coefficients of a, b, and c appear in the first exponential. And in the 
second example, you can identify all five of the “special solutions” to du=dt =Au. Three 
of them are the pure exponentials u1 = e8tx1, u3 = e0tx3, and u5 = e0tx5, formed as usual 
from the three eigenvectors of A. The other two involve the generalized eigenvectors x2 
and x4: 
u2 = e8t(tx1+x2) and u4 = e0t(tx3+x4): (8) 
The most general solution to du=dt = Au is a combination c1u1 +. . .+c5u5, and the 
combination that matches u0 at time t = 0 is again 
u0 = c1x1+. . .+c5x5; or u0 = Mc; or c = M.1u0: 
This only means that u =MeJtM.1u0, and that the S and L in the old formula SeLtS.1u0 
have been replaced by M and J.
472 Appendix B The Jordan Form 
Problem Set B 
1. Find the Jordan forms (in three steps!) of 
A = 
"
1 1 
1 1
# 
and B = 
2
64
0 1 2 
0 0 0 
0 0 0
3
75
: 
2. Show that the special solution u2 in equation (17) does satisfy du=dt = Au, exactly 
because of the string Ax1 = 8x1, Ax7 = 8x7+x1. 
3. For the matrix B in Problem 1, use MeJtM.1 to compute the exponential eBt , and 
compare it with the power series I+Bt +(Bt)2=2!+. . . . 
4. Show that each Jordan block Ji is similar to its transpose, JT
i = P.1JiP, using the 
permutation matrix P with 1s along the cross-diagonal (lower left to upper right). 
Deduce that every matrix is similar to its transpose. 
5. Find “by inspection” the Jordan forms of 
A = 
2
64
1 2 3 
0 4 5 
0 0 6
3
75
and B = 
" 
1 1 
.1 .1
#
: 
6. Find the Jordan form J and the matrix M for A and B (B has eigenvalues 1, 1, 1, .1). 
What is the solution to du=dt = Au, and what is eAt? 
A = 
2
666664 
0 0 1 0 0 
0 0 0 1 0 
0 0 0 0 1 
0 0 0 0 0 
0 0 0 0 0
3
777775
and B = 
2
6664 
1 .1 0 .1 
0 2 0 1 
.2 1 .1 1 
2 .1 2 0 
3
7775
: 
7. Suppose that A2 = A. Show that its Jordan form J = M.1AM satisfies J2 = J. Since 
the diagonal blocks stay separate, this means J2
i = Ji for each block; show by direct 
computation that Ji can only be a 1 by 1 block, Ji = [0] or Ji = [1]. Thus, A is similar 
to a diagonal matrix of 0s and 1s. 
Note. This is a typical case of our closing theorem: The matrix A can be diagonalized if 
and only if the product (A.l1I)(A.l2I) . . . (A.lpI), without including any repetitions 
of the l ’s, is zero. One extreme case is a matrix with distinct eigenvalues; the Cayley- 
Hamilton theorem says that with n factors A.l I we always get zero. The other extreme 
is the identity matrix, also diagonalizable (p = 1 and A.I = 0). The nondiagonalizable 
matrix A = 
. 1 1 
0 1 
¤ 
satisfies not (A.I) = 0 but only (A.I)2 = 0—an equation with a 
repeated root.
Solutions to Selected [xercises 
Problem Set 1.2, page 9 
1. The lines intersect at (x, y) = (3, 1). Then 3 (column 1) + 1 (column 2) = (4,4). 
3. These "planes" intersect in a line in four-dimensional space. The fourth plane normally 
intersects that line in a point. An inconsistent equation like u + w = 5 leaves 
no solution (no intersection). 
5. The two points on the plane are (1,0, 0, 0) and (0, 1,0, 0). 
7. Solvable for (3,5,8) and (1,2,3); not solvable for b = (3,5,7) or b = (1,2,2). 
9. Column 3 = 2(column 2) -column 1. Ifb = (0,0 , 0),t hen (u, v, w) = (c,- 2c,c ) 
11. Both a = 2 and a = -2 give a line of solutions. All other a give x = 0, y = 0. 
13. The row picture has two lines meeting at (4, 2). The column picture has 4( 1, 1) + 
2(-2, 1) = 4(column 1) + 2(column 2) = right-hand side (0, 6). 
15. The row picture shows four lines. The column picture is in/our-dimensional space. 
No solution unless the right-hand side is a combination of the two columns. 
17. If x, y, z satisfy the first two equations, they also satisfy the third equation. The line 
L of solutions contains v = (1,1,0), W = (!, 1, !), and u = ..v + !w, and all 
combinations cv + d w with c + d == 1. 
19. Column 3 == column 1; solutions (x, y, z) = (1,1,0) or (0,1,1) and you can add 
any multiple of (-1,0, 1); b = (4,6, c) needs c = 10 for solvability. 
21. The second plane and row 2 of the matrix and all columns of the matrix are changed. 
The solution is not changed. 
23. u = 0, v = 0; w = 1, because 1 (column 3) = b. 
Problem Set 1a3, page 15 
1. Multiply by f = ..o = 5, and subtract to find 2x + 3y = 1 and -6y = 6. Pivots 
2, -6. 
3. Subtract -! times equation 1 (or add ! times equation 1). The new second equation 
is 3y = 3. Then y = 1 and x = 5. If the right-hand side changes sign, so does the 
solution: (x, y) = (-5, -1). 
5. 6x + 4y is 2 times 3x + 2y. There is no solution unless the right-hand side is 
2 . 1 ° = 20. Then all points on the line 3x + 2 y = 10 are solutions, including (0, 5) 
and (4, -1). 
7. If a = 2, elimination must fail. The equations have no solution. If a = 0, elimination 
stops for a row exchange. Then 3y = -3 gives y = -1 and 4x + 6y = 6 gives 
x = 3. 
9. 6x - 4y is 2 times (3x - 2y). Therefore, we need b2 = 2b1• Then there will be 
lnflnltAlu rrHlnu C'Al11t1AnC' Thi3 r-nl111'l'1nC' f.. A) ..nrl f_'J _Lt.) <:lri3 An thi3 C'f".l1"Y\O 111'113 
AppendixC 
Matrix Factorizations 
1. A = LU = 
A
lower triangular L 
1s on the diagonal
!A 
upper triangular U 
pivots on the diagonal
! 
Requirements: No row exchanges as Gaussian elimination reduces A to U. 
2. A = LDU = 
A
lower triangular L 
1s on the diagonal
!A 
pivot matrix 
D is diagonal
!A
upper triangular U 
1s on the diagonal
! 
Requirements: No row exchanges. The pivots in D are divided out to leave 1s in 
U. If A is symmetric, then U is LT and A = LDLT. 
3. PA = LU (permutation matrix P to avoid zeros in the pivot positions). 
Requirements: A is invertible. Then P, L, U are invertible. P does the row exchanges 
in advance. Alternative: A = L1P1U1. 
4. EA = R (m.m invertible E) (any A) = rref(A): 
Requirements: None! The reduced row echelon form R has r pivot rows and pivot 
columns. The only nonzero in a pivot column is the unit pivot. The Last m.r rows 
of E are a basis for the left nullspace of A. and the first r columns of E.1 are a basis 
for the column space of A. 
5. A =CCT = 
.
lower triangular matrix C
..
transpose is upper triangular
. 
Requirements: A is symmetric and positive definite (all n pivots in D are positive). 
This Cholesky factorization has C = L
p
D. 
6. A = QR = 
.
orthonormal columns in Q
..
upper triangular R
. 
Requirements: A has independent columns. Those are orthogonalized in Q by the 
Gram-Schmidt process. If A is square, then Q.1 = QT. 
7. A = SLS.1 = 
.
eigenvectors in S
..
eigenvalues in L
..
left eigenvectors in S.1
.
: 
Requirements: A must have n linearly independent eigenvectors.
474 Appendix C Matrix Factorizations 
8. A = QLQT = 
.
orthogonal matrix Q
..
real eigenvalue matrix L
..
QT is Q.1
.
: 
Requirements: A is symmetric. This is the Spectral Theorem. 
9. A = MJM.1 = 
.
generalized eigenvectors in M
..
Jordan blocks in J
..
M.1
.
: 
Requirements: A is any square matrix. Jordan form J has a block for each independent 
eigenvector of A. Each block has one eigenvalue. 
10. A =USVT = 
A
orthogonal 
U is m.m
!A 
m.n matrix S 
s1; : : : ;sr on diagonal
!A
orthogonal 
V is n.n 
!
: 
Requirements: None. This singular value decomposition (SVD) has the eigenvectors 
of AAT in U and of ATA in V; si =
p
li(ATA) =
p
li(AAT). 
11. A+ =VS+UT = 
A
orthogonal 
n.n 
!A
diagonal n.m 
1=s1; : : : ;1=sr
!A
orthogonal 
m.m 
!
: 
Requirements: None. The pseudoinverse has A+A = projection onto row space of 
A and AA+ = projection onto column space. The shortest least-squares solution to 
Ax = b is bx = A+b. This solves ATAbx = ATb. 
12. A = QH = 
.
orthogonal matrix Q
..
symmetric positive definite matrix H
.
: 
Requirements: A is invertible. This polar decomposition has H2 = ATA. The 
factor H is semidefinite if A is singular. The reverse polar decomposition A = KQ 
has K2 = AAT. Both have Q =UVT from the SVD. 
13. A =ULU.1 = 
.
unitary U
..
eigenvalue matrix L
..
U.1 =UH =UT
.
: 
Requirements: A is normal: AHA = AAH. Its orthonormal (and possibly complex) 
eigenvectors are the columns of U. Complex l ’s unless A = AH. 
14. A =UTU.1 = 
.
unitary U
..
triangular T with l ’s on diagonal
..
U.1 =UH
.
: 
Requirements: Schur triangularization of any square A. There is a matrix U with 
orthonormal columns that makes U.1AU triangular. 
15. Fn = 
"
I D 
I .D
#"
Fn=2 
Fn=2
#" 
even-odd 
permutation
# 
= one step of the FFT. 
Requirements: Fn = Fourier matrix with entries wjk where wn = 1, w = e2pi=n. 
Then FnFn = nI. D has 1;w;w2; : : : on its diagonal. For n = 2` the Fast Fourier 
Transform has 12
n` multiplications from ` stages of D’s.
AppendixD 
Glossary: A Dictionary for Linear Algebra 
Adjacency matrix of a graph Square matrix with ai j = 1 when there is an edge from 
node i to node j; otherwise ai j = 0. A = AT for an undirected graph. 
Affine transformation T(v) = Av+v0 = linear transformation plus shift. 
Associative Law (AB)C = A(BC) Parentheses can be removed to leave ABC. 
Augmented matrix [A b] Ax = b is solvable when b is in the column space of A; then 
[A b] has the same rank as A. Elimination on [A b] keeps equations correct. 
Back substitution Upper triangular systems are solved in reverse order xn to x1. 
Basis for V Independent vectors v1; : : : ;vd whose linear combinations give every v in 
V. A vector space has many bases! 
Big formula for n by n determinants det(A) is a sum of n! terms, one term for each 
permutation P of the columns. That term is the product a1a . . .anw down the diagonal 
of the reordered matrix, times det(P) = §1. 
Block matrix A matrix can be partitioned into matrix blocks, by cuts between rows 
and/or between columns. 
Block multiplication of AB is allowed if the block shapes permit (the columns of A 
and rows of B must be in matching blocks). 
Cayley-Hamilton Theorem p(l ) = det(A.l I) has p(A) = zero matrix. 
Change of basis matrix M The old basis vectors v j are combinations ami jwi of the 
new basis vectors. The coordinates of c1v1+. . .+cnvn = d1w1+. . .+dnwn are related 
by d = Mc. (For n = 2, set v1 = m11w1+m21w2, v2 = m12w1+m22w2.) 
Characteristic equation det(A.l I) = 0 The n roots are the eigenvalues of A. 
Cholesky factorization A =CCT = (L
p
D)(L
p
D)T for positive definite A.
476 Appendix D Glossary: A Dictionary for Linear Algebra 
Circulant matrix C Constant diagonals wrap around as in cyclic shift S. Every 
circulant is c0I+c1S+. . .+cn.1Sn.1. Cx = convolution c ¤ x. Eigenvectors in F. 
Cofactor Ci j Remove row i and column j; multiply the determinant by (.1)i+j. 
Column picture of Ax = b The vector b becomes a combination of the columns of A. 
The system is solvable only when b is in the column space C(A). 
Column space C(A) Space of all combinations of the columns of A. 
Commuting matrices AB = BA If diagonalizable, they share n eigenvectors. 
Companion matrix Put c1; : : : ;cn in row n and put n.1 1s along diagonal 1. Then 
det(A.l I) = §(c1+c2l +c3l 2+. . . ). 
Complete solution x = xp+xn to Ax = b (Particular xp) + (xn in nullspace). 
Complex conjugate z = a.ib for any complex number z = a+ib.Then zz = jzj2. 
Condition number cond(A) =k(A) = kAkkA.1k =smax=smin In Ax = b, the 
relative change kd xk=kxk is less than cond(A) times the relative change kd bk=kbk. 
Condition numbers measure the sensitivity of the output to change in the input. 
Conjugate Gradient Method A sequence of steps to solve positive definite Ax = b 
by minimizing 12
xTAx.xTb over growing Krylov subspaces. 
Covariance matrix S When random variables xi have mean = average value = 0, 
their covariances Si j are the averages of xix j. With means xi, the matrix S = mean of 
(x.x)(x.x)T is positive (semi)definite; it is diagonal if the xi are independent. 
Cramer’s Rule for Ax = b Bj has b replacing column j of A, and x j = jBjj=jAj. 
Cross product u.v in R3 Vector perpendicular to u and v, length kukkvkj sinq j = 
parallelogram area, computed as the “determinant” of [i j k; u1 u2 u3; v1 v2 v3]. 
Cyclic shift S Permutation with s21 = 1, s32 = 1; : : :, finally s1n = 1. Its eigenvalues 
are nth roots e2pik=n of 1; eigenvectors are columns of the Fourier matrix F. 
Determinant jAj = det(A) Defined by det I = 1, sign reversal for row exchange, and 
linearity in each row. Then jAj = 0 when A is singular. Also jABj = jAjjBj, 
jA.1j = 1=jAj, and jATj = jAj. The big formula for det(A) has a sum of n! terms, the 
cofactor formula uses determinants of size n.1, volume of box = j det(A)j. 
Diagonal matrix D di j = 0 if i 6= j. Block-diagonal: zero outside square blocks Dii. 
Diagonalizable matrix A Must have n independent eigenvectors (in the columns of 
S; automatic with n different eigenvalues). Then S.1AS = L = eigenvalue matrix.
Appendix D Glossary: A Dictionary for Linear Algebra 477 
Diagonalization L = S.1AS L = eigenvalue matrix and S = eigenvector matrix. A 
must have n independent eigenvectors to make S invertible. All Ak = SLkS.1. 
Dimension of vector space dim(V) = number of vectors in any basis for V. 
Distributive Law A(B+C) = AB+AC Add then multiply, or multiply then add. 
Dot product xTy = x1y1+. . .+xnyn Complex dot product is xTy. Perpendicular 
vectors have zero dot product. (AB)i j = (row i of A) . (column j of B). 
Echelon matrix U The first nonzero entry (the pivot) in each row comes after the 
pivot in the previous row. All zero rows come last. 
Eigenvalue l and eigenvector x Ax =l x with x 6= 0, so det(A.l I) = 0. 
Eigshow Graphical 2 by 2 eigenvalues and singular values (MATLAB or Java). 
Elimination A sequence of row operations that reduces A to an upper triangular U or 
to the reduced form R = rref(A). Then A = LU with multipliers `i j in L, or PA = LU 
with row exchanges in P, or EA = R with an invertible E. 
Elimination matrix = Elementary matrix Ei j The identity matrix with an extra 
.`i j in the i, j entry (i 6= j). Then Ei jA subtracts `i j times row j of A from row i. 
Ellipse (or ellipsoid) xTAx = 1 A must be positive definite; the axes of the ellipse are 
eigenvectors of A, with lengths 1=
p
l . (For kxk = 1 the vectors y = Ax lie on the 
ellipse kA.1yk2 = yT(AAT).1y = 1 displayed by eigshow; axis lengths si.) 
Exponential eAt = I+At +(At)2=2!+. . . has derivative AeAt ; eAtu(0) solves u0 = Au. 
Factorization A = LU If elimination takes A to U without row exchanges, then the 
lower triangular L with multipliers `i j (and `ii = 1) brings U back to A. 
Fast Fourier Transform (FFT) A factorization of the Fourier matrix Fn into 
` = log2 n matrices Si times a permutation. Each Si needs only n=2 multiplications, so 
Fnx and F.1 
n c can be computed with n`=2 multiplications. Revolutionary. 
Fibonacci numbers 0, 1, 1, 2, 3, 5,: : : satisfy 
Fn = Fn.1+Fn.2 = (l n 
1 .l n 
2 )=(l1.l2). Growth rate l1 = (1+
p
5)=2 the largest 
eigenvalue of the Fibonacci matrix 
. 1 1 
1 0 
¤
. 
Four fundamental subspaces of A C(A), N(A), C(AT), N(AT). 
Fourier matrix F Entries Fjk = e2pi jk=n give orthogonal columns FTF = nI. Then 
y = Fc is the (inverse) Discrete Fourier Transform y j = acke2pi jk=n. 
Free columns of A Columns without pivots; combinations of earlier columns.
478 Appendix D Glossary: A Dictionary for Linear Algebra 
Free variable xi Column i has no pivot in elimination. We can give the n.r free 
variables any values, then Ax = b determines the r pivot variables (if solvable!). 
Full column rank r = n Independent columns, N(A) = f0g, no free variables. 
Full row rank r = m Independent rows, at least one solution to Ax = b, column space 
is all of Rm. Full rank means full column rank or full row rank. 
Fundamental Theorem The nullspace N(A) and row space C(AT) are orthogonal 
complements (perpendicular subspaces of Rn with dimensions r and n.r) from 
Ax = 0. Applied to AT, the column space C(A) is the orthogonal complement of 
N(AT). 
Gauss-Jordan method Invert A by row operations on [A I] to reach [I A.1]. 
Gram-Schmidt orthogonalization A = QR Independent columns in A, orthonormal 
columns in Q. Each column qj of Q is a combination of the first j columns of A (and 
conversely, so R is upper triangular). Convention: diag(R) > 0. 
Graph G Set of n nodes connected pairwise by m edges. A complete graph has all 
n(n.1)=2 edges between nodes. A tree has only n.1 edges and no closed loops. A 
directed graph has a direction arrow specified on each edge. 
Hankel matrix H Constant along each antidiagonal; hi j depends on i+ j. 
Hermitian matrix AH = AT = A Complex analog of a symmetric matrix: aji = ai j. 
Hessenberg matrix H Triangular matrix with one extra nonzero adjacent diagonal. 
Hilbert matrix hilb(n) Entries Hi j = 1=(i+ j.1) = 
R 1 
0 xi.1x j.1dx. Positive definite 
but extremely small lmin and large condition number. 
Hypercube matrix P2 
L Row n+1 counts corners, edges, faces, : : :, of a cube in Rn. 
Identity matrix I (or In) Diagonal entries = 1, off-diagonal entries = 0. 
Incidence matrix of a directed graph The m by n edge-node incidence matrix has a 
row for each edge (node i to node j), with entries .1 and 1 in columns i and j. 
Indefinite matrix A symmetric matrix with eigenvalues of both signs (+ and .). 
Independent vectors v1; : : : ;vk No combination c1v1+. . .+ckvk = zero vector 
unless all ci = 0. If the v’s are the columns of A, the only solution to Ax = 0 is x = 0. 
Inverse matrix A.1 Square matrix with A.1A = I and AA.1 = I. No inverse if 
detA = 0 and rank(A) < n, and Ax = 0 for a nonzero vector x. The inverses of AB and 
AT are B.1A.1 and (A.1)T Cofactor formula (A.1)i j =Cji=detA.
Appendix D Glossary: A Dictionary for Linear Algebra 479 
Iterative method A sequence of steps intended to approach the desired solution. 
Jordan form J = M.1AM If A has s independent eigenvectors, its “generalized” 
eigenvector matrix M gives J = diag(J1; : : : ;Js). The block Jk is lkIk+Nk where Nk has 
1s on diagonal 1. Each block has one eigenvalue lk and one eigenvector (1;0; : : : ;0). 
Kirchhoff’s Laws Current law: net current (in minus out) is zero at each node. 
Voltage law: Potential differences (voltage drops) add to zero around any closed loop. 
Kronecker product (tensor product) A­B Blocks ai jB, eigenvalues lp(A)lq(B). 
Krylov subspace Kj(A;b) The subspace spanned by b;Ab; : : : ;Aj.1b. Numerical 
methods approximate A.1b by x j with residual b.Axj in this subspace. A good basis 
for Kj requires only multiplication by A at each step. 
Least-squares solution bx The vector bx that minimizes the error kek2 solves 
ATAbx = ATb. Then e = b.Abx is orthogonal to all columns of A. 
Left inverse A+ If A has full column rank n, then A+ = (ATA).1AT has A+A = In. 
Left nullspace N(AT) Nullspace of AT = “left nullspace” of A because yTA = 0T. 
Length kxk Square root of xTx (Pythagoras in n dimensions). 
Linear combination cv+dw or ac jv j Vector addition and scalar multiplication. 
Linear transformation T Each vector v in the input space transforms to T(v) in the 
output space, and linearity requires T(cv+dw) = cT (v)+dT(w). Examples: Matrix 
multiplication Av, differentiation in function space. 
Linearly dependent v1; : : : ;vn A combination other than all ci = 0 gives acivi = 0. 
Lucas numbers L = 2;1;3;4; : : :, satisfy Ln = Ln.1+Ln.2 =l n 
1 +l 2 
n , with 
eigenvalues l1;l2 = (1§
p
5)=2 of the Fibonacci matrix 
. 1 1 
1 0 
¤
. Compare L0 = 2 with 
Fibonacci. 
Markov matrix M All mi j . 0 and each column sum is 1. Largest eigenvalue l = 1. 
If mi j > 0, the columns of Mk approach the steady-state eigenvector Ms = s > 0. 
Matrix multiplication AB The i, j entry of AB is (row i of A) . (column j of B) 
= aaikbk j. By columns: column j of AB = A times column j of B. By rows: row i of A 
multiplies B. Columns times rows: AB = sum of (column k)(row k). All these 
equivalent definitions come from the rule that AB times x equals A times Bx. 
Minimal polynomial of A The lowest-degree polynomial with m(A) = zero matrix. 
The roots of m are eigenvalues, and m(l ) divides det(A.l I). 
Multiplication Ax = x1(column 1)+. . .+xn(column n) = combination of columns.
480 Appendix D Glossary: A Dictionary for Linear Algebra 
Multiplicities AM and GM The algebraic multiplicity AM of an eigenvalue l is the 
number of times l appears as a root of det(A.l I) = 0. The geometric multiplicity 
GM is the number of independent eigenvectors (= dimension of the eigenspace for l ). 
Multiplier `i j The pivot row j is multiplied by `i j and subtracted from row i to 
eliminate the i, j entry: `i j = (entry to eliminate)=( jth pivot). 
Network A directed graph that has constants c1; : : : ;cm associated with the edges. 
Nilpotent matrix N Some power of N is the zero matrix, Nk = 0. The only 
eigenvalue is l = 0 (repeated n times). Examples: triangular matrices with zero 
diagonal. 
Norm kAk of a matrix The “`2 norm” is the maximum ratio kAxk=kxk =smax. Then 
kAxk · kAkkxk, kABk · kAkkBk, and kA+Bk · kAk+kBk. Frobenius norm 
kAk2
F = aaa2i
j; `1 and `. norms are largest column and row sums of jai jj. 
Normal equation ATAbx = ATb Gives the least-squares solution to Ax = b if A has full 
rank n. The equation says that (columns of A) . (b.Abx) = 0. 
Normal matrix N NNT = NTN, leads to orthonormal (complex) eigenvectors. 
Nullspace matrix N The columns of N are the n.r special solutions to As = 0. 
Nullspace N(A) Solutions to Ax = 0. Dimension n.r = (# columns) . rank. 
Orthogonal matrix Q Square matrix with orthonormal columns, so QTQ = I implies 
QT = Q.1. Preserves length and angles, kQxk = kxk and (Qx)T(Qy) = xTy. All 
jl j = 1, with orthogonal eigenvectors. Examples: Rotation, reflection, permutation. 
Orthogonal subspaces Every v in V is orthogonal to every w in W. 
Orthonormal vectors q1; : : : ;qn Dot products are qTi
qj = 0, if i 6= j and qTi
qj = 1. 
The matrix Q with these orthonormal columns has QTQ = I. If m = n, then QT = Q.1 
and q1; : : : ;qn is an orthonormal basis for Rn: every v = a(vTqj)qj. 
Outer product is uvT column times row = rank-1 matrix. 
Partial pivoting In elimination, the jth pivot is chosen as the largest available entry 
(in absolute value) in column j. Then all multipliers have j`i jj · 1. Roundoff error is 
controlled (depending on the condition number of A). 
Particular solution xp Any solution to Ax = b; often xp has free variables = 0. 
Pascal matrix PS = pascal(n) The symmetric matrix with binomial entries 
.i+j.2 
i.1 
.
. 
PS = PLPU all contain Pascal’s triangle with det = 1 (see index for more properties).
Appendix D Glossary: A Dictionary for Linear Algebra 481 
Permutation matrix P There are n! orders of 1; : : : ;n; the n! P’s have the rows of I in 
those orders. PA puts the rows of A in the same order. P is a product of row exchanges 
Pi j; P is even or odd (detP = 1 or .1) based on the number of exchanges. 
Pivot columns of A Columns that contain pivots after row reduction; not 
combinations of earlier columns. The pivot columns are a basis for the column space. 
Pivot d The first nonzero entry when a row is used in elimination. 
Plane (or hyperplane) in Rn Solutions to aTx = 0 give the plane (dimension n.1) 
perpendicular to a 6= 0. 
Polar decomposition A = QH Orthogonal Q, positive (semi)definite H. 
Positive definite matrix A Symmetric matrix with positive eigenvalues and positive 
pivots. Definition: xTAx > 0 unless x = 0. 
Projection matrix P onto subspace S Projection p = Pb is the closest point to b in 
S, error e = b.Pb is perpendicular to S. P2 = P = PT, eigenvalues are 1 or 0, 
eigenvectors are in S or S?. If columns of A = basis for S, then P = A(ATA).1AT. 
Projection p = a(aTb=aTa) onto the line through a P = aaT=aTa has rank 1. 
Pseudoinverse A+ (Moore-Penrose inverse) The n by m matrix that “inverts” A 
from column space back to row space, with N(A+) = N(AT). A+A and AA+ are the 
projection matrices onto the row space and column space. rank(A+) = rank(A). 
Random matrix rand(n) or randn(n) MATLAB creates a matrix with random entries, 
uniformly distributed on [0 1] for rand, and standard normal distribution for randn. 
Rank 1 matrix A = uvT 6= 0 Column and row spaces = lines cu and cv. 
Rank r(A) Equals number of pivots = dimension of column space = dimension of 
row space. 
Rayleigh quotient q(x) = xTAx=xTx For A = AT, lmin · q(x) ·lmax. Those 
extremes are reached at the eigenvectors x for lmin(A) and lmax(A). 
Reduced row echelon form R = rref(A) Pivots= 1; zeros above and below pivots; r 
nonzero rows of R give a basis for the row space of A. 
Reflection matrix Q = I.2uuT The unit vector u is reflected to Qu = .u. All 
vectors x in the plane uTx = 0 are unchanged because Qx = x. The “Householder 
matrix” has QT = Q.1 = Q. 
Right inverse A+ If A has full row rank m, then A+ = AT(AAT).1 has AA+ = Im.
482 Appendix D Glossary: A Dictionary for Linear Algebra 
Rotation matrix R = 
. cosq .sinq 
sinq cosq 
¤ 
rotates the plane by q , and R.1 = RT rotates back 
by .q . Orthogonal matrix, eigenvalues eiq and e.iq , eigenvectors (1;§i). 
Row picture of Ax = b Each equation gives a plane in Rn planes intersect at x. 
Row space C(AT) All combinations of rows of A. Column vectors by convention. 
Saddle point of f (x1; : : : ;xn) A point where the first derivatives of f are zero and the 
second derivative matrix (¶ 2 f =¶ xi¶ x j = Hessian matrix) is indefinite. 
Schur complement S = D.CA.1B Appears in block elimination on 
. A B 
C D
¤
. 
Schwarz inequality jv .wj · kvkkwk Then jvTAwj2 · (vTAv)(wTAw) if A =CTC. 
Semidefinite matrix A (Positive) semidefinite means symmetric with xTAx . 0 for 
all vectors x. Then all eigenvalues l . 0; no negative pivots. 
Similar matrices A and B B = M.1AM has the same eigenvalues as A. 
Simplex method for linear programming The minimum cost vector x¤ is found by 
moving from corner to lower-cost corner along the edges of the feasible set (where the 
constraints Ax = b and x . 0 are satisfied). Minimum cost at a corner! 
Singular matrix A A square matrix that has no inverse: det(A) = 0. 
Singular Value Decomposition (SVD) A =USVT = (orthogonal U) times (diagonal 
S) times (orthogonal VT) First r columns of U and V are orthonormal bases of C(A) 
and C(AT), with Avi =siui and singular value si > 0. Last columns of U and V are 
orthonormal bases of the nullspaces of AT and A. 
Skew-symmetric matrix K The transpose is .K, since Ki j = .Kji. Eigenvalues are 
pure imaginary, eigenvectors are orthogonal, eKt is an orthogonal matrix. 
Solvable system Ax = b The right side b is in the column space of A. 
Spanning set v1; : : : ;vm, for V Every vector in V is a combination of v1; : : : ;vm. 
Special solutions to As = 0 One free variable is si = 1, other free variables = 0. 
Spectral theorem A = QLQT Real symmetric A has real li and orthonormal qi, with 
Aqi =liqi. In mechanics, the qi give the principal axes. 
Spectrum of A The set of eigenvalues fl1; : : : ;lmg. Spectral radius = jlmaxj. 
Standard basis for Rn Columns of n by n identity matrix (written i; j;k in R3). 
Stiffness matrix K When x gives the movements of the nodes in a discrete structure, 
Kx gives the internal forces. Often K = ATCA, where C contains spring constants from 
Hooke’s Law and Ax = stretching (strains) from the movements x.
Appendix D Glossary: A Dictionary for Linear Algebra 483 
Subspace S of V Any vector space inside V, including V and Z = fzero vectorg. 
Sum V+Wof subspaces Space of all (v in V)+(w in W). Direct sum: 
dim(V+W) = dimV+dimW, when V andW share only the zero vector. 
Symmetric factorizations A = LDLT and A = QLQT The number of positive pivots 
in D and positive eigenvalues in L is the same. 
Symmetric matrix A The transpose is AT = A, and ai j = aji. A.1 is also symmetric. 
All matrices of the form RTR and LDLT and QLQT are symmetric. Symmetric matrices 
have real eigenvalues in L and orthonormal eigenvectors in Q. 
Toeplitz matrix T Constant-diagonal matrix, so ti j depends only on j.i. Toeplitz 
matrices represent linear time-invariant filters in signal processing. 
Trace of A Sum of diagonal entries = sum of eigenvalues of A. TrAB = TrBA. 
Transpose matrix AT Entries ATi
j = Aji. AT is n by m, ATA is square, symmetric, 
positive semidefinite. The transposes of AB and A.1 are BTAT and (AT).1. 
Triangle inequality ku+vk · kuk+kvk For matrix norms, kA+Bk · kAk+kBk. 
Tridiagonal matrix T ti j = 0 if ji. jj > 1. T.1 has rank 1 above and below diagonal. 
Unitary matrix UH =UT =U.1 Orthonormal columns (complex analog of Q). 
Vandermonde matrix V Vc = b gives the polynomial p(x) = c0+. . .+cn.1xn.1 
with p(xi) = bi at n points. Vi j = (xi) j.1, and detV = product of (xk.xi) for k > i. 
Vector addition v+w = (v1+w1; : : : ;vn+wn) = diagonal of parallelogram. 
Vector space V Set of vectors such that all combinations cv+dw remain in V. Eight 
required rules are given in Section 2.1 for cv+dw. 
Vector v in Rn Sequence of n real numbers v = (v1; : : : ;vn) = point in Rn. 
Volume of box The rows (or columns) of A generate a box with volume j det(A)j. 
Wavelets wjk(t) or vectors wjk Rescale and shift the time axis to create 
wjk(t) = w00(2jt .k). Vectors from w00 = (1;1;.1;.1) would be (1;.1;0;0) and 
(0;0;1;.1).
AppendixE 
MATLAB Teaching Codes 
cofactor Compute the n by n matrix of cofactors. 
cramer Solve the system Ax = b by Cramer’s Rule. 
deter Matrix determinant computed from the pivots in PA = LU. 
eigen2 Eigenvalues, eigenvectors, and det(A.l I) for 2 by 2 matrices. 
eigshow Graphical demonstration of eigenvalues and singular values. 
eigval Eigenvalues and their multiplicity as roots of det(A.l I) = 0. 
eigvec Compute as many linearly independent eigenvectors as possible. 
elim Reduction of A to row echelon form R by an invertible E. 
findpiv Find a pivot for Gaussian elimination (used by plu). 
fourbase Construct bases for all four fundamental subspaces. 
grams Gram-Schmidt orthogonalization of the columns of A. 
house 2 by 12 matrix giving corner coordinates of a house. 
inverse Matrix inverse (if it exists) by Gauss-Jordan elimination. 
leftnull Compute a basis for the left nullspace. 
linefit Plot the least squares fit to m given points by a line. 
lsq Least-squares solution to Ax = b from ATA = ATb. 
normal Eigenvalues and orthonormal eigenvectors when ATA = AAT. 
nulbasis Matrix of special solutions to Ax = 0 (basis for null space). 
orthcomp Find a basis for the orthogonal complement of a subspace. 
partic Particular solution of Ax = b, with all free variables zero.
Appendix E MATLAB Teaching Codes 485 
plot2d Two-dimensional plot for the house figures. 
plu Rectangular PA = LU factorization with row exchanges. 
poly2str Express a polynomial as a string. 
project Project a vector b onto the column space of A. 
projmat Construct the projection matrix onto the column space of A. 
randperm Construct a random permutation. 
rowbasis Compute a basis for the row space from the pivot rows of R. 
samespan Test whether two matrices have the same column space. 
signperm Determinant of the permutation matrix with rows ordered by p. 
slu LU factorization of a square matrix using no row exchanges. 
slv Apply slu to solve the system Ax = b allowing no row exchanges. 
splu Square PA = LU factorization with row exchanges. 
splv The solution to a square, invertible system Ax = b. 
symmeig Compute the eigenvalues and eigenvectors of a symmetric matrix. 
tridiag Construct a tridiagonal matrix with constant diagonals a, b, c. 
These Teaching Codes are directly available from the Linear Algebra Home Page: 
http://web.mit.edu/18.06/www. 
They were written in MATLAB , and translated into Maple and Mathematica.
AppendixF 
Linear Algebra in a Nutshell 
(A is n by n) 
Nonsingular Singular 
A is invertible. A is not invertible. 
The columns are independent. The columns are dependent. 
The rows are independent. The rows are dependent. 
The determinant is not zero. The determinant is zero. 
Ax = 0 has one solution x = 0. Ax = 0 has infinitely many solutions. 
Ax = b has one solution x = A.1b. Ax = b has no solution or infinitely many. 
A has n (nonzero) pivots. A has r < n pivots. 
A has full rank r = n. A has rank r < n. 
The reduced row echelon form is R = I. R has at least one zero row. 
The column space is all of Rn. The column space has dimension r < n. 
The row space is all of Rn. The row space has dimension r < n. 
All eigenvalues are nonzero. Zero is an eigenvalue of A. 
ATA is symmetric positive definite. ATA is only semidefinite. 
A has n (positive) singular values. A has r < n singular values. 
Each line of the singular column can be made quantitative using r.
